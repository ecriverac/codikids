"use strict";var Blockly={};Blockly.Blocks=Object.create(null),Blockly.utils={},Blockly.utils.global=function(){return"object"==typeof self?self:"object"==typeof window?window:"object"==typeof global?global:this}(),Blockly.Msg={},Blockly.utils.global.Blockly||(Blockly.utils.global.Blockly={}),Blockly.utils.global.Blockly.Msg||(Blockly.utils.global.Blockly.Msg=Blockly.Msg),Blockly.utils.Coordinate=function(t,e){this.x=t,this.y=e},Blockly.utils.Coordinate.equals=function(t,e){return t==e||!(!t||!e)&&t.x==e.x&&t.y==e.y},Blockly.utils.Coordinate.distance=function(t,e){var o=t.x-e.x,l=t.y-e.y;return Math.sqrt(o*o+l*l)},Blockly.utils.Coordinate.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},Blockly.utils.Coordinate.difference=function(t,e){return new Blockly.utils.Coordinate(t.x-e.x,t.y-e.y)},Blockly.utils.Coordinate.sum=function(t,e){return new Blockly.utils.Coordinate(t.x+e.x,t.y+e.y)},Blockly.utils.Coordinate.prototype.scale=function(t){return this.x*=t,this.y*=t,this},Blockly.utils.Coordinate.prototype.translate=function(t,e){return this.x+=t,this.y+=e,this},Blockly.utils.string={},Blockly.utils.string.startsWith=function(t,e){return 0==t.lastIndexOf(e,0)},Blockly.utils.string.shortestStringLength=function(t){return t.length?t.reduce((function(t,e){return t.length<e.length?t:e})).length:0},Blockly.utils.string.commonWordPrefix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;for(var o=0,l=e||Blockly.utils.string.shortestStringLength(t),i=0;i<l;i++){for(var n=t[0][i],r=1;r<t.length;r++)if(n!=t[r][i])return o;" "==n&&(o=i+1)}for(r=1;r<t.length;r++)if((n=t[r][i])&&" "!=n)return o;return l},Blockly.utils.string.commonWordSuffix=function(t,e){if(!t.length)return 0;if(1==t.length)return t[0].length;for(var o=0,l=e||Blockly.utils.string.shortestStringLength(t),i=0;i<l;i++){for(var n=t[0].substr(-i-1,1),r=1;r<t.length;r++)if(n!=t[r].substr(-i-1,1))return o;" "==n&&(o=i+1)}for(r=1;r<t.length;r++)if((n=t[r].charAt(t[r].length-i-1))&&" "!=n)return o;return l},Blockly.utils.string.wrap=function(t,e){for(var o=t.split("\n"),l=0;l<o.length;l++)o[l]=Blockly.utils.string.wrapLine_(o[l],e);return o.join("\n")},Blockly.utils.string.wrapLine_=function(t,e){if(t.length<=e)return t;for(var o=t.trim().split(/\s+/),l=0;l<o.length;l++)o[l].length>e&&(e=o[l].length);l=-1/0;var i=1;do{var n=l,r=t,s=[],c=o.length/i,a=1;for(l=0;l<o.length-1;l++)a<(l+1.5)/c?(a++,s[l]=!0):s[l]=!1;s=Blockly.utils.string.wrapMutate_(o,s,e),l=Blockly.utils.string.wrapScore_(o,s,e),t=Blockly.utils.string.wrapToText_(o,s),i++}while(l>n);return r},Blockly.utils.string.wrapScore_=function(t,e,o){for(var l=[0],i=[],n=0;n<t.length;n++)l[l.length-1]+=t[n].length,!0===e[n]?(l.push(0),i.push(t[n].charAt(t[n].length-1))):!1===e[n]&&l[l.length-1]++;for(t=Math.max.apply(Math,l),n=e=0;n<l.length;n++)e-=2*Math.pow(Math.abs(o-l[n]),1.5),e-=Math.pow(t-l[n],1.5),-1!=".?!".indexOf(i[n])?e+=o/3:-1!=",;)]}".indexOf(i[n])&&(e+=o/4);return 1<l.length&&l[l.length-1]<=l[l.length-2]&&(e+=.5),e},Blockly.utils.string.wrapMutate_=function(t,e,o){for(var l,i=Blockly.utils.string.wrapScore_(t,e,o),n=0;n<e.length-1;n++)if(e[n]!=e[n+1]){var r=[].concat(e);r[n]=!r[n],r[n+1]=!r[n+1];var s=Blockly.utils.string.wrapScore_(t,r,o);s>i&&(i=s,l=r)}return l?Blockly.utils.string.wrapMutate_(t,l,o):e},Blockly.utils.string.wrapToText_=function(t,e){for(var o=[],l=0;l<t.length;l++)o.push(t[l]),void 0!==e[l]&&o.push(e[l]?"\n":" ");return o.join("")},Blockly.utils.Size=function(t,e){this.width=t,this.height=e},Blockly.utils.Size.equals=function(t,e){return t==e||!(!t||!e)&&t.width==e.width&&t.height==e.height},Blockly.utils.style={},Blockly.utils.style.getSize=function(t){if("none"!=Blockly.utils.style.getStyle_(t,"display"))return Blockly.utils.style.getSizeWithDisplay_(t);var e=t.style,o=e.display,l=e.visibility,i=e.position;e.visibility="hidden",e.position="absolute",e.display="inline";var n=t.offsetWidth;return t=t.offsetHeight,e.display=o,e.position=i,e.visibility=l,new Blockly.utils.Size(n,t)},Blockly.utils.style.getSizeWithDisplay_=function(t){return new Blockly.utils.Size(t.offsetWidth,t.offsetHeight)},Blockly.utils.style.getStyle_=function(t,e){return Blockly.utils.style.getComputedStyle(t,e)||Blockly.utils.style.getCascadedStyle(t,e)||t.style&&t.style[e]},Blockly.utils.style.getComputedStyle=function(t,e){if(document.defaultView&&document.defaultView.getComputedStyle){var o=document.defaultView.getComputedStyle(t,null);if(o)return o[e]||o.getPropertyValue(e)||""}return""},Blockly.utils.style.getCascadedStyle=function(t,e){return t.currentStyle?t.currentStyle[e]:null},Blockly.utils.style.getPageOffset=function(t){var e=new Blockly.utils.Coordinate(0,0);t=t.getBoundingClientRect();var o=document.documentElement;return o=new Blockly.utils.Coordinate(window.pageXOffset||o.scrollLeft,window.pageYOffset||o.scrollTop),e.x=t.left+o.x,e.y=t.top+o.y,e},Blockly.utils.style.getViewportPageOffset=function(){var t=document.body,e=document.documentElement;return new Blockly.utils.Coordinate(t.scrollLeft||e.scrollLeft,t.scrollTop||e.scrollTop)},Blockly.utils.style.setElementShown=function(t,e){t.style.display=e?"":"none"},Blockly.utils.style.isRightToLeft=function(t){return"rtl"==Blockly.utils.style.getStyle_(t,"direction")},Blockly.utils.style.getBorderBox=function(t){var e=Blockly.utils.style.getComputedStyle(t,"borderLeftWidth"),o=Blockly.utils.style.getComputedStyle(t,"borderRightWidth"),l=Blockly.utils.style.getComputedStyle(t,"borderTopWidth");return t=Blockly.utils.style.getComputedStyle(t,"borderBottomWidth"),{top:parseFloat(l),right:parseFloat(o),bottom:parseFloat(t),left:parseFloat(e)}},Blockly.utils.style.scrollIntoContainerView=function(t,e,o){t=Blockly.utils.style.getContainerOffsetToScrollInto(t,e,o),e.scrollLeft=t.x,e.scrollTop=t.y},Blockly.utils.style.getContainerOffsetToScrollInto=function(t,e,o){var l=Blockly.utils.style.getPageOffset(t),i=Blockly.utils.style.getPageOffset(e),n=Blockly.utils.style.getBorderBox(e),r=l.x-i.x-n.left;return l=l.y-i.y-n.top,i=Blockly.utils.style.getSizeWithDisplay_(t),t=e.clientWidth-i.width,i=e.clientHeight-i.height,n=e.scrollLeft,e=e.scrollTop,o?(n+=r-t/2,e+=l-i/2):(n+=Math.min(r,Math.max(r-t,0)),e+=Math.min(l,Math.max(l-i,0))),new Blockly.utils.Coordinate(n,e)},Blockly.utils.userAgent={},function(t){function e(t){return-1!=o.indexOf(t.toUpperCase())}Blockly.utils.userAgent.raw=Blockly.utils.global.navigator&&Blockly.utils.global.navigator.userAgent||"";var o=Blockly.utils.userAgent.raw.toUpperCase();Blockly.utils.userAgent.IE=e("Trident")||e("MSIE"),Blockly.utils.userAgent.EDGE=e("Edge"),Blockly.utils.userAgent.JAVA_FX=e("JavaFX"),Blockly.utils.userAgent.WEBKIT=e("WebKit")&&!Blockly.utils.userAgent.EDGE,Blockly.utils.userAgent.GECKO=e("Gecko")&&!Blockly.utils.userAgent.WEBKIT&&!Blockly.utils.userAgent.IE&&!Blockly.utils.userAgent.EDGE,Blockly.utils.userAgent.ANDROID=e("Android"),Blockly.utils.userAgent.IPAD=e("iPad"),Blockly.utils.userAgent.IPOD=e("iPod"),Blockly.utils.userAgent.IPHONE=e("iPhone")&&!Blockly.utils.userAgent.IPAD&&!Blockly.utils.userAgent.IPOD,Blockly.utils.userAgent.MAC=e("Macintosh"),Blockly.utils.userAgent.TABLET=Blockly.utils.userAgent.IPAD||Blockly.utils.userAgent.ANDROID&&!e("Mobile")||e("Silk"),Blockly.utils.userAgent.MOBILE=!Blockly.utils.userAgent.TABLET&&(Blockly.utils.userAgent.IPOD||Blockly.utils.userAgent.IPHONE||Blockly.utils.userAgent.ANDROID||e("IEMobile"))}(),Blockly.utils.noEvent=function(t){t.preventDefault(),t.stopPropagation()},Blockly.utils.isTargetInput=function(t){return"textarea"==t.target.type||"text"==t.target.type||"number"==t.target.type||"email"==t.target.type||"password"==t.target.type||"search"==t.target.type||"tel"==t.target.type||"url"==t.target.type||t.target.isContentEditable},Blockly.utils.getRelativeXY=function(t){var e=new Blockly.utils.Coordinate(0,0),o=t.getAttribute("x");return o&&(e.x=parseInt(o,10)),(o=t.getAttribute("y"))&&(e.y=parseInt(o,10)),(o=(o=t.getAttribute("transform"))&&o.match(Blockly.utils.getRelativeXY.XY_REGEX_))&&(e.x+=Number(o[1]),o[3]&&(e.y+=Number(o[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(Blockly.utils.getRelativeXY.XY_STYLE_REGEX_))&&(e.x+=Number(t[1]),t[3]&&(e.y+=Number(t[3]))),e},Blockly.utils.getInjectionDivXY_=function(t){for(var e=0,o=0;t;){var l=Blockly.utils.getRelativeXY(t);if(e+=l.x,o+=l.y,-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv "))break;t=t.parentNode}return new Blockly.utils.Coordinate(e,o)},Blockly.utils.getRelativeXY.XY_REGEX_=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Blockly.utils.getRelativeXY.XY_STYLE_REGEX_=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Blockly.utils.isRightButton=function(t){return!(!t.ctrlKey||!Blockly.utils.userAgent.MAC)||2==t.button},Blockly.utils.mouseToSvg=function(t,e,o){var l=e.createSVGPoint();return l.x=t.clientX,l.y=t.clientY,o||(o=e.getScreenCTM().inverse()),l.matrixTransform(o)},Blockly.utils.getScrollDeltaPixels=function(t){switch(t.deltaMode){case 0:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*Blockly.LINE_MODE_MULTIPLIER,y:t.deltaY*Blockly.LINE_MODE_MULTIPLIER};case 2:return{x:t.deltaX*Blockly.PAGE_MODE_MULTIPLIER,y:t.deltaY*Blockly.PAGE_MODE_MULTIPLIER}}},Blockly.utils.tokenizeInterpolation=function(t){return Blockly.utils.tokenizeInterpolation_(t,!0)},Blockly.utils.replaceMessageReferences=function(t){return"string"!=typeof t?t:(t=Blockly.utils.tokenizeInterpolation_(t,!1)).length?t[0]:""},Blockly.utils.checkMessageReferences=function(t){for(var e=!0,o=Blockly.Msg,l=t.match(/%{BKY_[A-Z]\w*}/gi),i=0;i<l.length;i++)null==o[l[i].toUpperCase().slice(6,-1)]&&(console.log("WARNING: No message string for "+l[i]+" in "+t),e=!1);return e},Blockly.utils.tokenizeInterpolation_=function(t,e){var o=[],l=t.split("");l.push("");for(var i=0,n=[],r=null,s=0;s<l.length;s++){var c=l[s];0==i?"%"==c?((c=n.join(""))&&o.push(c),n.length=0,i=1):n.push(c):1==i?"%"==c?(n.push(c),i=0):e&&"0"<=c&&"9">=c?(i=2,r=c,(c=n.join(""))&&o.push(c),n.length=0):"{"==c?i=3:(n.push("%",c),i=0):2==i?"0"<=c&&"9">=c?r+=c:(o.push(parseInt(r,10)),s--,i=0):3==i&&(""==c?(n.splice(0,0,"%{"),s--,i=0):"}"!=c?n.push(c):(i=n.join(""),/[A-Z]\w*/i.test(i)?(c=i.toUpperCase(),(c=Blockly.utils.string.startsWith(c,"BKY_")?c.substring(4):null)&&c in Blockly.Msg?"string"==typeof(i=Blockly.Msg[c])?Array.prototype.push.apply(o,Blockly.utils.tokenizeInterpolation_(i,e)):o.push(e?String(i):i):o.push("%{"+i+"}")):o.push("%{"+i+"}"),i=n.length=0))}for((c=n.join(""))&&o.push(c),l=[],s=n.length=0;s<o.length;++s)"string"==typeof o[s]?n.push(o[s]):((c=n.join(""))&&l.push(c),n.length=0,l.push(o[s]));return(c=n.join(""))&&l.push(c),n.length=0,l},Blockly.utils.genUid=function(){for(var t=Blockly.utils.genUid.soup_.length,e=[],o=0;20>o;o++)e[o]=Blockly.utils.genUid.soup_.charAt(Math.random()*t);return e.join("")},Blockly.utils.genUid.soup_="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Blockly.utils.is3dSupported=function(){if(void 0!==Blockly.utils.is3dSupported.cached_)return Blockly.utils.is3dSupported.cached_;if(!Blockly.utils.global.getComputedStyle)return!1;var t=document.createElement("p"),e="none",o={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};for(var l in document.body.insertBefore(t,null),o)if(void 0!==t.style[l]){if(t.style[l]="translate3d(1px,1px,1px)",!(e=Blockly.utils.global.getComputedStyle(t)))return document.body.removeChild(t),!1;e=e.getPropertyValue(o[l])}return document.body.removeChild(t),Blockly.utils.is3dSupported.cached_="none"!==e,Blockly.utils.is3dSupported.cached_},Blockly.utils.runAfterPageLoad=function(t){if("object"!=typeof document)throw Error("Blockly.utils.runAfterPageLoad() requires browser document.");if("complete"==document.readyState)t();else var e=setInterval((function(){"complete"==document.readyState&&(clearInterval(e),t())}),10)},Blockly.utils.getViewportBBox=function(){var t=Blockly.utils.style.getViewportPageOffset();return{right:document.documentElement.clientWidth+t.x,bottom:document.documentElement.clientHeight+t.y,top:t.y,left:t.x}},Blockly.utils.arrayRemove=function(t,e){var o=t.indexOf(e);return-1!=o&&(t.splice(o,1),!0)},Blockly.utils.getDocumentScroll=function(){var t=document.documentElement,e=window;return Blockly.utils.userAgent.IE&&e.pageYOffset!=t.scrollTop?new Blockly.utils.Coordinate(t.scrollLeft,t.scrollTop):new Blockly.utils.Coordinate(e.pageXOffset||t.scrollLeft,e.pageYOffset||t.scrollTop)},Blockly.utils.getBlockTypeCounts=function(t,e){var o,l=Object.create(null),i=t.getDescendants(!0);if(e){var n=t.getNextBlock();n&&(n=i.indexOf(n),i.splice(n,i.length-n))}for(n=0;o=i[n];n++)l[o.type]?l[o.type]++:l[o.type]=1;return l},Blockly.utils.screenToWsCoordinates=function(t,e){var o=e.x,l=e.y,i=t.getInjectionDiv().getBoundingClientRect();return o=new Blockly.utils.Coordinate(o-i.left,l-i.top),l=t.getOriginOffsetInPixels(),Blockly.utils.Coordinate.difference(o,l).scale(1/t.scale)},Blockly.Events={},Blockly.Events.group_="",Blockly.Events.recordUndo=!0,Blockly.Events.disabled_=0,Blockly.Events.CREATE="create",Blockly.Events.BLOCK_CREATE=Blockly.Events.CREATE,Blockly.Events.DELETE="delete",Blockly.Events.BLOCK_DELETE=Blockly.Events.DELETE,Blockly.Events.CHANGE="change",Blockly.Events.BLOCK_CHANGE=Blockly.Events.CHANGE,Blockly.Events.MOVE="move",Blockly.Events.BLOCK_MOVE=Blockly.Events.MOVE,Blockly.Events.VAR_CREATE="var_create",Blockly.Events.VAR_DELETE="var_delete",Blockly.Events.VAR_RENAME="var_rename",Blockly.Events.UI="ui",Blockly.Events.COMMENT_CREATE="comment_create",Blockly.Events.COMMENT_DELETE="comment_delete",Blockly.Events.COMMENT_CHANGE="comment_change",Blockly.Events.COMMENT_MOVE="comment_move",Blockly.Events.FINISHED_LOADING="finished_loading",Blockly.Events.BUMP_EVENTS=[Blockly.Events.BLOCK_CREATE,Blockly.Events.BLOCK_MOVE,Blockly.Events.COMMENT_CREATE,Blockly.Events.COMMENT_MOVE],Blockly.Events.FIRE_QUEUE_=[],Blockly.Events.fire=function(t){Blockly.Events.isEnabled()&&(Blockly.Events.FIRE_QUEUE_.length||setTimeout(Blockly.Events.fireNow_,0),Blockly.Events.FIRE_QUEUE_.push(t))},Blockly.Events.fireNow_=function(){for(var t,e=Blockly.Events.filter(Blockly.Events.FIRE_QUEUE_,!0),o=Blockly.Events.FIRE_QUEUE_.length=0;t=e[o];o++)if(t.workspaceId){var l=Blockly.Workspace.getById(t.workspaceId);l&&l.fireChangeListener(t)}},Blockly.Events.filter=function(t,e){var o=t.slice();e||o.reverse();for(var l,i=[],n=Object.create(null),r=0;l=o[r];r++)if(!l.isNull()){var s=[l.type,l.blockId,l.workspaceId].join(" "),c=n[s],a=c?c.event:null;c?l.type==Blockly.Events.MOVE&&c.index==r-1?(a.newParentId=l.newParentId,a.newInputName=l.newInputName,a.newCoordinate=l.newCoordinate,c.index=r):l.type==Blockly.Events.CHANGE&&l.element==a.element&&l.name==a.name?a.newValue=l.newValue:(l.type!=Blockly.Events.UI||"click"!=l.element||"commentOpen"!=a.element&&"mutatorOpen"!=a.element&&"warningOpen"!=a.element)&&(n[s]={event:l,index:1},i.push(l)):(n[s]={event:l,index:r},i.push(l))}for(o=i.filter((function(t){return!t.isNull()})),e||o.reverse(),r=1;l=o[r];r++)l.type==Blockly.Events.CHANGE&&"mutation"==l.element&&o.unshift(o.splice(r,1)[0]);return o},Blockly.Events.clearPendingUndo=function(){for(var t,e=0;t=Blockly.Events.FIRE_QUEUE_[e];e++)t.recordUndo=!1},Blockly.Events.disable=function(){Blockly.Events.disabled_++},Blockly.Events.enable=function(){Blockly.Events.disabled_--},Blockly.Events.isEnabled=function(){return 0==Blockly.Events.disabled_},Blockly.Events.getGroup=function(){return Blockly.Events.group_},Blockly.Events.setGroup=function(t){Blockly.Events.group_="boolean"==typeof t?t?Blockly.utils.genUid():"":t},Blockly.Events.getDescendantIds=function(t){var e=[];t=t.getDescendants(!1);for(var o,l=0;o=t[l];l++)e[l]=o.id;return e},Blockly.Events.fromJson=function(t,e){switch(t.type){case Blockly.Events.CREATE:var o=new Blockly.Events.Create(null);break;case Blockly.Events.DELETE:o=new Blockly.Events.Delete(null);break;case Blockly.Events.CHANGE:o=new Blockly.Events.Change(null,"","","","");break;case Blockly.Events.MOVE:o=new Blockly.Events.Move(null);break;case Blockly.Events.VAR_CREATE:o=new Blockly.Events.VarCreate(null);break;case Blockly.Events.VAR_DELETE:o=new Blockly.Events.VarDelete(null);break;case Blockly.Events.VAR_RENAME:o=new Blockly.Events.VarRename(null,"");break;case Blockly.Events.UI:o=new Blockly.Events.Ui(null,"","","");break;case Blockly.Events.COMMENT_CREATE:o=new Blockly.Events.CommentCreate(null);break;case Blockly.Events.COMMENT_CHANGE:o=new Blockly.Events.CommentChange(null,"","");break;case Blockly.Events.COMMENT_MOVE:o=new Blockly.Events.CommentMove(null);break;case Blockly.Events.COMMENT_DELETE:o=new Blockly.Events.CommentDelete(null);break;default:throw Error("Unknown event type.")}return o.fromJson(t),o.workspaceId=e.id,o},Blockly.Events.disableOrphans=function(t){if((t.type==Blockly.Events.MOVE||t.type==Blockly.Events.CREATE)&&t.workspaceId){var e=Blockly.Workspace.getById(t.workspaceId);if(t=e.getBlockById(t.blockId)){var o=t.getParent();if(o&&o.isEnabled())for(e=t.getDescendants(!1),t=0;o=e[t];t++)o.setEnabled(!0);else if((t.outputConnection||t.previousConnection)&&!e.isDragging())do{t.setEnabled(!1),t=t.getNextBlock()}while(t)}}},Blockly.Events.Abstract=function(){this.workspaceId=void 0,this.group=Blockly.Events.getGroup(),this.recordUndo=Blockly.Events.recordUndo},Blockly.Events.Abstract.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),t},Blockly.Events.Abstract.prototype.fromJson=function(t){this.group=t.group},Blockly.Events.Abstract.prototype.isNull=function(){return!1},Blockly.Events.Abstract.prototype.run=function(t){},Blockly.Events.Abstract.prototype.getEventWorkspace_=function(){if(this.workspaceId)var t=Blockly.Workspace.getById(this.workspaceId);if(!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t},Blockly.utils.object={},Blockly.utils.object.inherits=function(t,e){t.superClass_=e.prototype,t.prototype=Object.create(e.prototype),t.prototype.constructor=t},Blockly.utils.object.mixin=function(t,e){for(var o in e)t[o]=e[o]},Blockly.utils.object.values=function(t){return Object.values?Object.values(t):Object.keys(t).map((function(e){return t[e]}))},Blockly.utils.xml={},Blockly.utils.xml.NAME_SPACE="https://developers.google.com/blockly/xml",Blockly.utils.xml.document=function(){return document},Blockly.utils.xml.createElement=function(t){return Blockly.utils.xml.document().createElementNS(Blockly.utils.xml.NAME_SPACE,t)},Blockly.utils.xml.createTextNode=function(t){return Blockly.utils.xml.document().createTextNode(t)},Blockly.utils.xml.textToDomDocument=function(t){return(new DOMParser).parseFromString(t,"text/xml")},Blockly.utils.xml.domToText=function(t){return(new XMLSerializer).serializeToString(t)},Blockly.Events.BlockBase=function(t){Blockly.Events.BlockBase.superClass_.constructor.call(this),this.blockId=t.id,this.workspaceId=t.workspace.id},Blockly.utils.object.inherits(Blockly.Events.BlockBase,Blockly.Events.Abstract),Blockly.Events.BlockBase.prototype.toJson=function(){var t=Blockly.Events.BlockBase.superClass_.toJson.call(this);return t.blockId=this.blockId,t},Blockly.Events.BlockBase.prototype.fromJson=function(t){Blockly.Events.BlockBase.superClass_.fromJson.call(this,t),this.blockId=t.blockId},Blockly.Events.Change=function(t,e,o,l,i){t&&(Blockly.Events.Change.superClass_.constructor.call(this,t),this.element=e,this.name=o,this.oldValue=l,this.newValue=i)},Blockly.utils.object.inherits(Blockly.Events.Change,Blockly.Events.BlockBase),Blockly.Events.BlockChange=Blockly.Events.Change,Blockly.Events.Change.prototype.type=Blockly.Events.CHANGE,Blockly.Events.Change.prototype.toJson=function(){var t=Blockly.Events.Change.superClass_.toJson.call(this);return t.element=this.element,this.name&&(t.name=this.name),t.newValue=this.newValue,t},Blockly.Events.Change.prototype.fromJson=function(t){Blockly.Events.Change.superClass_.fromJson.call(this,t),this.element=t.element,this.name=t.name,this.newValue=t.newValue},Blockly.Events.Change.prototype.isNull=function(){return this.oldValue==this.newValue},Blockly.Events.Change.prototype.run=function(t){var e=this.getEventWorkspace_().getBlockById(this.blockId);if(e)switch(e.mutator&&e.mutator.setVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(e=e.getField(this.name))?e.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":e.setCommentText(t||null);break;case"collapsed":e.setCollapsed(!!t);break;case"disabled":e.setEnabled(!t);break;case"inline":e.setInputsInline(!!t);break;case"mutation":var o="";if(e.mutationToDom&&(o=(o=e.mutationToDom())&&Blockly.Xml.domToText(o)),e.domToMutation){var l=Blockly.Xml.textToDom(t||"<mutation/>");e.domToMutation(l)}Blockly.Events.fire(new Blockly.Events.Change(e,"mutation",null,o,t));break;default:console.warn("Unknown change type: "+this.element)}else console.warn("Can't change non-existent block: "+this.blockId)},Blockly.Events.Create=function(t){t&&(Blockly.Events.Create.superClass_.constructor.call(this,t),this.xml=t.workspace.rendered?Blockly.Xml.blockToDomWithXY(t):Blockly.Xml.blockToDom(t),this.ids=Blockly.Events.getDescendantIds(t))},Blockly.utils.object.inherits(Blockly.Events.Create,Blockly.Events.BlockBase),Blockly.Events.BlockCreate=Blockly.Events.Create,Blockly.Events.Create.prototype.type=Blockly.Events.CREATE,Blockly.Events.Create.prototype.toJson=function(){var t=Blockly.Events.Create.superClass_.toJson.call(this);return t.xml=Blockly.Xml.domToText(this.xml),t.ids=this.ids,t},Blockly.Events.Create.prototype.fromJson=function(t){Blockly.Events.Create.superClass_.fromJson.call(this,t),this.xml=Blockly.Xml.textToDom(t.xml),this.ids=t.ids},Blockly.Events.Create.prototype.run=function(t){var e=this.getEventWorkspace_();if(t)(t=Blockly.utils.xml.createElement("xml")).appendChild(this.xml),Blockly.Xml.domToWorkspace(t,e);else{t=0;for(var o;o=this.ids[t];t++){var l=e.getBlockById(o);l?l.dispose(!1):o==this.blockId&&console.warn("Can't uncreate non-existent block: "+o)}}},Blockly.Events.Delete=function(t){if(t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");Blockly.Events.Delete.superClass_.constructor.call(this,t),this.oldXml=t.workspace.rendered?Blockly.Xml.blockToDomWithXY(t):Blockly.Xml.blockToDom(t),this.ids=Blockly.Events.getDescendantIds(t)}},Blockly.utils.object.inherits(Blockly.Events.Delete,Blockly.Events.BlockBase),Blockly.Events.BlockDelete=Blockly.Events.Delete,Blockly.Events.Delete.prototype.type=Blockly.Events.DELETE,Blockly.Events.Delete.prototype.toJson=function(){var t=Blockly.Events.Delete.superClass_.toJson.call(this);return t.ids=this.ids,t},Blockly.Events.Delete.prototype.fromJson=function(t){Blockly.Events.Delete.superClass_.fromJson.call(this,t),this.ids=t.ids},Blockly.Events.Delete.prototype.run=function(t){var e=this.getEventWorkspace_();if(t){t=0;for(var o;o=this.ids[t];t++){var l=e.getBlockById(o);l?l.dispose(!1):o==this.blockId&&console.warn("Can't delete non-existent block: "+o)}}else(t=Blockly.utils.xml.createElement("xml")).appendChild(this.oldXml),Blockly.Xml.domToWorkspace(t,e)},Blockly.Events.Move=function(t){t&&(Blockly.Events.Move.superClass_.constructor.call(this,t),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)},Blockly.utils.object.inherits(Blockly.Events.Move,Blockly.Events.BlockBase),Blockly.Events.BlockMove=Blockly.Events.Move,Blockly.Events.Move.prototype.type=Blockly.Events.MOVE,Blockly.Events.Move.prototype.toJson=function(){var t=Blockly.Events.Move.superClass_.toJson.call(this);return this.newParentId&&(t.newParentId=this.newParentId),this.newInputName&&(t.newInputName=this.newInputName),this.newCoordinate&&(t.newCoordinate=Math.round(this.newCoordinate.x)+","+Math.round(this.newCoordinate.y)),t},Blockly.Events.Move.prototype.fromJson=function(t){Blockly.Events.Move.superClass_.fromJson.call(this,t),this.newParentId=t.newParentId,this.newInputName=t.newInputName,t.newCoordinate&&(t=t.newCoordinate.split(","),this.newCoordinate=new Blockly.utils.Coordinate(Number(t[0]),Number(t[1])))},Blockly.Events.Move.prototype.recordNew=function(){var t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate},Blockly.Events.Move.prototype.currentLocation_=function(){var t=this.getEventWorkspace_().getBlockById(this.blockId),e={},o=t.getParent();return o?(e.parentId=o.id,(t=o.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e},Blockly.Events.Move.prototype.isNull=function(){return this.oldParentId==this.newParentId&&this.oldInputName==this.newInputName&&Blockly.utils.Coordinate.equals(this.oldCoordinate,this.newCoordinate)},Blockly.Events.Move.prototype.run=function(t){var e=this.getEventWorkspace_(),o=e.getBlockById(this.blockId);if(o){var l=t?this.newParentId:this.oldParentId,i=t?this.newInputName:this.oldInputName;t=t?this.newCoordinate:this.oldCoordinate;var n=null;if(l&&!(n=e.getBlockById(l)))return void console.warn("Can't connect to non-existent block: "+l);if(o.getParent()&&o.unplug(),t)i=o.getRelativeToSurfaceXY(),o.moveBy(t.x-i.x,t.y-i.y);else{if(o=o.outputConnection||o.previousConnection,i){if(e=n.getInput(i))var r=e.connection}else o.type==Blockly.PREVIOUS_STATEMENT&&(r=n.nextConnection);r?o.connect(r):console.warn("Can't connect to non-existent input: "+i)}}else console.warn("Can't move non-existent block: "+this.blockId)},Blockly.Events.FinishedLoading=function(t){this.workspaceId=t.id,this.group=Blockly.Events.getGroup(),this.recordUndo=!1},Blockly.utils.object.inherits(Blockly.Events.FinishedLoading,Blockly.Events.Abstract),Blockly.Events.FinishedLoading.prototype.type=Blockly.Events.FINISHED_LOADING,Blockly.Events.FinishedLoading.prototype.toJson=function(){var t={type:this.type};return this.group&&(t.group=this.group),this.workspaceId&&(t.workspaceId=this.workspaceId),t},Blockly.Events.FinishedLoading.prototype.fromJson=function(t){this.workspaceId=t.workspaceId,this.group=t.group},Blockly.Events.VarBase=function(t){Blockly.Events.VarBase.superClass_.constructor.call(this),this.varId=t.getId(),this.workspaceId=t.workspace.id},Blockly.utils.object.inherits(Blockly.Events.VarBase,Blockly.Events.Abstract),Blockly.Events.VarBase.prototype.toJson=function(){var t=Blockly.Events.VarBase.superClass_.toJson.call(this);return t.varId=this.varId,t},Blockly.Events.VarBase.prototype.fromJson=function(t){Blockly.Events.VarBase.superClass_.toJson.call(this),this.varId=t.varId},Blockly.Events.VarCreate=function(t){t&&(Blockly.Events.VarCreate.superClass_.constructor.call(this,t),this.varType=t.type,this.varName=t.name)},Blockly.utils.object.inherits(Blockly.Events.VarCreate,Blockly.Events.VarBase),Blockly.Events.VarCreate.prototype.type=Blockly.Events.VAR_CREATE,Blockly.Events.VarCreate.prototype.toJson=function(){var t=Blockly.Events.VarCreate.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},Blockly.Events.VarCreate.prototype.fromJson=function(t){Blockly.Events.VarCreate.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},Blockly.Events.VarCreate.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.createVariable(this.varName,this.varType,this.varId):e.deleteVariableById(this.varId)},Blockly.Events.VarDelete=function(t){t&&(Blockly.Events.VarDelete.superClass_.constructor.call(this,t),this.varType=t.type,this.varName=t.name)},Blockly.utils.object.inherits(Blockly.Events.VarDelete,Blockly.Events.VarBase),Blockly.Events.VarDelete.prototype.type=Blockly.Events.VAR_DELETE,Blockly.Events.VarDelete.prototype.toJson=function(){var t=Blockly.Events.VarDelete.superClass_.toJson.call(this);return t.varType=this.varType,t.varName=this.varName,t},Blockly.Events.VarDelete.prototype.fromJson=function(t){Blockly.Events.VarDelete.superClass_.fromJson.call(this,t),this.varType=t.varType,this.varName=t.varName},Blockly.Events.VarDelete.prototype.run=function(t){var e=this.getEventWorkspace_();t?e.deleteVariableById(this.varId):e.createVariable(this.varName,this.varType,this.varId)},Blockly.Events.VarRename=function(t,e){t&&(Blockly.Events.VarRename.superClass_.constructor.call(this,t),this.oldName=t.name,this.newName=e)},Blockly.utils.object.inherits(Blockly.Events.VarRename,Blockly.Events.VarBase),Blockly.Events.VarRename.prototype.type=Blockly.Events.VAR_RENAME,Blockly.Events.VarRename.prototype.toJson=function(){var t=Blockly.Events.VarRename.superClass_.toJson.call(this);return t.oldName=this.oldName,t.newName=this.newName,t},Blockly.Events.VarRename.prototype.fromJson=function(t){Blockly.Events.VarRename.superClass_.fromJson.call(this,t),this.oldName=t.oldName,this.newName=t.newName},Blockly.Events.VarRename.prototype.run=function(t){this.getEventWorkspace_().renameVariableById(this.varId,t?this.newName:this.oldName)},Blockly.utils.dom={},Blockly.utils.dom.SVG_NS="http://www.w3.org/2000/svg",Blockly.utils.dom.HTML_NS="http://www.w3.org/1999/xhtml",Blockly.utils.dom.XLINK_NS="http://www.w3.org/1999/xlink",Blockly.utils.dom.Node={ELEMENT_NODE:1,TEXT_NODE:3,COMMENT_NODE:8,DOCUMENT_POSITION_CONTAINED_BY:16},Blockly.utils.dom.cacheWidths_=null,Blockly.utils.dom.cacheReference_=0,Blockly.utils.dom.createSvgElement=function(t,e,o){for(var l in t=document.createElementNS(Blockly.utils.dom.SVG_NS,t),e)t.setAttribute(l,e[l]);return document.body.runtimeStyle&&(t.runtimeStyle=t.currentStyle=t.style),o&&o.appendChild(t),t},Blockly.utils.dom.addClass=function(t,e){var o=t.getAttribute("class")||"";return-1==(" "+o+" ").indexOf(" "+e+" ")&&(o&&(o+=" "),t.setAttribute("class",o+e),!0)},Blockly.utils.dom.removeClass=function(t,e){var o=t.getAttribute("class");if(-1==(" "+o+" ").indexOf(" "+e+" "))return!1;o=o.split(/\s+/);for(var l=0;l<o.length;l++)o[l]&&o[l]!=e||(o.splice(l,1),l--);return o.length?t.setAttribute("class",o.join(" ")):t.removeAttribute("class"),!0},Blockly.utils.dom.hasClass=function(t,e){return-1!=(" "+t.getAttribute("class")+" ").indexOf(" "+e+" ")},Blockly.utils.dom.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},Blockly.utils.dom.insertAfter=function(t,e){var o=e.nextSibling,l=e.parentNode;if(!l)throw Error("Reference node has no parent.");o?l.insertBefore(t,o):l.appendChild(t)},Blockly.utils.dom.containsNode=function(t,e){return!!(t.compareDocumentPosition(e)&Blockly.utils.dom.Node.DOCUMENT_POSITION_CONTAINED_BY)},Blockly.utils.dom.setCssTransform=function(t,e){t.style.transform=e,t.style["-webkit-transform"]=e},Blockly.utils.dom.startTextWidthCache=function(){Blockly.utils.dom.cacheReference_++,Blockly.utils.dom.cacheWidths_||(Blockly.utils.dom.cacheWidths_={})},Blockly.utils.dom.stopTextWidthCache=function(){Blockly.utils.dom.cacheReference_--,Blockly.utils.dom.cacheReference_||(Blockly.utils.dom.cacheWidths_=null)},Blockly.utils.dom.getTextWidth=function(t){var e,o=t.textContent+"\n"+t.className.baseVal;if(Blockly.utils.dom.cacheWidths_&&(e=Blockly.utils.dom.cacheWidths_[o]))return e;try{e=Blockly.utils.userAgent.IE||Blockly.utils.userAgent.EDGE?t.getBBox().width:t.getComputedTextLength()}catch(l){return 8*t.textContent.length}return Blockly.utils.dom.cacheWidths_&&(Blockly.utils.dom.cacheWidths_[o]=e),e},Blockly.Xml={},Blockly.Xml.workspaceToDom=function(t,e){var o=Blockly.utils.xml.createElement("xml"),l=Blockly.Xml.variablesToDom(Blockly.Variables.allUsedVarModels(t));l.hasChildNodes()&&o.appendChild(l);var i,n=t.getTopComments(!0);for(l=0;i=n[l];l++)o.appendChild(i.toXmlWithXY(e));for(n=t.getTopBlocks(!0),l=0;i=n[l];l++)o.appendChild(Blockly.Xml.blockToDomWithXY(i,e));return o},Blockly.Xml.variablesToDom=function(t){for(var e,o=Blockly.utils.xml.createElement("variables"),l=0;e=t[l];l++){var i=Blockly.utils.xml.createElement("variable");i.appendChild(Blockly.utils.xml.createTextNode(e.name)),e.type&&i.setAttribute("type",e.type),i.id=e.getId(),o.appendChild(i)}return o},Blockly.Xml.blockToDomWithXY=function(t,e){var o;t.workspace.RTL&&(o=t.workspace.getWidth());var l=Blockly.Xml.blockToDom(t,e),i=t.getRelativeToSurfaceXY();return l.setAttribute("x",Math.round(t.workspace.RTL?o-i.x:i.x)),l.setAttribute("y",Math.round(i.y)),l},Blockly.Xml.fieldToDom_=function(t){if(t.isSerializable()){var e=Blockly.utils.xml.createElement("field");return e.setAttribute("name",t.name),t.toXml(e)}return null},Blockly.Xml.allFieldsToDom_=function(t,e){for(var o,l=0;o=t.inputList[l];l++)for(var i,n=0;i=o.fieldRow[n];n++)(i=Blockly.Xml.fieldToDom_(i))&&e.appendChild(i)},Blockly.Xml.blockToDom=function(t,e){var o=Blockly.utils.xml.createElement(t.isShadow()?"shadow":"block");if(o.setAttribute("type",t.type),e||(o.id=t.id),t.mutationToDom){var l=t.mutationToDom();l&&(l.hasChildNodes()||l.hasAttributes())&&o.appendChild(l)}if(Blockly.Xml.allFieldsToDom_(t,o),l=t.getCommentText()){var i=t.commentModel.size,n=t.commentModel.pinned,r=Blockly.utils.xml.createElement("comment");r.appendChild(Blockly.utils.xml.createTextNode(l)),r.setAttribute("pinned",n),r.setAttribute("h",i.height),r.setAttribute("w",i.width),o.appendChild(r)}for(t.data&&((l=Blockly.utils.xml.createElement("data")).appendChild(Blockly.utils.xml.createTextNode(t.data)),o.appendChild(l)),i=0;n=t.inputList[i];i++){var s;if(r=!0,n.type!=Blockly.DUMMY_INPUT){var c=n.connection.targetBlock();n.type==Blockly.INPUT_VALUE?s=Blockly.utils.xml.createElement("value"):n.type==Blockly.NEXT_STATEMENT&&(s=Blockly.utils.xml.createElement("statement")),!(l=n.connection.getShadowDom())||c&&c.isShadow()||s.appendChild(Blockly.Xml.cloneShadow_(l,e)),c&&(s.appendChild(Blockly.Xml.blockToDom(c,e)),r=!1),s.setAttribute("name",n.name),r||o.appendChild(s)}}return null!=t.inputsInline&&t.inputsInline!=t.inputsInlineDefault&&o.setAttribute("inline",t.inputsInline),t.isCollapsed()&&o.setAttribute("collapsed",!0),t.isEnabled()||o.setAttribute("disabled",!0),t.isDeletable()||t.isShadow()||o.setAttribute("deletable",!1),t.isMovable()||t.isShadow()||o.setAttribute("movable",!1),t.isEditable()||o.setAttribute("editable",!1),(i=t.getNextBlock())&&((s=Blockly.utils.xml.createElement("next")).appendChild(Blockly.Xml.blockToDom(i,e)),o.appendChild(s)),!(l=t.nextConnection&&t.nextConnection.getShadowDom())||i&&i.isShadow()||s.appendChild(Blockly.Xml.cloneShadow_(l,e)),o},Blockly.Xml.cloneShadow_=function(t,e){for(var o,l=t=t.cloneNode(!0);l;)if(e&&"shadow"==l.nodeName&&l.removeAttribute("id"),l.firstChild)l=l.firstChild;else{for(;l&&!l.nextSibling;)o=l,l=l.parentNode,o.nodeType==Blockly.utils.dom.Node.TEXT_NODE&&""==o.data.trim()&&l.firstChild!=o&&Blockly.utils.dom.removeNode(o);l&&(o=l,l=l.nextSibling,o.nodeType==Blockly.utils.dom.Node.TEXT_NODE&&""==o.data.trim()&&Blockly.utils.dom.removeNode(o))}return t},Blockly.Xml.domToText=function(t){t=Blockly.utils.xml.domToText(t);var e=/(<[^/](?:[^>]*[^/])?>[^<]*)\n([^<]*<\/)/;do{var o=t;t=t.replace(e,"$1&#10;$2")}while(t!=o);return t},Blockly.Xml.domToPrettyText=function(t){t=Blockly.Xml.domToText(t).split("<");for(var e="",o=1;o<t.length;o++){var l=t[o];"/"==l[0]&&(e=e.substring(2)),t[o]=e+"<"+l,"/"!=l[0]&&"/>"!=l.slice(-2)&&(e+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},Blockly.Xml.textToDom=function(t){var e=Blockly.utils.xml.textToDomDocument(t);if(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)throw Error("textToDom was unable to parse: "+t);return e.documentElement},Blockly.Xml.clearWorkspaceAndLoadFromXml=function(t,e){e.setResizesEnabled(!1),e.clear();var o=Blockly.Xml.domToWorkspace(t,e);return e.setResizesEnabled(!0),o},Blockly.Xml.domToWorkspace=function(t,e){if(t instanceof Blockly.Workspace){var o=t;t=e,e=o,console.warn("Deprecated call to Blockly.Xml.domToWorkspace, swap the arguments.")}var l;e.RTL&&(l=e.getWidth()),o=[],Blockly.utils.dom.startTextWidthCache();var i=t.childNodes.length,n=Blockly.Events.getGroup();n||Blockly.Events.setGroup(!0),e.setResizesEnabled&&e.setResizesEnabled(!1);var r=!0;try{for(var s=0;s<i;s++){var c=t.childNodes[s],a=c.nodeName.toLowerCase();if("block"==a||"shadow"==a&&!Blockly.Events.recordUndo){var u=Blockly.Xml.domToBlock(c,e);o.push(u.id);var h=c.hasAttribute("x")?parseInt(c.getAttribute("x"),10):10,p=c.hasAttribute("y")?parseInt(c.getAttribute("y"),10):10;isNaN(h)||isNaN(p)||u.moveBy(e.RTL?l-h:h,p),r=!1}else{if("shadow"==a)throw TypeError("Shadow block cannot be a top-level block.");if("comment"==a)e.rendered?Blockly.WorkspaceCommentSvg?Blockly.WorkspaceCommentSvg.fromXml(c,e,l):console.warn("Missing require for Blockly.WorkspaceCommentSvg, ignoring workspace comment."):Blockly.WorkspaceComment?Blockly.WorkspaceComment.fromXml(c,e):console.warn("Missing require for Blockly.WorkspaceComment, ignoring workspace comment.");else if("variables"==a){if(!r)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Blockly.Xml.domToVariables(c,e),r=!1}}}}finally{n||Blockly.Events.setGroup(!1),Blockly.utils.dom.stopTextWidthCache()}return e.setResizesEnabled&&e.setResizesEnabled(!0),Blockly.Events.fire(new Blockly.Events.FinishedLoading(e)),o},Blockly.Xml.appendDomToWorkspace=function(t,e){if(e.hasOwnProperty("scale")){var o=Blockly.BlockSvg.TAB_WIDTH;try{Blockly.BlockSvg.TAB_WIDTH=0;var l=e.getBlocksBoundingBox()}finally{Blockly.BlockSvg.TAB_WIDTH=o}}if(o=Blockly.Xml.domToWorkspace(t,e),l&&l.top!=l.bottom){var i,n=l.bottom,r=l.left,s=1/0,c=1/0;for(l=0;l<o.length;l++){var a=e.getBlockById(o[l]).getRelativeToSurfaceXY();a.y<c&&(c=a.y),a.x<s&&(s=a.x)}for(n=n-c+Blockly.BlockSvg.SEP_SPACE_Y,r-=s,e.RTL&&(i=e.getWidth()),l=0;l<o.length;l++)e.getBlockById(o[l]).moveBy(e.RTL?i-r:r,n)}return o},Blockly.Xml.domToBlock=function(t,e){if(t instanceof Blockly.Workspace){var o=t;t=e,e=o,console.warn("Deprecated call to Blockly.Xml.domToBlock, swap the arguments.")}Blockly.Events.disable(),o=e.getAllVariables();try{var l=Blockly.Xml.domToBlockHeadless_(t,e),i=l.getDescendants(!1);if(e.rendered){l.setConnectionsHidden(!0);for(var n=i.length-1;0<=n;n--)i[n].initSvg();for(n=i.length-1;0<=n;n--)i[n].render(!1);setTimeout((function(){l.workspace&&l.setConnectionsHidden(!1)}),1),l.updateDisabled(),e.resizeContents()}else for(n=i.length-1;0<=n;n--)i[n].initModel()}finally{Blockly.Events.enable()}if(Blockly.Events.isEnabled()){for(i=Blockly.Variables.getAddedVariables(e,o),n=0;n<i.length;n++)Blockly.Events.fire(new Blockly.Events.VarCreate(i[n]));Blockly.Events.fire(new Blockly.Events.BlockCreate(l))}return l},Blockly.Xml.domToVariables=function(t,e){for(var o,l=0;o=t.childNodes[l];l++)if(o.nodeType==Blockly.utils.dom.Node.ELEMENT_NODE){var i=o.getAttribute("type"),n=o.getAttribute("id");e.createVariable(o.textContent,i,n)}},Blockly.Xml.domToBlockHeadless_=function(t,e){var o=null,l=t.getAttribute("type");if(!l)throw TypeError("Block type unspecified: "+t.outerHTML);var i=t.getAttribute("id");o=e.newBlock(l,i);var n,r=null;for(i=0;n=t.childNodes[i];i++)if(n.nodeType!=Blockly.utils.dom.Node.TEXT_NODE){for(var s,c=r=null,a=0;s=n.childNodes[a];a++)s.nodeType==Blockly.utils.dom.Node.ELEMENT_NODE&&("block"==s.nodeName.toLowerCase()?r=s:"shadow"==s.nodeName.toLowerCase()&&(c=s));switch(!r&&c&&(r=c),a=n.getAttribute("name"),n.nodeName.toLowerCase()){case"mutation":o.domToMutation&&(o.domToMutation(n),o.initSvg&&o.initSvg());break;case"comment":if(!Blockly.Comment){console.warn("Missing require for Blockly.Comment, ignoring block comment.");break}r=n.textContent,c="true"==n.getAttribute("pinned"),a=parseInt(n.getAttribute("w"),10),n=parseInt(n.getAttribute("h"),10),o.setCommentText(r),o.commentModel.pinned=c,isNaN(a)||isNaN(n)||(o.commentModel.size=new Blockly.utils.Size(a,n)),c&&o.getCommentIcon&&!o.isInFlyout&&setTimeout((function(){o.getCommentIcon().setVisible(!0)}),1);break;case"data":o.data=n.textContent;break;case"title":case"field":Blockly.Xml.domToField_(o,a,n);break;case"value":case"statement":if(!(n=o.getInput(a))){console.warn("Ignoring non-existent input "+a+" in block "+l);break}if(c&&n.connection.setShadowDom(c),r)if((r=Blockly.Xml.domToBlockHeadless_(r,e)).outputConnection)n.connection.connect(r.outputConnection);else{if(!r.previousConnection)throw TypeError("Child block does not have output or previous statement.");n.connection.connect(r.previousConnection)}break;case"next":if(c&&o.nextConnection&&o.nextConnection.setShadowDom(c),r){if(!o.nextConnection)throw TypeError("Next statement does not exist.");if(o.nextConnection.isConnected())throw TypeError("Next statement is already connected.");if(!(r=Blockly.Xml.domToBlockHeadless_(r,e)).previousConnection)throw TypeError("Next block does not have previous statement.");o.nextConnection.connect(r.previousConnection)}break;default:console.warn("Ignoring unknown tag: "+n.nodeName)}}if((i=t.getAttribute("inline"))&&o.setInputsInline("true"==i),(i=t.getAttribute("disabled"))&&o.setEnabled("true"!=i&&"disabled"!=i),(i=t.getAttribute("deletable"))&&o.setDeletable("true"==i),(i=t.getAttribute("movable"))&&o.setMovable("true"==i),(i=t.getAttribute("editable"))&&o.setEditable("true"==i),(i=t.getAttribute("collapsed"))&&o.setCollapsed("true"==i),"shadow"==t.nodeName.toLowerCase()){for(l=o.getChildren(!1),i=0;n=l[i];i++)if(!n.isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(o.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");o.setShadow(!0)}return o},Blockly.Xml.domToField_=function(t,e,o){var l=t.getField(e);l?l.fromXml(o):console.warn("Ignoring non-existent field "+e+" in block "+t.type)},Blockly.Xml.deleteNext=function(t){for(var e,o=0;e=t.childNodes[o];o++)if("next"==e.nodeName.toLowerCase()){t.removeChild(e);break}},Blockly.Connection=function(t,e){this.sourceBlock_=t,this.type=e},Blockly.Connection.CAN_CONNECT=0,Blockly.Connection.REASON_SELF_CONNECTION=1,Blockly.Connection.REASON_WRONG_TYPE=2,Blockly.Connection.REASON_TARGET_NULL=3,Blockly.Connection.REASON_CHECKS_FAILED=4,Blockly.Connection.REASON_DIFFERENT_WORKSPACES=5,Blockly.Connection.REASON_SHADOW_PARENT=6,Blockly.Connection.prototype.targetConnection=null,Blockly.Connection.prototype.disposed=!1,Blockly.Connection.prototype.check_=null,Blockly.Connection.prototype.shadowDom_=null,Blockly.Connection.prototype.x_=0,Blockly.Connection.prototype.y_=0,Blockly.Connection.prototype.connect_=function(t){var e,o=this,l=o.getSourceBlock(),i=t.getSourceBlock();if(t.isConnected()&&t.disconnect(),o.isConnected()){var n=o.targetBlock(),r=o.getShadowDom();if(o.setShadowDom(null),n.isShadow())r=Blockly.Xml.blockToDom(n),n.dispose(),n=null;else if(o.type==Blockly.INPUT_VALUE){if(!n.outputConnection)throw Error("Orphan block does not have an output connection.");var s=Blockly.Connection.lastConnectionInRow_(i,n);s&&(n.outputConnection.connect(s),n=null)}else if(o.type==Blockly.NEXT_STATEMENT){if(!n.previousConnection)throw Error("Orphan block does not have a previous connection.");for(s=i;s.nextConnection;){var c=s.getNextBlock();if(!c||c.isShadow()){n.previousConnection.checkType_(s.nextConnection)&&(s.nextConnection.connect(n.previousConnection),n=null);break}s=c}}if(n&&(o.disconnect(),Blockly.Events.recordUndo)){var a=Blockly.Events.getGroup();setTimeout((function(){n.workspace&&!n.getParent()&&(Blockly.Events.setGroup(a),n.outputConnection?n.outputConnection.onFailedConnect(o):n.previousConnection&&n.previousConnection.onFailedConnect(o),Blockly.Events.setGroup(!1))}),Blockly.BUMP_DELAY)}o.setShadowDom(r)}Blockly.Events.isEnabled()&&(e=new Blockly.Events.BlockMove(i)),Blockly.Connection.connectReciprocally_(o,t),i.setParent(l),e&&(e.recordNew(),Blockly.Events.fire(e))},Blockly.Connection.prototype.dispose=function(){if(this.isConnected()){this.setShadowDom(null);var t=this.targetBlock();t.isShadow()?t.dispose():t.unplug()}this.disposed=!0},Blockly.Connection.prototype.getSourceBlock=function(){return this.sourceBlock_},Blockly.Connection.prototype.isSuperior=function(){return this.type==Blockly.INPUT_VALUE||this.type==Blockly.NEXT_STATEMENT},Blockly.Connection.prototype.isConnected=function(){return!!this.targetConnection},Blockly.Connection.prototype.canConnectWithReason_=function(t){if(!t)return Blockly.Connection.REASON_TARGET_NULL;if(this.isSuperior())var e=this.sourceBlock_,o=t.getSourceBlock();else o=this.sourceBlock_,e=t.getSourceBlock();return e&&e==o?Blockly.Connection.REASON_SELF_CONNECTION:t.type!=Blockly.OPPOSITE_TYPE[this.type]?Blockly.Connection.REASON_WRONG_TYPE:e&&o&&e.workspace!==o.workspace?Blockly.Connection.REASON_DIFFERENT_WORKSPACES:this.checkType_(t)?e.isShadow()&&!o.isShadow()?Blockly.Connection.REASON_SHADOW_PARENT:Blockly.Connection.CAN_CONNECT:Blockly.Connection.REASON_CHECKS_FAILED},Blockly.Connection.prototype.checkConnection_=function(t){switch(this.canConnectWithReason_(t)){case Blockly.Connection.CAN_CONNECT:break;case Blockly.Connection.REASON_SELF_CONNECTION:throw Error("Attempted to connect a block to itself.");case Blockly.Connection.REASON_DIFFERENT_WORKSPACES:throw Error("Blocks not on same workspace.");case Blockly.Connection.REASON_WRONG_TYPE:throw Error("Attempt to connect incompatible types.");case Blockly.Connection.REASON_TARGET_NULL:throw Error("Target connection is null.");case Blockly.Connection.REASON_CHECKS_FAILED:throw Error("Connection checks failed. "+this+" expected "+this.check_+", found "+t.check_);case Blockly.Connection.REASON_SHADOW_PARENT:throw Error("Connecting non-shadow to shadow block.");default:throw Error("Unknown connection failure: this should never happen!")}},Blockly.Connection.prototype.canConnectToPrevious_=function(t){return!(this.targetConnection||-1!=Blockly.draggingConnections_.indexOf(t)||t.targetConnection&&(!(t=t.targetBlock()).isInsertionMarker()||t.getPreviousBlock()))},Blockly.Connection.prototype.isConnectionAllowed=function(t){if(t.sourceBlock_.isInsertionMarker()||this.canConnectWithReason_(t)!=Blockly.Connection.CAN_CONNECT)return!1;switch(t.type){case Blockly.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t);case Blockly.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||this.isConnected())return!1;break;case Blockly.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Blockly.NEXT_STATEMENT:if(t.isConnected()&&!this.sourceBlock_.nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection)return!1;break;default:throw Error("Unknown connection type in isConnectionAllowed")}return-1==Blockly.draggingConnections_.indexOf(t)},Blockly.Connection.prototype.onFailedConnect=function(t){},Blockly.Connection.prototype.connect=function(t){if(this.targetConnection!=t){this.checkConnection_(t);var e=Blockly.Events.getGroup();e||Blockly.Events.setGroup(!0),this.isSuperior()?this.connect_(t):t.connect_(this),e||Blockly.Events.setGroup(!1)}},Blockly.Connection.connectReciprocally_=function(t,e){if(!t||!e)throw Error("Cannot connect null connections.");t.targetConnection=e,e.targetConnection=t},Blockly.Connection.singleConnection_=function(t,e){for(var o=!1,l=0;l<t.inputList.length;l++){var i=t.inputList[l].connection;if(i&&i.type==Blockly.INPUT_VALUE&&e.outputConnection.checkType_(i)){if(o)return null;o=i}}return o},Blockly.Connection.lastConnectionInRow_=function(t,e){for(var o,l=t;o=Blockly.Connection.singleConnection_(l,e);)if(!(l=o.targetBlock())||l.isShadow())return o;return null},Blockly.Connection.prototype.disconnect=function(){var t=this.targetConnection;if(!t)throw Error("Source connection not connected.");if(t.targetConnection!=this)throw Error("Target connection not connected to source connection.");if(this.isSuperior()){var e=this.sourceBlock_,o=t.getSourceBlock();t=this}else e=t.getSourceBlock(),o=this.sourceBlock_;var l=Blockly.Events.getGroup();l||Blockly.Events.setGroup(!0),this.disconnectInternal_(e,o),t.respawnShadow_(),l||Blockly.Events.setGroup(!1)},Blockly.Connection.prototype.disconnectInternal_=function(t,e){var o;Blockly.Events.isEnabled()&&(o=new Blockly.Events.BlockMove(e)),this.targetConnection=this.targetConnection.targetConnection=null,e.setParent(null),o&&(o.recordNew(),Blockly.Events.fire(o))},Blockly.Connection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),e=this.getShadowDom();if(t.workspace&&e&&Blockly.Events.recordUndo)if((t=Blockly.Xml.domToBlock(e,t.workspace)).outputConnection)this.connect(t.outputConnection);else{if(!t.previousConnection)throw Error("Child block does not have output or previous statement.");this.connect(t.previousConnection)}},Blockly.Connection.prototype.targetBlock=function(){return this.isConnected()?this.targetConnection.getSourceBlock():null},Blockly.Connection.prototype.checkType_=function(t){if(!this.check_||!t.check_)return!0;for(var e=0;e<this.check_.length;e++)if(-1!=t.check_.indexOf(this.check_[e]))return!0;return!1},Blockly.Connection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()},Blockly.Connection.prototype.setCheck=function(t){return t?(Array.isArray(t)||(t=[t]),this.check_=t,this.onCheckChanged_()):this.check_=null,this},Blockly.Connection.prototype.getCheck=function(){return this.check_},Blockly.Connection.prototype.setShadowDom=function(t){this.shadowDom_=t},Blockly.Connection.prototype.getShadowDom=function(){return this.shadowDom_},Blockly.Connection.prototype.neighbours_=function(t){return[]},Blockly.Connection.prototype.getParentInput=function(){for(var t=null,e=this.sourceBlock_,o=e.inputList,l=0;l<e.inputList.length;l++)if(o[l].connection===this){t=o[l];break}return t},Blockly.Connection.prototype.toString=function(){var t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection==this)var e="Output Connection of ";else if(t.previousConnection==this)e="Previous Connection of ";else if(t.nextConnection==this)e="Next Connection of ";else{e=null;for(var o,l=0;o=t.inputList[l];l++)if(o.connection==this){e=o;break}if(!e)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";e='Input "'+e.name+'" connection on '}return e+t.toDevString()},Blockly.Extensions={},Blockly.Extensions.ALL_={},Blockly.Extensions.register=function(t,e){if("string"!=typeof t||""==t.trim())throw Error('Error: Invalid extension name "'+t+'"');if(Blockly.Extensions.ALL_[t])throw Error('Error: Extension "'+t+'" is already registered.');if("function"!=typeof e)throw Error('Error: Extension "'+t+'" must be a function');Blockly.Extensions.ALL_[t]=e},Blockly.Extensions.registerMixin=function(t,e){if(!e||"object"!=typeof e)throw Error('Error: Mixin "'+t+'" must be a object');Blockly.Extensions.register(t,(function(){this.mixin(e)}))},Blockly.Extensions.registerMutator=function(t,e,o,l){var i='Error when registering mutator "'+t+'": ';Blockly.Extensions.checkHasFunction_(i,e.domToMutation,"domToMutation"),Blockly.Extensions.checkHasFunction_(i,e.mutationToDom,"mutationToDom");var n=Blockly.Extensions.checkMutatorDialog_(e,i);if(o&&"function"!=typeof o)throw Error('Extension "'+t+'" is not a function');Blockly.Extensions.register(t,(function(){if(n){if(!Blockly.Mutator)throw Error(i+"Missing require for Blockly.Mutator");this.setMutator(new Blockly.Mutator(l))}this.mixin(e),o&&o.apply(this)}))},Blockly.Extensions.unregister=function(t){Blockly.Extensions.ALL_[t]?delete Blockly.Extensions.ALL_[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},Blockly.Extensions.apply=function(t,e,o){var l=Blockly.Extensions.ALL_[t];if("function"!=typeof l)throw Error('Error: Extension "'+t+'" not found.');if(o)Blockly.Extensions.checkNoMutatorProperties_(t,e);else var i=Blockly.Extensions.getMutatorProperties_(e);if(l.apply(e),o)Blockly.Extensions.checkBlockHasMutatorProperties_('Error after applying mutator "'+t+'": ',e);else if(!Blockly.Extensions.mutatorPropertiesMatch_(i,e))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},Blockly.Extensions.checkHasFunction_=function(t,e,o){if(!e)throw Error(t+'missing required property "'+o+'"');if("function"!=typeof e)throw Error(t+'" required property "'+o+'" must be a function')},Blockly.Extensions.checkNoMutatorProperties_=function(t,e){if(Blockly.Extensions.getMutatorProperties_(e).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+e.id)},Blockly.Extensions.checkMutatorDialog_=function(t,e){var o=void 0!==t.compose,l=void 0!==t.decompose;if(o&&l){if("function"!=typeof t.compose)throw Error(e+"compose must be a function.");if("function"!=typeof t.decompose)throw Error(e+"decompose must be a function.");return!0}if(o||l)throw Error(e+'Must have both or neither of "compose" and "decompose"');return!1},Blockly.Extensions.checkBlockHasMutatorProperties_=function(t,e){if("function"!=typeof e.domToMutation)throw Error(t+'Applying a mutator didn\'t add "domToMutation"');if("function"!=typeof e.mutationToDom)throw Error(t+'Applying a mutator didn\'t add "mutationToDom"');Blockly.Extensions.checkMutatorDialog_(e,t)},Blockly.Extensions.getMutatorProperties_=function(t){var e=[];return void 0!==t.domToMutation&&e.push(t.domToMutation),void 0!==t.mutationToDom&&e.push(t.mutationToDom),void 0!==t.compose&&e.push(t.compose),void 0!==t.decompose&&e.push(t.decompose),e},Blockly.Extensions.mutatorPropertiesMatch_=function(t,e){var o=Blockly.Extensions.getMutatorProperties_(e);if(o.length!=t.length)return!1;for(var l=0;l<o.length;l++)if(t[l]!=o[l])return!1;return!0},Blockly.Extensions.buildTooltipForDropdown=function(t,e){var o=[];return"object"==typeof document&&Blockly.utils.runAfterPageLoad((function(){for(var t in e)Blockly.utils.checkMessageReferences(e[t])})),function(){this.type&&-1==o.indexOf(this.type)&&(Blockly.Extensions.checkDropdownOptionsInTable_(this,t,e),o.push(this.type)),this.setTooltip((function(){var l=this.getFieldValue(t),i=e[l];return null==i?-1==o.indexOf(this.type)&&(l="No tooltip mapping for value "+l+" of field "+t,null!=this.type&&(l+=" of block type "+this.type),console.warn(l+".")):i=Blockly.utils.replaceMessageReferences(i),i}).bind(this))}},Blockly.Extensions.checkDropdownOptionsInTable_=function(t,e,o){var l=t.getField(e);if(!l.isOptionListDynamic()){l=l.getOptions();for(var i=0;i<l.length;++i){var n=l[i][1];null==o[n]&&console.warn("No tooltip mapping for value "+n+" of field "+e+" of block type "+t.type)}}},Blockly.Extensions.buildTooltipWithFieldText=function(t,e){return"object"==typeof document&&Blockly.utils.runAfterPageLoad((function(){Blockly.utils.checkMessageReferences(t)})),function(){this.setTooltip((function(){var o=this.getField(e);return Blockly.utils.replaceMessageReferences(t).replace("%1",o?o.getText():"")}).bind(this))}},Blockly.Extensions.extensionParentTooltip_=function(){this.tooltipWhenNotConnected_=this.tooltip,this.setTooltip((function(){var t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||this.tooltipWhenNotConnected_}).bind(this))},Blockly.Extensions.register("parent_tooltip_when_inline",Blockly.Extensions.extensionParentTooltip_),Blockly.blockAnimations={},Blockly.blockAnimations.disconnectPid_=0,Blockly.blockAnimations.disconnectGroup_=null,Blockly.blockAnimations.disposeUiEffect=function(t){var e=t.workspace,o=t.getSvgRoot();e.getAudioManager().play("delete"),t=e.getSvgXY(o),(o=o.cloneNode(!0)).translateX_=t.x,o.translateY_=t.y,o.setAttribute("transform","translate("+t.x+","+t.y+")"),e.getParentSvg().appendChild(o),o.bBox_=o.getBBox(),Blockly.blockAnimations.disposeUiStep_(o,e.RTL,new Date,e.scale)},Blockly.blockAnimations.disposeUiStep_=function(t,e,o,l){var i=(new Date-o)/150;1<i?Blockly.utils.dom.removeNode(t):(t.setAttribute("transform","translate("+(t.translateX_+(e?-1:1)*t.bBox_.width*l/2*i)+","+(t.translateY_+t.bBox_.height*l*i)+") scale("+(1-i)*l+")"),setTimeout(Blockly.blockAnimations.disposeUiStep_,10,t,e,o,l))},Blockly.blockAnimations.connectionUiEffect=function(t){var e=t.workspace,o=e.scale;if(e.getAudioManager().play("click"),!(1>o)){var l=e.getSvgXY(t.getSvgRoot());t.outputConnection?(l.x+=(t.RTL?3:-3)*o,l.y+=13*o):t.previousConnection&&(l.x+=(t.RTL?-23:23)*o,l.y+=3*o),t=Blockly.utils.dom.createSvgElement("circle",{cx:l.x,cy:l.y,r:0,fill:"none",stroke:"#888","stroke-width":10},e.getParentSvg()),Blockly.blockAnimations.connectionUiStep_(t,new Date,o)}},Blockly.blockAnimations.connectionUiStep_=function(t,e,o){var l=(new Date-e)/150;1<l?Blockly.utils.dom.removeNode(t):(t.setAttribute("r",25*l*o),t.style.opacity=1-l,Blockly.blockAnimations.disconnectPid_=setTimeout(Blockly.blockAnimations.connectionUiStep_,10,t,e,o))},Blockly.blockAnimations.disconnectUiEffect=function(t){if(t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var e=t.getHeightWidth().height;e=Math.atan(10/e)/Math.PI*180,t.RTL||(e*=-1),Blockly.blockAnimations.disconnectUiStep_(t.getSvgRoot(),e,new Date)}},Blockly.blockAnimations.disconnectUiStep_=function(t,e,o){var l=(new Date-o)/200;1<l?t.skew_="":(t.skew_="skewX("+Math.round(Math.sin(l*Math.PI*3)*(1-l)*e)+")",Blockly.blockAnimations.disconnectGroup_=t,Blockly.blockAnimations.disconnectPid_=setTimeout(Blockly.blockAnimations.disconnectUiStep_,10,t,e,o)),t.setAttribute("transform",t.translate_+t.skew_)},Blockly.blockAnimations.disconnectUiStop=function(){if(Blockly.blockAnimations.disconnectGroup_){clearTimeout(Blockly.blockAnimations.disconnectPid_);var t=Blockly.blockAnimations.disconnectGroup_;t.skew_="",t.setAttribute("transform",t.translate_),Blockly.blockAnimations.disconnectGroup_=null}},Blockly.InsertionMarkerManager=function(t){this.topBlock_=Blockly.selected=t,this.workspace_=t.workspace,this.lastMarker_=this.lastOnStack_=null,this.firstMarker_=this.createMarkerBlock_(this.topBlock_),this.localConnection_=this.closestConnection_=null,this.wouldDeleteBlock_=!1,this.markerConnection_=null,this.highlightingBlock_=!1,this.highlightedBlock_=null,this.availableConnections_=this.initAvailableConnections_()},Blockly.InsertionMarkerManager.prototype.dispose=function(){this.workspace_=this.topBlock_=null,this.availableConnections_.length=0,this.localConnection_=this.closestConnection_=null,Blockly.Events.disable();try{this.firstMarker_&&(this.firstMarker_.dispose(),this.firstMarker_=null),this.lastMarker_&&(this.lastMarker_.dispose(),this.lastMarker_=null)}finally{Blockly.Events.enable()}this.highlightedBlock_=null},Blockly.InsertionMarkerManager.prototype.wouldDeleteBlock=function(){return this.wouldDeleteBlock_},Blockly.InsertionMarkerManager.prototype.wouldConnectBlock=function(){return!!this.closestConnection_},Blockly.InsertionMarkerManager.prototype.applyConnections=function(){if(this.closestConnection_&&(Blockly.Events.disable(),this.hidePreview_(),Blockly.Events.enable(),this.localConnection_.connect(this.closestConnection_),this.topBlock_.rendered)){var t=this.localConnection_.isSuperior()?this.closestConnection_:this.localConnection_;Blockly.blockAnimations.connectionUiEffect(t.getSourceBlock()),this.topBlock_.getRootBlock().bringToFront()}},Blockly.InsertionMarkerManager.prototype.update=function(t,e){var o=this.getCandidate_(t);((this.wouldDeleteBlock_=this.shouldDelete_(o,e))||this.shouldUpdatePreviews_(o,t))&&(Blockly.Events.disable(),this.maybeHidePreview_(o),this.maybeShowPreview_(o),Blockly.Events.enable())},Blockly.InsertionMarkerManager.prototype.createMarkerBlock_=function(t){var e=t.type;Blockly.Events.disable();try{var o=this.workspace_.newBlock(e);if(o.setInsertionMarker(!0,t.width),o.setCollapsed(t.isCollapsed()),t.mutationToDom){var l=t.mutationToDom();l&&o.domToMutation(l)}for(e=0;e<t.inputList.length;e++){var i=t.inputList[e],n=o.inputList[e];for(l=0;l<i.fieldRow.length;l++)n.fieldRow[l].setValue(i.fieldRow[l].getValue())}o.initSvg(),o.getSvgRoot().setAttribute("visibility","hidden")}finally{Blockly.Events.enable()}return o},Blockly.InsertionMarkerManager.prototype.initAvailableConnections_=function(){var t=this.topBlock_.getConnections_(!1),e=this.topBlock_.lastConnectionInStack();return e&&e!=this.topBlock_.nextConnection&&(t.push(e),this.lastOnStack_=e,this.lastMarker_=this.createMarkerBlock_(e.sourceBlock_)),t},Blockly.InsertionMarkerManager.prototype.shouldUpdatePreviews_=function(t,e){var o=t.local,l=t.closest,i=t.radius;if(!o||!l)return!(!this.localConnection_||!this.closestConnection_);if(this.localConnection_&&this.closestConnection_){if(this.closestConnection_==l&&this.localConnection_==o)return!1;o=this.localConnection_.x_+e.x-this.closestConnection_.x_;var n=this.localConnection_.y_+e.y-this.closestConnection_.y_;return o=Math.sqrt(o*o+n*n),!(l&&i>o-Blockly.CURRENT_CONNECTION_PREFERENCE)}return!this.localConnection_&&!this.closestConnection_||(console.error("Only one of localConnection_ and closestConnection_ was set."),console.error("Returning true from shouldUpdatePreviews, but it's not clear why."),!0)},Blockly.InsertionMarkerManager.prototype.getCandidate_=function(t){for(var e=this.getStartRadius_(),o=null,l=null,i=0;i<this.availableConnections_.length;i++){var n=this.availableConnections_[i],r=n.closest(e,t);r.connection&&(o=r.connection,l=n,e=r.radius)}return{closest:o,local:l,radius:e}},Blockly.InsertionMarkerManager.prototype.getStartRadius_=function(){return this.closestConnection_&&this.localConnection_?Blockly.CONNECTING_SNAP_RADIUS:Blockly.SNAP_RADIUS},Blockly.InsertionMarkerManager.prototype.shouldReplace_=function(){var t=this.closestConnection_,e=this.localConnection_;return e.type==Blockly.OUTPUT_VALUE?!(!t.isConnected()||Blockly.Connection.lastConnectionInRow_(this.topBlock_,t.targetConnection.getSourceBlock())):e!=e.sourceBlock_.getFirstStatementConnection()&&!(this.topBlock_.nextConnection||e.type!=Blockly.PREVIOUS_STATEMENT||!t.isConnected())},Blockly.InsertionMarkerManager.prototype.shouldDelete_=function(t,e){var o=t&&!!t.closest&&e!=Blockly.DELETE_AREA_TOOLBOX;return!!e&&!this.topBlock_.getParent()&&this.topBlock_.isDeletable()&&!o},Blockly.InsertionMarkerManager.prototype.maybeShowPreview_=function(t){if(!this.wouldDeleteBlock_){var e=t.closest;t=t.local,e&&(e==this.closestConnection_||e.sourceBlock_.isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.closestConnection_=e,this.localConnection_=t,this.showPreview_()))}},Blockly.InsertionMarkerManager.prototype.showPreview_=function(){this.shouldReplace_()?this.highlightBlock_():this.connectMarker_(),this.closestConnection_&&this.closestConnection_.highlight()},Blockly.InsertionMarkerManager.prototype.maybeHidePreview_=function(t){if(t.closest){var e=this.closestConnection_!=t.closest;t=this.localConnection_!=t.local,this.closestConnection_&&this.localConnection_&&(e||t||this.wouldDeleteBlock_)&&this.hidePreview_()}else this.hidePreview_();this.localConnection_=this.closestConnection_=this.markerConnection_=null},Blockly.InsertionMarkerManager.prototype.hidePreview_=function(){this.closestConnection_&&this.closestConnection_.unhighlight(),this.highlightingBlock_?this.unhighlightBlock_():this.markerConnection_&&this.disconnectMarker_()},Blockly.InsertionMarkerManager.prototype.highlightBlock_=function(){var t=this.closestConnection_,e=this.localConnection_;t.targetBlock()?(this.highlightedBlock_=t.targetBlock(),t.targetBlock().highlightForReplacement(!0)):e.type==Blockly.OUTPUT_VALUE&&(this.highlightedBlock_=t.sourceBlock_,t.sourceBlock_.highlightShapeForInput(t,!0)),this.highlightingBlock_=!0},Blockly.InsertionMarkerManager.prototype.unhighlightBlock_=function(){var t=this.closestConnection_;t.type!=Blockly.INPUT_VALUE||t.isConnected()?this.highlightedBlock_.highlightForReplacement(!1):this.highlightedBlock_.highlightShapeForInput(t,!1),this.highlightedBlock_=null,this.highlightingBlock_=!1},Blockly.InsertionMarkerManager.prototype.disconnectMarker_=function(){if(this.markerConnection_){var t=this.markerConnection_,e=t.sourceBlock_,o=e.nextConnection,l=e.previousConnection,i=e.outputConnection;if(i=t.type==Blockly.INPUT_VALUE&&!(i&&i.targetConnection),!(t!=o||l&&l.targetConnection)||i?t.targetBlock().unplug(!1):t.type==Blockly.NEXT_STATEMENT&&t!=o?((o=t.targetConnection).sourceBlock_.unplug(!1),l=l?l.targetConnection:null,e.unplug(!0),l&&l.connect(o)):e.unplug(!0),t.targetConnection)throw Error("markerConnection_ still connected at the end of disconnectInsertionMarker");this.markerConnection_=null,e.getSvgRoot().setAttribute("visibility","hidden")}else console.log("No insertion marker connection to disconnect")},Blockly.InsertionMarkerManager.prototype.connectMarker_=function(){var t=this.localConnection_,e=this.closestConnection_,o=this.lastOnStack_&&t==this.lastOnStack_?this.lastMarker_:this.firstMarker_;if((t=o.getMatchingConnection(t.sourceBlock_,t))==this.markerConnection_)throw Error("Made it to connectMarker_ even though the marker isn't changing");o.render(),o.rendered=!0,o.getSvgRoot().setAttribute("visibility","visible"),o.positionNewBlock(o,t,e),t.connect(e),this.markerConnection_=t},Blockly.InsertionMarkerManager.prototype.getInsertionMarkers=function(){var t=[];return this.firstMarker_&&t.push(this.firstMarker_),this.lastMarker_&&t.push(this.lastMarker_),t},Blockly.BlockDragger=function(t,e){this.draggingBlock_=t,this.workspace_=e,this.draggedConnectionManager_=new Blockly.InsertionMarkerManager(this.draggingBlock_),this.deleteArea_=null,this.wouldDeleteBlock_=!1,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=Blockly.BlockDragger.initIconData_(t)},Blockly.BlockDragger.prototype.dispose=function(){this.startWorkspace_=this.workspace_=this.draggingBlock_=null,this.dragIconData_.length=0,this.draggedConnectionManager_&&(this.draggedConnectionManager_.dispose(),this.draggedConnectionManager_=null)},Blockly.BlockDragger.initIconData_=function(t){var e=[];t=t.getDescendants(!1);for(var o,l=0;o=t[l];l++){o=o.getIcons();for(var i=0;i<o.length;i++){var n={location:o[i].getIconLocation(),icon:o[i]};e.push(n)}}return e},Blockly.BlockDragger.prototype.startBlockDrag=function(t,e){if(Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.workspace_.isMutator&&this.draggingBlock_.bringToFront(),Blockly.utils.dom.startTextWidthCache(),this.workspace_.setResizesEnabled(!1),Blockly.blockAnimations.disconnectUiStop(),this.draggingBlock_.getParent()||e&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock()){this.draggingBlock_.unplug(e);var o=this.pixelsToWorkspaceUnits_(t);o=Blockly.utils.Coordinate.sum(this.startXY_,o),this.draggingBlock_.translate(o.x,o.y),Blockly.blockAnimations.disconnectUiEffect(this.draggingBlock_)}if(this.draggingBlock_.setDragging(!0),this.draggingBlock_.moveToDragSurface_(),o=this.workspace_.getToolbox()){var l=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";o.addStyle(l)}},Blockly.BlockDragger.prototype.dragBlock=function(t,e){var o=this.pixelsToWorkspaceUnits_(e),l=Blockly.utils.Coordinate.sum(this.startXY_,o);this.draggingBlock_.moveDuringDrag(l),this.dragIcons_(o),this.deleteArea_=this.workspace_.isDeleteArea(t),this.draggedConnectionManager_.update(o,this.deleteArea_),this.updateCursorDuringBlockDrag_()},Blockly.BlockDragger.prototype.endBlockDrag=function(t,e){this.dragBlock(t,e),this.dragIconData_=[],Blockly.utils.dom.stopTextWidthCache(),Blockly.blockAnimations.disconnectUiStop();var o=this.pixelsToWorkspaceUnits_(e),l=Blockly.utils.Coordinate.sum(this.startXY_,o);this.draggingBlock_.moveOffDragSurface_(l),this.maybeDeleteBlock_()||(this.draggingBlock_.moveConnections_(o.x,o.y),this.draggingBlock_.setDragging(!1),this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.render(),this.draggingBlock_.scheduleSnapAndBump()),this.workspace_.setResizesEnabled(!0),(o=this.workspace_.getToolbox())&&(l=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",o.removeStyle(l)),Blockly.Events.setGroup(!1)},Blockly.BlockDragger.prototype.fireMoveEvent_=function(){var t=new Blockly.Events.BlockMove(this.draggingBlock_);t.oldCoordinate=this.startXY_,t.recordNew(),Blockly.Events.fire(t)},Blockly.BlockDragger.prototype.maybeDeleteBlock_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBlock_?(t&&setTimeout(t.close.bind(t),100),this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0)):t&&t.close(),this.wouldDeleteBlock_},Blockly.BlockDragger.prototype.updateCursorDuringBlockDrag_=function(){this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock();var t=this.workspace_.trashcan;this.wouldDeleteBlock_?(this.draggingBlock_.setDeleteStyle(!0),this.deleteArea_==Blockly.DELETE_AREA_TRASH&&t&&t.setOpen_(!0)):(this.draggingBlock_.setDeleteStyle(!1),t&&t.setOpen_(!1))},Blockly.BlockDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new Blockly.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},Blockly.BlockDragger.prototype.dragIcons_=function(t){for(var e=0;e<this.dragIconData_.length;e++){var o=this.dragIconData_[e];o.icon.setIconLocation(Blockly.utils.Coordinate.sum(o.location,t))}},Blockly.BlockDragger.prototype.getInsertionMarkers=function(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]},Blockly.Touch={},Blockly.Touch.TOUCH_ENABLED="ontouchstart"in Blockly.utils.global||!!(Blockly.utils.global.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!Blockly.utils.global.navigator||!Blockly.utils.global.navigator.maxTouchPoints&&!Blockly.utils.global.navigator.msMaxTouchPoints),Blockly.Touch.touchIdentifier_=null,Blockly.Touch.TOUCH_MAP={},Blockly.utils.global.PointerEvent?Blockly.Touch.TOUCH_MAP={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]}:Blockly.Touch.TOUCH_ENABLED&&(Blockly.Touch.TOUCH_MAP={mousedown:["touchstart"],mousemove:["touchmove"],mouseup:["touchend","touchcancel"]}),Blockly.longPid_=0,Blockly.longStart_=function(t,e){Blockly.longStop_(),t.changedTouches&&1!=t.changedTouches.length||(Blockly.longPid_=setTimeout((function(){t.changedTouches&&(t.button=2,t.clientX=t.changedTouches[0].clientX,t.clientY=t.changedTouches[0].clientY),e&&e.handleRightClick(t)}),Blockly.LONGPRESS))},Blockly.longStop_=function(){Blockly.longPid_&&(clearTimeout(Blockly.longPid_),Blockly.longPid_=0)},Blockly.Touch.clearTouchIdentifier=function(){Blockly.Touch.touchIdentifier_=null},Blockly.Touch.shouldHandleEvent=function(t){return!Blockly.Touch.isMouseOrTouchEvent(t)||Blockly.Touch.checkTouchIdentifier(t)},Blockly.Touch.getTouchIdentifierFromEvent=function(t){return null!=t.pointerId?t.pointerId:t.changedTouches&&t.changedTouches[0]&&null!=t.changedTouches[0].identifier?t.changedTouches[0].identifier:"mouse"},Blockly.Touch.checkTouchIdentifier=function(t){var e=Blockly.Touch.getTouchIdentifierFromEvent(t);return null!=Blockly.Touch.touchIdentifier_?Blockly.Touch.touchIdentifier_==e:("mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type)&&(Blockly.Touch.touchIdentifier_=e,!0)},Blockly.Touch.setClientFromTouch=function(t){if(Blockly.utils.string.startsWith(t.type,"touch")){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}},Blockly.Touch.isMouseOrTouchEvent=function(t){return Blockly.utils.string.startsWith(t.type,"touch")||Blockly.utils.string.startsWith(t.type,"mouse")||Blockly.utils.string.startsWith(t.type,"pointer")},Blockly.Touch.isTouchEvent=function(t){return Blockly.utils.string.startsWith(t.type,"touch")||Blockly.utils.string.startsWith(t.type,"pointer")},Blockly.Touch.splitEventByTouches=function(t){var e=[];if(t.changedTouches)for(var o=0;o<t.changedTouches.length;o++)e[o]={type:t.type,changedTouches:[t.changedTouches[o]],target:t.target,stopPropagation:function(){t.stopPropagation()},preventDefault:function(){t.preventDefault()}};else e.push(t);return e},Blockly.ScrollbarPair=function(t){this.workspace_=t,this.hScroll=new Blockly.Scrollbar(t,!0,!0,"blocklyMainWorkspaceScrollbar"),this.vScroll=new Blockly.Scrollbar(t,!1,!0,"blocklyMainWorkspaceScrollbar"),this.corner_=Blockly.utils.dom.createSvgElement("rect",{height:Blockly.Scrollbar.scrollbarThickness,width:Blockly.Scrollbar.scrollbarThickness,class:"blocklyScrollbarBackground"},null),Blockly.utils.dom.insertAfter(this.corner_,t.getBubbleCanvas())},Blockly.ScrollbarPair.prototype.oldHostMetrics_=null,Blockly.ScrollbarPair.prototype.dispose=function(){Blockly.utils.dom.removeNode(this.corner_),this.oldHostMetrics_=this.workspace_=this.corner_=null,this.hScroll.dispose(),this.hScroll=null,this.vScroll.dispose(),this.vScroll=null},Blockly.ScrollbarPair.prototype.resize=function(){var t=this.workspace_.getMetrics();if(t){var e=!1,o=!1;this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.contentWidth==t.contentWidth&&this.oldHostMetrics_.viewLeft==t.viewLeft&&this.oldHostMetrics_.contentLeft==t.contentLeft||(e=!0),this.oldHostMetrics_&&this.oldHostMetrics_.contentHeight==t.contentHeight&&this.oldHostMetrics_.viewTop==t.viewTop&&this.oldHostMetrics_.contentTop==t.contentTop||(o=!0)):o=e=!0,e&&this.hScroll.resize(t),o&&this.vScroll.resize(t),this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth==t.viewWidth&&this.oldHostMetrics_.absoluteLeft==t.absoluteLeft||this.corner_.setAttribute("x",this.vScroll.position_.x),this.oldHostMetrics_&&this.oldHostMetrics_.viewHeight==t.viewHeight&&this.oldHostMetrics_.absoluteTop==t.absoluteTop||this.corner_.setAttribute("y",this.hScroll.position_.y),this.oldHostMetrics_=t}},Blockly.ScrollbarPair.prototype.set=function(t,e){var o={},l=t*this.hScroll.ratio_,i=e*this.vScroll.ratio_,n=this.vScroll.scrollViewSize_;o.x=this.getRatio_(l,this.hScroll.scrollViewSize_),o.y=this.getRatio_(i,n),this.workspace_.setMetrics(o),this.hScroll.setHandlePosition(l),this.vScroll.setHandlePosition(i)},Blockly.ScrollbarPair.prototype.getRatio_=function(t,e){var o=t/e;return isNaN(o)?0:o},Blockly.Scrollbar=function(t,e,o,l){this.workspace_=t,this.pair_=o||!1,this.horizontal_=e,this.oldHostMetrics_=null,this.createDom_(l),this.position_=new Blockly.utils.Coordinate(0,0),t=Blockly.Scrollbar.scrollbarThickness,e?(this.svgBackground_.setAttribute("height",t),this.outerSvg_.setAttribute("height",t),this.svgHandle_.setAttribute("height",t-5),this.svgHandle_.setAttribute("y",2.5),this.lengthAttribute_="width",this.positionAttribute_="x"):(this.svgBackground_.setAttribute("width",t),this.outerSvg_.setAttribute("width",t),this.svgHandle_.setAttribute("width",t-5),this.svgHandle_.setAttribute("x",2.5),this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDownBar_),this.onMouseDownHandleWrapper_=Blockly.bindEventWithChecks_(this.svgHandle_,"mousedown",this,this.onMouseDownHandle_)},Blockly.Scrollbar.prototype.origin_=new Blockly.utils.Coordinate(0,0),Blockly.Scrollbar.prototype.startDragMouse_=0,Blockly.Scrollbar.prototype.scrollViewSize_=0,Blockly.Scrollbar.prototype.handleLength_=0,Blockly.Scrollbar.prototype.handlePosition_=0,Blockly.Scrollbar.prototype.isVisible_=!0,Blockly.Scrollbar.prototype.containerVisible_=!0,Blockly.Scrollbar.scrollbarThickness=15,Blockly.Touch.TOUCH_ENABLED&&(Blockly.Scrollbar.scrollbarThickness=25),Blockly.Scrollbar.metricsAreEquivalent_=function(t,e){return!(!t||!e||t.viewWidth!=e.viewWidth||t.viewHeight!=e.viewHeight||t.viewLeft!=e.viewLeft||t.viewTop!=e.viewTop||t.absoluteTop!=e.absoluteTop||t.absoluteLeft!=e.absoluteLeft||t.contentWidth!=e.contentWidth||t.contentHeight!=e.contentHeight||t.contentLeft!=e.contentLeft||t.contentTop!=e.contentTop)},Blockly.Scrollbar.prototype.dispose=function(){this.cleanUp_(),Blockly.unbindEvent_(this.onMouseDownBarWrapper_),this.onMouseDownBarWrapper_=null,Blockly.unbindEvent_(this.onMouseDownHandleWrapper_),this.onMouseDownHandleWrapper_=null,Blockly.utils.dom.removeNode(this.outerSvg_),this.svgBackground_=this.svgGroup_=this.outerSvg_=null,this.svgHandle_&&(this.workspace_.getThemeManager().unsubscribe(this.svgHandle_),this.svgHandle_=null),this.workspace_=null},Blockly.Scrollbar.prototype.setHandleLength_=function(t){this.handleLength_=t,this.svgHandle_.setAttribute(this.lengthAttribute_,this.handleLength_)},Blockly.Scrollbar.prototype.setHandlePosition=function(t){this.handlePosition_=t,this.svgHandle_.setAttribute(this.positionAttribute_,this.handlePosition_)},Blockly.Scrollbar.prototype.setScrollViewSize_=function(t){this.scrollViewSize_=t,this.outerSvg_.setAttribute(this.lengthAttribute_,this.scrollViewSize_),this.svgBackground_.setAttribute(this.lengthAttribute_,this.scrollViewSize_)},Blockly.ScrollbarPair.prototype.setContainerVisible=function(t){this.hScroll.setContainerVisible(t),this.vScroll.setContainerVisible(t)},Blockly.Scrollbar.prototype.setPosition_=function(t,e){this.position_.x=t,this.position_.y=e,Blockly.utils.dom.setCssTransform(this.outerSvg_,"translate("+(this.position_.x+this.origin_.x)+"px,"+(this.position_.y+this.origin_.y)+"px)")},Blockly.Scrollbar.prototype.resize=function(t){(t||(t=this.workspace_.getMetrics()))&&(Blockly.Scrollbar.metricsAreEquivalent_(t,this.oldHostMetrics_)||(this.oldHostMetrics_=t,this.horizontal_?this.resizeHorizontal_(t):this.resizeVertical_(t),this.onScroll_()))},Blockly.Scrollbar.prototype.resizeHorizontal_=function(t){this.resizeViewHorizontal(t)},Blockly.Scrollbar.prototype.resizeViewHorizontal=function(t){var e=t.viewWidth-1;this.pair_&&(e-=Blockly.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.pair_&&this.workspace_.RTL&&(e+=Blockly.Scrollbar.scrollbarThickness),this.setPosition_(e,t.absoluteTop+t.viewHeight-Blockly.Scrollbar.scrollbarThickness-.5),this.resizeContentHorizontal(t)},Blockly.Scrollbar.prototype.resizeContentHorizontal=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentWidth),this.ratio_=this.scrollViewSize_/t.contentWidth,(-1/0==this.ratio_||1/0==this.ratio_||isNaN(this.ratio_))&&(this.ratio_=0),this.setHandleLength_(Math.max(0,t.viewWidth*this.ratio_)),this.setHandlePosition(this.constrainHandle_((t.viewLeft-t.contentLeft)*this.ratio_))},Blockly.Scrollbar.prototype.resizeVertical_=function(t){this.resizeViewVertical(t)},Blockly.Scrollbar.prototype.resizeViewVertical=function(t){var e=t.viewHeight-1;this.pair_&&(e-=Blockly.Scrollbar.scrollbarThickness),this.setScrollViewSize_(Math.max(0,e)),e=t.absoluteLeft+.5,this.workspace_.RTL||(e+=t.viewWidth-Blockly.Scrollbar.scrollbarThickness-1),this.setPosition_(e,t.absoluteTop+.5),this.resizeContentVertical(t)},Blockly.Scrollbar.prototype.resizeContentVertical=function(t){this.pair_||this.setVisible(this.scrollViewSize_<t.contentHeight),this.ratio_=this.scrollViewSize_/t.contentHeight,(-1/0==this.ratio_||1/0==this.ratio_||isNaN(this.ratio_))&&(this.ratio_=0),this.setHandleLength_(Math.max(0,t.viewHeight*this.ratio_)),this.setHandlePosition(this.constrainHandle_((t.viewTop-t.contentTop)*this.ratio_))},Blockly.Scrollbar.prototype.createDom_=function(t){var e="blocklyScrollbar"+(this.horizontal_?"Horizontal":"Vertical");t&&(e+=" "+t),this.outerSvg_=Blockly.utils.dom.createSvgElement("svg",{class:e},null),this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{},this.outerSvg_),this.svgBackground_=Blockly.utils.dom.createSvgElement("rect",{class:"blocklyScrollbarBackground"},this.svgGroup_),t=Math.floor((Blockly.Scrollbar.scrollbarThickness-5)/2),this.svgHandle_=Blockly.utils.dom.createSvgElement("rect",{class:"blocklyScrollbarHandle",rx:t,ry:t},this.svgGroup_),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbar","fill"),this.workspace_.getThemeManager().subscribe(this.svgHandle_,"scrollbarOpacity","fill-opacity"),Blockly.utils.dom.insertAfter(this.outerSvg_,this.workspace_.getParentSvg())},Blockly.Scrollbar.prototype.isVisible=function(){return this.isVisible_},Blockly.Scrollbar.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},Blockly.Scrollbar.prototype.setVisible=function(t){var e=t!=this.isVisible();if(this.pair_)throw Error("Unable to toggle visibility of paired scrollbars.");this.isVisible_=t,e&&this.updateDisplay_()},Blockly.Scrollbar.prototype.updateDisplay_=function(){this.containerVisible_&&this.isVisible()?this.outerSvg_.setAttribute("display","block"):this.outerSvg_.setAttribute("display","none")},Blockly.Scrollbar.prototype.onMouseDownBar_=function(t){if(this.workspace_.markFocused(),Blockly.Touch.clearTouchIdentifier(),this.cleanUp_(),Blockly.utils.isRightButton(t))t.stopPropagation();else{var e=Blockly.utils.mouseToSvg(t,this.workspace_.getParentSvg(),this.workspace_.getInverseScreenCTM());e=this.horizontal_?e.x:e.y;var o=Blockly.utils.getInjectionDivXY_(this.svgHandle_),l=this.handlePosition_,i=.95*this.handleLength_;e<=(o=this.horizontal_?o.x:o.y)?l-=i:e>=o+this.handleLength_&&(l+=i),this.setHandlePosition(this.constrainHandle_(l)),this.onScroll_(),t.stopPropagation(),t.preventDefault()}},Blockly.Scrollbar.prototype.onMouseDownHandle_=function(t){this.workspace_.markFocused(),this.cleanUp_(),Blockly.utils.isRightButton(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition_,this.workspace_.setupDragSurface(),this.startDragMouse_=this.horizontal_?t.clientX:t.clientY,Blockly.Scrollbar.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,this.onMouseUpHandle_),Blockly.Scrollbar.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.onMouseMoveHandle_),t.stopPropagation(),t.preventDefault())},Blockly.Scrollbar.prototype.onMouseMoveHandle_=function(t){this.setHandlePosition(this.constrainHandle_(this.startDragHandle+((this.horizontal_?t.clientX:t.clientY)-this.startDragMouse_))),this.onScroll_()},Blockly.Scrollbar.prototype.onMouseUpHandle_=function(){this.workspace_.resetDragSurface(),Blockly.Touch.clearTouchIdentifier(),this.cleanUp_()},Blockly.Scrollbar.prototype.cleanUp_=function(){Blockly.hideChaff(!0),Blockly.Scrollbar.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseUpWrapper_),Blockly.Scrollbar.onMouseUpWrapper_=null),Blockly.Scrollbar.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Scrollbar.onMouseMoveWrapper_),Blockly.Scrollbar.onMouseMoveWrapper_=null)},Blockly.Scrollbar.prototype.constrainHandle_=function(t){return 0>=t||isNaN(t)||this.scrollViewSize_<this.handleLength_?0:Math.min(t,this.scrollViewSize_-this.handleLength_)},Blockly.Scrollbar.prototype.onScroll_=function(){var t=this.handlePosition_/this.scrollViewSize_;isNaN(t)&&(t=0);var e={};this.horizontal_?e.x=t:e.y=t,this.workspace_.setMetrics(e)},Blockly.Scrollbar.prototype.set=function(t){this.setHandlePosition(this.constrainHandle_(t*this.ratio_)),this.onScroll_()},Blockly.Scrollbar.prototype.setOrigin=function(t,e){this.origin_=new Blockly.utils.Coordinate(t,e)},Blockly.utils.math={},Blockly.utils.math.toRadians=function(t){return t*Math.PI/180},Blockly.utils.math.toDegrees=function(t){return 180*t/Math.PI},Blockly.utils.math.clamp=function(t,e,o){if(o<t){var l=o;o=t,t=l}return Math.max(t,Math.min(e,o))},Blockly.Cursor=function(){this.drawer_=this.curNode_=null},Blockly.Cursor.prototype.setDrawer=function(t){this.drawer_=t},Blockly.Cursor.prototype.getDrawer=function(){return this.drawer_},Blockly.Cursor.prototype.getCurNode=function(){return this.curNode_},Blockly.Cursor.prototype.setCurNode=function(t){this.curNode_=t,this.drawer_&&this.drawer_.draw(this.getCurNode())},Blockly.Cursor.prototype.hide=function(){this.drawer_&&this.drawer_.hide()},Blockly.Cursor.prototype.next=function(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()==Blockly.ASTNode.types.NEXT||t.getType()==Blockly.ASTNode.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t},Blockly.Cursor.prototype.in=function(){var t=this.getCurNode();return t?(t.getType()!=Blockly.ASTNode.types.PREVIOUS&&t.getType()!=Blockly.ASTNode.types.OUTPUT||(t=t.next()),(t=t.in())&&this.setCurNode(t),t):null},Blockly.Cursor.prototype.prev=function(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()==Blockly.ASTNode.types.NEXT||t.getType()==Blockly.ASTNode.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t},Blockly.Cursor.prototype.out=function(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()==Blockly.ASTNode.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null},Blockly.MarkerCursor=function(){Blockly.MarkerCursor.superClass_.constructor.call(this)},Blockly.utils.object.inherits(Blockly.MarkerCursor,Blockly.Cursor),Blockly.MarkerCursor.prototype.next=function(){return null},Blockly.MarkerCursor.prototype.in=function(){return null},Blockly.MarkerCursor.prototype.prev=function(){return null},Blockly.MarkerCursor.prototype.out=function(){return null},Blockly.Theme=function(t,e,o){this.blockStyles_=t,this.categoryStyles_=e,this.componentStyles_=o||Object.create(null)},Blockly.Theme.prototype.setAllBlockStyles=function(t){for(var e in t)this.setBlockStyle(e,t[e])},Blockly.Theme.prototype.getAllBlockStyles=function(){return this.blockStyles_},Blockly.Theme.prototype.getBlockStyle=function(t){return this.blockStyles_[t]},Blockly.Theme.prototype.setBlockStyle=function(t,e){this.blockStyles_[t]=e},Blockly.Theme.prototype.getCategoryStyle=function(t){return this.categoryStyles_[t]},Blockly.Theme.prototype.setCategoryStyle=function(t,e){this.categoryStyles_[t]=e},Blockly.Theme.prototype.getComponentStyle=function(t){return(t=this.componentStyles_[t])&&"string"==typeof propertyValue&&this.getComponentStyle(t)?this.getComponentStyle(t):t?String(t):null},Blockly.Theme.prototype.setComponentStyle=function(t,e){this.componentStyles_[t]=e},Blockly.ThemeManager=function(t){this.theme_=t,this.subscribedWorkspaces_=[],this.componentDB_=Object.create(null)},Blockly.ThemeManager.prototype.getTheme=function(){return this.theme_},Blockly.ThemeManager.prototype.setTheme=function(t){if(this.theme_!==t){this.theme_=t,t=0;for(var e;e=this.subscribedWorkspaces_[t];t++)e.refreshTheme();t=0,e=Object.keys(this.componentDB_);for(var o;o=e[t];t++)for(var l,i=0;l=this.componentDB_[o][i];i++){var n=l.element;l=l.propertyName;var r=this.theme_&&this.theme_.getComponentStyle(o);n.style[l]=r||""}}},Blockly.ThemeManager.prototype.subscribeWorkspace=function(t){this.subscribedWorkspaces_.push(t)},Blockly.ThemeManager.prototype.unsubscribeWorkspace=function(t){if(0>(t=this.subscribedWorkspaces_.indexOf(t)))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.");this.subscribedWorkspaces_.splice(t,1)},Blockly.ThemeManager.prototype.subscribe=function(t,e,o){this.componentDB_[e]||(this.componentDB_[e]=[]),this.componentDB_[e].push({element:t,propertyName:o}),e=this.theme_&&this.theme_.getComponentStyle(e),t.style[o]=e||""},Blockly.ThemeManager.prototype.unsubscribe=function(t){if(t)for(var e,o=Object.keys(this.componentDB_),l=0;e=o[l];l++){for(var i=this.componentDB_[e],n=i.length-1;0<=n;n--)i[n].element===t&&i.splice(n,1);this.componentDB_[e].length||delete this.componentDB_[e]}},Blockly.ThemeManager.prototype.dispose=function(){this.componentDB_=this.subscribedWorkspaces_=this.theme_=this.owner_=null},Blockly.Themes={},Blockly.Themes.Classic={},Blockly.Themes.Classic.defaultBlockStyles={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},Blockly.Themes.Classic.categoryStyles={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},Blockly.Themes.Classic=new Blockly.Theme(Blockly.Themes.Classic.defaultBlockStyles,Blockly.Themes.Classic.categoryStyles),Blockly.VariableMap=function(t){this.variableMap_=Object.create(null),this.workspace=t},Blockly.VariableMap.prototype.clear=function(){this.variableMap_=Object.create(null)},Blockly.VariableMap.prototype.renameVariable=function(t,e){var o=this.getVariable(e,t.type),l=this.workspace.getAllBlocks(!1);Blockly.Events.setGroup(!0);try{o&&o.getId()!=t.getId()?this.renameVariableWithConflict_(t,e,o,l):this.renameVariableAndUses_(t,e,l)}finally{Blockly.Events.setGroup(!1)}},Blockly.VariableMap.prototype.renameVariableById=function(t,e){var o=this.getVariableById(t);if(!o)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(o,e)},Blockly.VariableMap.prototype.renameVariableAndUses_=function(t,e,o){for(Blockly.Events.fire(new Blockly.Events.VarRename(t,e)),t.name=e,e=0;e<o.length;e++)o[e].updateVarName(t)},Blockly.VariableMap.prototype.renameVariableWithConflict_=function(t,e,o,l){var i=t.type;for(e!=o.name&&this.renameVariableAndUses_(o,e,l),e=0;e<l.length;e++)l[e].renameVarById(t.getId(),o.getId());Blockly.Events.fire(new Blockly.Events.VarDelete(t)),t=this.getVariablesOfType(i).indexOf(t),this.variableMap_[i].splice(t,1)},Blockly.VariableMap.prototype.createVariable=function(t,e,o){var l=this.getVariable(t,e);if(l){if(o&&l.getId()!=o)throw Error('Variable "'+t+'" is already in use and its id is "'+l.getId()+'" which conflicts with the passed in id, "'+o+'".');return l}if(o&&this.getVariableById(o))throw Error('Variable id, "'+o+'", is already in use.');return l=o||Blockly.utils.genUid(),l=new Blockly.VariableModel(this.workspace,t,e=e||"",l),(t=this.variableMap_[e]||[]).push(l),delete this.variableMap_[e],this.variableMap_[e]=t,l},Blockly.VariableMap.prototype.deleteVariable=function(t){for(var e,o=this.variableMap_[t.type],l=0;e=o[l];l++)if(e.getId()==t.getId()){o.splice(l,1),Blockly.Events.fire(new Blockly.Events.VarDelete(t));break}},Blockly.VariableMap.prototype.deleteVariableById=function(t){var e=this.getVariableById(t);if(e){var o,l=e.name,i=this.getVariableUsesById(t);for(t=0;o=i[t];t++)if("procedures_defnoreturn"==o.type||"procedures_defreturn"==o.type)return t=o.getFieldValue("NAME"),l=Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",l).replace("%2",t),void Blockly.alert(l);var n=this;1<i.length?(l=Blockly.Msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(i.length)).replace("%2",l),Blockly.confirm(l,(function(t){t&&n.deleteVariableInternal_(e,i)}))):n.deleteVariableInternal_(e,i)}else console.warn("Can't delete non-existent variable: "+t)},Blockly.VariableMap.prototype.deleteVariableInternal_=function(t,e){var o=Blockly.Events.getGroup();o||Blockly.Events.setGroup(!0);try{for(var l=0;l<e.length;l++)e[l].dispose(!0,!1);this.deleteVariable(t)}finally{o||Blockly.Events.setGroup(!1)}},Blockly.VariableMap.prototype.getVariable=function(t,e){var o=this.variableMap_[e||""];if(o)for(var l,i=0;l=o[i];i++)if(Blockly.Names.equals(l.name,t))return l;return null},Blockly.VariableMap.prototype.getVariableById=function(t){for(var e=Object.keys(this.variableMap_),o=0;o<e.length;o++)for(var l,i=e[o],n=0;l=this.variableMap_[i][n];n++)if(l.getId()==t)return l;return null},Blockly.VariableMap.prototype.getVariablesOfType=function(t){return(t=this.variableMap_[t||""])?t.slice():[]},Blockly.VariableMap.prototype.getVariableTypes=function(t){var e=[];t&&t.getPotentialVariableMap()&&(e=Object.keys(t.getPotentialVariableMap().variableMap_)),t=Object.keys(this.variableMap_).concat(e),e=!1;for(var o=0;o<t.length;o++)""==t[o]&&(e=!0);return e||t.push(""),t},Blockly.VariableMap.prototype.getAllVariables=function(){var t,e=[];for(t in this.variableMap_)e=e.concat(this.variableMap_[t]);return e},Blockly.VariableMap.prototype.getVariableUsesById=function(t){for(var e=[],o=this.workspace.getAllBlocks(!1),l=0;l<o.length;l++){var i=o[l].getVarModels();if(i)for(var n=0;n<i.length;n++)i[n].getId()==t&&e.push(o[l])}return e},Blockly.Workspace=function(t){this.id=Blockly.utils.genUid(),Blockly.Workspace.WorkspaceDB_[this.id]=this,this.options=t||{},this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.topBlocks_=[],this.topComments_=[],this.commentDB_=Object.create(null),this.listeners_=[],this.undoStack_=[],this.redoStack_=[],this.blockDB_=Object.create(null),this.typedBlocksDB_=Object.create(null),this.variableMap_=new Blockly.VariableMap(this),this.potentialVariableMap_=null,this.cursor_=new Blockly.Cursor,this.marker_=new Blockly.MarkerCursor,this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Blockly.ThemeManager(this.options.theme||Blockly.Themes.Classic),this.themeManager_.subscribeWorkspace(this)},Blockly.Workspace.prototype.rendered=!1,Blockly.Workspace.prototype.isClearing=!1,Blockly.Workspace.prototype.MAX_UNDO=1024,Blockly.Workspace.prototype.connectionDBList=null,Blockly.Workspace.prototype.setCursor=function(t){this.cursor_=t},Blockly.Workspace.prototype.setMarker=function(t){this.marker_=t},Blockly.Workspace.prototype.getCursor=function(){return this.cursor_},Blockly.Workspace.prototype.getMarker=function(){return this.marker_},Blockly.Workspace.prototype.getTheme=function(){return this.themeManager_.getTheme()},Blockly.Workspace.prototype.setTheme=function(t){t||(t=Blockly.Themes.Classic),this.themeManager_.setTheme(t)},Blockly.Workspace.prototype.refreshTheme=function(){this.updateBlockStyles_(this.getAllBlocks().filter((function(t){return void 0!==t.getStyleName()})));var t=new Blockly.Events.Ui(null,"theme",null,null);t.workspaceId=this.id,Blockly.Events.fire(t)},Blockly.Workspace.prototype.updateBlockStyles_=function(t){for(var e,o=0;e=t[o];o++){var l=e.getStyleName();e.setStyle(l),e.mutator&&e.mutator.updateBlockStyle(l)}},Blockly.Workspace.prototype.dispose=function(){this.listeners_.length=0,this.clear(),delete Blockly.Workspace.WorkspaceDB_[this.id],this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||(this.themeManager_.dispose(),this.themeManager_=null))},Blockly.Workspace.SCAN_ANGLE=3,Blockly.Workspace.prototype.sortObjects_=function(t,e){var o=t.getRelativeToSurfaceXY(),l=e.getRelativeToSurfaceXY();return o.y+Blockly.Workspace.prototype.sortObjects_.offset*o.x-(l.y+Blockly.Workspace.prototype.sortObjects_.offset*l.x)},Blockly.Workspace.prototype.addTopBlock=function(t){this.topBlocks_.push(t)},Blockly.Workspace.prototype.removeTopBlock=function(t){if(!Blockly.utils.arrayRemove(this.topBlocks_,t))throw Error("Block not present in workspace's list of top-most blocks.")},Blockly.Workspace.prototype.getTopBlocks=function(t){var e=[].concat(this.topBlocks_);return t&&1<e.length&&(this.sortObjects_.offset=Math.sin(Blockly.utils.math.toRadians(Blockly.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e},Blockly.Workspace.prototype.addTypedBlock=function(t){this.typedBlocksDB_[t.type]||(this.typedBlocksDB_[t.type]=[]),this.typedBlocksDB_[t.type].push(t)},Blockly.Workspace.prototype.removeTypedBlock=function(t){this.typedBlocksDB_[t.type].splice(this.typedBlocksDB_[t.type].indexOf(t),1),this.typedBlocksDB_[t.type].length||delete this.typedBlocksDB_[t.type]},Blockly.Workspace.prototype.getBlocksByType=function(t,e){if(!this.typedBlocksDB_[t])return[];var o=this.typedBlocksDB_[t].slice(0);return e&&1<o.length&&(this.sortObjects_.offset=Math.sin(Blockly.utils.math.toRadians(Blockly.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),o.sort(this.sortObjects_)),o},Blockly.Workspace.prototype.addTopComment=function(t){this.topComments_.push(t),this.commentDB_[t.id]&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB_[t.id]=t},Blockly.Workspace.prototype.removeTopComment=function(t){if(!Blockly.utils.arrayRemove(this.topComments_,t))throw Error("Comment not present in workspace's list of top-most comments.");delete this.commentDB_[t.id]},Blockly.Workspace.prototype.getTopComments=function(t){var e=[].concat(this.topComments_);return t&&1<e.length&&(this.sortObjects_.offset=Math.sin(Blockly.utils.math.toRadians(Blockly.Workspace.SCAN_ANGLE)),this.RTL&&(this.sortObjects_.offset*=-1),e.sort(this.sortObjects_)),e},Blockly.Workspace.prototype.getAllBlocks=function(t){if(t){t=this.getTopBlocks(!0);for(var e=[],o=0;o<t.length;o++)e.push.apply(e,t[o].getDescendants(!0))}else for(e=this.getTopBlocks(!1),o=0;o<e.length;o++)e.push.apply(e,e[o].getChildren(!1));return e.filter((function(t){return!t.isInsertionMarker()}))},Blockly.Workspace.prototype.clear=function(){this.isClearing=!0;try{var t=Blockly.Events.getGroup();for(t||Blockly.Events.setGroup(!0);this.topBlocks_.length;)this.topBlocks_[0].dispose();for(;this.topComments_.length;)this.topComments_[this.topComments_.length-1].dispose();t||Blockly.Events.setGroup(!1),this.variableMap_.clear(),this.potentialVariableMap_&&this.potentialVariableMap_.clear()}finally{this.isClearing=!1}},Blockly.Workspace.prototype.renameVariableById=function(t,e){this.variableMap_.renameVariableById(t,e)},Blockly.Workspace.prototype.createVariable=function(t,e,o){return this.variableMap_.createVariable(t,e,o)},Blockly.Workspace.prototype.getVariableUsesById=function(t){return this.variableMap_.getVariableUsesById(t)},Blockly.Workspace.prototype.deleteVariableById=function(t){this.variableMap_.deleteVariableById(t)},Blockly.Workspace.prototype.deleteVariableInternal_=function(t,e){this.variableMap_.deleteVariableInternal_(t,e)},Blockly.Workspace.prototype.variableIndexOf=function(t){return console.warn("Deprecated call to Blockly.Workspace.prototype.variableIndexOf"),-1},Blockly.Workspace.prototype.getVariable=function(t,e){return this.variableMap_.getVariable(t,e)},Blockly.Workspace.prototype.getVariableById=function(t){return this.variableMap_.getVariableById(t)},Blockly.Workspace.prototype.getVariablesOfType=function(t){return this.variableMap_.getVariablesOfType(t)},Blockly.Workspace.prototype.getVariableTypes=function(){return this.variableMap_.getVariableTypes(this)},Blockly.Workspace.prototype.getAllVariables=function(){return this.variableMap_.getAllVariables()},Blockly.Workspace.prototype.getWidth=function(){return 0},Blockly.Workspace.prototype.newBlock=function(t,e){return new Blockly.Block(this,t,e)},Blockly.Workspace.prototype.remainingCapacity=function(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks().length},Blockly.Workspace.prototype.remainingCapacityOfType=function(t){return this.options.maxInstances?(this.options.maxInstances[t]||1/0)-this.getBlocksByType(t).length:1/0},Blockly.Workspace.prototype.isCapacityAvailable=function(t){if(!this.hasBlockLimits())return!0;var e,o=0;for(e in t){if(t[e]>this.remainingCapacityOfType(e))return!1;o+=t[e]}return!(o>this.remainingCapacity())},Blockly.Workspace.prototype.hasBlockLimits=function(){return 1/0!=this.options.maxBlocks||!!this.options.maxInstances},Blockly.Workspace.prototype.undo=function(t){var e=t?this.redoStack_:this.undoStack_,o=t?this.undoStack_:this.redoStack_,l=e.pop();if(l){for(var i=[l];e.length&&l.group&&l.group==e[e.length-1].group;)i.push(e.pop());for(e=0;l=i[e];e++)o.push(l);i=Blockly.Events.filter(i,t),Blockly.Events.recordUndo=!1;try{for(e=0;l=i[e];e++)l.run(t)}finally{Blockly.Events.recordUndo=!0}}},Blockly.Workspace.prototype.clearUndo=function(){this.undoStack_.length=0,this.redoStack_.length=0,Blockly.Events.clearPendingUndo()},Blockly.Workspace.prototype.addChangeListener=function(t){return this.listeners_.push(t),t},Blockly.Workspace.prototype.removeChangeListener=function(t){Blockly.utils.arrayRemove(this.listeners_,t)},Blockly.Workspace.prototype.fireChangeListener=function(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(var e,o=0;e=this.listeners_[o];o++)e(t)},Blockly.Workspace.prototype.getBlockById=function(t){return this.blockDB_[t]||null},Blockly.Workspace.prototype.getCommentById=function(t){return this.commentDB_[t]||null},Blockly.Workspace.prototype.allInputsFilled=function(t){for(var e,o=this.getTopBlocks(!1),l=0;e=o[l];l++)if(!e.allInputsFilled(t))return!1;return!0},Blockly.Workspace.prototype.getPotentialVariableMap=function(){return this.potentialVariableMap_},Blockly.Workspace.prototype.createPotentialVariableMap=function(){this.potentialVariableMap_=new Blockly.VariableMap(this)},Blockly.Workspace.prototype.getVariableMap=function(){return this.variableMap_},Blockly.Workspace.WorkspaceDB_=Object.create(null),Blockly.Workspace.getById=function(t){return Blockly.Workspace.WorkspaceDB_[t]||null},Blockly.Workspace.getAll=function(){var t,e=[];for(t in Blockly.Workspace.WorkspaceDB_)e.push(Blockly.Workspace.WorkspaceDB_[t]);return e},Blockly.Workspace.prototype.getThemeManager=function(){return this.themeManager_},Blockly.Bubble=function(t,e,o,l,i,n){this.workspace_=t,this.content_=e,this.shape_=o,o=Blockly.Bubble.ARROW_ANGLE,this.workspace_.RTL&&(o=-o),this.arrow_radians_=Blockly.utils.math.toRadians(o),t.getBubbleCanvas().appendChild(this.createDom_(e,!(!i||!n))),this.setAnchorLocation(l),i&&n||(i=(e=this.content_.getBBox()).width+2*Blockly.Bubble.BORDER_WIDTH,n=e.height+2*Blockly.Bubble.BORDER_WIDTH),this.setBubbleSize(i,n),this.positionBubble_(),this.renderArrow_(),this.rendered_=!0,t.options.readOnly||(Blockly.bindEventWithChecks_(this.bubbleBack_,"mousedown",this,this.bubbleMouseDown_),this.resizeGroup_&&Blockly.bindEventWithChecks_(this.resizeGroup_,"mousedown",this,this.resizeMouseDown_))},Blockly.Bubble.BORDER_WIDTH=6,Blockly.Bubble.ARROW_THICKNESS=5,Blockly.Bubble.ARROW_ANGLE=20,Blockly.Bubble.ARROW_BEND=4,Blockly.Bubble.ANCHOR_RADIUS=8,Blockly.Bubble.onMouseUpWrapper_=null,Blockly.Bubble.onMouseMoveWrapper_=null,Blockly.Bubble.prototype.resizeCallback_=null,Blockly.Bubble.unbindDragEvents_=function(){Blockly.Bubble.onMouseUpWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseUpWrapper_),Blockly.Bubble.onMouseUpWrapper_=null),Blockly.Bubble.onMouseMoveWrapper_&&(Blockly.unbindEvent_(Blockly.Bubble.onMouseMoveWrapper_),Blockly.Bubble.onMouseMoveWrapper_=null)},Blockly.Bubble.bubbleMouseUp_=function(){Blockly.Touch.clearTouchIdentifier(),Blockly.Bubble.unbindDragEvents_()},Blockly.Bubble.prototype.rendered_=!1,Blockly.Bubble.prototype.anchorXY_=null,Blockly.Bubble.prototype.relativeLeft_=0,Blockly.Bubble.prototype.relativeTop_=0,Blockly.Bubble.prototype.width_=0,Blockly.Bubble.prototype.height_=0,Blockly.Bubble.prototype.autoLayout_=!0,Blockly.Bubble.prototype.createDom_=function(t,e){this.bubbleGroup_=Blockly.utils.dom.createSvgElement("g",{},null);var o={filter:"url(#"+this.workspace_.options.embossFilterId+")"};return Blockly.utils.userAgent.JAVA_FX&&(o={}),o=Blockly.utils.dom.createSvgElement("g",o,this.bubbleGroup_),this.bubbleArrow_=Blockly.utils.dom.createSvgElement("path",{},o),this.bubbleBack_=Blockly.utils.dom.createSvgElement("rect",{class:"blocklyDraggable",x:0,y:0,rx:Blockly.Bubble.BORDER_WIDTH,ry:Blockly.Bubble.BORDER_WIDTH},o),e?(this.resizeGroup_=Blockly.utils.dom.createSvgElement("g",{class:this.workspace_.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.bubbleGroup_),Blockly.utils.dom.createSvgElement("polygon",{points:"0,x x,x x,0".replace(/x/g,(o=2*Blockly.Bubble.BORDER_WIDTH).toString())},this.resizeGroup_),Blockly.utils.dom.createSvgElement("line",{class:"blocklyResizeLine",x1:o/3,y1:o-1,x2:o-1,y2:o/3},this.resizeGroup_),Blockly.utils.dom.createSvgElement("line",{class:"blocklyResizeLine",x1:2*o/3,y1:o-1,x2:o-1,y2:2*o/3},this.resizeGroup_)):this.resizeGroup_=null,this.bubbleGroup_.appendChild(t),this.bubbleGroup_},Blockly.Bubble.prototype.getSvgRoot=function(){return this.bubbleGroup_},Blockly.Bubble.prototype.setSvgId=function(t){this.bubbleGroup_.dataset&&(this.bubbleGroup_.dataset.blockId=t)},Blockly.Bubble.prototype.bubbleMouseDown_=function(t){var e=this.workspace_.getGesture(t);e&&e.handleBubbleStart(t,this)},Blockly.Bubble.prototype.showContextMenu_=function(t){},Blockly.Bubble.prototype.isDeletable=function(){return!1},Blockly.Bubble.prototype.resizeMouseDown_=function(t){this.promote_(),Blockly.Bubble.unbindDragEvents_(),Blockly.utils.isRightButton(t)||(this.workspace_.startDrag(t,new Blockly.utils.Coordinate(this.workspace_.RTL?-this.width_:this.width_,this.height_)),Blockly.Bubble.onMouseUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",this,Blockly.Bubble.bubbleMouseUp_),Blockly.Bubble.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",this,this.resizeMouseMove_),Blockly.hideChaff()),t.stopPropagation()},Blockly.Bubble.prototype.resizeMouseMove_=function(t){this.autoLayout_=!1,t=this.workspace_.moveDrag(t),this.setBubbleSize(this.workspace_.RTL?-t.x:t.x,t.y),this.workspace_.RTL&&this.positionBubble_()},Blockly.Bubble.prototype.registerResizeEvent=function(t){this.resizeCallback_=t},Blockly.Bubble.prototype.promote_=function(){var t=this.bubbleGroup_.parentNode;return t.lastChild!==this.bubbleGroup_&&(t.appendChild(this.bubbleGroup_),!0)},Blockly.Bubble.prototype.setAnchorLocation=function(t){this.anchorXY_=t,this.rendered_&&this.positionBubble_()},Blockly.Bubble.prototype.layoutBubble_=function(){var t=this.workspace_.getMetrics();t.viewLeft/=this.workspace_.scale,t.viewWidth/=this.workspace_.scale,t.viewTop/=this.workspace_.scale,t.viewHeight/=this.workspace_.scale;var e=this.getOptimalRelativeLeft_(t),o=this.getOptimalRelativeTop_(t),l=this.shape_.getBBox(),i={x:e,y:-this.height_-Blockly.BlockSvg.MIN_BLOCK_Y},n={x:-this.width_-30,y:o};o={x:l.width,y:o};var r={x:e,y:l.height};e=l.width<l.height?o:r,l=l.width<l.height?r:o,o=this.getOverlap_(i,t),r=this.getOverlap_(n,t);var s=this.getOverlap_(e,t);t=this.getOverlap_(l,t),o==(t=Math.max(o,r,s,t))?(this.relativeLeft_=i.x,this.relativeTop_=i.y):r==t?(this.relativeLeft_=n.x,this.relativeTop_=n.y):s==t?(this.relativeLeft_=e.x,this.relativeTop_=e.y):(this.relativeLeft_=l.x,this.relativeTop_=l.y)},Blockly.Bubble.prototype.getOverlap_=function(t,e){var o=this.workspace_.RTL?this.anchorXY_.x-t.x-this.width_:t.x+this.anchorXY_.x,l=t.y+this.anchorXY_.y;return Math.max(0,Math.min(1,(Math.min(o+this.width_,e.viewLeft+e.viewWidth)-Math.max(o,e.viewLeft))*(Math.min(l+this.height_,e.viewTop+e.viewHeight)-Math.max(l,e.viewTop))/(this.width_*this.height_)))},Blockly.Bubble.prototype.getOptimalRelativeLeft_=function(t){var e=-this.width_/4;if(this.width_>t.viewWidth)return e;if(this.workspace_.RTL)var o=this.anchorXY_.x-e,l=o-this.width_,i=t.viewLeft+t.viewWidth,n=t.viewLeft+Blockly.Scrollbar.scrollbarThickness/this.workspace_.scale;else o=(l=e+this.anchorXY_.x)+this.width_,n=t.viewLeft,i=t.viewLeft+t.viewWidth-Blockly.Scrollbar.scrollbarThickness/this.workspace_.scale;return this.workspace_.RTL?l<n?e=-(n-this.anchorXY_.x+this.width_):o>i&&(e=-(i-this.anchorXY_.x)):l<n?e=n-this.anchorXY_.x:o>i&&(e=i-this.anchorXY_.x-this.width_),e},Blockly.Bubble.prototype.getOptimalRelativeTop_=function(t){var e=-this.height_/4;if(this.height_>t.viewHeight)return e;var o=this.anchorXY_.y+e,l=t.viewTop;t=t.viewTop+t.viewHeight-Blockly.Scrollbar.scrollbarThickness/this.workspace_.scale;var i=this.anchorXY_.y;return o<l?e=l-i:o+this.height_>t&&(e=t-i-this.height_),e},Blockly.Bubble.prototype.positionBubble_=function(){var t=this.anchorXY_.x;this.moveTo(t=this.workspace_.RTL?t-(this.relativeLeft_+this.width_):t+this.relativeLeft_,this.relativeTop_+this.anchorXY_.y)},Blockly.Bubble.prototype.moveTo=function(t,e){this.bubbleGroup_.setAttribute("transform","translate("+t+","+e+")")},Blockly.Bubble.prototype.getBubbleSize=function(){return new Blockly.utils.Size(this.width_,this.height_)},Blockly.Bubble.prototype.setBubbleSize=function(t,e){var o=2*Blockly.Bubble.BORDER_WIDTH;t=Math.max(t,o+45),e=Math.max(e,o+20),this.width_=t,this.height_=e,this.bubbleBack_.setAttribute("width",t),this.bubbleBack_.setAttribute("height",e),this.resizeGroup_&&this.resizeGroup_.setAttribute("transform",this.workspace_.RTL?"translate("+2*Blockly.Bubble.BORDER_WIDTH+","+(e-o)+") scale(-1 1)":"translate("+(t-o)+","+(e-o)+")"),this.autoLayout_&&this.layoutBubble_(),this.positionBubble_(),this.renderArrow_(),this.resizeCallback_&&this.resizeCallback_()},Blockly.Bubble.prototype.renderArrow_=function(){var t=[],e=this.width_/2,o=this.height_/2,l=-this.relativeLeft_,i=-this.relativeTop_;if(e==l&&o==i)t.push("M "+e+","+o);else{i-=o,l-=e,this.workspace_.RTL&&(l*=-1);var n=Math.sqrt(i*i+l*l),r=Math.acos(l/n);0>i&&(r=2*Math.PI-r);var s=r+Math.PI/2;s>2*Math.PI&&(s-=2*Math.PI);var c=Math.sin(s),a=Math.cos(s),u=this.getBubbleSize();s=(u.width+u.height)/Blockly.Bubble.ARROW_THICKNESS,s=Math.min(s,u.width,u.height)/4,l=e+(u=1-Blockly.Bubble.ANCHOR_RADIUS/n)*l,i=o+u*i,u=e+s*a;var h=o+s*c;e-=s*a,o-=s*c,(c=r+this.arrow_radians_)>2*Math.PI&&(c-=2*Math.PI),r=Math.sin(c)*n/Blockly.Bubble.ARROW_BEND,n=Math.cos(c)*n/Blockly.Bubble.ARROW_BEND,t.push("M"+u+","+h),t.push("C"+(u+n)+","+(h+r)+" "+l+","+i+" "+l+","+i),t.push("C"+l+","+i+" "+(e+n)+","+(o+r)+" "+e+","+o)}t.push("z"),this.bubbleArrow_.setAttribute("d",t.join(" "))},Blockly.Bubble.prototype.setColour=function(t){this.bubbleBack_.setAttribute("fill",t),this.bubbleArrow_.setAttribute("fill",t)},Blockly.Bubble.prototype.dispose=function(){Blockly.Bubble.unbindDragEvents_(),Blockly.utils.dom.removeNode(this.bubbleGroup_),this.shape_=this.content_=this.workspace_=this.resizeGroup_=this.bubbleBack_=this.bubbleArrow_=this.bubbleGroup_=null},Blockly.Bubble.prototype.moveDuringDrag=function(t,e){t?t.translateSurface(e.x,e.y):this.moveTo(e.x,e.y),this.relativeLeft_=this.workspace_.RTL?this.anchorXY_.x-e.x-this.width_:e.x-this.anchorXY_.x,this.relativeTop_=e.y-this.anchorXY_.y,this.renderArrow_()},Blockly.Bubble.prototype.getRelativeToSurfaceXY=function(){return new Blockly.utils.Coordinate(this.anchorXY_.x+this.relativeLeft_,this.anchorXY_.y+this.relativeTop_)},Blockly.Bubble.prototype.setAutoLayout=function(t){this.autoLayout_=t},Blockly.Events.CommentBase=function(t){this.commentId=t.id,this.workspaceId=t.workspace.id,this.group=Blockly.Events.getGroup(),this.recordUndo=Blockly.Events.recordUndo},Blockly.utils.object.inherits(Blockly.Events.CommentBase,Blockly.Events.Abstract),Blockly.Events.CommentBase.prototype.toJson=function(){var t=Blockly.Events.CommentBase.superClass_.toJson.call(this);return this.commentId&&(t.commentId=this.commentId),t},Blockly.Events.CommentBase.prototype.fromJson=function(t){Blockly.Events.CommentBase.superClass_.fromJson.call(this,t),this.commentId=t.commentId},Blockly.Events.CommentChange=function(t,e,o){t&&(Blockly.Events.CommentChange.superClass_.constructor.call(this,t),this.oldContents_=e,this.newContents_=o)},Blockly.utils.object.inherits(Blockly.Events.CommentChange,Blockly.Events.CommentBase),Blockly.Events.CommentChange.prototype.type=Blockly.Events.COMMENT_CHANGE,Blockly.Events.CommentChange.prototype.toJson=function(){var t=Blockly.Events.CommentChange.superClass_.toJson.call(this);return t.newContents=this.newContents_,t},Blockly.Events.CommentChange.prototype.fromJson=function(t){Blockly.Events.CommentChange.superClass_.fromJson.call(this,t),this.newContents_=t.newValue},Blockly.Events.CommentChange.prototype.isNull=function(){return this.oldContents_==this.newContents_},Blockly.Events.CommentChange.prototype.run=function(t){var e=this.getEventWorkspace_().getCommentById(this.commentId);e?e.setContent(t?this.newContents_:this.oldContents_):console.warn("Can't change non-existent comment: "+this.commentId)},Blockly.Events.CommentCreate=function(t){t&&(Blockly.Events.CommentCreate.superClass_.constructor.call(this,t),this.xml=t.toXmlWithXY())},Blockly.utils.object.inherits(Blockly.Events.CommentCreate,Blockly.Events.CommentBase),Blockly.Events.CommentCreate.prototype.type=Blockly.Events.COMMENT_CREATE,Blockly.Events.CommentCreate.prototype.toJson=function(){var t=Blockly.Events.CommentCreate.superClass_.toJson.call(this);return t.xml=Blockly.Xml.domToText(this.xml),t},Blockly.Events.CommentCreate.prototype.fromJson=function(t){Blockly.Events.CommentCreate.superClass_.fromJson.call(this,t),this.xml=Blockly.Xml.textToDom(t.xml)},Blockly.Events.CommentCreate.prototype.run=function(t){Blockly.Events.CommentCreateDeleteHelper(this,t)},Blockly.Events.CommentCreateDeleteHelper=function(t,e){var o=t.getEventWorkspace_();if(e){var l=Blockly.utils.xml.createElement("xml");l.appendChild(t.xml),Blockly.Xml.domToWorkspace(l,o)}else(o=o.getCommentById(t.commentId))?o.dispose(!1,!1):console.warn("Can't uncreate non-existent comment: "+t.commentId)},Blockly.Events.CommentDelete=function(t){t&&(Blockly.Events.CommentDelete.superClass_.constructor.call(this,t),this.xml=t.toXmlWithXY())},Blockly.utils.object.inherits(Blockly.Events.CommentDelete,Blockly.Events.CommentBase),Blockly.Events.CommentDelete.prototype.type=Blockly.Events.COMMENT_DELETE,Blockly.Events.CommentDelete.prototype.toJson=function(){return Blockly.Events.CommentDelete.superClass_.toJson.call(this)},Blockly.Events.CommentDelete.prototype.fromJson=function(t){Blockly.Events.CommentDelete.superClass_.fromJson.call(this,t)},Blockly.Events.CommentDelete.prototype.run=function(t){Blockly.Events.CommentCreateDeleteHelper(this,!t)},Blockly.Events.CommentMove=function(t){t&&(Blockly.Events.CommentMove.superClass_.constructor.call(this,t),this.comment_=t,this.oldCoordinate_=t.getXY(),this.newCoordinate_=null)},Blockly.utils.object.inherits(Blockly.Events.CommentMove,Blockly.Events.CommentBase),Blockly.Events.CommentMove.prototype.recordNew=function(){if(!this.comment_)throw Error("Tried to record the new position of a comment on the same event twice.");this.newCoordinate_=this.comment_.getXY(),this.comment_=null},Blockly.Events.CommentMove.prototype.type=Blockly.Events.COMMENT_MOVE,Blockly.Events.CommentMove.prototype.setOldCoordinate=function(t){this.oldCoordinate_=t},Blockly.Events.CommentMove.prototype.toJson=function(){var t=Blockly.Events.CommentMove.superClass_.toJson.call(this);return this.newCoordinate_&&(t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y)),t},Blockly.Events.CommentMove.prototype.fromJson=function(t){Blockly.Events.CommentMove.superClass_.fromJson.call(this,t),t.newCoordinate&&(t=t.newCoordinate.split(","),this.newCoordinate_=new Blockly.utils.Coordinate(Number(t[0]),Number(t[1])))},Blockly.Events.CommentMove.prototype.isNull=function(){return Blockly.utils.Coordinate.equals(this.oldCoordinate_,this.newCoordinate_)},Blockly.Events.CommentMove.prototype.run=function(t){var e=this.getEventWorkspace_().getCommentById(this.commentId);if(e){t=t?this.newCoordinate_:this.oldCoordinate_;var o=e.getXY();e.moveBy(t.x-o.x,t.y-o.y)}else console.warn("Can't move non-existent comment: "+this.commentId)},Blockly.BubbleDragger=function(t,e){this.draggingBubble_=t,this.workspace_=e,this.deleteArea_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.draggingBubble_.getRelativeToSurfaceXY(),this.dragSurface_=Blockly.utils.is3dSupported()&&e.getBlockDragSurface()?e.getBlockDragSurface():null},Blockly.BubbleDragger.prototype.dispose=function(){this.dragSurface_=this.workspace_=this.draggingBubble_=null},Blockly.BubbleDragger.prototype.startBubbleDrag=function(){Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.workspace_.setResizesEnabled(!1),this.draggingBubble_.setAutoLayout(!1),this.dragSurface_&&this.moveToDragSurface_(),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!0);var t=this.workspace_.getToolbox();if(t){var e=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t.addStyle(e)}},Blockly.BubbleDragger.prototype.dragBubble=function(t,e){var o=this.pixelsToWorkspaceUnits_(e);o=Blockly.utils.Coordinate.sum(this.startXY_,o),this.draggingBubble_.moveDuringDrag(this.dragSurface_,o),this.draggingBubble_.isDeletable()&&(this.deleteArea_=this.workspace_.isDeleteArea(t),this.updateCursorDuringBubbleDrag_())},Blockly.BubbleDragger.prototype.maybeDeleteBubble_=function(){var t=this.workspace_.trashcan;return this.wouldDeleteBubble_?(t&&setTimeout(t.close.bind(t),100),this.fireMoveEvent_(),this.draggingBubble_.dispose(!1,!0)):t&&t.close(),this.wouldDeleteBubble_},Blockly.BubbleDragger.prototype.updateCursorDuringBubbleDrag_=function(){this.wouldDeleteBubble_=this.deleteArea_!=Blockly.DELETE_AREA_NONE;var t=this.workspace_.trashcan;this.wouldDeleteBubble_?(this.draggingBubble_.setDeleteStyle(!0),this.deleteArea_==Blockly.DELETE_AREA_TRASH&&t&&t.setOpen_(!0)):(this.draggingBubble_.setDeleteStyle(!1),t&&t.setOpen_(!1))},Blockly.BubbleDragger.prototype.endBubbleDrag=function(t,e){this.dragBubble(t,e);var o=this.pixelsToWorkspaceUnits_(e);o=Blockly.utils.Coordinate.sum(this.startXY_,o),this.draggingBubble_.moveTo(o.x,o.y),this.maybeDeleteBubble_()||(this.dragSurface_&&this.dragSurface_.clearAndHide(this.workspace_.getBubbleCanvas()),this.draggingBubble_.setDragging&&this.draggingBubble_.setDragging(!1),this.fireMoveEvent_()),this.workspace_.setResizesEnabled(!0),this.workspace_.toolbox_&&(o=this.draggingBubble_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab",this.workspace_.toolbox_.removeStyle(o)),Blockly.Events.setGroup(!1)},Blockly.BubbleDragger.prototype.fireMoveEvent_=function(){if(this.draggingBubble_.isComment){var t=new Blockly.Events.CommentMove(this.draggingBubble_);t.setOldCoordinate(this.startXY_),t.recordNew(),Blockly.Events.fire(t)}},Blockly.BubbleDragger.prototype.pixelsToWorkspaceUnits_=function(t){return t=new Blockly.utils.Coordinate(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t},Blockly.BubbleDragger.prototype.moveToDragSurface_=function(){this.draggingBubble_.moveTo(0,0),this.dragSurface_.translateSurface(this.startXY_.x,this.startXY_.y),this.dragSurface_.setBlocksAndShow(this.draggingBubble_.getSvgRoot())},Blockly.constants={},Blockly.LINE_MODE_MULTIPLIER=40,Blockly.PAGE_MODE_MULTIPLIER=125,Blockly.DRAG_RADIUS=5,Blockly.FLYOUT_DRAG_RADIUS=10,Blockly.SNAP_RADIUS=28,Blockly.CONNECTING_SNAP_RADIUS=Blockly.SNAP_RADIUS,Blockly.CURRENT_CONNECTION_PREFERENCE=8,Blockly.INSERTION_MARKER_COLOUR="#000000",Blockly.BUMP_DELAY=250,Blockly.BUMP_RANDOMNESS=10,Blockly.COLLAPSE_CHARS=30,Blockly.LONGPRESS=750,Blockly.SOUND_LIMIT=100,Blockly.DRAG_STACK=!0,Blockly.HSV_SATURATION=.45,Blockly.HSV_VALUE=.65,Blockly.SPRITE={width:96,height:124,url:"sprites.png"},Blockly.INPUT_VALUE=1,Blockly.OUTPUT_VALUE=2,Blockly.NEXT_STATEMENT=3,Blockly.PREVIOUS_STATEMENT=4,Blockly.DUMMY_INPUT=5,Blockly.ALIGN_LEFT=-1,Blockly.ALIGN_CENTRE=0,Blockly.ALIGN_RIGHT=1,Blockly.DRAG_NONE=0,Blockly.DRAG_STICKY=1,Blockly.DRAG_BEGIN=1,Blockly.DRAG_FREE=2,Blockly.OPPOSITE_TYPE=[],Blockly.OPPOSITE_TYPE[Blockly.INPUT_VALUE]=Blockly.OUTPUT_VALUE,Blockly.OPPOSITE_TYPE[Blockly.OUTPUT_VALUE]=Blockly.INPUT_VALUE,Blockly.OPPOSITE_TYPE[Blockly.NEXT_STATEMENT]=Blockly.PREVIOUS_STATEMENT,Blockly.OPPOSITE_TYPE[Blockly.PREVIOUS_STATEMENT]=Blockly.NEXT_STATEMENT,Blockly.TOOLBOX_AT_TOP=0,Blockly.TOOLBOX_AT_BOTTOM=1,Blockly.TOOLBOX_AT_LEFT=2,Blockly.TOOLBOX_AT_RIGHT=3,Blockly.DELETE_AREA_NONE=null,Blockly.DELETE_AREA_TRASH=1,Blockly.DELETE_AREA_TOOLBOX=2,Blockly.VARIABLE_CATEGORY_NAME="VARIABLE",Blockly.VARIABLE_DYNAMIC_CATEGORY_NAME="VARIABLE_DYNAMIC",Blockly.PROCEDURE_CATEGORY_NAME="PROCEDURE",Blockly.RENAME_VARIABLE_ID="RENAME_VARIABLE_ID",Blockly.DELETE_VARIABLE_ID="DELETE_VARIABLE_ID",Blockly.Events.Ui=function(t,e,o,l){Blockly.Events.Ui.superClass_.constructor.call(this),this.blockId=t?t.id:null,this.workspaceId=t?t.workspace.id:void 0,this.element=e,this.oldValue=o,this.newValue=l,this.recordUndo=!1},Blockly.utils.object.inherits(Blockly.Events.Ui,Blockly.Events.Abstract),Blockly.Events.Ui.prototype.type=Blockly.Events.UI,Blockly.Events.Ui.prototype.toJson=function(){var t=Blockly.Events.Ui.superClass_.toJson.call(this);return t.element=this.element,void 0!==this.newValue&&(t.newValue=this.newValue),this.blockId&&(t.blockId=this.blockId),t},Blockly.Events.Ui.prototype.fromJson=function(t){Blockly.Events.Ui.superClass_.fromJson.call(this,t),this.element=t.element,this.newValue=t.newValue,this.blockId=t.blockId},Blockly.WorkspaceDragger=function(t){this.workspace_=t,this.startScrollXY_=new Blockly.utils.Coordinate(t.scrollX,t.scrollY)},Blockly.WorkspaceDragger.prototype.dispose=function(){this.workspace_=null},Blockly.WorkspaceDragger.prototype.startDrag=function(){Blockly.selected&&Blockly.selected.unselect(),this.workspace_.setupDragSurface()},Blockly.WorkspaceDragger.prototype.endDrag=function(t){this.drag(t),this.workspace_.resetDragSurface()},Blockly.WorkspaceDragger.prototype.drag=function(t){t=Blockly.utils.Coordinate.sum(this.startScrollXY_,t),this.workspace_.scroll(t.x,t.y)},Blockly.FlyoutDragger=function(t){Blockly.FlyoutDragger.superClass_.constructor.call(this,t.getWorkspace()),this.scrollbar_=t.scrollbar_,this.horizontalLayout_=t.horizontalLayout_},Blockly.utils.object.inherits(Blockly.FlyoutDragger,Blockly.WorkspaceDragger),Blockly.FlyoutDragger.prototype.drag=function(t){t=Blockly.utils.Coordinate.sum(this.startScrollXY_,t),this.scrollbar_.set(this.horizontalLayout_?-t.x:-t.y)},Blockly.Tooltip={},Blockly.Tooltip.visible=!1,Blockly.Tooltip.blocked_=!1,Blockly.Tooltip.LIMIT=50,Blockly.Tooltip.mouseOutPid_=0,Blockly.Tooltip.showPid_=0,Blockly.Tooltip.lastX_=0,Blockly.Tooltip.lastY_=0,Blockly.Tooltip.element_=null,Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.OFFSET_X=0,Blockly.Tooltip.OFFSET_Y=10,Blockly.Tooltip.RADIUS_OK=10,Blockly.Tooltip.HOVER_MS=750,Blockly.Tooltip.MARGINS=5,Blockly.Tooltip.DIV=null,Blockly.Tooltip.createDom=function(){Blockly.Tooltip.DIV||(Blockly.Tooltip.DIV=document.createElement("div"),Blockly.Tooltip.DIV.className="blocklyTooltipDiv",document.body.appendChild(Blockly.Tooltip.DIV))},Blockly.Tooltip.bindMouseEvents=function(t){Blockly.bindEvent_(t,"mouseover",null,Blockly.Tooltip.onMouseOver_),Blockly.bindEvent_(t,"mouseout",null,Blockly.Tooltip.onMouseOut_),t.addEventListener("mousemove",Blockly.Tooltip.onMouseMove_,!1)},Blockly.Tooltip.onMouseOver_=function(t){if(!Blockly.Tooltip.blocked_){for(t=t.currentTarget;"string"!=typeof t.tooltip&&"function"!=typeof t.tooltip;)t=t.tooltip;Blockly.Tooltip.element_!=t&&(Blockly.Tooltip.hide(),Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.element_=t),clearTimeout(Blockly.Tooltip.mouseOutPid_)}},Blockly.Tooltip.onMouseOut_=function(t){Blockly.Tooltip.blocked_||(Blockly.Tooltip.mouseOutPid_=setTimeout((function(){Blockly.Tooltip.element_=null,Blockly.Tooltip.poisonedElement_=null,Blockly.Tooltip.hide()}),1),clearTimeout(Blockly.Tooltip.showPid_))},Blockly.Tooltip.onMouseMove_=function(t){if(Blockly.Tooltip.element_&&Blockly.Tooltip.element_.tooltip&&!Blockly.Tooltip.blocked_)if(Blockly.Tooltip.visible){var e=Blockly.Tooltip.lastX_-t.pageX;t=Blockly.Tooltip.lastY_-t.pageY,Math.sqrt(e*e+t*t)>Blockly.Tooltip.RADIUS_OK&&Blockly.Tooltip.hide()}else Blockly.Tooltip.poisonedElement_!=Blockly.Tooltip.element_&&(clearTimeout(Blockly.Tooltip.showPid_),Blockly.Tooltip.lastX_=t.pageX,Blockly.Tooltip.lastY_=t.pageY,Blockly.Tooltip.showPid_=setTimeout(Blockly.Tooltip.show_,Blockly.Tooltip.HOVER_MS))},Blockly.Tooltip.hide=function(){Blockly.Tooltip.visible&&(Blockly.Tooltip.visible=!1,Blockly.Tooltip.DIV&&(Blockly.Tooltip.DIV.style.display="none")),Blockly.Tooltip.showPid_&&clearTimeout(Blockly.Tooltip.showPid_)},Blockly.Tooltip.block=function(){Blockly.Tooltip.hide(),Blockly.Tooltip.blocked_=!0},Blockly.Tooltip.unblock=function(){Blockly.Tooltip.blocked_=!1},Blockly.Tooltip.show_=function(){if(!Blockly.Tooltip.blocked_&&(Blockly.Tooltip.poisonedElement_=Blockly.Tooltip.element_,Blockly.Tooltip.DIV)){Blockly.Tooltip.DIV.innerHTML="";for(var t=Blockly.Tooltip.element_.tooltip;"function"==typeof t;)t=t();t=(t=Blockly.utils.string.wrap(t,Blockly.Tooltip.LIMIT)).split("\n");for(var e=0;e<t.length;e++){var o=document.createElement("div");o.appendChild(document.createTextNode(t[e])),Blockly.Tooltip.DIV.appendChild(o)}t=Blockly.Tooltip.element_.RTL,e=document.documentElement.clientWidth,o=document.documentElement.clientHeight,Blockly.Tooltip.DIV.style.direction=t?"rtl":"ltr",Blockly.Tooltip.DIV.style.display="block",Blockly.Tooltip.visible=!0;var l=Blockly.Tooltip.lastX_;l=t?l-(Blockly.Tooltip.OFFSET_X+Blockly.Tooltip.DIV.offsetWidth):l+Blockly.Tooltip.OFFSET_X;var i=Blockly.Tooltip.lastY_+Blockly.Tooltip.OFFSET_Y;i+Blockly.Tooltip.DIV.offsetHeight>o+window.scrollY&&(i-=Blockly.Tooltip.DIV.offsetHeight+2*Blockly.Tooltip.OFFSET_Y),t?l=Math.max(Blockly.Tooltip.MARGINS-window.scrollX,l):l+Blockly.Tooltip.DIV.offsetWidth>e+window.scrollX-2*Blockly.Tooltip.MARGINS&&(l=e-Blockly.Tooltip.DIV.offsetWidth-2*Blockly.Tooltip.MARGINS),Blockly.Tooltip.DIV.style.top=i+"px",Blockly.Tooltip.DIV.style.left=l+"px"}},Blockly.Gesture=function(t,e){this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=this.startBubble_=this.currentDragDeltaXY_=this.mouseDownXY_=null,this.creatorWorkspace_=e,this.isDraggingBubble_=this.isDraggingBlock_=this.isDraggingWorkspace_=this.hasExceededDragRadius_=!1,this.mostRecentEvent_=t,this.flyout_=this.workspaceDragger_=this.blockDragger_=this.bubbleDragger_=this.onUpWrapper_=this.onMoveWrapper_=null,this.isEnding_=this.hasStarted_=this.calledUpdateIsDragging_=!1,this.healStack_=!Blockly.DRAG_STACK},Blockly.Gesture.prototype.dispose=function(){Blockly.Touch.clearTouchIdentifier(),Blockly.Tooltip.unblock(),this.creatorWorkspace_.clearGesture(),this.onMoveWrapper_&&Blockly.unbindEvent_(this.onMoveWrapper_),this.onUpWrapper_&&Blockly.unbindEvent_(this.onUpWrapper_),this.flyout_=this.startWorkspace_=this.targetBlock_=this.startBlock_=this.startField_=null,this.blockDragger_&&(this.blockDragger_.dispose(),this.blockDragger_=null),this.workspaceDragger_&&(this.workspaceDragger_.dispose(),this.workspaceDragger_=null),this.bubbleDragger_&&(this.bubbleDragger_.dispose(),this.bubbleDragger_=null)},Blockly.Gesture.prototype.updateFromEvent_=function(t){var e=new Blockly.utils.Coordinate(t.clientX,t.clientY);this.updateDragDelta_(e)&&(this.updateIsDragging_(),Blockly.longStop_()),this.mostRecentEvent_=t},Blockly.Gesture.prototype.updateDragDelta_=function(t){return this.currentDragDeltaXY_=Blockly.utils.Coordinate.difference(t,this.mouseDownXY_),!this.hasExceededDragRadius_&&(this.hasExceededDragRadius_=Blockly.utils.Coordinate.magnitude(this.currentDragDeltaXY_)>(this.flyout_?Blockly.FLYOUT_DRAG_RADIUS:Blockly.DRAG_RADIUS))},Blockly.Gesture.prototype.updateIsDraggingFromFlyout_=function(){return!(!this.flyout_.isBlockCreatable_(this.targetBlock_)||this.flyout_.isScrollable()&&!this.flyout_.isDragTowardWorkspace(this.currentDragDeltaXY_)||(this.startWorkspace_=this.flyout_.targetWorkspace_,this.startWorkspace_.updateScreenCalculationsIfScrolled(),Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.startBlock_=null,this.targetBlock_=this.flyout_.createBlock(this.targetBlock_),this.targetBlock_.select(),0))},Blockly.Gesture.prototype.updateIsDraggingBubble_=function(){return!!this.startBubble_&&(this.isDraggingBubble_=!0,this.startDraggingBubble_(),!0)},Blockly.Gesture.prototype.updateIsDraggingBlock_=function(){return!!this.targetBlock_&&(this.flyout_?this.isDraggingBlock_=this.updateIsDraggingFromFlyout_():this.targetBlock_.isMovable()&&(this.isDraggingBlock_=!0),!!this.isDraggingBlock_&&(this.startDraggingBlock_(),!0))},Blockly.Gesture.prototype.updateIsDraggingWorkspace_=function(){(this.flyout_?this.flyout_.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger_=this.flyout_?new Blockly.FlyoutDragger(this.flyout_):new Blockly.WorkspaceDragger(this.startWorkspace_),this.isDraggingWorkspace_=!0,this.workspaceDragger_.startDrag())},Blockly.Gesture.prototype.updateIsDragging_=function(){if(this.calledUpdateIsDragging_)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging_=!0,this.updateIsDraggingBubble_()||this.updateIsDraggingBlock_()||this.updateIsDraggingWorkspace_()},Blockly.Gesture.prototype.startDraggingBlock_=function(){this.blockDragger_=new Blockly.BlockDragger(this.targetBlock_,this.startWorkspace_),this.blockDragger_.startBlockDrag(this.currentDragDeltaXY_,this.healStack_),this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_)},Blockly.Gesture.prototype.startDraggingBubble_=function(){this.bubbleDragger_=new Blockly.BubbleDragger(this.startBubble_,this.startWorkspace_),this.bubbleDragger_.startBubbleDrag(),this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_)},Blockly.Gesture.prototype.doStart=function(t){Blockly.utils.isTargetInput(t)?this.cancel():(this.hasStarted_=!0,Blockly.blockAnimations.disconnectUiStop(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.startWorkspace_.markFocused(),this.mostRecentEvent_=t,Blockly.hideChaff(!!this.flyout_),Blockly.Tooltip.block(),this.targetBlock_&&(!this.targetBlock_.isInFlyout&&t.shiftKey?(Blockly.navigation.enableKeyboardAccessibility(),this.creatorWorkspace_.getCursor().setCurNode(Blockly.navigation.getTopNode(this.targetBlock_))):this.targetBlock_.select()),Blockly.utils.isRightButton(t)?this.handleRightClick(t):("touchstart"!=t.type.toLowerCase()&&"pointerdown"!=t.type.toLowerCase()||"mouse"==t.pointerType||Blockly.longStart_(t,this),this.mouseDownXY_=new Blockly.utils.Coordinate(t.clientX,t.clientY),this.healStack_=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t)))},Blockly.Gesture.prototype.bindMouseEvents=function(t){this.onMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this)),this.onUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this)),t.preventDefault(),t.stopPropagation()},Blockly.Gesture.prototype.handleMove=function(t){this.updateFromEvent_(t),this.isDraggingWorkspace_?this.workspaceDragger_.drag(this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.dragBlock(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBubble_&&this.bubbleDragger_.dragBubble(this.mostRecentEvent_,this.currentDragDeltaXY_),t.preventDefault(),t.stopPropagation()},Blockly.Gesture.prototype.handleUp=function(t){this.updateFromEvent_(t),Blockly.longStop_(),this.isEnding_?console.log("Trying to end a gesture recursively."):(this.isEnding_=!0,this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(t,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(t,this.currentDragDeltaXY_):this.isDraggingWorkspace_?this.workspaceDragger_.endDrag(this.currentDragDeltaXY_):this.isBubbleClick_()?this.doBubbleClick_():this.isFieldClick_()?this.doFieldClick_():this.isBlockClick_()?this.doBlockClick_():this.isWorkspaceClick_()&&this.doWorkspaceClick_(t),t.preventDefault(),t.stopPropagation(),this.dispose())},Blockly.Gesture.prototype.cancel=function(){this.isEnding_||(Blockly.longStop_(),this.isDraggingBubble_?this.bubbleDragger_.endBubbleDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingBlock_?this.blockDragger_.endBlockDrag(this.mostRecentEvent_,this.currentDragDeltaXY_):this.isDraggingWorkspace_&&this.workspaceDragger_.endDrag(this.currentDragDeltaXY_),this.dispose())},Blockly.Gesture.prototype.handleRightClick=function(t){this.targetBlock_?(this.bringBlockToFront_(),Blockly.hideChaff(this.flyout_),this.targetBlock_.showContextMenu_(t)):this.startBubble_?this.startBubble_.showContextMenu_(t):this.startWorkspace_&&!this.flyout_&&(Blockly.hideChaff(),this.startWorkspace_.showContextMenu_(t)),t.preventDefault(),t.stopPropagation(),this.dispose()},Blockly.Gesture.prototype.handleWsStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace_(e),this.mostRecentEvent_=t,this.doStart(t),Blockly.keyboardAccessibilityMode&&Blockly.navigation.setState(Blockly.navigation.STATE_WS)},Blockly.Gesture.prototype.handleFlyoutStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout_(e),this.handleWsStart(t,e.getWorkspace())},Blockly.Gesture.prototype.handleBlockStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(e),this.mostRecentEvent_=t},Blockly.Gesture.prototype.handleBubbleStart=function(t,e){if(this.hasStarted_)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(e),this.mostRecentEvent_=t},Blockly.Gesture.prototype.doBubbleClick_=function(){this.startBubble_.setFocus&&this.startBubble_.setFocus(),this.startBubble_.select&&this.startBubble_.select()},Blockly.Gesture.prototype.doFieldClick_=function(){this.startField_.showEditor_(),this.bringBlockToFront_()},Blockly.Gesture.prototype.doBlockClick_=function(){this.flyout_&&this.flyout_.autoClose?this.targetBlock_.isEnabled()&&(Blockly.Events.getGroup()||Blockly.Events.setGroup(!0),this.flyout_.createBlock(this.targetBlock_).scheduleSnapAndBump()):Blockly.Events.fire(new Blockly.Events.Ui(this.startBlock_,"click",void 0,void 0)),this.bringBlockToFront_(),Blockly.Events.setGroup(!1)},Blockly.Gesture.prototype.doWorkspaceClick_=function(t){var e=this.creatorWorkspace_;t.shiftKey?(Blockly.navigation.enableKeyboardAccessibility(),t=new Blockly.utils.Coordinate(t.clientX,t.clientY),t=Blockly.utils.screenToWsCoordinates(e,t),t=Blockly.ASTNode.createWorkspaceNode(e,t),e.getCursor().setCurNode(t)):Blockly.selected&&Blockly.selected.unselect()},Blockly.Gesture.prototype.bringBlockToFront_=function(){this.targetBlock_&&!this.flyout_&&this.targetBlock_.bringToFront()},Blockly.Gesture.prototype.setStartField=function(t){if(this.hasStarted_)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField_||(this.startField_=t)},Blockly.Gesture.prototype.setStartBubble=function(t){this.startBubble_||(this.startBubble_=t)},Blockly.Gesture.prototype.setStartBlock=function(t){this.startBlock_||this.startBubble_||(this.startBlock_=t,t.isInFlyout&&t!=t.getRootBlock()?this.setTargetBlock_(t.getRootBlock()):this.setTargetBlock_(t))},Blockly.Gesture.prototype.setTargetBlock_=function(t){t.isShadow()?this.setTargetBlock_(t.getParent()):this.targetBlock_=t},Blockly.Gesture.prototype.setStartWorkspace_=function(t){this.startWorkspace_||(this.startWorkspace_=t)},Blockly.Gesture.prototype.setStartFlyout_=function(t){this.flyout_||(this.flyout_=t)},Blockly.Gesture.prototype.isBubbleClick_=function(){return!!this.startBubble_&&!this.hasExceededDragRadius_},Blockly.Gesture.prototype.isBlockClick_=function(){return!!this.startBlock_&&!this.hasExceededDragRadius_&&!this.isFieldClick_()},Blockly.Gesture.prototype.isFieldClick_=function(){return!!this.startField_&&this.startField_.isClickable()&&!this.hasExceededDragRadius_&&(!this.flyout_||!this.flyout_.autoClose)},Blockly.Gesture.prototype.isWorkspaceClick_=function(){return!(this.startBlock_||this.startBubble_||this.startField_||this.hasExceededDragRadius_)},Blockly.Gesture.prototype.isDragging=function(){return this.isDraggingWorkspace_||this.isDraggingBlock_||this.isDraggingBubble_},Blockly.Gesture.prototype.hasStarted=function(){return this.hasStarted_},Blockly.Gesture.prototype.getInsertionMarkers=function(){return this.blockDragger_?this.blockDragger_.getInsertionMarkers():[]},Blockly.Gesture.inProgress=function(){for(var t,e=Blockly.Workspace.getAll(),o=0;t=e[o];o++)if(t.currentGesture_)return!0;return!1},Blockly.Field=function(t,e,o){this.tooltip_=this.validator_=this.value_=null,this.size_=new Blockly.utils.Size(0,0),this.markerSvg_=this.cursorSvg_=null,o&&this.configure_(o),this.setValue(t),e&&this.setValidator(e)},Blockly.Field.BORDER_RECT_DEFAULT_HEIGHT=16,Blockly.Field.TEXT_DEFAULT_HEIGHT=12.5,Blockly.Field.X_PADDING=10,Blockly.Field.Y_PADDING=10,Blockly.Field.DEFAULT_TEXT_OFFSET=Blockly.Field.X_PADDING/2,Blockly.Field.prototype.name=void 0,Blockly.Field.prototype.disposed=!1,Blockly.Field.prototype.maxDisplayLength=50,Blockly.Field.prototype.sourceBlock_=null,Blockly.Field.prototype.isDirty_=!0,Blockly.Field.prototype.visible_=!0,Blockly.Field.prototype.clickTarget_=null,Blockly.Field.NBSP=" ",Blockly.Field.prototype.EDITABLE=!0,Blockly.Field.prototype.SERIALIZABLE=!1,Blockly.Field.prototype.configure_=function(t){var e=t.tooltip;"string"==typeof e&&(e=Blockly.utils.replaceMessageReferences(t.tooltip)),e&&this.setTooltip(e)},Blockly.Field.prototype.setSourceBlock=function(t){if(this.sourceBlock_)throw Error("Field already bound to a block.");this.sourceBlock_=t},Blockly.Field.prototype.getSourceBlock=function(){return this.sourceBlock_},Blockly.Field.prototype.init=function(){this.fieldGroup_||(this.fieldGroup_=Blockly.utils.dom.createSvgElement("g",{},null),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())},Blockly.Field.prototype.initView=function(){this.createBorderRect_(),this.createTextElement_()},Blockly.Field.prototype.initModel=function(){},Blockly.Field.prototype.createBorderRect_=function(){this.size_.height=Math.max(this.size_.height,Blockly.Field.BORDER_RECT_DEFAULT_HEIGHT),this.size_.width=Math.max(this.size_.width,Blockly.Field.X_PADDING),this.borderRect_=Blockly.utils.dom.createSvgElement("rect",{rx:4,ry:4,x:0,y:0,height:this.size_.height,width:this.size_.width},this.fieldGroup_)},Blockly.Field.prototype.createTextElement_=function(){this.textElement_=Blockly.utils.dom.createSvgElement("text",{class:"blocklyText",y:Blockly.Field.TEXT_DEFAULT_HEIGHT,x:this.borderRect_?Blockly.Field.DEFAULT_TEXT_OFFSET:0},this.fieldGroup_),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)},Blockly.Field.prototype.bindEvents_=function(){Blockly.Tooltip.bindMouseEvents(this.getClickTarget_()),this.mouseDownWrapper_=Blockly.bindEventWithChecks_(this.getClickTarget_(),"mousedown",this,this.onMouseDown_)},Blockly.Field.prototype.fromXml=function(t){this.setValue(t.textContent)},Blockly.Field.prototype.toXml=function(t){return t.textContent=this.getValue(),t},Blockly.Field.prototype.dispose=function(){Blockly.DropDownDiv.hideIfOwner(this),Blockly.WidgetDiv.hideIfOwner(this),this.mouseDownWrapper_&&Blockly.unbindEvent_(this.mouseDownWrapper_),Blockly.utils.dom.removeNode(this.fieldGroup_),this.disposed=!0},Blockly.Field.prototype.updateEditable=function(){var t=this.getClickTarget_();this.EDITABLE&&t&&(this.sourceBlock_.isEditable()?(Blockly.utils.dom.addClass(t,"blocklyEditableText"),Blockly.utils.dom.removeClass(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(Blockly.utils.dom.addClass(t,"blocklyNonEditableText"),Blockly.utils.dom.removeClass(t,"blocklyEditableText"),t.style.cursor=""))},Blockly.Field.prototype.isClickable=function(){return!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&!!this.showEditor_&&"function"==typeof this.showEditor_},Blockly.Field.prototype.isCurrentlyEditable=function(){return this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()},Blockly.Field.prototype.isSerializable=function(){var t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t},Blockly.Field.prototype.isVisible=function(){return this.visible_},Blockly.Field.prototype.setVisible=function(t){if(this.visible_!=t){this.visible_=t;var e=this.getSvgRoot();e&&(e.style.display=t?"block":"none")}},Blockly.Field.prototype.setValidator=function(t){this.validator_=t},Blockly.Field.prototype.getValidator=function(){return this.validator_},Blockly.Field.prototype.classValidator=function(t){return t},Blockly.Field.prototype.callValidator=function(t){var e=this.classValidator(t);if(null===e)return null;if(void 0!==e&&(t=e),e=this.getValidator()){if(null===(e=e.call(this,t)))return null;void 0!==e&&(t=e)}return t},Blockly.Field.prototype.getSvgRoot=function(){return this.fieldGroup_},Blockly.Field.prototype.updateColour=function(){},Blockly.Field.prototype.render_=function(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_(),this.updateSize_())},Blockly.Field.prototype.updateWidth=function(){console.warn("Deprecated call to updateWidth, call Blockly.Field.updateSize_ to force an update to the size of the field, or Blockly.utils.dom.getTextWidth() to check the size of the field."),this.updateSize_()},Blockly.Field.prototype.updateSize_=function(){var t=Blockly.utils.dom.getTextWidth(this.textElement_);this.borderRect_&&this.borderRect_.setAttribute("width",t+=Blockly.Field.X_PADDING),this.size_.width=t},Blockly.Field.prototype.getSize=function(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&0==this.size_.width&&(console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead."),this.render_()),this.size_):new Blockly.utils.Size(0,0)},Blockly.Field.prototype.getScaledBBox_=function(){var t=this.borderRect_.getBBox(),e=t.height*this.sourceBlock_.workspace.scale;t=t.width*this.sourceBlock_.workspace.scale;var o=this.getAbsoluteXY_();return{top:o.y,bottom:o.y+e,left:o.x,right:o.x+t}},Blockly.Field.prototype.getDisplayText_=function(){var t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+"…"),t=t.replace(/\s/g,Blockly.Field.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+="‏"),t):Blockly.Field.NBSP},Blockly.Field.prototype.getText=function(){if(this.getText_){var t=this.getText_.call(this);if(null!==t)return String(t)}return String(this.getValue())},Blockly.Field.prototype.setText=function(t){throw Error("setText method is deprecated")},Blockly.Field.prototype.markDirty=function(){this.isDirty_=!0},Blockly.Field.prototype.forceRerender=function(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours())},Blockly.Field.prototype.setValue=function(t){if(null!==t){var e=this.doClassValidation_(t);if(!((t=this.processValidation_(t,e))instanceof Error)){if((e=this.getValidator())&&(e=e.call(this,t),(t=this.processValidation_(t,e))instanceof Error))return;(e=this.getValue())!==t&&(this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name||null,e,t)),this.doValueUpdate_(t),this.isDirty_&&this.forceRerender())}}},Blockly.Field.prototype.processValidation_=function(t,e){return null===e?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):(void 0!==e&&(t=e),t)},Blockly.Field.prototype.getValue=function(){return this.value_},Blockly.Field.prototype.doClassValidation_=function(t){return null==t?null:t=this.classValidator(t)},Blockly.Field.prototype.doValueUpdate_=function(t){this.value_=t,this.isDirty_=!0},Blockly.Field.prototype.doValueInvalid_=function(t){},Blockly.Field.prototype.onMouseDown_=function(t){this.sourceBlock_&&this.sourceBlock_.workspace&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)},Blockly.Field.prototype.setTooltip=function(t){var e=this.getClickTarget_();e?e.tooltip=t||""===t?t:this.sourceBlock_:this.tooltip_=t},Blockly.Field.prototype.getClickTarget_=function(){return this.clickTarget_||this.getSvgRoot()},Blockly.Field.prototype.getAbsoluteXY_=function(){return Blockly.utils.style.getPageOffset(this.borderRect_)},Blockly.Field.prototype.referencesVariables=function(){return!1},Blockly.Field.prototype.getParentInput=function(){for(var t=null,e=this.sourceBlock_,o=e.inputList,l=0;l<e.inputList.length;l++)for(var i=o[l],n=i.fieldRow,r=0;r<n.length;r++)if(n[r]===this){t=i;break}return t},Blockly.Field.prototype.getFlipRtl=function(){return!1},Blockly.Field.prototype.isTabNavigable=function(){return!1},Blockly.Field.prototype.onBlocklyAction=function(t){return!1},Blockly.Field.prototype.setCursorSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},Blockly.Field.prototype.setMarkerSvg=function(t){t?(this.fieldGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},Blockly.fieldRegistry={},Blockly.fieldRegistry.typeMap_={},Blockly.fieldRegistry.register=function(t,e){if("string"!=typeof t||""==t.trim())throw Error('Invalid field type "'+t+'". The type must be a non-empty string.');if(Blockly.fieldRegistry.typeMap_[t])throw Error('Error: Field "'+t+'" is already registered.');if(!e||"function"!=typeof e.fromJson)throw Error('Field "'+e+'" must have a fromJson function');t=t.toLowerCase(),Blockly.fieldRegistry.typeMap_[t]=e},Blockly.fieldRegistry.unregister=function(t){Blockly.fieldRegistry.typeMap_[t]?delete Blockly.fieldRegistry.typeMap_[t]:console.warn('No field mapping for type "'+t+'" found to unregister')},Blockly.fieldRegistry.fromJson=function(t){var e=t.type.toLowerCase();return(e=Blockly.fieldRegistry.typeMap_[e])?e.fromJson(t):(console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Blockly.FieldLabel=function(t,e,o){this.class_=null,null==t&&(t=""),Blockly.FieldLabel.superClass_.constructor.call(this,t,null,o),o||(this.class_=e||null),this.size_=new Blockly.utils.Size(0,Blockly.Field.TEXT_DEFAULT_HEIGHT)},Blockly.utils.object.inherits(Blockly.FieldLabel,Blockly.Field),Blockly.FieldLabel.fromJson=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return new Blockly.FieldLabel(e,void 0,t)},Blockly.FieldLabel.prototype.EDITABLE=!1,Blockly.FieldLabel.prototype.configure_=function(t){Blockly.FieldLabel.superClass_.configure_.call(this,t),this.class_=t.class},Blockly.FieldLabel.prototype.initView=function(){this.createTextElement_(),this.textElement_.setAttribute("y",this.size_.height),this.class_&&Blockly.utils.dom.addClass(this.textElement_,this.class_)},Blockly.FieldLabel.prototype.doClassValidation_=function(t){return null==t?null:String(t)},Blockly.FieldLabel.prototype.setClass=function(t){this.textElement_&&(this.class_&&Blockly.utils.dom.removeClass(this.textElement_,this.class_),t&&Blockly.utils.dom.addClass(this.textElement_,t)),this.class_=t},Blockly.fieldRegistry.register("field_label",Blockly.FieldLabel),Blockly.Input=function(t,e,o,l){if(t!=Blockly.DUMMY_INPUT&&!e)throw Error("Value inputs and statement inputs must have non-empty name.");this.type=t,this.name=e,this.sourceBlock_=o,this.connection=l,this.fieldRow=[]},Blockly.Input.prototype.align=Blockly.ALIGN_LEFT,Blockly.Input.prototype.visible_=!0,Blockly.Input.prototype.getSourceBlock=function(){return this.sourceBlock_},Blockly.Input.prototype.appendField=function(t,e){return this.insertFieldAt(this.fieldRow.length,t,e),this},Blockly.Input.prototype.insertFieldAt=function(t,e,o){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return e||""==e&&o?("string"==typeof e&&(e=new Blockly.FieldLabel(e)),e.setSourceBlock(this.sourceBlock_),this.sourceBlock_.rendered&&e.init(),e.name=o,e.prefixField&&(t=this.insertFieldAt(t,e.prefixField)),this.fieldRow.splice(t,0,e),++t,e.suffixField&&(t=this.insertFieldAt(t,e.suffixField)),this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()),t):t},Blockly.Input.prototype.removeField=function(t){for(var e,o=0;e=this.fieldRow[o];o++)if(e.name===t)return e.dispose(),this.fieldRow.splice(o,1),void(this.sourceBlock_.rendered&&(this.sourceBlock_.render(),this.sourceBlock_.bumpNeighbours()));throw Error('Field "%s" not found.',t)},Blockly.Input.prototype.isVisible=function(){return this.visible_},Blockly.Input.prototype.setVisible=function(t){var e=[];if(this.visible_==t)return e;for(var o,l=(this.visible_=t)?"block":"none",i=0;o=this.fieldRow[i];i++)o.setVisible(t);return this.connection&&(t?e=this.connection.unhideAll():this.connection.hideAll(),i=this.connection.targetBlock())&&(i.getSvgRoot().style.display=l,t||(i.rendered=!1)),e},Blockly.Input.prototype.markDirty=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.markDirty()},Blockly.Input.prototype.setCheck=function(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this},Blockly.Input.prototype.setAlign=function(t){return this.align=t,this.sourceBlock_.rendered&&this.sourceBlock_.render(),this},Blockly.Input.prototype.init=function(){if(this.sourceBlock_.workspace.rendered)for(var t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()};Blockly.Input.prototype.dispose=function(){for(var t,e=0;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose(),this.sourceBlock_=null},Blockly.utils.colour={},Blockly.utils.colour.parse=function(t){t=String(t).toLowerCase().trim();var e=Blockly.utils.colour.names[t];if(e)return e;if(/^#[0-9a-f]{6}$/.test(e="#"==t[0]?t:"#"+t))return e;if(/^#[0-9a-f]{3}$/.test(e))return["#",e[1],e[1],e[2],e[2],e[3],e[3]].join("");var o=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return o&&(t=Number(o[1]),e=Number(o[2]),o=Number(o[3]),0<=t&&256>t&&0<=e&&256>e&&0<=o&&256>o)?Blockly.utils.colour.rgbToHex(t,e,o):null},Blockly.utils.colour.rgbToHex=function(t,e,o){return e=t<<16|e<<8|o,16>t?"#"+(16777216|e).toString(16).substr(1):"#"+e.toString(16)},Blockly.utils.colour.hexToRgb=function(t){return[(t=parseInt(t.substr(1),16))>>16,t>>8&255,255&t]},Blockly.utils.colour.hsvToHex=function(t,e,o){var l=0,i=0,n=0;if(0==e)n=i=l=o;else{var r=Math.floor(t/60),s=t/60-r;t=o*(1-e);var c=o*(1-e*s);switch(e=o*(1-e*(1-s)),r){case 1:l=c,i=o,n=t;break;case 2:l=t,i=o,n=e;break;case 3:l=t,i=c,n=o;break;case 4:l=e,i=t,n=o;break;case 5:l=o,i=t,n=c;break;case 6:case 0:l=o,i=e,n=t}}return Blockly.utils.colour.rgbToHex(Math.floor(l),Math.floor(i),Math.floor(n))},Blockly.utils.colour.blend=function(t,e,o){return t=Blockly.utils.colour.hexToRgb(Blockly.utils.colour.parse(t)),e=Blockly.utils.colour.hexToRgb(Blockly.utils.colour.parse(e)),Blockly.utils.colour.rgbToHex(Math.round(e[0]+o*(t[0]-e[0])),Math.round(e[1]+o*(t[1]-e[1])),Math.round(e[2]+o*(t[2]-e[2])))},Blockly.utils.colour.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Blockly.Block=function(t,e,o){if(Blockly.Generator&&void 0!==Blockly.Generator.prototype[e])throw Error('Block prototypeName "'+e+'" conflicts with Blockly.Generator members.');if(this.id=o&&!t.getBlockById(o)?o:Blockly.utils.genUid(),t.blockDB_[this.id]=this,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.inputsInline=void 0,this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.comment=null,this.commentModel={text:null,pinned:!1,size:new Blockly.utils.Size(160,80)},this.xy_=new Blockly.utils.Coordinate(0,0),this.workspace=t,this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,this.isInsertionMarker_=!1,this.hat=void 0,e){if(this.type=e,!(o=Blockly.Blocks[e])||"object"!=typeof o)throw TypeError("Unknown block type: "+e);Blockly.utils.object.mixin(this,o)}if(t.addTopBlock(this),t.addTypedBlock(this),"function"==typeof this.init&&this.init(),this.inputsInlineDefault=this.inputsInline,Blockly.Events.isEnabled()){(t=Blockly.Events.getGroup())||Blockly.Events.setGroup(!0);try{Blockly.Events.fire(new Blockly.Events.BlockCreate(this))}finally{t||Blockly.Events.setGroup(!1)}}"function"==typeof this.onchange&&this.setOnChange(this.onchange)},Blockly.Block.prototype.data=null,Blockly.Block.prototype.disposed=!1,Blockly.Block.prototype.hue_=null,Blockly.Block.prototype.colour_="#000000",Blockly.Block.prototype.colourSecondary_=null,Blockly.Block.prototype.colourTertiary_=null,Blockly.Block.prototype.styleName_=null,Blockly.Block.prototype.dispose=function(t){if(this.workspace){this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),Blockly.keyboardAccessibilityMode&&Blockly.navigation.moveCursorOnBlockDelete(this),this.unplug(t),Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockDelete(this)),Blockly.Events.disable();try{this.workspace&&(this.workspace.removeTopBlock(this),this.workspace.removeTypedBlock(this),delete this.workspace.blockDB_[this.id],this.workspace=null),Blockly.selected==this&&(Blockly.selected=null);for(var e=this.childBlocks_.length-1;0<=e;e--)this.childBlocks_[e].dispose(!1);e=0;for(var o;o=this.inputList[e];e++)o.dispose();this.inputList.length=0;var l,i=this.getConnections_(!0);for(e=0;l=i[e];e++)l.dispose()}finally{Blockly.Events.enable(),this.disposed=!0}}},Blockly.Block.prototype.initModel=function(){for(var t,e=0;t=this.inputList[e];e++)for(var o,l=0;o=t.fieldRow[l];l++)o.initModel&&o.initModel()},Blockly.Block.prototype.unplug=function(t){this.outputConnection?this.unplugFromRow_(t):this.previousConnection&&this.unplugFromStack_(t)},Blockly.Block.prototype.unplugFromRow_=function(t){var e=null;this.outputConnection.isConnected()&&(e=this.outputConnection.targetConnection,this.outputConnection.disconnect()),e&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&((t=t.targetConnection).disconnect(),t.checkType_(e)?e.connect(t):t.onFailedConnect(e))},Blockly.Block.prototype.getOnlyValueConnection_=function(){for(var t=null,e=0;e<this.inputList.length;e++){var o=this.inputList[e].connection;if(o&&o.type==Blockly.INPUT_VALUE&&o.targetConnection){if(t)return null;t=o}}return t},Blockly.Block.prototype.unplugFromStack_=function(t){var e=null;this.previousConnection.isConnected()&&(e=this.previousConnection.targetConnection,this.previousConnection.disconnect());var o=this.getNextBlock();t&&o&&!o.isShadow()&&((t=this.nextConnection.targetConnection).disconnect(),e&&e.checkType_(t)&&e.connect(t))},Blockly.Block.prototype.getConnections_=function(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(var e,o=0;e=this.inputList[o];o++)e.connection&&t.push(e.connection);return t},Blockly.Block.prototype.lastConnectionInStack=function(){for(var t=this.nextConnection;t;){var e=t.targetBlock();if(!e)return t;t=e.nextConnection}return null},Blockly.Block.prototype.bumpNeighbours=function(){console.warn("Not expected to reach Block.bumpNeighbours function. BlockSvg.bumpNeighbours was expected to be called instead.")},Blockly.Block.prototype.getParent=function(){return this.parentBlock_},Blockly.Block.prototype.getInputWithBlock=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.connection&&e.connection.targetBlock()==t)return e;return null},Blockly.Block.prototype.getSurroundParent=function(){var t=this;do{var e=t;if(!(t=t.getParent()))return null}while(t.getNextBlock()==e);return t},Blockly.Block.prototype.getNextBlock=function(){return this.nextConnection&&this.nextConnection.targetBlock()},Blockly.Block.prototype.getPreviousBlock=function(){return this.previousConnection&&this.previousConnection.targetBlock()},Blockly.Block.prototype.getFirstStatementConnection=function(){for(var t,e=0;t=this.inputList[e];e++)if(t.connection&&t.connection.type==Blockly.NEXT_STATEMENT)return t.connection;return null},Blockly.Block.prototype.getRootBlock=function(){var t=this;do{var e=t;t=e.parentBlock_}while(t);return e},Blockly.Block.prototype.getTopStackBlock=function(){var t=this;do{var e=t.getPreviousBlock()}while(e&&e.getNextBlock()==t&&(t=e));return t},Blockly.Block.prototype.getChildren=function(t){if(!t)return this.childBlocks_;t=[];for(var e,o=0;e=this.inputList[o];o++)e.connection&&(e=e.connection.targetBlock())&&t.push(e);return(o=this.getNextBlock())&&t.push(o),t},Blockly.Block.prototype.setParent=function(t){if(t!=this.parentBlock_){if(this.parentBlock_){if(Blockly.utils.arrayRemove(this.parentBlock_.childBlocks_,this),this.previousConnection&&this.previousConnection.isConnected())throw Error("Still connected to previous block.");if(this.outputConnection&&this.outputConnection.isConnected())throw Error("Still connected to parent block.");this.parentBlock_=null}else this.workspace.removeTopBlock(this);(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}},Blockly.Block.prototype.getDescendants=function(t){for(var e,o=[this],l=this.getChildren(t),i=0;e=l[i];i++)o.push.apply(o,e.getDescendants(t));return o},Blockly.Block.prototype.isDeletable=function(){return this.deletable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setDeletable=function(t){this.deletable_=t},Blockly.Block.prototype.isMovable=function(){return this.movable_&&!this.isShadow_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setMovable=function(t){this.movable_=t},Blockly.Block.prototype.isDuplicatable=function(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(Blockly.utils.getBlockTypeCounts(this,!0))},Blockly.Block.prototype.isShadow=function(){return this.isShadow_},Blockly.Block.prototype.setShadow=function(t){this.isShadow_=t},Blockly.Block.prototype.isInsertionMarker=function(){return this.isInsertionMarker_},Blockly.Block.prototype.setInsertionMarker=function(t){this.isInsertionMarker_=t},Blockly.Block.prototype.isEditable=function(){return this.editable_&&!(this.workspace&&this.workspace.options.readOnly)},Blockly.Block.prototype.setEditable=function(t){this.editable_=t,t=0;for(var e;e=this.inputList[t];t++)for(var o,l=0;o=e.fieldRow[l];l++)o.updateEditable()},Blockly.Block.prototype.getMatchingConnection=function(t,e){var o=this.getConnections_(!0),l=t.getConnections_(!0);if(o.length!=l.length)throw Error("Connection lists did not match in length.");for(var i=0;i<l.length;i++)if(l[i]==e)return o[i];return null},Blockly.Block.prototype.setHelpUrl=function(t){this.helpUrl=t},Blockly.Block.prototype.setTooltip=function(t){this.tooltip=t},Blockly.Block.prototype.getColour=function(){return this.colour_},Blockly.Block.prototype.getColourSecondary=function(){return this.colourSecondary_},Blockly.Block.prototype.getColourTertiary=function(){return this.colourTertiary_},Blockly.Block.prototype.getColourShadow=function(){return this.getColourSecondary()||Blockly.utils.colour.blend("#fff",this.getColour(),.6)},Blockly.Block.prototype.getColourBorder=function(){var t=this.getColourTertiary();return t?{colourBorder:t,colourLight:null,colourDark:null}:(t=this.getColour(),{colourBorder:null,colourLight:Blockly.utils.colour.blend("#fff",t,.3),colourDark:Blockly.utils.colour.blend("#000",t,.2)})},Blockly.Block.prototype.getStyleName=function(){return this.styleName_},Blockly.Block.prototype.getHue=function(){return this.hue_},Blockly.Block.prototype.setColour=function(t){var e="string"==typeof t?Blockly.utils.replaceMessageReferences(t):t,o=Number(e);if(!isNaN(o)&&0<=o&&360>=o)this.hue_=o,this.colour_=Blockly.hueToHex(o);else{if(!(o=Blockly.utils.colour.parse(e)))throw o='Invalid colour: "'+e+'"',t!=e&&(o+=' (from "'+t+'")'),Error(o);this.colour_=o,this.hue_=null}},Blockly.Block.prototype.setStyle=function(t){var e=this.workspace.getTheme().getBlockStyle(t);if(this.styleName_=t,!e)throw Error("Invalid style name: "+t);this.colourSecondary_=e.colourSecondary,this.colourTertiary_=e.colourTertiary,this.hat=e.hat,this.setColour(e.colourPrimary)},Blockly.Block.prototype.setOnChange=function(t){if(t&&"function"!=typeof t)throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),(this.onchange=t)&&(this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_))},Blockly.Block.prototype.getField=function(t){for(var e,o=0;e=this.inputList[o];o++)for(var l,i=0;l=e.fieldRow[i];i++)if(l.name==t)return l;return null},Blockly.Block.prototype.getVars=function(){for(var t,e=[],o=0;t=this.inputList[o];o++)for(var l,i=0;l=t.fieldRow[i];i++)l.referencesVariables()&&e.push(l.getValue());return e},Blockly.Block.prototype.getVarModels=function(){for(var t,e=[],o=0;t=this.inputList[o];o++)for(var l,i=0;l=t.fieldRow[i];i++)l.referencesVariables()&&(l=this.workspace.getVariableById(l.getValue()))&&e.push(l);return e},Blockly.Block.prototype.updateVarName=function(t){for(var e,o=0;e=this.inputList[o];o++)for(var l,i=0;l=e.fieldRow[i];i++)l.referencesVariables()&&t.getId()==l.getValue()&&l.refreshVariableName()},Blockly.Block.prototype.renameVarById=function(t,e){for(var o,l=0;o=this.inputList[l];l++)for(var i,n=0;i=o.fieldRow[n];n++)i.referencesVariables()&&t==i.getValue()&&i.setValue(e)},Blockly.Block.prototype.getFieldValue=function(t){return(t=this.getField(t))?t.getValue():null},Blockly.Block.prototype.setFieldValue=function(t,e){var o=this.getField(e);if(!o)throw Error('Field "'+e+'" not found.');o.setValue(t)},Blockly.Block.prototype.setPreviousStatement=function(t,e){if(t){if(void 0===e&&(e=null),!this.previousConnection){if(this.outputConnection)throw Error("Remove output connection prior to adding previous connection.");this.previousConnection=this.makeConnection_(Blockly.PREVIOUS_STATEMENT)}this.previousConnection.setCheck(e)}else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}},Blockly.Block.prototype.setNextStatement=function(t,e){if(t)void 0===e&&(e=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Blockly.NEXT_STATEMENT)),this.nextConnection.setCheck(e);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}},Blockly.Block.prototype.setOutput=function(t,e){if(t){if(void 0===e&&(e=null),!this.outputConnection){if(this.previousConnection)throw Error("Remove previous connection prior to adding output connection.");this.outputConnection=this.makeConnection_(Blockly.OUTPUT_VALUE)}this.outputConnection.setCheck(e)}else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}},Blockly.Block.prototype.setInputsInline=function(t){this.inputsInline!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)},Blockly.Block.prototype.getInputsInline=function(){if(null!=this.inputsInline)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==Blockly.DUMMY_INPUT&&this.inputList[t].type==Blockly.DUMMY_INPUT)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1].type==Blockly.INPUT_VALUE&&this.inputList[t].type==Blockly.DUMMY_INPUT)return!0;return!1},Blockly.Block.prototype.setDisabled=function(t){console.warn("Deprecated call to Blockly.Block.prototype.setDisabled, use Blockly.Block.prototype.setEnabled instead."),this.setEnabled(!t)},Blockly.Block.prototype.isEnabled=function(){return!this.disabled},Blockly.Block.prototype.setEnabled=function(t){this.isEnabled()!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"disabled",null,this.disabled,!t)),this.disabled=!t)},Blockly.Block.prototype.getInheritedDisabled=function(){for(var t=this.getSurroundParent();t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1},Blockly.Block.prototype.isCollapsed=function(){return this.collapsed_},Blockly.Block.prototype.setCollapsed=function(t){this.collapsed_!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)},Blockly.Block.prototype.toString=function(t,e){var o=[],l=e||"?";if(this.collapsed_)o.push(this.getInput("_TEMP_COLLAPSED_INPUT").fieldRow[0].getText());else for(var i,n=0;i=this.inputList[n];n++){for(var r,s=0;r=i.fieldRow[s];s++)o.push(r.getText());i.connection&&((i=i.connection.targetBlock())?o.push(i.toString(void 0,e)):o.push(l))}return o=o.join(" ").trim()||"???",t&&o.length>t&&(o=o.substring(0,t-3)+"..."),o},Blockly.Block.prototype.appendValueInput=function(t){return this.appendInput_(Blockly.INPUT_VALUE,t)},Blockly.Block.prototype.appendStatementInput=function(t){return this.appendInput_(Blockly.NEXT_STATEMENT,t)},Blockly.Block.prototype.appendDummyInput=function(t){return this.appendInput_(Blockly.DUMMY_INPUT,t||"")},Blockly.Block.prototype.jsonInit=function(t){var e=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(e+"Must not have both an output and a previousStatement.");if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(e+"Must not have both a colour and a style.");t.style?this.jsonInitStyle_(t,e):this.jsonInitColour_(t,e);for(var o=0;void 0!==t["message"+o];)this.interpolate_(t["message"+o],t["args"+o]||[],t["lastDummyAlign"+o]),o++;if(void 0!==t.inputsInline&&this.setInputsInline(t.inputsInline),void 0!==t.output&&this.setOutput(!0,t.output),void 0!==t.previousStatement&&this.setPreviousStatement(!0,t.previousStatement),void 0!==t.nextStatement&&this.setNextStatement(!0,t.nextStatement),void 0!==t.tooltip&&(o=Blockly.utils.replaceMessageReferences(o=t.tooltip),this.setTooltip(o)),void 0!==t.enableContextMenu&&(this.contextMenu=!!(o=t.enableContextMenu)),void 0!==t.helpUrl&&(o=Blockly.utils.replaceMessageReferences(o=t.helpUrl),this.setHelpUrl(o)),"string"==typeof t.extensions&&(console.warn(e+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),void 0!==t.mutator&&Blockly.Extensions.apply(t.mutator,this,!0),Array.isArray(t.extensions))for(t=t.extensions,e=0;e<t.length;++e)Blockly.Extensions.apply(t[e],this,!1)},Blockly.Block.prototype.jsonInitColour_=function(t,e){if("colour"in t)if(void 0===t.colour)console.warn(e+"Undefined colour value.");else{var o=t.colour;try{this.setColour(o)}catch(l){console.warn(e+"Illegal colour value: ",o)}}},Blockly.Block.prototype.jsonInitStyle_=function(t,e){var o=t.style;try{this.setStyle(o)}catch(l){console.warn(e+"Style does not exist: ",o)}},Blockly.Block.prototype.mixin=function(t,e){if(void 0!==e&&"boolean"!=typeof e)throw Error("opt_disableCheck must be a boolean if provided");if(!e){var o,l=[];for(o in t)void 0!==this[o]&&l.push(o);if(l.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(l))}Blockly.utils.object.mixin(this,t)},Blockly.Block.prototype.interpolate_=function(t,e,o){var l=Blockly.utils.tokenizeInterpolation(t),i=[],n=0;t=[];for(var r=0;r<l.length;r++){var s=l[r];if("number"==typeof s){if(0>=s||s>e.length)throw Error('Block "'+this.type+'": Message index %'+s+" out of range.");if(i[s])throw Error('Block "'+this.type+'": Message index %'+s+" duplicated.");i[s]=!0,n++,t.push(e[s-1])}else(s=s.trim())&&t.push(s)}if(n!=e.length)throw Error('Block "'+this.type+'": Message does not reference all '+e.length+" arg(s).");for(t.length&&("string"==typeof t[t.length-1]||Blockly.utils.string.startsWith(t[t.length-1].type,"field_"))&&(r={type:"input_dummy"},o&&(r.align=o),t.push(r)),o={LEFT:Blockly.ALIGN_LEFT,RIGHT:Blockly.ALIGN_RIGHT,CENTRE:Blockly.ALIGN_CENTRE},e=[],r=0;r<t.length;r++)if("string"==typeof(i=t[r]))e.push([i,void 0]);else{l=n=null;do{if(s=!1,"string"==typeof i)n=new Blockly.FieldLabel(i);else switch(i.type){case"input_value":l=this.appendValueInput(i.name);break;case"input_statement":l=this.appendStatementInput(i.name);break;case"input_dummy":l=this.appendDummyInput(i.name);break;default:!(n=Blockly.fieldRegistry.fromJson(i))&&i.alt&&(i=i.alt,s=!0)}}while(s);if(n)e.push([n,i.name]);else if(l){for(i.check&&l.setCheck(i.check),i.align&&l.setAlign(o[i.align]),i=0;i<e.length;i++)l.appendField(e[i][0],e[i][1]);e.length=0}}},Blockly.Block.prototype.appendInput_=function(t,e){var o=null;return t!=Blockly.INPUT_VALUE&&t!=Blockly.NEXT_STATEMENT||(o=this.makeConnection_(t)),o=new Blockly.Input(t,e,this,o),this.inputList.push(o),o},Blockly.Block.prototype.moveInputBefore=function(t,e){if(t!=e){for(var o,l=-1,i=e?-1:this.inputList.length,n=0;o=this.inputList[n];n++)if(o.name==t){if(l=n,-1!=i)break}else if(e&&o.name==e&&(i=n,-1!=l))break;if(-1==l)throw Error('Named input "'+t+'" not found.');if(-1==i)throw Error('Reference input "'+e+'" not found.');this.moveNumberedInputBefore(l,i)}},Blockly.Block.prototype.moveNumberedInputBefore=function(t,e){if(t==e)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(e>this.inputList.length)throw RangeError("Reference input "+e+" out of bounds.");var o=this.inputList[t];this.inputList.splice(t,1),t<e&&e--,this.inputList.splice(e,0,o)},Blockly.Block.prototype.removeInput=function(t,e){for(var o,l=0;o=this.inputList[l];l++)if(o.name==t)return o.dispose(),void this.inputList.splice(l,1);if(!e)throw Error("Input not found: "+t)},Blockly.Block.prototype.getInput=function(t){for(var e,o=0;e=this.inputList[o];o++)if(e.name==t)return e;return null},Blockly.Block.prototype.getInputTargetBlock=function(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()},Blockly.Block.prototype.getCommentText=function(){return this.commentModel.text},Blockly.Block.prototype.setCommentText=function(t){this.commentModel.text!=t&&(Blockly.Events.fire(new Blockly.Events.BlockChange(this,"comment",null,this.commentModel.text,t)),this.comment=this.commentModel.text=t)},Blockly.Block.prototype.setWarningText=function(t,e){},Blockly.Block.prototype.setMutator=function(t){},Blockly.Block.prototype.getRelativeToSurfaceXY=function(){return this.xy_},Blockly.Block.prototype.moveBy=function(t,e){if(this.parentBlock_)throw Error("Block has parent.");var o=new Blockly.Events.BlockMove(this);this.xy_.translate(t,e),o.recordNew(),Blockly.Events.fire(o)},Blockly.Block.prototype.makeConnection_=function(t){return new Blockly.Connection(this,t)},Blockly.Block.prototype.allInputsFilled=function(t){if(void 0===t&&(t=!0),!t&&this.isShadow())return!1;for(var e,o=0;e=this.inputList[o];o++)if(e.connection&&(!(e=e.connection.targetBlock())||!e.allInputsFilled(t)))return!1;return!(o=this.getNextBlock())||o.allInputsFilled(t)},Blockly.Block.prototype.toDevString=function(){var t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t},Blockly.BlockDragSurfaceSvg=function(t){this.container_=t,this.createDom()},Blockly.BlockDragSurfaceSvg.prototype.SVG_=null,Blockly.BlockDragSurfaceSvg.prototype.dragGroup_=null,Blockly.BlockDragSurfaceSvg.prototype.container_=null,Blockly.BlockDragSurfaceSvg.prototype.scale_=1,Blockly.BlockDragSurfaceSvg.prototype.surfaceXY_=null,Blockly.BlockDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.dom.createSvgElement("svg",{xmlns:Blockly.utils.dom.SVG_NS,"xmlns:html":Blockly.utils.dom.HTML_NS,"xmlns:xlink":Blockly.utils.dom.XLINK_NS,version:"1.1",class:"blocklyBlockDragSurface"},this.container_),this.dragGroup_=Blockly.utils.dom.createSvgElement("g",{},this.SVG_))},Blockly.BlockDragSurfaceSvg.prototype.setBlocksAndShow=function(t){if(this.dragGroup_.childNodes.length)throw Error("Already dragging a block.");this.dragGroup_.appendChild(t),this.SVG_.style.display="block",this.surfaceXY_=new Blockly.utils.Coordinate(0,0)},Blockly.BlockDragSurfaceSvg.prototype.translateAndScaleGroup=function(t,e,o){this.scale_=o,t=t.toFixed(0),e=e.toFixed(0),this.dragGroup_.setAttribute("transform","translate("+t+","+e+") scale("+o+")")},Blockly.BlockDragSurfaceSvg.prototype.translateSurfaceInternal_=function(){var t=this.surfaceXY_.x,e=this.surfaceXY_.y;t=t.toFixed(0),e=e.toFixed(0),this.SVG_.style.display="block",Blockly.utils.dom.setCssTransform(this.SVG_,"translate3d("+t+"px, "+e+"px, 0px)")},Blockly.BlockDragSurfaceSvg.prototype.translateSurface=function(t,e){this.surfaceXY_=new Blockly.utils.Coordinate(t*this.scale_,e*this.scale_),this.translateSurfaceInternal_()},Blockly.BlockDragSurfaceSvg.prototype.getSurfaceTranslation=function(){var t=Blockly.utils.getRelativeXY(this.SVG_);return new Blockly.utils.Coordinate(t.x/this.scale_,t.y/this.scale_)},Blockly.BlockDragSurfaceSvg.prototype.getGroup=function(){return this.dragGroup_},Blockly.BlockDragSurfaceSvg.prototype.getCurrentBlock=function(){return this.dragGroup_.firstChild},Blockly.BlockDragSurfaceSvg.prototype.clearAndHide=function(t){if(t?t.appendChild(this.getCurrentBlock()):this.dragGroup_.removeChild(this.getCurrentBlock()),this.SVG_.style.display="none",this.dragGroup_.childNodes.length)throw Error("Drag group was not cleared.");this.surfaceXY_=null},Blockly.blockRendering={},Blockly.blockRendering.IPathObject=function(t){},Blockly.blockRendering.PathObject=function(t){this.svgRoot=t,this.svgPath=Blockly.utils.dom.createSvgElement("path",{class:"blocklyPath"},this.svgRoot),this.svgPathLight=Blockly.utils.dom.createSvgElement("path",{class:"blocklyPathLight"},this.svgRoot),this.svgPathDark=Blockly.utils.dom.createSvgElement("path",{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot)},Blockly.blockRendering.PathObject.prototype.setPaths=function(t){this.svgPath.setAttribute("d",t),this.svgPathLight.style.display="none",this.svgPathDark.style.display="none"},Blockly.blockRendering.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)")},Blockly.utils.IdGenerator={},Blockly.utils.IdGenerator.nextId_=0,Blockly.utils.IdGenerator.getNextUniqueId=function(){return"blockly:"+(Blockly.utils.IdGenerator.nextId_++).toString(36)},Blockly.Component=function(){this.rightToLeft_=Blockly.Component.defaultRightToLeft,this.id_=null,this.inDocument_=!1,this.parent_=this.element_=null,this.children_=[],this.childIndex_={}},Blockly.Component.defaultRightToLeft=!1,Blockly.Component.Error={ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds"},Blockly.Component.prototype.getId=function(){return this.id_||(this.id_=Blockly.utils.IdGenerator.getNextUniqueId())},Blockly.Component.prototype.getElement=function(){return this.element_},Blockly.Component.prototype.setElementInternal=function(t){this.element_=t},Blockly.Component.prototype.setParent=function(t){if(this==t)throw Error(Blockly.Component.Error.PARENT_UNABLE_TO_BE_SET);if(t&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=t)throw Error(Blockly.Component.Error.PARENT_UNABLE_TO_BE_SET);this.parent_=t},Blockly.Component.prototype.getParent=function(){return this.parent_},Blockly.Component.prototype.isInDocument=function(){return this.inDocument_},Blockly.Component.prototype.createDom=function(){this.element_=document.createElement("div")},Blockly.Component.prototype.render=function(t){this.render_(t)},Blockly.Component.prototype.renderBefore=function(t){this.render_(t.parentNode,t)},Blockly.Component.prototype.render_=function(t,e){if(this.inDocument_)throw Error(Blockly.Component.Error.ALREADY_RENDERED);this.element_||this.createDom(),t?t.insertBefore(this.element_,e||null):document.body.appendChild(this.element_),this.parent_&&!this.parent_.isInDocument()||this.enterDocument()},Blockly.Component.prototype.enterDocument=function(){this.inDocument_=!0,this.forEachChild((function(t){!t.isInDocument()&&t.getElement()&&t.enterDocument()}))},Blockly.Component.prototype.exitDocument=function(){this.forEachChild((function(t){t.isInDocument()&&t.exitDocument()})),this.inDocument_=!1},Blockly.Component.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},Blockly.Component.prototype.disposeInternal=function(){this.inDocument_&&this.exitDocument(),this.forEachChild((function(t){t.dispose()})),this.element_&&Blockly.utils.dom.removeNode(this.element_),this.parent_=this.element_=this.childIndex_=this.children_=null},Blockly.Component.prototype.addChild=function(t,e){this.addChildAt(t,this.getChildCount(),e)},Blockly.Component.prototype.addChildAt=function(t,e,o){if(t.inDocument_&&(o||!this.inDocument_))throw Error(Blockly.Component.Error.ALREADY_RENDERED);if(0>e||e>this.getChildCount())throw Error(Blockly.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);if(this.childIndex_[t.getId()]=t,t.getParent()==this){var l=this.children_.indexOf(t);-1<l&&this.children_.splice(l,1)}t.setParent(this),this.children_.splice(e,0,t),t.inDocument_&&this.inDocument_&&t.getParent()==this?(e=(o=this.getContentElement()).childNodes[e]||null)!=t.getElement()&&o.insertBefore(t.getElement(),e):o?(this.element_||this.createDom(),e=this.getChildAt(e+1),t.render_(this.getContentElement(),e?e.element_:null)):this.inDocument_&&!t.inDocument_&&t.element_&&t.element_.parentNode&&t.element_.parentNode.nodeType==Blockly.utils.dom.Node.ELEMENT_NODE&&t.enterDocument()},Blockly.Component.prototype.getContentElement=function(){return this.element_},Blockly.Component.prototype.isRightToLeft=function(){return this.rightToLeft_},Blockly.Component.prototype.setRightToLeft=function(t){if(this.inDocument_)throw Error(Blockly.Component.Error.ALREADY_RENDERED);this.rightToLeft_=t},Blockly.Component.prototype.hasChildren=function(){return 0!=this.children_.length},Blockly.Component.prototype.getChildCount=function(){return this.children_.length},Blockly.Component.prototype.getChild=function(t){return t&&this.childIndex_[t]||null},Blockly.Component.prototype.getChildAt=function(t){return this.children_[t]||null},Blockly.Component.prototype.forEachChild=function(t,e){for(var o=0;o<this.children_.length;o++)t.call(e,this.children_[o],o)},Blockly.Component.prototype.indexOfChild=function(t){return this.children_.indexOf(t)},Blockly.utils.aria={},Blockly.utils.aria.ARIA_PREFIX_="aria-",Blockly.utils.aria.ROLE_ATTRIBUTE_="role",Blockly.utils.aria.Role={ALERT:"alert",ALERTDIALOG:"alertdialog",APPLICATION:"application",ARTICLE:"article",BANNER:"banner",BUTTON:"button",CHECKBOX:"checkbox",COLUMNHEADER:"columnheader",COMBOBOX:"combobox",COMPLEMENTARY:"complementary",CONTENTINFO:"contentinfo",DEFINITION:"definition",DIALOG:"dialog",DIRECTORY:"directory",DOCUMENT:"document",FORM:"form",GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",HEADING:"heading",IMG:"img",LINK:"link",LIST:"list",LISTBOX:"listbox",LISTITEM:"listitem",LOG:"log",MAIN:"main",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUBAR:"menubar",MENUITEM:"menuitem",MENUITEMCHECKBOX:"menuitemcheckbox",MENUITEMRADIO:"menuitemradio",NAVIGATION:"navigation",NOTE:"note",OPTION:"option",PRESENTATION:"presentation",PROGRESSBAR:"progressbar",RADIO:"radio",RADIOGROUP:"radiogroup",REGION:"region",ROW:"row",ROWGROUP:"rowgroup",ROWHEADER:"rowheader",SCROLLBAR:"scrollbar",SEARCH:"search",SEPARATOR:"separator",SLIDER:"slider",SPINBUTTON:"spinbutton",STATUS:"status",TAB:"tab",TABLE:"table",TABLIST:"tablist",TABPANEL:"tabpanel",TEXTBOX:"textbox",TEXTINFO:"textinfo",TIMER:"timer",TOOLBAR:"toolbar",TOOLTIP:"tooltip",TREE:"tree",TREEGRID:"treegrid",TREEITEM:"treeitem"},Blockly.utils.aria.State={ACTIVEDESCENDANT:"activedescendant",ATOMIC:"atomic",AUTOCOMPLETE:"autocomplete",BUSY:"busy",CHECKED:"checked",COLINDEX:"colindex",CONTROLS:"controls",DESCRIBEDBY:"describedby",DISABLED:"disabled",DROPEFFECT:"dropeffect",EXPANDED:"expanded",FLOWTO:"flowto",GRABBED:"grabbed",HASPOPUP:"haspopup",HIDDEN:"hidden",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",LIVE:"live",MULTILINE:"multiline",MULTISELECTABLE:"multiselectable",ORIENTATION:"orientation",OWNS:"owns",POSINSET:"posinset",PRESSED:"pressed",READONLY:"readonly",RELEVANT:"relevant",REQUIRED:"required",ROWINDEX:"rowindex",SELECTED:"selected",SETSIZE:"setsize",SORT:"sort",VALUEMAX:"valuemax",VALUEMIN:"valuemin",VALUENOW:"valuenow",VALUETEXT:"valuetext"},Blockly.utils.aria.setRole=function(t,e){e?t.setAttribute(Blockly.utils.aria.ROLE_ATTRIBUTE_,e):Blockly.utils.aria.removeRole(t)},Blockly.utils.aria.getRole=function(t){return t.getAttribute(Blockly.utils.aria.ROLE_ATTRIBUTE_)||null},Blockly.utils.aria.removeRole=function(t){t.removeAttribute(Blockly.utils.aria.ROLE_ATTRIBUTE_)},Blockly.utils.aria.setState=function(t,e,o){Array.isArray(o)&&(o=o.join(" ")),e=Blockly.utils.aria.getAriaAttributeName_(e),t.setAttribute(e,o)},Blockly.utils.aria.getAriaAttributeName_=function(t){return Blockly.utils.aria.ARIA_PREFIX_+t},Blockly.Menu=function(){Blockly.Component.call(this),this.highlightedIndex_=-1},Blockly.utils.object.inherits(Blockly.Menu,Blockly.Component),Blockly.Menu.prototype.createDom=function(){var t=document.createElement("div");t.id=this.getId(),this.setElementInternal(t),t.className="goog-menu goog-menu-vertical blocklyNonSelectable",t.tabIndex=0,Blockly.utils.aria.setRole(t,this.roleName_||Blockly.utils.aria.Role.MENU)},Blockly.Menu.prototype.focus=function(){var t=this.getElement();t&&(t.focus(),Blockly.utils.dom.addClass(t,"focused"))},Blockly.Menu.prototype.blur=function(){var t=this.getElement();t&&(t.blur(),Blockly.utils.dom.removeClass(t,"focused"))},Blockly.Menu.prototype.setRole=function(t){this.roleName_=t},Blockly.Menu.prototype.enterDocument=function(){Blockly.Menu.superClass_.enterDocument.call(this),this.forEachChild((function(t){t.isInDocument()&&this.registerChildId_(t)}),this),this.attachEvents_()},Blockly.Menu.prototype.exitDocument=function(){this.setHighlightedIndex(-1),Blockly.Menu.superClass_.exitDocument.call(this)},Blockly.Menu.prototype.disposeInternal=function(){Blockly.Menu.superClass_.disposeInternal.call(this),this.detachEvents_()},Blockly.Menu.prototype.attachEvents_=function(){var t=this.getElement();this.mouseOverHandler_=Blockly.bindEventWithChecks_(t,"mouseover",this,this.handleMouseOver_,!0),this.clickHandler_=Blockly.bindEventWithChecks_(t,"click",this,this.handleClick_,!0),this.mouseEnterHandler_=Blockly.bindEventWithChecks_(t,"mouseenter",this,this.handleMouseEnter_,!0),this.mouseLeaveHandler_=Blockly.bindEventWithChecks_(t,"mouseleave",this,this.handleMouseLeave_,!0),this.onKeyDownWrapper_=Blockly.bindEventWithChecks_(t,"keydown",this,this.handleKeyEvent)},Blockly.Menu.prototype.detachEvents_=function(){Blockly.unbindEvent_(this.mouseOverHandler_),Blockly.unbindEvent_(this.clickHandler_),Blockly.unbindEvent_(this.mouseEnterHandler_),Blockly.unbindEvent_(this.mouseLeaveHandler_),Blockly.unbindEvent_(this.onKeyDownWrapper_)},Blockly.Menu.prototype.childElementIdMap_=null,Blockly.Menu.prototype.registerChildId_=function(t){var e=t.getElement();e=e.id||(e.id=t.getId()),this.childElementIdMap_||(this.childElementIdMap_={}),this.childElementIdMap_[e]=t},Blockly.Menu.prototype.getMenuItem=function(t){if(this.childElementIdMap_)for(var e=this.getElement();t&&t!==e;){var o=t.id;if(o in this.childElementIdMap_)return this.childElementIdMap_[o];t=t.parentNode}return null},Blockly.Menu.prototype.unhighlightCurrent=function(){var t=this.getHighlighted();t&&t.setHighlighted(!1)},Blockly.Menu.prototype.clearHighlighted=function(){this.unhighlightCurrent(),this.setHighlightedIndex(-1)},Blockly.Menu.prototype.getHighlighted=function(){return this.getChildAt(this.highlightedIndex_)},Blockly.Menu.prototype.setHighlightedIndex=function(t){var e=this.getChildAt(t);e?(e.setHighlighted(!0),this.highlightedIndex_=t):-1<this.highlightedIndex_&&(this.getHighlighted().setHighlighted(!1),this.highlightedIndex_=-1),e&&Blockly.utils.style.scrollIntoContainerView(e.getElement(),this.getElement())},Blockly.Menu.prototype.setHighlighted=function(t){this.setHighlightedIndex(this.indexOfChild(t))},Blockly.Menu.prototype.highlightNext=function(){this.unhighlightCurrent(),this.highlightHelper((function(t,e){return(t+1)%e}),this.highlightedIndex_)},Blockly.Menu.prototype.highlightPrevious=function(){this.unhighlightCurrent(),this.highlightHelper((function(t,e){return 0>--t?e-1:t}),this.highlightedIndex_)},Blockly.Menu.prototype.highlightHelper=function(t,e){var o=0>e?-1:e,l=this.getChildCount();o=t.call(this,o,l);for(var i=0;i<=l;){var n=this.getChildAt(o);if(n&&this.canHighlightItem(n))return this.setHighlightedIndex(o),!0;i++,o=t.call(this,o,l)}return!1},Blockly.Menu.prototype.canHighlightItem=function(t){return t.isEnabled()},Blockly.Menu.prototype.handleMouseOver_=function(t){(t=this.getMenuItem(t.target))&&t.isEnabled()&&this.getHighlighted()!==t&&(this.unhighlightCurrent(),this.setHighlighted(t))},Blockly.Menu.prototype.handleClick_=function(t){var e=this.getMenuItem(t.target);e&&e.handleClick(t)&&t.preventDefault()},Blockly.Menu.prototype.handleMouseEnter_=function(t){this.focus()},Blockly.Menu.prototype.handleMouseLeave_=function(t){this.getElement()&&(this.blur(),this.clearHighlighted())},Blockly.Menu.prototype.handleKeyEvent=function(t){return!(0==this.getChildCount()||!this.handleKeyEventInternal(t)||(t.preventDefault(),t.stopPropagation(),0))},Blockly.Menu.prototype.handleKeyEventInternal=function(t){var e=this.getHighlighted();if(e&&"function"==typeof e.handleKeyEvent&&e.handleKeyEvent(t))return!0;if(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)return!1;switch(t.keyCode){case Blockly.utils.KeyCodes.ENTER:e&&e.performActionInternal(t);break;case Blockly.utils.KeyCodes.UP:this.highlightPrevious();break;case Blockly.utils.KeyCodes.DOWN:this.highlightNext();break;default:return!1}return!0},Blockly.MenuItem=function(t,e){Blockly.Component.call(this),this.setContentInternal(t),this.setValue(e),this.enabled_=!0},Blockly.utils.object.inherits(Blockly.MenuItem,Blockly.Component),Blockly.MenuItem.prototype.createDom=function(){var t=document.createElement("div");t.id=this.getId(),this.setElementInternal(t),t.className="goog-menuitem goog-option "+(this.enabled_?"":"goog-menuitem-disabled ")+(this.checked_?"goog-option-selected ":"")+(this.isRightToLeft()?"goog-menuitem-rtl ":"");var e=this.getContentWrapperDom();t.appendChild(e);var o=this.getCheckboxDom();o&&e.appendChild(o),e.appendChild(this.getContentDom()),Blockly.utils.aria.setRole(t,this.roleName_||(this.checkable_?Blockly.utils.aria.Role.MENUITEMCHECKBOX:Blockly.utils.aria.Role.MENUITEM)),Blockly.utils.aria.setState(t,Blockly.utils.aria.State.SELECTED,this.checkable_&&this.checked_||!1)},Blockly.MenuItem.prototype.getCheckboxDom=function(){if(!this.checkable_)return null;var t=document.createElement("div");return t.className="goog-menuitem-checkbox",t},Blockly.MenuItem.prototype.getContentDom=function(){var t=this.content_;return"string"==typeof t&&(t=document.createTextNode(t)),t},Blockly.MenuItem.prototype.getContentWrapperDom=function(){var t=document.createElement("div");return t.className="goog-menuitem-content",t},Blockly.MenuItem.prototype.setContentInternal=function(t){this.content_=t},Blockly.MenuItem.prototype.setValue=function(t){this.value_=t},Blockly.MenuItem.prototype.getValue=function(){return this.value_},Blockly.MenuItem.prototype.setRole=function(t){this.roleName_=t},Blockly.MenuItem.prototype.setCheckable=function(t){this.checkable_=t},Blockly.MenuItem.prototype.setChecked=function(t){if(this.checkable_){this.checked_=t;var e=this.getElement();e&&this.isEnabled()&&(t?(Blockly.utils.dom.addClass(e,"goog-option-selected"),Blockly.utils.aria.setState(e,Blockly.utils.aria.State.SELECTED,!0)):(Blockly.utils.dom.removeClass(e,"goog-option-selected"),Blockly.utils.aria.setState(e,Blockly.utils.aria.State.SELECTED,!1)))}},Blockly.MenuItem.prototype.setHighlighted=function(t){this.highlight_=t;var e=this.getElement();e&&this.isEnabled()&&(t?Blockly.utils.dom.addClass(e,"goog-menuitem-highlight"):Blockly.utils.dom.removeClass(e,"goog-menuitem-highlight"))},Blockly.MenuItem.prototype.isEnabled=function(){return this.enabled_},Blockly.MenuItem.prototype.setEnabled=function(t){this.enabled_=t,(t=this.getElement())&&(this.enabled_?Blockly.utils.dom.removeClass(t,"goog-menuitem-disabled"):Blockly.utils.dom.addClass(t,"goog-menuitem-disabled"))},Blockly.MenuItem.prototype.handleClick=function(t){this.isEnabled()&&(this.setHighlighted(!0),this.performActionInternal())},Blockly.MenuItem.prototype.performActionInternal=function(){this.checkable_&&this.setChecked(!this.checked_),this.actionHandler_&&this.actionHandler_.call(this.actionHandlerObj_,this)},Blockly.MenuItem.prototype.onAction=function(t,e){this.actionHandler_=t,this.actionHandlerObj_=e},Blockly.utils.uiMenu={},Blockly.utils.uiMenu.getSize=function(t){t=t.getElement();var e=Blockly.utils.style.getSize(t);return e.height=t.scrollHeight,e},Blockly.utils.uiMenu.adjustBBoxesForRTL=function(t,e,o){e.left+=o.width,e.right+=o.width,t.left+=o.width,t.right+=o.width},Blockly.ContextMenu={},Blockly.ContextMenu.currentBlock=null,Blockly.ContextMenu.eventWrapper_=null,Blockly.ContextMenu.show=function(t,e,o){if(Blockly.WidgetDiv.show(Blockly.ContextMenu,o,null),e.length){var l=Blockly.ContextMenu.populate_(e,o);Blockly.ContextMenu.position_(l,t,o),setTimeout((function(){l.getElement().focus()}),1),Blockly.ContextMenu.currentBlock=null}else Blockly.ContextMenu.hide()},Blockly.ContextMenu.populate_=function(t,e){var o=new Blockly.Menu;o.setRightToLeft(e);for(var l,i=0;l=t[i];i++){var n=new Blockly.MenuItem(l.text);n.setRightToLeft(e),o.addChild(n,!0),n.setEnabled(l.enabled),l.enabled&&n.onAction((function(){Blockly.ContextMenu.hide(),this.callback()}),l)}return o},Blockly.ContextMenu.position_=function(t,e,o){var l=Blockly.utils.getViewportBBox();e={top:e.clientY+l.top,bottom:e.clientY+l.top,left:e.clientX+l.left,right:e.clientX+l.left},Blockly.ContextMenu.createWidget_(t);var i=Blockly.utils.uiMenu.getSize(t);o&&Blockly.utils.uiMenu.adjustBBoxesForRTL(l,e,i),Blockly.WidgetDiv.positionWithAnchor(l,e,i,o),t.getElement().focus()},Blockly.ContextMenu.createWidget_=function(t){t.render(Blockly.WidgetDiv.DIV);var e=t.getElement();Blockly.utils.dom.addClass(e,"blocklyContextMenu"),Blockly.bindEventWithChecks_(e,"contextmenu",null,Blockly.utils.noEvent),t.focus()},Blockly.ContextMenu.hide=function(){Blockly.WidgetDiv.hideIfOwner(Blockly.ContextMenu),Blockly.ContextMenu.currentBlock=null,Blockly.ContextMenu.eventWrapper_&&Blockly.unbindEvent_(Blockly.ContextMenu.eventWrapper_)},Blockly.ContextMenu.callbackFactory=function(t,e){return function(){Blockly.Events.disable();try{var o=Blockly.Xml.domToBlock(e,t.workspace),l=t.getRelativeToSurfaceXY();l.x=t.RTL?l.x-Blockly.SNAP_RADIUS:l.x+Blockly.SNAP_RADIUS,l.y+=2*Blockly.SNAP_RADIUS,o.moveBy(l.x,l.y)}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!o.isShadow()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(o)),o.select()}},Blockly.ContextMenu.blockDeleteOption=function(t){var e=t.getDescendants(!1).length,o=t.getNextBlock();return o&&(e-=o.getDescendants(!1).length),{text:1==e?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(e)),enabled:!0,callback:function(){Blockly.Events.setGroup(!0),t.dispose(!0,!0),Blockly.Events.setGroup(!1)}}},Blockly.ContextMenu.blockHelpOption=function(t){return{enabled:!("function"==typeof t.helpUrl?!t.helpUrl():!t.helpUrl),text:Blockly.Msg.HELP,callback:function(){t.showHelp_()}}},Blockly.ContextMenu.blockDuplicateOption=function(t){var e=t.isDuplicatable();return{text:Blockly.Msg.DUPLICATE_BLOCK,enabled:e,callback:function(){Blockly.duplicate_(t)}}},Blockly.ContextMenu.blockCommentOption=function(t){var e={enabled:!Blockly.utils.userAgent.IE};return t.comment?(e.text=Blockly.Msg.REMOVE_COMMENT,e.callback=function(){t.setCommentText(null)}):(e.text=Blockly.Msg.ADD_COMMENT,e.callback=function(){t.setCommentText("")}),e},Blockly.ContextMenu.commentDeleteOption=function(t){return{text:Blockly.Msg.REMOVE_COMMENT,enabled:!0,callback:function(){Blockly.Events.setGroup(!0),t.dispose(!0,!0),Blockly.Events.setGroup(!1)}}},Blockly.ContextMenu.commentDuplicateOption=function(t){return{text:Blockly.Msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){Blockly.duplicate_(t)}}},Blockly.ContextMenu.workspaceCommentOption=function(t,e){if(!Blockly.WorkspaceCommentSvg)throw Error("Missing require for Blockly.WorkspaceCommentSvg");var o={enabled:!Blockly.utils.userAgent.IE};return o.text=Blockly.Msg.ADD_COMMENT,o.callback=function(){var o=new Blockly.WorkspaceCommentSvg(t,Blockly.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT,Blockly.WorkspaceCommentSvg.DEFAULT_SIZE,Blockly.WorkspaceCommentSvg.DEFAULT_SIZE),l=t.getInjectionDiv().getBoundingClientRect();l=new Blockly.utils.Coordinate(e.clientX-l.left,e.clientY-l.top);var i=t.getOriginOffsetInPixels();(l=Blockly.utils.Coordinate.difference(l,i)).scale(1/t.scale),o.moveBy(l.x,l.y),t.rendered&&(o.initSvg(),o.render(),o.select())},o},Blockly.RenderedConnection=function(t,e){Blockly.RenderedConnection.superClass_.constructor.call(this,t,e),this.db_=t.workspace.connectionDBList[e],this.dbOpposite_=t.workspace.connectionDBList[Blockly.OPPOSITE_TYPE[e]],this.offsetInBlock_=new Blockly.utils.Coordinate(0,0),this.inDB_=!1,this.hidden_=!this.db_},Blockly.utils.object.inherits(Blockly.RenderedConnection,Blockly.Connection),Blockly.RenderedConnection.prototype.dispose=function(){Blockly.RenderedConnection.superClass_.dispose.call(this),this.inDB_&&this.db_.removeConnection_(this)},Blockly.RenderedConnection.prototype.distanceFrom=function(t){var e=this.x_-t.x_;return t=this.y_-t.y_,Math.sqrt(e*e+t*t)},Blockly.RenderedConnection.prototype.bumpAwayFrom_=function(t){if(!this.sourceBlock_.workspace.isDragging()){var e=this.sourceBlock_.getRootBlock();if(!e.isInFlyout){var o=!1;if(!e.isMovable()){if(!(e=t.getSourceBlock().getRootBlock()).isMovable())return;t=this,o=!0}var l=Blockly.selected==e;l||e.addSelect();var i=t.x_+Blockly.SNAP_RADIUS+Math.floor(Math.random()*Blockly.BUMP_RANDOMNESS)-this.x_,n=t.y_+Blockly.SNAP_RADIUS+Math.floor(Math.random()*Blockly.BUMP_RANDOMNESS)-this.y_;o&&(n=-n),e.RTL&&(i=t.x_-Blockly.SNAP_RADIUS-Math.floor(Math.random()*Blockly.BUMP_RANDOMNESS)-this.x_),e.moveBy(i,n),l||e.removeSelect()}}},Blockly.RenderedConnection.prototype.moveTo=function(t,e){this.inDB_&&this.db_.removeConnection_(this),this.x_=t,this.y_=e,this.hidden_||this.db_.addConnection(this)},Blockly.RenderedConnection.prototype.moveBy=function(t,e){this.moveTo(this.x_+t,this.y_+e)},Blockly.RenderedConnection.prototype.moveToOffset=function(t){this.moveTo(t.x+this.offsetInBlock_.x,t.y+this.offsetInBlock_.y)},Blockly.RenderedConnection.prototype.setOffsetInBlock=function(t,e){this.offsetInBlock_.x=t,this.offsetInBlock_.y=e},Blockly.RenderedConnection.prototype.getOffsetInBlock=function(){return this.offsetInBlock_},Blockly.RenderedConnection.prototype.tighten_=function(){var t=this.targetConnection.x_-this.x_,e=this.targetConnection.y_-this.y_;if(0!=t||0!=e){var o=this.targetBlock(),l=o.getSvgRoot();if(!l)throw Error("block is not rendered.");l=Blockly.utils.getRelativeXY(l),o.getSvgRoot().setAttribute("transform","translate("+(l.x-t)+","+(l.y-e)+")"),o.moveConnections_(-t,-e)}},Blockly.RenderedConnection.prototype.closest=function(t,e){return this.dbOpposite_.searchForClosest(this,t,e)},Blockly.RenderedConnection.prototype.highlight=function(){var t=this.sourceBlock_.workspace.getRenderer().getConstants();t=this.type==Blockly.INPUT_VALUE||this.type==Blockly.OUTPUT_VALUE?Blockly.utils.svgPaths.moveBy(0,-5)+Blockly.utils.svgPaths.lineOnAxis("v",5)+t.PUZZLE_TAB.pathDown+Blockly.utils.svgPaths.lineOnAxis("v",5):Blockly.utils.svgPaths.moveBy(-5,0)+Blockly.utils.svgPaths.lineOnAxis("h",5)+t.NOTCH.pathLeft+Blockly.utils.svgPaths.lineOnAxis("h",5);var e=this.sourceBlock_.getRelativeToSurfaceXY();Blockly.Connection.highlightedPath_=Blockly.utils.dom.createSvgElement("path",{class:"blocklyHighlightedConnectionPath",d:t,transform:"translate("+(this.x_-e.x)+","+(this.y_-e.y)+")"+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())},Blockly.RenderedConnection.prototype.unhideAll=function(){this.setHidden(!1);var t=[];if(this.type!=Blockly.INPUT_VALUE&&this.type!=Blockly.NEXT_STATEMENT)return t;var e=this.targetBlock();if(e){if(e.isCollapsed()){var o=[];e.outputConnection&&o.push(e.outputConnection),e.nextConnection&&o.push(e.nextConnection),e.previousConnection&&o.push(e.previousConnection)}else o=e.getConnections_(!0);for(var l=0;l<o.length;l++)t.push.apply(t,o[l].unhideAll());t.length||(t[0]=e)}return t},Blockly.RenderedConnection.prototype.unhighlight=function(){Blockly.utils.dom.removeNode(Blockly.Connection.highlightedPath_),delete Blockly.Connection.highlightedPath_},Blockly.RenderedConnection.prototype.setHidden=function(t){(this.hidden_=t)&&this.inDB_?this.db_.removeConnection_(this):t||this.inDB_||this.db_.addConnection(this)},Blockly.RenderedConnection.prototype.hideAll=function(){if(this.setHidden(!0),this.targetConnection)for(var t=this.targetBlock().getDescendants(!1),e=0;e<t.length;e++){for(var o=t[e],l=o.getConnections_(!0),i=0;i<l.length;i++)l[i].setHidden(!0);for(o=o.getIcons(),i=0;i<o.length;i++)o[i].setVisible(!1)}},Blockly.RenderedConnection.prototype.isConnectionAllowed=function(t,e){return!(this.distanceFrom(t)>e)&&Blockly.RenderedConnection.superClass_.isConnectionAllowed.call(this,t)},Blockly.RenderedConnection.prototype.onFailedConnect=function(t){this.bumpAwayFrom_(t)},Blockly.RenderedConnection.prototype.disconnectInternal_=function(t,e){Blockly.RenderedConnection.superClass_.disconnectInternal_.call(this,t,e),t.rendered&&t.render(),e.rendered&&(e.updateDisabled(),e.render())},Blockly.RenderedConnection.prototype.respawnShadow_=function(){var t=this.getSourceBlock(),e=this.getShadowDom();if(t.workspace&&e&&Blockly.Events.recordUndo){if(Blockly.RenderedConnection.superClass_.respawnShadow_.call(this),!(e=this.targetBlock()))throw Error("Couldn't respawn the shadow block that should exist here.");e.initSvg(),e.render(!1),t.rendered&&t.render()}},Blockly.RenderedConnection.prototype.neighbours_=function(t){return this.dbOpposite_.getNeighbours(this,t)},Blockly.RenderedConnection.prototype.connect_=function(t){Blockly.RenderedConnection.superClass_.connect_.call(this,t);var e=this.getSourceBlock();t=t.getSourceBlock(),e.rendered&&e.updateDisabled(),t.rendered&&t.updateDisabled(),e.rendered&&t.rendered&&(this.type==Blockly.NEXT_STATEMENT||this.type==Blockly.PREVIOUS_STATEMENT?t.render():e.render())},Blockly.RenderedConnection.prototype.onCheckChanged_=function(){this.isConnected()&&!this.checkType_(this.targetConnection)&&((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())},Blockly.utils.Rect=function(t,e,o,l){this.top=t,this.bottom=e,this.left=o,this.right=l},Blockly.utils.Rect.prototype.contains=function(t,e){return t>=this.left&&t<=this.right&&e>=this.top&&e<=this.bottom},Blockly.Icon=function(t){this.block_=t},Blockly.Icon.prototype.collapseHidden=!0,Blockly.Icon.prototype.SIZE=17,Blockly.Icon.prototype.bubble_=null,Blockly.Icon.prototype.iconXY_=null,Blockly.Icon.prototype.createIcon=function(){this.iconGroup_||(this.iconGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyIconGroup"},null),this.block_.isInFlyout&&Blockly.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly"),this.drawIcon_(this.iconGroup_),this.block_.getSvgRoot().appendChild(this.iconGroup_),Blockly.bindEventWithChecks_(this.iconGroup_,"mouseup",this,this.iconClick_),this.updateEditable())},Blockly.Icon.prototype.dispose=function(){Blockly.utils.dom.removeNode(this.iconGroup_),this.iconGroup_=null,this.setVisible(!1),this.block_=null},Blockly.Icon.prototype.updateEditable=function(){},Blockly.Icon.prototype.isVisible=function(){return!!this.bubble_},Blockly.Icon.prototype.iconClick_=function(t){this.block_.workspace.isDragging()||this.block_.isInFlyout||Blockly.utils.isRightButton(t)||this.setVisible(!this.isVisible())},Blockly.Icon.prototype.updateColour=function(){this.isVisible()&&this.bubble_.setColour(this.block_.getColour())},Blockly.Icon.prototype.setIconLocation=function(t){this.iconXY_=t,this.isVisible()&&this.bubble_.setAnchorLocation(t)},Blockly.Icon.prototype.computeIconLocation=function(){var t=this.block_.getRelativeToSurfaceXY(),e=Blockly.utils.getRelativeXY(this.iconGroup_);t=new Blockly.utils.Coordinate(t.x+e.x+this.SIZE/2,t.y+e.y+this.SIZE/2),Blockly.utils.Coordinate.equals(this.getIconLocation(),t)||this.setIconLocation(t)},Blockly.Icon.prototype.getIconLocation=function(){return this.iconXY_},Blockly.Icon.prototype.getCorrectedSize=function(){return new Blockly.utils.Size(Blockly.Icon.prototype.SIZE,Blockly.Icon.prototype.SIZE-2)},Blockly.Warning=function(t){Blockly.Warning.superClass_.constructor.call(this,t),this.createIcon(),this.text_={}},Blockly.utils.object.inherits(Blockly.Warning,Blockly.Icon),Blockly.Warning.prototype.collapseHidden=!1,Blockly.Warning.prototype.drawIcon_=function(t){Blockly.utils.dom.createSvgElement("path",{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},t),Blockly.utils.dom.createSvgElement("path",{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},t),Blockly.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},t)},Blockly.Warning.textToDom_=function(t){var e=Blockly.utils.dom.createSvgElement("text",{class:"blocklyText blocklyBubbleText",y:Blockly.Bubble.BORDER_WIDTH},null);t=t.split("\n");for(var o=0;o<t.length;o++){var l=Blockly.utils.dom.createSvgElement("tspan",{dy:"1em",x:Blockly.Bubble.BORDER_WIDTH},e),i=document.createTextNode(t[o]);l.appendChild(i)}return e},Blockly.Warning.prototype.setVisible=function(t){t!=this.isVisible()&&(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"warningOpen",!t,t)),t?this.createBubble():this.disposeBubble())},Blockly.Warning.prototype.createBubble=function(){if(this.paragraphElement_=Blockly.Warning.textToDom_(this.getText()),this.bubble_=new Blockly.Bubble(this.block_.workspace,this.paragraphElement_,this.block_.svgPath_,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),this.block_.RTL)for(var t,e=this.paragraphElement_.getBBox().width,o=0;t=this.paragraphElement_.childNodes[o];o++)t.setAttribute("text-anchor","end"),t.setAttribute("x",e+Blockly.Bubble.BORDER_WIDTH);this.updateColour()},Blockly.Warning.prototype.disposeBubble=function(){this.bubble_.dispose(),this.paragraphElement_=this.body_=this.bubble_=null},Blockly.Warning.prototype.bodyFocus_=function(t){this.bubble_.promote_()},Blockly.Warning.prototype.setText=function(t,e){this.text_[e]!=t&&(t?this.text_[e]=t:delete this.text_[e],this.isVisible()&&(this.setVisible(!1),this.setVisible(!0)))},Blockly.Warning.prototype.getText=function(){var t,e=[];for(t in this.text_)e.push(this.text_[t]);return e.join("\n")},Blockly.Warning.prototype.dispose=function(){this.block_.warning=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.BlockSvg=function(t,e,o){this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{},null),this.svgGroup_.translate_="",this.pathObject=t.getRenderer().makePathObject(this.svgGroup_),this.svgPathDark_=this.pathObject.svgPathDark||null,this.svgPath_=this.pathObject.svgPath||null,this.svgPathLight_=this.pathObject.svgPathLight||null,this.svgPath_.tooltip=this,this.rendered=!1,this.useDragSurface_=Blockly.utils.is3dSupported()&&!!t.blockDragSurface_,Blockly.Tooltip.bindMouseEvents(this.svgPath_),Blockly.BlockSvg.superClass_.constructor.call(this,t,e,o),this.svgGroup_.dataset&&(this.svgGroup_.dataset.id=this.id),this.markerSvg_=this.cursorSvg_=null},Blockly.utils.object.inherits(Blockly.BlockSvg,Blockly.Block),Blockly.BlockSvg.prototype.height=0,Blockly.BlockSvg.prototype.width=0,Blockly.BlockSvg.prototype.dragStartXY_=null,Blockly.BlockSvg.prototype.warningTextDb_=null,Blockly.BlockSvg.INLINE=-1,Blockly.BlockSvg.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",Blockly.BlockSvg.SEP_SPACE_Y=10,Blockly.BlockSvg.MIN_BLOCK_Y=25,Blockly.BlockSvg.TAB_WIDTH=8,Blockly.BlockSvg.START_HAT=!1,Blockly.BlockSvg.prototype.initSvg=function(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(var t,e=0;t=this.inputList[e];e++)t.init();for(t=this.getIcons(),e=0;e<t.length;e++)t[e].createIcon();this.updateColour(),this.updateMovable(),this.workspace.options.readOnly||this.eventsInit_||Blockly.bindEventWithChecks_(this.getSvgRoot(),"mousedown",this,this.onMouseDown_),this.eventsInit_=!0,this.getSvgRoot().parentNode||this.workspace.getCanvas().appendChild(this.getSvgRoot())},Blockly.BlockSvg.prototype.select=function(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(Blockly.selected!=this){var t=null;if(Blockly.selected){t=Blockly.selected.id,Blockly.Events.disable();try{Blockly.selected.unselect()}finally{Blockly.Events.enable()}}(t=new Blockly.Events.Ui(null,"selected",t,this.id)).workspaceId=this.workspace.id,Blockly.Events.fire(t),Blockly.selected=this,this.addSelect()}},Blockly.BlockSvg.prototype.unselect=function(){if(Blockly.selected==this){var t=new Blockly.Events.Ui(null,"selected",this.id,null);t.workspaceId=this.workspace.id,Blockly.Events.fire(t),Blockly.selected=null,this.removeSelect()}},Blockly.BlockSvg.prototype.mutator=null,Blockly.BlockSvg.prototype.comment=null,Blockly.BlockSvg.prototype.commentIcon_=null,Blockly.BlockSvg.prototype.warning=null,Blockly.BlockSvg.prototype.getIcons=function(){var t=[];return this.mutator&&t.push(this.mutator),this.commentIcon_&&t.push(this.commentIcon_),this.warning&&t.push(this.warning),t},Blockly.BlockSvg.prototype.setParent=function(t){var e=this.parentBlock_;if(t!=e){Blockly.utils.dom.startTextWidthCache(),Blockly.BlockSvg.superClass_.setParent.call(this,t),Blockly.utils.dom.stopTextWidthCache();var o=this.getSvgRoot();if(!this.workspace.isClearing&&o){var l=this.getRelativeToSurfaceXY();t?(t.getSvgRoot().appendChild(o),t=this.getRelativeToSurfaceXY(),this.moveConnections_(t.x-l.x,t.y-l.y)):e&&(this.workspace.getCanvas().appendChild(o),this.translate(l.x,l.y))}}},Blockly.BlockSvg.prototype.getRelativeToSurfaceXY=function(){var t=0,e=0,o=this.useDragSurface_?this.workspace.blockDragSurface_.getGroup():null,l=this.getSvgRoot();if(l)do{var i=Blockly.utils.getRelativeXY(l);t+=i.x,e+=i.y,this.useDragSurface_&&this.workspace.blockDragSurface_.getCurrentBlock()==l&&(t+=(i=this.workspace.blockDragSurface_.getSurfaceTranslation()).x,e+=i.y),l=l.parentNode}while(l&&l!=this.workspace.getCanvas()&&l!=o);return new Blockly.utils.Coordinate(t,e)},Blockly.BlockSvg.prototype.moveBy=function(t,e){if(this.parentBlock_)throw Error("Block has parent.");var o=Blockly.Events.isEnabled();if(o)var l=new Blockly.Events.BlockMove(this);var i=this.getRelativeToSurfaceXY();this.translate(i.x+t,i.y+e),this.moveConnections_(t,e),o&&(l.recordNew(),Blockly.Events.fire(l)),this.workspace.resizeContents()},Blockly.BlockSvg.prototype.translate=function(t,e){this.getSvgRoot().setAttribute("transform","translate("+t+","+e+")")},Blockly.BlockSvg.prototype.moveToDragSurface_=function(){if(this.useDragSurface_){var t=this.getRelativeToSurfaceXY();this.clearTransformAttributes_(),this.workspace.blockDragSurface_.translateSurface(t.x,t.y),this.workspace.blockDragSurface_.setBlocksAndShow(this.getSvgRoot())}},Blockly.BlockSvg.prototype.moveTo=function(t){var e=this.getRelativeToSurfaceXY();this.moveBy(t.x-e.x,t.y-e.y)},Blockly.BlockSvg.prototype.moveOffDragSurface_=function(t){this.useDragSurface_&&(this.translate(t.x,t.y),this.workspace.blockDragSurface_.clearAndHide(this.workspace.getCanvas()))},Blockly.BlockSvg.prototype.moveDuringDrag=function(t){this.useDragSurface_?this.workspace.blockDragSurface_.translateSurface(t.x,t.y):(this.svgGroup_.translate_="translate("+t.x+","+t.y+")",this.svgGroup_.setAttribute("transform",this.svgGroup_.translate_+this.svgGroup_.skew_))},Blockly.BlockSvg.prototype.clearTransformAttributes_=function(){this.getSvgRoot().removeAttribute("transform")},Blockly.BlockSvg.prototype.snapToGrid=function(){if(this.workspace&&!this.workspace.isDragging()&&!this.getParent()&&!this.isInFlyout){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var e=t.getSpacing(),o=e/2,l=this.getRelativeToSurfaceXY();t=Math.round((l.x-o)/e)*e+o-l.x,e=Math.round((l.y-o)/e)*e+o-l.y,t=Math.round(t),e=Math.round(e),0==t&&0==e||this.moveBy(t,e)}}},Blockly.BlockSvg.prototype.getBoundingRectangle=function(){var t=this.getRelativeToSurfaceXY(this),e=this.outputConnection?Blockly.BlockSvg.TAB_WIDTH:0,o=this.getHeightWidth(),l=t.y,i=t.y+o.height;if(this.RTL){var n=t.x-(o.width-e);t=t.x+e}else n=t.x-e,t=t.x+o.width-e;return new Blockly.utils.Rect(l,i,n,t)},Blockly.BlockSvg.prototype.markDirty=function(){for(var t,e=0;t=this.inputList[e];e++)t.markDirty()},Blockly.BlockSvg.prototype.setCollapsed=function(t){if(this.collapsed_!=t){for(var e,o=[],l=0;e=this.inputList[l];l++)o.push.apply(o,e.setVisible(!t));if(t){for(e=this.getIcons(),l=0;l<e.length;l++)e[l].setVisible(!1);l=this.toString(Blockly.COLLAPSE_CHARS),this.appendDummyInput("_TEMP_COLLAPSED_INPUT").appendField(l).init(),e=this.getDescendants(!0),(l=this.getNextBlock())&&(l=e.indexOf(l),e.splice(l,e.length-l)),l=1;for(var i;i=e[l];l++)if(i.warning){this.setWarningText(Blockly.Msg.COLLAPSED_WARNINGS_WARNING,Blockly.BlockSvg.COLLAPSED_WARNING_ID);break}}else this.removeInput("_TEMP_COLLAPSED_INPUT"),this.warning&&(this.warning.setText("",Blockly.BlockSvg.COLLAPSED_WARNING_ID),Object.keys(this.warning.text_).length||this.setWarningText(null));if(Blockly.BlockSvg.superClass_.setCollapsed.call(this,t),o.length||(o[0]=this),this.rendered)for(l=0;i=o[l];l++)i.render()}},Blockly.BlockSvg.prototype.tab=function(t,e){var o=this.createTabList_(),l=o.indexOf(t);-1==l&&(l=e?-1:o.length),(o=o[e?l+1:l-1])?o instanceof Blockly.Field?o.showEditor_():o.tab(null,e):(o=this.getParent())&&o.tab(this,e)},Blockly.BlockSvg.prototype.createTabList_=function(){for(var t,e=[],o=0;t=this.inputList[o];o++){for(var l,i=0;l=t.fieldRow[i];i++)l.isTabNavigable()&&l.isVisible()&&e.push(l);t.connection&&(t=t.connection.targetBlock())&&e.push(t)}return e},Blockly.BlockSvg.prototype.onMouseDown_=function(t){var e=this.workspace&&this.workspace.getGesture(t);e&&e.handleBlockStart(t,this)},Blockly.BlockSvg.prototype.showHelp_=function(){var t="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;t&&window.open(t)},Blockly.BlockSvg.prototype.generateContextMenu=function(){if(this.workspace.options.readOnly||!this.contextMenu)return null;var t=this,e=[];if(!this.isInFlyout){if(this.isDeletable()&&this.isMovable()&&e.push(Blockly.ContextMenu.blockDuplicateOption(t)),this.workspace.options.comments&&!this.collapsed_&&this.isEditable()&&e.push(Blockly.ContextMenu.blockCommentOption(t)),this.isMovable())if(this.collapsed_)this.workspace.options.collapse&&((o={enabled:!0}).text=Blockly.Msg.EXPAND_BLOCK,o.callback=function(){t.setCollapsed(!1)},e.push(o));else{for(var o=1;o<this.inputList.length;o++)if(this.inputList[o-1].type!=Blockly.NEXT_STATEMENT&&this.inputList[o].type!=Blockly.NEXT_STATEMENT){o={enabled:!0};var l=this.getInputsInline();o.text=l?Blockly.Msg.EXTERNAL_INPUTS:Blockly.Msg.INLINE_INPUTS,o.callback=function(){t.setInputsInline(!l)},e.push(o);break}this.workspace.options.collapse&&((o={enabled:!0}).text=Blockly.Msg.COLLAPSE_BLOCK,o.callback=function(){t.setCollapsed(!0)},e.push(o))}this.workspace.options.disable&&this.isEditable()&&(o={text:this.isEnabled()?Blockly.Msg.DISABLE_BLOCK:Blockly.Msg.ENABLE_BLOCK,enabled:!this.getInheritedDisabled(),callback:function(){var e=Blockly.Events.getGroup();e||Blockly.Events.setGroup(!0),t.setEnabled(!t.isEnabled()),e||Blockly.Events.setGroup(!1)}},e.push(o)),this.isDeletable()&&e.push(Blockly.ContextMenu.blockDeleteOption(t))}return e.push(Blockly.ContextMenu.blockHelpOption(t)),this.customContextMenu&&this.customContextMenu(e),e},Blockly.BlockSvg.prototype.showContextMenu_=function(t){var e=this.generateContextMenu();e&&e.length&&(Blockly.ContextMenu.show(t,e,this.RTL),Blockly.ContextMenu.currentBlock=this)},Blockly.BlockSvg.prototype.moveConnections_=function(t,e){if(this.rendered){for(var o=this.getConnections_(!1),l=0;l<o.length;l++)o[l].moveBy(t,e);for(o=this.getIcons(),l=0;l<o.length;l++)o[l].computeIconLocation();for(l=0;l<this.childBlocks_.length;l++)this.childBlocks_[l].moveConnections_(t,e)}},Blockly.BlockSvg.prototype.setDragging=function(t){if(t){var e=this.getSvgRoot();e.translate_="",e.skew_="",Blockly.draggingConnections_=Blockly.draggingConnections_.concat(this.getConnections_(!0)),Blockly.utils.dom.addClass(this.svgGroup_,"blocklyDragging")}else Blockly.draggingConnections_=[],Blockly.utils.dom.removeClass(this.svgGroup_,"blocklyDragging");for(e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)},Blockly.BlockSvg.prototype.updateMovable=function(){this.isMovable()?Blockly.utils.dom.addClass(this.svgGroup_,"blocklyDraggable"):Blockly.utils.dom.removeClass(this.svgGroup_,"blocklyDraggable")},Blockly.BlockSvg.prototype.setMovable=function(t){Blockly.BlockSvg.superClass_.setMovable.call(this,t),this.updateMovable()},Blockly.BlockSvg.prototype.setEditable=function(t){Blockly.BlockSvg.superClass_.setEditable.call(this,t),t=this.getIcons();for(var e=0;e<t.length;e++)t[e].updateEditable()},Blockly.BlockSvg.prototype.setShadow=function(t){Blockly.BlockSvg.superClass_.setShadow.call(this,t),this.updateColour()},Blockly.BlockSvg.prototype.setInsertionMarker=function(t){this.isInsertionMarker_!=t&&(this.isInsertionMarker_=t)&&(this.setColour(Blockly.INSERTION_MARKER_COLOUR),Blockly.utils.dom.addClass(this.svgGroup_,"blocklyInsertionMarker"))},Blockly.BlockSvg.prototype.getSvgRoot=function(){return this.svgGroup_},Blockly.BlockSvg.prototype.dispose=function(t,e){if(this.workspace){Blockly.Tooltip.hide(),Blockly.utils.dom.startTextWidthCache();var o=this.workspace;if(Blockly.selected==this&&(this.unselect(),this.workspace.cancelCurrentGesture()),Blockly.ContextMenu.currentBlock==this&&Blockly.ContextMenu.hide(),Blockly.keyboardAccessibilityMode&&Blockly.navigation.moveCursorOnBlockDelete(this),e&&this.rendered&&(this.unplug(t),Blockly.blockAnimations.disposeUiEffect(this)),this.rendered=!1,this.warningTextDb_){for(var l in this.warningTextDb_)clearTimeout(this.warningTextDb_[l]);this.warningTextDb_=null}l=this.getIcons();for(var i=0;i<l.length;i++)l[i].dispose();Blockly.BlockSvg.superClass_.dispose.call(this,t),Blockly.utils.dom.removeNode(this.svgGroup_),o.resizeContents(),this.svgPathDark_=this.svgPathLight_=this.svgPath_=this.svgGroup_=null,Blockly.utils.dom.stopTextWidthCache()}},Blockly.BlockSvg.prototype.updateColour=function(){if(this.isEnabled()){this.isShadow()?this.setShadowColour_():(this.setBorderColour_(),this.svgPath_.setAttribute("fill",this.getColour()));for(var t=this.getIcons(),e=0;e<t.length;e++)t[e].updateColour();for(t=0;e=this.inputList[t];t++)for(var o,l=0;o=e.fieldRow[l];l++)o.updateColour()}},Blockly.BlockSvg.prototype.setBorderColour_=function(){var t=this.getColourBorder();t.colourBorder?(this.svgPathLight_.style.display="none",this.svgPathDark_.style.display="none",this.svgPath_.setAttribute("stroke",t.colourBorder)):(this.svgPathLight_.style.display="",this.svgPathDark_.style.display="",this.svgPath_.setAttribute("stroke","none"),this.svgPathLight_.setAttribute("stroke",t.colourLight),this.svgPathDark_.setAttribute("fill",t.colourDark))},Blockly.BlockSvg.prototype.setShadowColour_=function(){var t=this.getColourShadow();return this.svgPathLight_.style.display="none",this.svgPathDark_.setAttribute("fill",t),this.svgPath_.setAttribute("stroke","none"),this.svgPath_.setAttribute("fill",t),t},Blockly.BlockSvg.prototype.updateDisabled=function(){!this.isEnabled()||this.getInheritedDisabled()?Blockly.utils.dom.addClass(this.svgGroup_,"blocklyDisabled")&&this.svgPath_.setAttribute("fill","url(#"+this.workspace.options.disabledPatternId+")"):Blockly.utils.dom.removeClass(this.svgGroup_,"blocklyDisabled")&&this.updateColour();for(var t,e=this.getChildren(!1),o=0;t=e[o];o++)t.updateDisabled()},Blockly.BlockSvg.prototype.getCommentIcon=function(){return this.commentIcon_},Blockly.BlockSvg.prototype.setCommentText=function(t){if(!Blockly.Comment)throw Error("Missing require for Blockly.Comment");this.commentModel.text!=t&&(Blockly.BlockSvg.superClass_.setCommentText.call(this,t),!!this.commentIcon_==(t=null!=t)?this.commentIcon_.updateText():(t?this.comment=this.commentIcon_=new Blockly.Comment(this):(this.commentIcon_.dispose(),this.comment=this.commentIcon_=null),this.rendered&&(this.render(),this.bumpNeighbours())))},Blockly.BlockSvg.prototype.setWarningText=function(t,e){this.warningTextDb_||(this.warningTextDb_=Object.create(null));var o=e||"";if(o)this.warningTextDb_[o]&&(clearTimeout(this.warningTextDb_[o]),delete this.warningTextDb_[o]);else for(var l in this.warningTextDb_)clearTimeout(this.warningTextDb_[l]),delete this.warningTextDb_[l];if(this.workspace.isDragging()){var i=this;this.warningTextDb_[o]=setTimeout((function(){i.workspace&&(delete i.warningTextDb_[o],i.setWarningText(t,o))}),100)}else{this.isInFlyout&&(t=null),l=this.getSurroundParent();for(var n=null;l;)l.isCollapsed()&&(n=l),l=l.getSurroundParent();n&&n.setWarningText(Blockly.Msg.COLLAPSED_WARNINGS_WARNING,Blockly.BlockSvg.COLLAPSED_WARNING_ID),l=!1,"string"==typeof t?(this.warning||(this.warning=new Blockly.Warning(this),l=!0),this.warning.setText(t,o)):this.warning&&!o?(this.warning.dispose(),l=!0):this.warning&&(l=this.warning.getText(),this.warning.setText("",o),(n=this.warning.getText())||this.warning.dispose(),l=l!=n),l&&this.rendered&&(this.render(),this.bumpNeighbours())}},Blockly.BlockSvg.prototype.setMutator=function(t){this.mutator&&this.mutator!==t&&this.mutator.dispose(),t&&(t.block_=this,this.mutator=t,t.createIcon())},Blockly.BlockSvg.prototype.setDisabled=function(t){console.warn("Deprecated call to Blockly.BlockSvg.prototype.setDisabled, use Blockly.BlockSvg.prototype.setEnabled instead."),this.setEnabled(!t)},Blockly.BlockSvg.prototype.setEnabled=function(t){this.isEnabled()!=t&&(Blockly.BlockSvg.superClass_.setEnabled.call(this,t),this.rendered&&this.updateDisabled())},Blockly.BlockSvg.prototype.setHighlighted=function(t){this.rendered&&(t?(this.svgPath_.setAttribute("filter","url(#"+this.workspace.options.embossFilterId+")"),this.svgPathLight_.style.display="none"):(this.svgPath_.setAttribute("filter","none"),this.svgPathLight_.style.display="inline"))},Blockly.BlockSvg.prototype.addSelect=function(){Blockly.utils.dom.addClass(this.svgGroup_,"blocklySelected")},Blockly.BlockSvg.prototype.removeSelect=function(){Blockly.utils.dom.removeClass(this.svgGroup_,"blocklySelected")},Blockly.BlockSvg.prototype.setDeleteStyle=function(t){t?Blockly.utils.dom.addClass(this.svgGroup_,"blocklyDraggingDelete"):Blockly.utils.dom.removeClass(this.svgGroup_,"blocklyDraggingDelete")},Blockly.BlockSvg.prototype.setColour=function(t){Blockly.BlockSvg.superClass_.setColour.call(this,t),this.rendered&&this.updateColour()},Blockly.BlockSvg.prototype.bringToFront=function(){var t=this;do{var e=t.getSvgRoot();e.parentNode.appendChild(e),t=t.getParent()}while(t)},Blockly.BlockSvg.prototype.setPreviousStatement=function(t,e){Blockly.BlockSvg.superClass_.setPreviousStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},Blockly.BlockSvg.prototype.setNextStatement=function(t,e){Blockly.BlockSvg.superClass_.setNextStatement.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},Blockly.BlockSvg.prototype.setOutput=function(t,e){Blockly.BlockSvg.superClass_.setOutput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},Blockly.BlockSvg.prototype.setInputsInline=function(t){Blockly.BlockSvg.superClass_.setInputsInline.call(this,t),this.rendered&&(this.render(),this.bumpNeighbours())},Blockly.BlockSvg.prototype.removeInput=function(t,e){Blockly.BlockSvg.superClass_.removeInput.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},Blockly.BlockSvg.prototype.moveNumberedInputBefore=function(t,e){Blockly.BlockSvg.superClass_.moveNumberedInputBefore.call(this,t,e),this.rendered&&(this.render(),this.bumpNeighbours())},Blockly.BlockSvg.prototype.appendInput_=function(t,e){var o=Blockly.BlockSvg.superClass_.appendInput_.call(this,t,e);return this.rendered&&(this.render(),this.bumpNeighbours()),o},Blockly.BlockSvg.prototype.setConnectionsHidden=function(t){if(!t&&this.isCollapsed()){if(this.outputConnection&&this.outputConnection.setHidden(t),this.previousConnection&&this.previousConnection.setHidden(t),this.nextConnection){this.nextConnection.setHidden(t);var e=this.nextConnection.targetBlock();e&&e.setConnectionsHidden(t)}}else for(var o=this.getConnections_(!0),l=0;e=o[l];l++)e.setHidden(t),e.isSuperior()&&(e=e.targetBlock())&&e.setConnectionsHidden(t)},Blockly.BlockSvg.prototype.getConnections_=function(t){var e=[];if((t||this.rendered)&&(this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection),t||!this.collapsed_)){t=0;for(var o;o=this.inputList[t];t++)o.connection&&e.push(o.connection)}return e},Blockly.BlockSvg.prototype.makeConnection_=function(t){return new Blockly.RenderedConnection(this,t)},Blockly.BlockSvg.prototype.bumpNeighbours=function(){if(this.workspace&&!this.workspace.isDragging()){var t=this.getRootBlock();if(!t.isInFlyout)for(var e,o=this.getConnections_(!1),l=0;e=o[l];l++){e.isConnected()&&e.isSuperior()&&e.targetBlock().bumpNeighbours();for(var i,n=e.neighbours_(Blockly.SNAP_RADIUS),r=0;i=n[r];r++)e.isConnected()&&i.isConnected()||i.getSourceBlock().getRootBlock()!=t&&(e.isSuperior()?i.bumpAwayFrom_(e):e.bumpAwayFrom_(i))}}},Blockly.BlockSvg.prototype.scheduleSnapAndBump=function(){var t=this,e=Blockly.Events.getGroup();setTimeout((function(){Blockly.Events.setGroup(e),t.snapToGrid(),Blockly.Events.setGroup(!1)}),Blockly.BUMP_DELAY/2),setTimeout((function(){Blockly.Events.setGroup(e),t.bumpNeighbours(),Blockly.Events.setGroup(!1)}),Blockly.BUMP_DELAY)},Blockly.BlockSvg.prototype.positionNearConnection=function(t,e){t.type!=Blockly.NEXT_STATEMENT&&t.type!=Blockly.INPUT_VALUE||this.moveBy(e.x_-t.x_,e.y_-t.y_)},Blockly.BlockSvg.prototype.render=function(t){Blockly.utils.dom.startTextWidthCache(),this.rendered=!0,this.workspace.getRenderer().render(this),this.updateConnectionLocations_(),!1!==t&&((t=this.getParent())?t.render(!0):this.workspace.resizeContents()),Blockly.utils.dom.stopTextWidthCache()},Blockly.BlockSvg.prototype.updateConnectionLocations_=function(){var t=this.getRelativeToSurfaceXY();this.previousConnection&&this.previousConnection.moveToOffset(t),this.outputConnection&&this.outputConnection.moveToOffset(t);for(var e=0;e<this.inputList.length;e++){var o=this.inputList[e].connection;o&&(o.moveToOffset(t),o.isConnected()&&o.tighten_())}this.nextConnection&&(this.nextConnection.moveToOffset(t),this.nextConnection.isConnected()&&this.nextConnection.tighten_())},Blockly.BlockSvg.prototype.setCursorSvg=function(t){t?(this.svgGroup_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},Blockly.BlockSvg.prototype.setMarkerSvg=function(t){t?(this.cursorSvg_?this.svgGroup_.insertBefore(t,this.cursorSvg_):this.svgGroup_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},Blockly.BlockSvg.prototype.getHeightWidth=function(){var t=this.height,e=this.width,o=this.getNextBlock();return o&&(t+=(o=o.getHeightWidth()).height-4,e=Math.max(e,o.width)),{height:t,width:e}},Blockly.BlockSvg.prototype.positionNewBlock=function(t,e,o){e.type!=Blockly.NEXT_STATEMENT&&e.type!=Blockly.INPUT_VALUE||t.moveBy(o.x_-e.x_,o.y_-e.y_)},Blockly.BlockSvg.prototype.highlightForReplacement=function(t){t?Blockly.utils.dom.addClass(this.svgGroup_,"blocklyReplaceable"):Blockly.utils.dom.removeClass(this.svgGroup_,"blocklyReplaceable")},Blockly.Css={},Blockly.Css.injected_=!1,Blockly.Css.register=function(t){if(Blockly.Css.injected_)throw Error("CSS already injected");Array.prototype.push.apply(Blockly.Css.CONTENT,t),t.length=0},Blockly.Css.inject=function(t,e){if(!Blockly.Css.injected_){Blockly.Css.injected_=!0;var o=Blockly.Css.CONTENT.join("\n");if(Blockly.Css.CONTENT.length=0,t){var l=e.replace(/[\\/]$/,"");o=o.replace(/<<<PATH>>>/g,l),l=document.createElement("style"),o=document.createTextNode(o),l.appendChild(o),document.head.insertBefore(l,document.head.firstChild)}}},Blockly.Css.setCursor=function(t){console.warn("Deprecated call to Blockly.Css.setCursor. See https://github.com/google/blockly/issues/981 for context")},Blockly.Css.CONTENT=[".blocklySvg {","background-color: #fff;","outline: none;","overflow: hidden;","position: absolute;","display: block;","}",".blocklyWidgetDiv {","display: none;","position: absolute;","z-index: 99999;","}",".injectionDiv {","height: 100%;","position: relative;","overflow: hidden;","touch-action: none;","}",".blocklyNonSelectable {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","}",".blocklyWsDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","}",".blocklyWsDragSurface.blocklyOverflowVisible {","overflow: visible;","}",".blocklyBlockDragSurface {","display: none;","position: absolute;","top: 0;","left: 0;","right: 0;","bottom: 0;","overflow: visible !important;","z-index: 50;","}",".blocklyBlockCanvas.blocklyCanvasTransitioning,",".blocklyBubbleCanvas.blocklyCanvasTransitioning {","transition: transform .5s;","}",".blocklyTooltipDiv {","background-color: #ffffc7;","border: 1px solid #ddc;","box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);","color: #000;","display: none;","font-family: sans-serif;","font-size: 9pt;","opacity: .9;","padding: 2px;","position: absolute;","z-index: 100000;","}",".blocklyDropDownDiv {","position: fixed;","left: 0;","top: 0;","z-index: 1000;","display: none;","border: 1px solid;","border-radius: 2px;","padding: 4px;","box-shadow: 0px 0px 3px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv.focused {","box-shadow: 0px 0px 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownContent {","max-height: 300px;","overflow: auto;","overflow-x: hidden;","}",".blocklyDropDownArrow {","position: absolute;","left: 0;","top: 0;","width: 16px;","height: 16px;","z-index: -1;","background-color: inherit;","border-color: inherit;","}",".blocklyDropDownButton {","display: inline-block;","float: left;","padding: 0;","margin: 4px;","border-radius: 4px;","outline: none;","border: 1px solid;","transition: box-shadow .1s;","cursor: pointer;","}",".arrowTop {","border-top: 1px solid;","border-left: 1px solid;","border-top-left-radius: 4px;","border-color: inherit;","}",".arrowBottom {","border-bottom: 1px solid;","border-right: 1px solid;","border-bottom-right-radius: 4px;","border-color: inherit;","}",".blocklyResizeSE {","cursor: se-resize;","fill: #aaa;","}",".blocklyResizeSW {","cursor: sw-resize;","fill: #aaa;","}",".blocklyResizeLine {","stroke: #515A5A;","stroke-width: 1;","}",".blocklyHighlightedConnectionPath {","fill: none;","stroke: #fc3;","stroke-width: 4px;","}",".blocklyPathLight {","fill: none;","stroke-linecap: round;","stroke-width: 1;","}",".blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",".blocklySelected>.blocklyPathLight {","display: none;","}",".blocklyDraggable {",'cursor: url("<<<PATH>>>/handopen.cur"), auto;',"cursor: grab;","cursor: -webkit-grab;","}",".blocklyDragging {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDraggable:active {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyBlockDragSurface .blocklyDraggable {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyDragging.blocklyDraggingDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyDragging>.blocklyPath,",".blocklyDragging>.blocklyPathLight {","fill-opacity: .8;","stroke-opacity: .8;","}",".blocklyDragging>.blocklyPathDark {","display: none;","}",".blocklyDisabled>.blocklyPath {","fill-opacity: .5;","stroke-opacity: .5;","}",".blocklyDisabled>.blocklyPathLight,",".blocklyDisabled>.blocklyPathDark {","display: none;","}",".blocklyInsertionMarker>.blocklyPath,",".blocklyInsertionMarker>.blocklyPathLight,",".blocklyInsertionMarker>.blocklyPathDark {","fill-opacity: .2;","stroke: none","}",".blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",".blocklyReplaceable .blocklyPathLight,",".blocklyReplaceable .blocklyPathDark {","display: none;","}",".blocklyText {","cursor: default;","fill: #fff;","font-family: sans-serif;","font-size: 11pt;","}",".blocklyMultilineText {","font-family: monospace;","}",".blocklyNonEditableText>text {","pointer-events: none;","}",".blocklyNonEditableText>rect,",".blocklyEditableText>rect {","fill: #fff;","fill-opacity: .6;","}",".blocklyNonEditableText>text,",".blocklyEditableText>text {","fill: #000;","}",".blocklyEditableText:hover>rect {","stroke: #fff;","stroke-width: 2;","}",".blocklyBubbleText {","fill: #000;","}",".blocklyFlyout {","position: absolute;","z-index: 20;","}",".blocklySvg text, .blocklyBlockDragSurface text {","user-select: none;","-ms-user-select: none;","-webkit-user-select: none;","cursor: inherit;","}",".blocklyHidden {","display: none;","}",".blocklyFieldDropdown:not(.blocklyHidden) {","display: block;","}",".blocklyIconGroup {","cursor: default;","}",".blocklyIconGroup:not(:hover),",".blocklyIconGroupReadonly {","opacity: .6;","}",".blocklyIconShape {","fill: #00f;","stroke: #fff;","stroke-width: 1px;","}",".blocklyIconSymbol {","fill: #fff;","}",".blocklyMinimalBody {","margin: 0;","padding: 0;","}",".blocklyCommentForeignObject {","position: relative;","z-index: 0;","}",".blocklyCommentRect {","fill: #E7DE8E;","stroke: #bcA903;","stroke-width: 1px","}",".blocklyCommentTarget {","fill: transparent;","stroke: #bcA903;","}",".blocklyCommentTargetFocused {","fill: none;","}",".blocklyCommentHandleTarget {","fill: none;","}",".blocklyCommentHandleTargetFocused {","fill: transparent;","}",".blocklyFocused>.blocklyCommentRect {","fill: #B9B272;","stroke: #B9B272;","}",".blocklySelected>.blocklyCommentTarget {","stroke: #fc3;","stroke-width: 3px;","}",".blocklyCommentTextarea {","background-color: #fef49c;","border: 0;","outline: 0;","margin: 0;","padding: 3px;","resize: none;","display: block;","overflow: hidden;","}",".blocklyCommentDeleteIcon {","cursor: pointer;","fill: #000;","display: none","}",".blocklySelected > .blocklyCommentDeleteIcon {","display: block","}",".blocklyDeleteIconShape {","fill: #000;","stroke: #000;","stroke-width: 1px;","}",".blocklyDeleteIconShape.blocklyDeleteIconHighlighted {","stroke: #fc3;","}",".blocklyHtmlInput {","border: none;","border-radius: 4px;","font-family: sans-serif;","height: 100%;","margin: 0;","outline: none;","padding: 0;","width: 100%;","text-align: center;","}",".blocklyHtmlInput::-ms-clear {","display: none;","}",".blocklyMainBackground {","stroke-width: 1;","stroke: #c6c6c6;","}",".blocklyMutatorBackground {","fill: #fff;","stroke: #ddd;","stroke-width: 1;","}",".blocklyFlyoutBackground {","fill: #ddd;","fill-opacity: .8;","}",".blocklyMainWorkspaceScrollbar {","z-index: 20;","}",".blocklyFlyoutScrollbar {","z-index: 30;","}",".blocklyScrollbarHorizontal, .blocklyScrollbarVertical {","position: absolute;","outline: none;","}",".blocklyScrollbarBackground {","opacity: 0;","}",".blocklyScrollbarHandle {","fill: #ccc;","}",".blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyScrollbarHandle:hover {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarHandle {","fill: #bbb;","}",".blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,",".blocklyFlyout .blocklyScrollbarHandle:hover {","fill: #aaa;","}",".blocklyInvalidInput {","background: #faa;","}",".blocklyContextMenu {","border-radius: 4px;","max-height: 100%;","}",".blocklyDropdownMenu {","border-radius: 2px;","padding: 0 !important;","}",".blocklyWidgetDiv .blocklyDropdownMenu .goog-menuitem,",".blocklyDropDownDiv .blocklyDropdownMenu .goog-menuitem {","padding-left: 28px;","}",".blocklyWidgetDiv .blocklyDropdownMenu .goog-menuitem.goog-menuitem-rtl,",".blocklyDropDownDiv .blocklyDropdownMenu .goog-menuitem.goog-menuitem-rtl {","padding-left: 5px;","padding-right: 28px;","}",".blocklyVerticalCursor {","stroke-width: 3px;","fill: rgba(255,255,255,.5);","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-icon {","background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;","}",".blocklyWidgetDiv .goog-menu {","background: #fff;","border-color: transparent;","border-style: solid;","border-width: 1px;","cursor: default;","font: normal 13px Arial, sans-serif;","margin: 0;","outline: none;","padding: 4px 0;","position: absolute;","overflow-y: auto;","overflow-x: hidden;","max-height: 100%;","z-index: 20000;","box-shadow: 0px 0px 3px 1px rgba(0,0,0,.3);","}",".blocklyWidgetDiv .goog-menu.focused {","box-shadow: 0px 0px 6px 1px rgba(0,0,0,.3);","}",".blocklyDropDownDiv .goog-menu {","cursor: default;",'font: normal 13px "Helvetica Neue", Helvetica, sans-serif;',"outline: none;","z-index: 20000;","}",".blocklyWidgetDiv .goog-menuitem,",".blocklyDropDownDiv .goog-menuitem {","color: #000;","font: normal 13px Arial, sans-serif;","list-style: none;","margin: 0;","min-width: 7em;","border: none;","padding: 6px 15px;","white-space: nowrap;","cursor: pointer;","}",".blocklyWidgetDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyWidgetDiv .goog-menu-noicon .goog-menuitem,",".blocklyDropDownDiv .goog-menu-nocheckbox .goog-menuitem,",".blocklyDropDownDiv .goog-menu-noicon .goog-menuitem {","padding-left: 12px;","}",".blocklyWidgetDiv .goog-menuitem-content,",".blocklyDropDownDiv .goog-menuitem-content {","font: normal 13px Arial, sans-serif;","}",".blocklyWidgetDiv .goog-menuitem-content {","color: #000;","}",".blocklyDropDownDiv .goog-menuitem-content {","color: #000;","}",".blocklyWidgetDiv .goog-menuitem-disabled,",".blocklyDropDownDiv .goog-menuitem-disabled {","cursor: inherit;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-content,",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-content {","color: #ccc !important;","}",".blocklyWidgetDiv .goog-menuitem-disabled .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-disabled .goog-menuitem-icon {","opacity: .3;","filter: alpha(opacity=30);","}",".blocklyWidgetDiv .goog-menuitem-highlight ,",".blocklyDropDownDiv .goog-menuitem-highlight {","background-color: rgba(0,0,0,.1);","}",".blocklyWidgetDiv .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-icon {","background-repeat: no-repeat;","height: 16px;","left: 6px;","position: absolute;","right: auto;","vertical-align: middle;","width: 16px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-icon {","left: auto;","right: 6px;","}",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-option-selected .goog-menuitem-icon,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-option-selected .goog-menuitem-icon {","position: static;","float: left;","margin-left: -24px;","}",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyWidgetDiv .goog-menuitem-rtl .goog-menuitem-icon,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-checkbox,",".blocklyDropDownDiv .goog-menuitem-rtl .goog-menuitem-icon {","float: right;","margin-right: -24px;","}"],Blockly.DropDownDiv=function(){},Blockly.DropDownDiv.DIV_=null,Blockly.DropDownDiv.boundsElement_=null,Blockly.DropDownDiv.owner_=null,Blockly.DropDownDiv.positionToField_=null,Blockly.DropDownDiv.ARROW_SIZE=16,Blockly.DropDownDiv.BORDER_SIZE=1,Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING=12,Blockly.DropDownDiv.PADDING_Y=16,Blockly.DropDownDiv.ANIMATION_TIME=.25,Blockly.DropDownDiv.DEFAULT_DROPDOWN_BORDER_COLOR="#dadce0",Blockly.DropDownDiv.DEFAULT_DROPDOWN_COLOR="#fff",Blockly.DropDownDiv.animateOutTimer_=null,Blockly.DropDownDiv.onHide_=null,Blockly.DropDownDiv.createDom=function(){if(!Blockly.DropDownDiv.DIV_){var t=document.createElement("div");t.className="blocklyDropDownDiv",t.style.backgroundColor=Blockly.DropDownDiv.DEFAULT_DROPDOWN_COLOR,t.style.borderColor=Blockly.DropDownDiv.DEFAULT_DROPDOWN_BORDER_COLOR,document.body.appendChild(t),Blockly.DropDownDiv.DIV_=t;var e=document.createElement("div");e.className="blocklyDropDownContent",t.appendChild(e),Blockly.DropDownDiv.content_=e,(e=document.createElement("div")).className="blocklyDropDownArrow",t.appendChild(e),Blockly.DropDownDiv.arrow_=e,Blockly.DropDownDiv.DIV_.style.opacity=0,Blockly.DropDownDiv.DIV_.style.transition="transform "+Blockly.DropDownDiv.ANIMATION_TIME+"s, opacity "+Blockly.DropDownDiv.ANIMATION_TIME+"s",t.addEventListener("focusin",(function(){Blockly.utils.dom.addClass(t,"focused")})),t.addEventListener("focusout",(function(){Blockly.utils.dom.removeClass(t,"focused")}))}},Blockly.DropDownDiv.setBoundsElement=function(t){Blockly.DropDownDiv.boundsElement_=t},Blockly.DropDownDiv.getContentDiv=function(){return Blockly.DropDownDiv.content_},Blockly.DropDownDiv.clearContent=function(){Blockly.DropDownDiv.content_.innerHTML="",Blockly.DropDownDiv.content_.style.width=""},Blockly.DropDownDiv.setColour=function(t,e){Blockly.DropDownDiv.DIV_.style.backgroundColor=t,Blockly.DropDownDiv.DIV_.style.borderColor=e},Blockly.DropDownDiv.setCategory=function(t){Blockly.DropDownDiv.DIV_.setAttribute("data-category",t)},Blockly.DropDownDiv.showPositionedByBlock=function(t,e,o,l){var i=e.workspace.scale,n=e.width,r=e.height;return n*=i,r*=i,n=(i=e.getSvgRoot().getBoundingClientRect()).left+n/2,r=i.top+r,i=i.top,l&&(i+=l),Blockly.DropDownDiv.setBoundsElement(e.workspace.getParentSvg().parentNode),Blockly.DropDownDiv.show(t,e.RTL,n,r,n,i,o)},Blockly.DropDownDiv.showPositionedByField=function(t,e,o){var l=t.getSvgRoot().getBoundingClientRect(),i=l.left+l.width/2,n=l.bottom;return l=l.top,o&&(l+=o),o=t.getSourceBlock(),Blockly.DropDownDiv.positionToField_=!0,Blockly.DropDownDiv.setBoundsElement(o.workspace.getParentSvg().parentNode),Blockly.DropDownDiv.show(t,o.RTL,i,n,i,l,e)},Blockly.DropDownDiv.show=function(t,e,o,l,i,n,r){return Blockly.DropDownDiv.owner_=t,Blockly.DropDownDiv.onHide_=r||null,(t=Blockly.DropDownDiv.getPositionMetrics(o,l,i,n)).arrowVisible?(Blockly.DropDownDiv.arrow_.style.display="",Blockly.DropDownDiv.arrow_.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",Blockly.DropDownDiv.arrow_.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow arrowTop":"blocklyDropDownArrow arrowBottom")):Blockly.DropDownDiv.arrow_.style.display="none",Blockly.DropDownDiv.DIV_.style.direction=e?"rtl":"ltr",Blockly.DropDownDiv.positionInternal_(t.initialX,t.initialY,t.finalX,t.finalY),t.arrowAtTop},Blockly.DropDownDiv.getBoundsInfo_=function(){var t=Blockly.DropDownDiv.boundsElement_.getBoundingClientRect(),e=Blockly.utils.style.getSize(Blockly.DropDownDiv.boundsElement_);return{left:t.left,right:t.left+e.width,top:t.top,bottom:t.top+e.height,width:e.width,height:e.height}},Blockly.DropDownDiv.getPositionMetrics=function(t,e,o,l){var i=Blockly.DropDownDiv.getBoundsInfo_(),n=Blockly.utils.style.getSize(Blockly.DropDownDiv.DIV_);return e+n.height<i.bottom?Blockly.DropDownDiv.getPositionBelowMetrics(t,e,i,n):l-n.height>i.top?Blockly.DropDownDiv.getPositionAboveMetrics(o,l,i,n):e+n.height<document.documentElement.clientHeight?Blockly.DropDownDiv.getPositionBelowMetrics(t,e,i,n):l-n.height>document.documentElement.clientTop?Blockly.DropDownDiv.getPositionAboveMetrics(o,l,i,n):Blockly.DropDownDiv.getPositionTopOfPageMetrics(t,i,n)},Blockly.DropDownDiv.getPositionBelowMetrics=function(t,e,o,l){return{initialX:(t=Blockly.DropDownDiv.getPositionX(t,o.left,o.right,l.width)).divX,initialY:e,finalX:t.divX,finalY:e+Blockly.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:-(Blockly.DropDownDiv.ARROW_SIZE/2+Blockly.DropDownDiv.BORDER_SIZE),arrowAtTop:!0,arrowVisible:!0}},Blockly.DropDownDiv.getPositionAboveMetrics=function(t,e,o,l){return{initialX:(t=Blockly.DropDownDiv.getPositionX(t,o.left,o.right,l.width)).divX,initialY:e-l.height,finalX:t.divX,finalY:e-l.height-Blockly.DropDownDiv.PADDING_Y,arrowX:t.arrowX,arrowY:l.height-2*Blockly.DropDownDiv.BORDER_SIZE-Blockly.DropDownDiv.ARROW_SIZE/2,arrowAtTop:!1,arrowVisible:!0}},Blockly.DropDownDiv.getPositionTopOfPageMetrics=function(t,e,o){return{initialX:(t=Blockly.DropDownDiv.getPositionX(t,e.left,e.right,o.width)).divX,initialY:0,finalX:t.divX,finalY:0,arrowVisible:!1}},Blockly.DropDownDiv.getPositionX=function(t,e,o,l){var i=t;return t=Blockly.utils.math.clamp(e,t-l/2,o-l),{arrowX:l=Blockly.utils.math.clamp(e=Blockly.DropDownDiv.ARROW_HORIZONTAL_PADDING,(i-=Blockly.DropDownDiv.ARROW_SIZE/2)-t,l-e-Blockly.DropDownDiv.ARROW_SIZE),divX:t}},Blockly.DropDownDiv.isVisible=function(){return!!Blockly.DropDownDiv.owner_},Blockly.DropDownDiv.hideIfOwner=function(t,e){return Blockly.DropDownDiv.owner_===t&&(e?Blockly.DropDownDiv.hideWithoutAnimation():Blockly.DropDownDiv.hide(),!0)},Blockly.DropDownDiv.hide=function(){var t=Blockly.DropDownDiv.DIV_;t.style.transform="translate(0, 0)",t.style.opacity=0,Blockly.DropDownDiv.animateOutTimer_=setTimeout((function(){Blockly.DropDownDiv.hideWithoutAnimation()}),1e3*Blockly.DropDownDiv.ANIMATION_TIME),Blockly.DropDownDiv.onHide_&&(Blockly.DropDownDiv.onHide_(),Blockly.DropDownDiv.onHide_=null)},Blockly.DropDownDiv.hideWithoutAnimation=function(){if(Blockly.DropDownDiv.isVisible()){Blockly.DropDownDiv.animateOutTimer_&&clearTimeout(Blockly.DropDownDiv.animateOutTimer_);var t=Blockly.DropDownDiv.DIV_;t.style.transform="",t.style.left="",t.style.top="",t.style.opacity=0,t.style.display="none",t.style.backgroundColor=Blockly.DropDownDiv.DEFAULT_DROPDOWN_COLOR,t.style.borderColor=Blockly.DropDownDiv.DEFAULT_DROPDOWN_BORDER_COLOR,Blockly.DropDownDiv.onHide_&&(Blockly.DropDownDiv.onHide_(),Blockly.DropDownDiv.onHide_=null),Blockly.DropDownDiv.clearContent(),Blockly.DropDownDiv.owner_=null}},Blockly.DropDownDiv.positionInternal_=function(t,e,o,l){t=Math.floor(t),e=Math.floor(e),o=Math.floor(o),l=Math.floor(l);var i=Blockly.DropDownDiv.DIV_;i.style.left=t+"px",i.style.top=e+"px",i.style.display="block",i.style.opacity=1,i.style.transform="translate("+(o-t)+"px,"+(l-e)+"px)"},Blockly.DropDownDiv.repositionForWindowResize=function(){if(Blockly.DropDownDiv.owner_){var t=Blockly.DropDownDiv.owner_.getSourceBlock(),e=t.workspace.scale,o=Blockly.DropDownDiv.positionToField_?Blockly.DropDownDiv.owner_.size_.width:t.width,l=Blockly.DropDownDiv.positionToField_?Blockly.DropDownDiv.owner_.size_.height:t.height;o*=e,l*=e,t=Blockly.DropDownDiv.positionToField_?Blockly.DropDownDiv.owner_.fieldGroup_.getBoundingClientRect():t.getSvgRoot().getBoundingClientRect(),l=Blockly.DropDownDiv.getPositionMetrics(o=t.left+o/2,t.top+l,o,t.top),Blockly.DropDownDiv.positionInternal_(l.initialX,l.initialY,l.finalX,l.finalY)}else Blockly.DropDownDiv.hide()},Blockly.Grid=function(t,e){this.gridPattern_=t,this.spacing_=e.spacing,this.length_=e.length,this.line2_=(this.line1_=t.firstChild)&&this.line1_.nextSibling,this.snapToGrid_=e.snap},Blockly.Grid.prototype.scale_=1,Blockly.Grid.prototype.dispose=function(){this.gridPattern_=null},Blockly.Grid.prototype.shouldSnap=function(){return this.snapToGrid_},Blockly.Grid.prototype.getSpacing=function(){return this.spacing_},Blockly.Grid.prototype.getPatternId=function(){return this.gridPattern_.id},Blockly.Grid.prototype.update=function(t){this.scale_=t;var e=this.spacing_*t||100;this.gridPattern_.setAttribute("width",e),this.gridPattern_.setAttribute("height",e);var o=(e=Math.floor(this.spacing_/2)+.5)-this.length_/2,l=e+this.length_/2;this.setLineAttributes_(this.line1_,t,o*=t,l*=t,e*=t,e),this.setLineAttributes_(this.line2_,t,e,e,o,l)},Blockly.Grid.prototype.setLineAttributes_=function(t,e,o,l,i,n){t&&(t.setAttribute("stroke-width",e),t.setAttribute("x1",o),t.setAttribute("y1",i),t.setAttribute("x2",l),t.setAttribute("y2",n))},Blockly.Grid.prototype.moveTo=function(t,e){this.gridPattern_.setAttribute("x",t),this.gridPattern_.setAttribute("y",e),(Blockly.utils.userAgent.IE||Blockly.utils.userAgent.EDGE)&&this.update(this.scale_)},Blockly.Grid.createDom=function(t,e,o){return t=Blockly.utils.dom.createSvgElement("pattern",{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},o),0<e.length&&0<e.spacing?(Blockly.utils.dom.createSvgElement("line",{stroke:e.colour},t),1<e.length&&Blockly.utils.dom.createSvgElement("line",{stroke:e.colour},t)):Blockly.utils.dom.createSvgElement("line",{},t),t},Blockly.Options=function(t){var e=!!t.readOnly;if(e)var o=null,l=!1,i=!1,n=!1,r=!1,s=!1,c=!1;else{l=!(!(o=Blockly.Options.parseToolboxTree(t.toolbox||null))||!o.getElementsByTagName("category").length),void 0===(i=t.trashcan)&&(i=l);var a=t.maxTrashcanContents;i?void 0===a&&(a=32):a=0,void 0===(n=t.collapse)&&(n=l),void 0===(r=t.comments)&&(r=l),void 0===(s=t.disable)&&(s=l),void 0===(c=t.sounds)&&(c=!0)}var u=!!t.rtl,h=t.horizontalLayout;void 0===h&&(h=!1);var p=t.toolboxPosition;p="end"!==p,p=h?p?Blockly.TOOLBOX_AT_TOP:Blockly.TOOLBOX_AT_BOTTOM:p==u?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT;var y=t.css;void 0===y&&(y=!0);var k="https://blockly-demo.appspot.com/static/media/";t.media?k=t.media:t.path&&(k=t.path+"media/");var d=void 0===t.oneBasedIndex||!!t.oneBasedIndex,_=t.theme,B=t.keyMap||Blockly.user.keyMap.createDefaultKeyMap(),g=t.renderer||"geras";this.RTL=u,this.oneBasedIndex=d,this.collapse=n,this.comments=r,this.disable=s,this.readOnly=e,this.maxBlocks=t.maxBlocks||1/0,this.maxInstances=t.maxInstances,this.pathToMedia=k,this.hasCategories=l,this.moveOptions=Blockly.Options.parseMoveOptions(t,l),this.hasScrollbars=this.moveOptions.scrollbars,this.hasTrashcan=i,this.maxTrashcanContents=a,this.hasSounds=c,this.hasCss=y,this.horizontalLayout=h,this.languageTree=o,this.gridOptions=Blockly.Options.parseGridOptions_(t),this.zoomOptions=Blockly.Options.parseZoomOptions_(t),this.toolboxPosition=p,this.theme=_,this.keyMap=B,this.renderer=g},Blockly.Options.prototype.parentWorkspace=null,Blockly.Options.prototype.setMetrics=null,Blockly.Options.prototype.getMetrics=null,Blockly.Options.parseMoveOptions=function(t,e){var o=t.move||{},l={};return l.scrollbars=void 0===o.scrollbars&&void 0===t.scrollbars?e:!!o.scrollbars||!!t.scrollbars,l.wheel=!(!l.scrollbars||void 0===o.wheel||!o.wheel),l.drag=!(!l.scrollbars||void 0!==o.drag&&!o.drag),l},Blockly.Options.parseZoomOptions_=function(t){var e={};return e.controls=void 0!==(t=t.zoom||{}).controls&&!!t.controls,e.wheel=void 0!==t.wheel&&!!t.wheel,e.startScale=void 0===t.startScale?1:Number(t.startScale),e.maxScale=void 0===t.maxScale?3:Number(t.maxScale),e.minScale=void 0===t.minScale?.3:Number(t.minScale),e.scaleSpeed=void 0===t.scaleSpeed?1.2:Number(t.scaleSpeed),e},Blockly.Options.parseGridOptions_=function(t){t=t.grid||{};var e={};return e.spacing=Number(t.spacing)||0,e.colour=t.colour||"#888",e.length=Number(t.length)||1,e.snap=0<e.spacing&&!!t.snap,e},Blockly.Options.parseToolboxTree=function(t){if(t){if("string"!=typeof t&&(Blockly.utils.userAgent.IE&&t.outerHTML?t=t.outerHTML:t instanceof Element||(t=null)),"string"==typeof t&&"xml"!=(t=Blockly.Xml.textToDom(t)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else t=null;return t},Blockly.WorkspaceDragSurfaceSvg=function(t){this.container_=t,this.createDom()},Blockly.WorkspaceDragSurfaceSvg.prototype.SVG_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.dragGroup_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.container_=null,Blockly.WorkspaceDragSurfaceSvg.prototype.createDom=function(){this.SVG_||(this.SVG_=Blockly.utils.dom.createSvgElement("svg",{xmlns:Blockly.utils.dom.SVG_NS,"xmlns:html":Blockly.utils.dom.HTML_NS,"xmlns:xlink":Blockly.utils.dom.XLINK_NS,version:"1.1",class:"blocklyWsDragSurface blocklyOverflowVisible"},null),this.container_.appendChild(this.SVG_))},Blockly.WorkspaceDragSurfaceSvg.prototype.translateSurface=function(t,e){var o=t.toFixed(0),l=e.toFixed(0);this.SVG_.style.display="block",Blockly.utils.dom.setCssTransform(this.SVG_,"translate3d("+o+"px, "+l+"px, 0px)")},Blockly.WorkspaceDragSurfaceSvg.prototype.getSurfaceTranslation=function(){return Blockly.utils.getRelativeXY(this.SVG_)},Blockly.WorkspaceDragSurfaceSvg.prototype.clearAndHide=function(t){if(!t)throw Error("Couldn't clear and hide the drag surface: missing new surface.");var e=this.SVG_.childNodes[0],o=this.SVG_.childNodes[1];if(!(e&&o&&Blockly.utils.dom.hasClass(e,"blocklyBlockCanvas")&&Blockly.utils.dom.hasClass(o,"blocklyBubbleCanvas")))throw Error("Couldn't clear and hide the drag surface. A node was missing.");if(null!=this.previousSibling_?Blockly.utils.dom.insertAfter(e,this.previousSibling_):t.insertBefore(e,t.firstChild),Blockly.utils.dom.insertAfter(o,e),this.SVG_.style.display="none",this.SVG_.childNodes.length)throw Error("Drag surface was not cleared.");Blockly.utils.dom.setCssTransform(this.SVG_,""),this.previousSibling_=null},Blockly.WorkspaceDragSurfaceSvg.prototype.setContentsAndShow=function(t,e,o,l,i,n){if(this.SVG_.childNodes.length)throw Error("Already dragging a block.");this.previousSibling_=o,t.setAttribute("transform","translate(0, 0) scale("+n+")"),e.setAttribute("transform","translate(0, 0) scale("+n+")"),this.SVG_.setAttribute("width",l),this.SVG_.setAttribute("height",i),this.SVG_.appendChild(t),this.SVG_.appendChild(e),this.SVG_.style.display="block"},Blockly.blockRendering.rendererMap_={},Blockly.blockRendering.useDebugger=!1,Blockly.blockRendering.register=function(t,e){if(Blockly.blockRendering.rendererMap_[t])throw Error("Renderer has already been registered.");Blockly.blockRendering.rendererMap_[t]=e},Blockly.blockRendering.unregister=function(t){Blockly.blockRendering.rendererMap_[t]?delete Blockly.blockRendering.rendererMap_[t]:console.warn('No renderer mapping for name "'+t+'" found to unregister')},Blockly.blockRendering.startDebugger=function(){Blockly.blockRendering.useDebugger=!0},Blockly.blockRendering.stopDebugger=function(){Blockly.blockRendering.useDebugger=!1},Blockly.blockRendering.init=function(t){if(!Blockly.blockRendering.rendererMap_[t])throw Error("Renderer not registered: ",t);var e=function(){e.superClass_.constructor.call(this)};return Blockly.utils.object.inherits(e,Blockly.blockRendering.rendererMap_[t]),(t=new e).init(),t},Blockly.ConnectionDB=function(){this.connections_=[]},Blockly.ConnectionDB.prototype.addConnection=function(t){if(t.inDB_)throw Error("Connection already in database.");if(!t.getSourceBlock().isInFlyout){var e=this.findPositionForConnection_(t);this.connections_.splice(e,0,t),t.inDB_=!0}},Blockly.ConnectionDB.prototype.findConnection=function(t){if(!this.connections_.length)return-1;var e=this.findPositionForConnection_(t);if(e>=this.connections_.length)return-1;for(var o=t.y_,l=e;0<=l&&this.connections_[l].y_==o;){if(this.connections_[l]==t)return l;l--}for(;e<this.connections_.length&&this.connections_[e].y_==o;){if(this.connections_[e]==t)return e;e++}return-1},Blockly.ConnectionDB.prototype.findPositionForConnection_=function(t){if(!this.connections_.length)return 0;for(var e=0,o=this.connections_.length;e<o;){var l=Math.floor((e+o)/2);if(this.connections_[l].y_<t.y_)e=l+1;else{if(!(this.connections_[l].y_>t.y_)){e=l;break}o=l}}return e},Blockly.ConnectionDB.prototype.removeConnection_=function(t){if(!t.inDB_)throw Error("Connection not in database.");var e=this.findConnection(t);if(-1==e)throw Error("Unable to find connection in connectionDB.");t.inDB_=!1,this.connections_.splice(e,1)},Blockly.ConnectionDB.prototype.getNeighbours=function(t,e){function o(t){var o=i-l[t].x_,r=n-l[t].y_;return Math.sqrt(o*o+r*r)<=e&&a.push(l[t]),r<e}for(var l=this.connections_,i=t.x_,n=t.y_,r=0,s=l.length-2,c=s;r<c;)l[c].y_<n?r=c:s=c,c=Math.floor((r+s)/2);var a=[];if(s=r=c,l.length){for(;0<=r&&o(r);)r--;do{s++}while(s<l.length&&o(s))}return a},Blockly.ConnectionDB.prototype.isInYRange_=function(t,e,o){return Math.abs(this.connections_[t].y_-e)<=o},Blockly.ConnectionDB.prototype.searchForClosest=function(t,e,o){if(!this.connections_.length)return{connection:null,radius:e};var l=t.y_,i=t.x_;t.x_=i+o.x,t.y_=l+o.y;var n=this.findPositionForConnection_(t);o=null;for(var r,s=e,c=n-1;0<=c&&this.isInYRange_(c,t.y_,e);)t.isConnectionAllowed(r=this.connections_[c],s)&&(o=r,s=r.distanceFrom(t)),c--;for(;n<this.connections_.length&&this.isInYRange_(n,t.y_,e);)t.isConnectionAllowed(r=this.connections_[n],s)&&(o=r,s=r.distanceFrom(t)),n++;return t.x_=i,t.y_=l,{connection:o,radius:s}},Blockly.ConnectionDB.init=function(){var t=[];return t[Blockly.INPUT_VALUE]=new Blockly.ConnectionDB,t[Blockly.OUTPUT_VALUE]=new Blockly.ConnectionDB,t[Blockly.NEXT_STATEMENT]=new Blockly.ConnectionDB,t[Blockly.PREVIOUS_STATEMENT]=new Blockly.ConnectionDB,t},Blockly.TouchGesture=function(t,e){Blockly.TouchGesture.superClass_.constructor.call(this,t,e),this.isMultiTouch_=!1,this.cachedPoints_={},this.startDistance_=this.previousScale_=0,this.onStartWrapper_=null},Blockly.utils.object.inherits(Blockly.TouchGesture,Blockly.Gesture),Blockly.TouchGesture.ZOOM_IN_MULTIPLIER=5,Blockly.TouchGesture.ZOOM_OUT_MULTIPLIER=6,Blockly.TouchGesture.prototype.doStart=function(t){Blockly.TouchGesture.superClass_.doStart.call(this,t),!this.isEnding_&&Blockly.Touch.isTouchEvent(t)&&this.handleTouchStart(t)},Blockly.TouchGesture.prototype.bindMouseEvents=function(t){this.onStartWrapper_=Blockly.bindEventWithChecks_(document,"mousedown",null,this.handleStart.bind(this),!0),this.onMoveWrapper_=Blockly.bindEventWithChecks_(document,"mousemove",null,this.handleMove.bind(this),!0),this.onUpWrapper_=Blockly.bindEventWithChecks_(document,"mouseup",null,this.handleUp.bind(this),!0),t.preventDefault(),t.stopPropagation()},Blockly.TouchGesture.prototype.handleStart=function(t){!this.isDragging()&&Blockly.Touch.isTouchEvent(t)&&(this.handleTouchStart(t),this.isMultiTouch()&&Blockly.longStop_())},Blockly.TouchGesture.prototype.handleMove=function(t){this.isDragging()?Blockly.Touch.shouldHandleEvent(t)&&Blockly.TouchGesture.superClass_.handleMove.call(this,t):this.isMultiTouch()?(Blockly.Touch.isTouchEvent(t)&&this.handleTouchMove(t),Blockly.longStop_()):Blockly.TouchGesture.superClass_.handleMove.call(this,t)},Blockly.TouchGesture.prototype.handleUp=function(t){Blockly.Touch.isTouchEvent(t)&&!this.isDragging()&&this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()?Blockly.Touch.shouldHandleEvent(t)&&Blockly.TouchGesture.superClass_.handleUp.call(this,t):(t.preventDefault(),t.stopPropagation(),this.dispose())},Blockly.TouchGesture.prototype.isMultiTouch=function(){return this.isMultiTouch_},Blockly.TouchGesture.prototype.dispose=function(){Blockly.TouchGesture.superClass_.dispose.call(this),this.onStartWrapper_&&Blockly.unbindEvent_(this.onStartWrapper_)},Blockly.TouchGesture.prototype.handleTouchStart=function(t){var e=Blockly.Touch.getTouchIdentifierFromEvent(t);this.cachedPoints_[e]=this.getTouchPoint(t),2==(e=Object.keys(this.cachedPoints_)).length&&(this.startDistance_=Blockly.utils.Coordinate.distance(this.cachedPoints_[e[0]],this.cachedPoints_[e[1]]),this.isMultiTouch_=!0,t.preventDefault())},Blockly.TouchGesture.prototype.handleTouchMove=function(t){var e=Blockly.Touch.getTouchIdentifierFromEvent(t);if(this.cachedPoints_[e]=this.getTouchPoint(t),2==(e=Object.keys(this.cachedPoints_)).length){if(e=this.touchScale_=Blockly.utils.Coordinate.distance(this.cachedPoints_[e[0]],this.cachedPoints_[e[1]])/this.startDistance_,0<this.previousScale_&&1/0>this.previousScale_){var o=e-this.previousScale_;o=0<o?o*Blockly.TouchGesture.ZOOM_IN_MULTIPLIER:o*Blockly.TouchGesture.ZOOM_OUT_MULTIPLIER;var l=this.startWorkspace_,i=Blockly.utils.mouseToSvg(t,l.getParentSvg(),l.getInverseScreenCTM());l.zoom(i.x,i.y,o)}this.previousScale_=e,t.preventDefault()}},Blockly.TouchGesture.prototype.handleTouchEnd=function(t){t=Blockly.Touch.getTouchIdentifierFromEvent(t),this.cachedPoints_[t]&&delete this.cachedPoints_[t],2>Object.keys(this.cachedPoints_).length&&(this.cachedPoints_={},this.previousScale_=0)},Blockly.TouchGesture.prototype.getTouchPoint=function(t){return this.startWorkspace_?new Blockly.utils.Coordinate(t.pageX?t.pageX:t.changedTouches[0].pageX,t.pageY?t.pageY:t.changedTouches[0].pageY):null},Blockly.WorkspaceAudio=function(t){this.parentWorkspace_=t,this.SOUNDS_=Object.create(null)},Blockly.WorkspaceAudio.prototype.lastSound_=null,Blockly.WorkspaceAudio.prototype.dispose=function(){this.SOUNDS_=this.parentWorkspace_=null},Blockly.WorkspaceAudio.prototype.load=function(t,e){if(t.length){try{var o=new Blockly.utils.global.Audio}catch(s){return}for(var l,i=0;i<t.length;i++){var n=t[i],r=n.match(/\.(\w+)$/);if(r&&o.canPlayType("audio/"+r[1])){l=new Blockly.utils.global.Audio(n);break}}l&&l.play&&(this.SOUNDS_[e]=l)}},Blockly.WorkspaceAudio.prototype.preload=function(){for(var t in this.SOUNDS_){var e=this.SOUNDS_[t];e.volume=.01;var o=e.play();if(void 0!==o?o.then(e.pause).catch((function(){})):e.pause(),Blockly.utils.userAgent.IPAD||Blockly.utils.userAgent.IPHONE)break}},Blockly.WorkspaceAudio.prototype.play=function(t,e){var o=this.SOUNDS_[t];if(o){var l=new Date;null!=this.lastSound_&&l-this.lastSound_<Blockly.SOUND_LIMIT||(this.lastSound_=l,(o=Blockly.utils.userAgent.IPAD||Blockly.utils.userAgent.ANDROID?o:o.cloneNode()).volume=void 0===e?1:e,o.play())}else this.parentWorkspace_&&this.parentWorkspace_.getAudioManager().play(t,e)},Blockly.WorkspaceSvg=function(t,e,o){Blockly.WorkspaceSvg.superClass_.constructor.call(this,t),this.getMetrics=t.getMetrics||Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_,this.setMetrics=t.setMetrics||Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_,this.connectionDBList=Blockly.ConnectionDB.init(),e&&(this.blockDragSurface_=e),o&&(this.workspaceDragSurface_=o),this.useWorkspaceDragSurface_=this.workspaceDragSurface_&&Blockly.utils.is3dSupported(),this.highlightedBlocks_=[],this.audioManager_=new Blockly.WorkspaceAudio(t.parentWorkspace),this.grid_=this.options.gridPattern?new Blockly.Grid(t.gridPattern,t.gridOptions):null,this.markerSvg_=this.cursorSvg_=null,Blockly.Variables&&Blockly.Variables.flyoutCategory&&this.registerToolboxCategoryCallback(Blockly.VARIABLE_CATEGORY_NAME,Blockly.Variables.flyoutCategory),Blockly.VariablesDynamic&&Blockly.VariablesDynamic.flyoutCategory&&this.registerToolboxCategoryCallback(Blockly.VARIABLE_DYNAMIC_CATEGORY_NAME,Blockly.VariablesDynamic.flyoutCategory),Blockly.Procedures&&Blockly.Procedures.flyoutCategory&&this.registerToolboxCategoryCallback(Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.flyoutCategory),this.renderer_=Blockly.blockRendering.init(this.options.renderer||"geras")},Blockly.utils.object.inherits(Blockly.WorkspaceSvg,Blockly.Workspace),Blockly.WorkspaceSvg.prototype.resizeHandlerWrapper_=null,Blockly.WorkspaceSvg.prototype.rendered=!0,Blockly.WorkspaceSvg.prototype.isVisible_=!0,Blockly.WorkspaceSvg.prototype.isFlyout=!1,Blockly.WorkspaceSvg.prototype.isMutator=!1,Blockly.WorkspaceSvg.prototype.resizesEnabled_=!0,Blockly.WorkspaceSvg.prototype.scrollX=0,Blockly.WorkspaceSvg.prototype.scrollY=0,Blockly.WorkspaceSvg.prototype.startScrollX=0,Blockly.WorkspaceSvg.prototype.startScrollY=0,Blockly.WorkspaceSvg.prototype.dragDeltaXY_=null,Blockly.WorkspaceSvg.prototype.scale=1,Blockly.WorkspaceSvg.prototype.trashcan=null,Blockly.WorkspaceSvg.prototype.scrollbar=null,Blockly.WorkspaceSvg.prototype.flyout_=null,Blockly.WorkspaceSvg.prototype.toolbox_=null,Blockly.WorkspaceSvg.prototype.currentGesture_=null,Blockly.WorkspaceSvg.prototype.blockDragSurface_=null,Blockly.WorkspaceSvg.prototype.workspaceDragSurface_=null,Blockly.WorkspaceSvg.prototype.useWorkspaceDragSurface_=!1,Blockly.WorkspaceSvg.prototype.isDragSurfaceActive_=!1,Blockly.WorkspaceSvg.prototype.injectionDiv_=null,Blockly.WorkspaceSvg.prototype.lastRecordedPageScroll_=null,Blockly.WorkspaceSvg.prototype.flyoutButtonCallbacks_={},Blockly.WorkspaceSvg.prototype.toolboxCategoryCallbacks_={},Blockly.WorkspaceSvg.prototype.configureContextMenu=null,Blockly.WorkspaceSvg.prototype.targetWorkspace=null,Blockly.WorkspaceSvg.prototype.inverseScreenCTM_=null,Blockly.WorkspaceSvg.prototype.inverseScreenCTMDirty_=!0,Blockly.WorkspaceSvg.prototype.getRenderer=function(){return this.renderer_},Blockly.WorkspaceSvg.prototype.setCursor=function(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(this.cursor_.setDrawer(this.getRenderer().makeCursorDrawer(this,!1)),this.setCursorSvg(this.cursor_.getDrawer().createDom()))},Blockly.WorkspaceSvg.prototype.setMarker=function(t){this.marker_&&this.marker_.getDrawer()&&this.marker_.getDrawer().dispose(),(this.marker_=t)&&(this.marker_.setDrawer(this.getRenderer().makeCursorDrawer(this,!0)),this.setMarkerSvg(this.marker_.getDrawer().createDom()))},Blockly.WorkspaceSvg.prototype.setCursorSvg=function(t){t?this.svgBlockCanvas_&&(this.svgBlockCanvas_.appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null},Blockly.WorkspaceSvg.prototype.setMarkerSvg=function(t){t?this.svgBlockCanvas_&&(this.cursorSvg_?this.svgBlockCanvas_.insertBefore(t,this.cursorSvg_):this.svgBlockCanvas_.appendChild(t),this.markerSvg_=t):this.markerSvg_=null},Blockly.WorkspaceSvg.prototype.getInverseScreenCTM=function(){if(this.inverseScreenCTMDirty_){var t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM_=t.inverse(),this.inverseScreenCTMDirty_=!1)}return this.inverseScreenCTM_},Blockly.WorkspaceSvg.prototype.updateInverseScreenCTM=function(){this.inverseScreenCTMDirty_=!0},Blockly.WorkspaceSvg.prototype.isVisible=function(){return this.isVisible_},Blockly.WorkspaceSvg.prototype.getSvgXY=function(t){var e=0,o=0,l=1;(Blockly.utils.dom.containsNode(this.getCanvas(),t)||Blockly.utils.dom.containsNode(this.getBubbleCanvas(),t))&&(l=this.scale);do{var i=Blockly.utils.getRelativeXY(t);t!=this.getCanvas()&&t!=this.getBubbleCanvas()||(l=1),e+=i.x*l,o+=i.y*l,t=t.parentNode}while(t&&t!=this.getParentSvg());return new Blockly.utils.Coordinate(e,o)},Blockly.WorkspaceSvg.prototype.getOriginOffsetInPixels=function(){return Blockly.utils.getInjectionDivXY_(this.svgBlockCanvas_)},Blockly.WorkspaceSvg.prototype.getInjectionDiv=function(){if(!this.injectionDiv_)for(var t=this.svgGroup_;t;){if(-1!=(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")){this.injectionDiv_=t;break}t=t.parentNode}return this.injectionDiv_},Blockly.WorkspaceSvg.prototype.setResizeHandlerWrapper=function(t){this.resizeHandlerWrapper_=t},Blockly.WorkspaceSvg.prototype.createDom=function(t){if(this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyWorkspace"},null),t&&(this.svgBackground_=Blockly.utils.dom.createSvgElement("rect",{height:"100%",width:"100%",class:t},this.svgGroup_),"blocklyMainBackground"==t&&this.grid_?this.svgBackground_.style.fill="url(#"+this.grid_.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspace","fill")),this.svgBlockCanvas_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyBlockCanvas"},this.svgGroup_),this.svgBubbleCanvas_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyBubbleCanvas"},this.svgGroup_),this.isFlyout||(Blockly.bindEventWithChecks_(this.svgGroup_,"mousedown",this,this.onMouseDown_,!1,!0),Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories){if(!Blockly.Toolbox)throw Error("Missing require for Blockly.Toolbox");this.toolbox_=new Blockly.Toolbox(this)}return this.grid_&&this.grid_.update(this.scale),this.recordDeleteAreas(),this.cursor_.setDrawer(this.getRenderer().makeCursorDrawer(this,!1)),t=this.cursor_.getDrawer().createDom(),this.svgGroup_.appendChild(t),this.marker_.setDrawer(this.getRenderer().makeCursorDrawer(this,!0)),t=this.marker_.getDrawer().createDom(),this.svgGroup_.appendChild(t),this.svgGroup_},Blockly.WorkspaceSvg.prototype.dispose=function(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&(Blockly.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.svgBubbleCanvas_=this.svgBlockCanvas_=null,this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout_&&(this.flyout_.dispose(),this.flyout_=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&(this.zoomControls_.dispose(),this.zoomControls_=null),this.marker_&&this.marker_.getDrawer().dispose(),this.getCursor()&&this.getCursor().getDrawer().dispose(),this.audioManager_&&(this.audioManager_.dispose(),this.audioManager_=null),this.grid_&&(this.grid_.dispose(),this.grid_=null),this.themeManager_&&this.themeManager_.unsubscribe(this.svgBackground_),Blockly.WorkspaceSvg.superClass_.dispose.call(this),this.flyoutButtonCallbacks_=this.toolboxCategoryCallbacks_=this.connectionDBList=null,!this.options.parentWorkspace){var t=this.getParentSvg().parentNode;t&&Blockly.utils.dom.removeNode(t)}this.resizeHandlerWrapper_&&(Blockly.unbindEvent_(this.resizeHandlerWrapper_),this.resizeHandlerWrapper_=null)},Blockly.WorkspaceSvg.prototype.newBlock=function(t,e){return new Blockly.BlockSvg(this,t,e)},Blockly.WorkspaceSvg.prototype.addTrashcan=function(){if(!Blockly.Trashcan)throw Error("Missing require for Blockly.Trashcan");this.trashcan=new Blockly.Trashcan(this);var t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.svgBlockCanvas_)},Blockly.WorkspaceSvg.prototype.addZoomControls=function(){if(!Blockly.ZoomControls)throw Error("Missing require for Blockly.ZoomControls");this.zoomControls_=new Blockly.ZoomControls(this);var t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)},Blockly.WorkspaceSvg.prototype.addFlyout_=function(t){var e={disabledPatternId:this.options.disabledPatternId,parentWorkspace:this,RTL:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,toolboxPosition:this.options.toolboxPosition,renderer:this.options.renderer};if(this.horizontalLayout){if(!Blockly.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout_=new Blockly.HorizontalFlyout(e)}else{if(!Blockly.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout_=new Blockly.VerticalFlyout(e)}return this.flyout_.autoClose=!1,this.flyout_.createDom(t)},Blockly.WorkspaceSvg.prototype.getFlyout=function(){return this.flyout_?this.flyout_:this.toolbox_?this.toolbox_.flyout_:null},Blockly.WorkspaceSvg.prototype.getToolbox=function(){return this.toolbox_},Blockly.WorkspaceSvg.prototype.updateScreenCalculations_=function(){this.updateInverseScreenCTM(),this.recordDeleteAreas()},Blockly.WorkspaceSvg.prototype.resizeContents=function(){if(this.resizesEnabled_&&this.rendered){if(this.scrollbar){var t=this.getMetrics();this.scrollbar.hScroll.resizeContentHorizontal(t),this.scrollbar.vScroll.resizeContentVertical(t)}this.updateInverseScreenCTM()}},Blockly.WorkspaceSvg.prototype.resize=function(){this.toolbox_&&this.toolbox_.position(),this.flyout_&&this.flyout_.position(),this.trashcan&&this.trashcan.position(),this.zoomControls_&&this.zoomControls_.position(),this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()},Blockly.WorkspaceSvg.prototype.updateScreenCalculationsIfScrolled=function(){var t=Blockly.utils.getDocumentScroll();Blockly.utils.Coordinate.equals(this.lastRecordedPageScroll_,t)||(this.lastRecordedPageScroll_=t,this.updateScreenCalculations_())},Blockly.WorkspaceSvg.prototype.getCanvas=function(){return this.svgBlockCanvas_},Blockly.WorkspaceSvg.prototype.getBubbleCanvas=function(){return this.svgBubbleCanvas_},Blockly.WorkspaceSvg.prototype.getParentSvg=function(){if(this.cachedParentSvg_)return this.cachedParentSvg_;for(var t=this.svgGroup_;t;){if("svg"==t.tagName)return this.cachedParentSvg_=t;t=t.parentNode}return null},Blockly.WorkspaceSvg.prototype.translate=function(t,e){if(this.useWorkspaceDragSurface_&&this.isDragSurfaceActive_)this.workspaceDragSurface_.translateSurface(t,e);else{var o="translate("+t+","+e+") scale("+this.scale+")";this.svgBlockCanvas_.setAttribute("transform",o),this.svgBubbleCanvas_.setAttribute("transform",o)}this.blockDragSurface_&&this.blockDragSurface_.translateAndScaleGroup(t,e,this.scale),this.grid_&&this.grid_.moveTo(t,e)},Blockly.WorkspaceSvg.prototype.resetDragSurface=function(){if(this.useWorkspaceDragSurface_){this.isDragSurfaceActive_=!1;var t=this.workspaceDragSurface_.getSurfaceTranslation();this.workspaceDragSurface_.clearAndHide(this.svgGroup_),this.svgBlockCanvas_.setAttribute("transform",t="translate("+t.x+","+t.y+") scale("+this.scale+")"),this.svgBubbleCanvas_.setAttribute("transform",t)}},Blockly.WorkspaceSvg.prototype.setupDragSurface=function(){if(this.useWorkspaceDragSurface_&&!this.isDragSurfaceActive_){this.isDragSurfaceActive_=!0;var t=this.svgBlockCanvas_.previousSibling,e=parseInt(this.getParentSvg().getAttribute("width"),10),o=parseInt(this.getParentSvg().getAttribute("height"),10),l=Blockly.utils.getRelativeXY(this.svgBlockCanvas_);this.workspaceDragSurface_.setContentsAndShow(this.svgBlockCanvas_,this.svgBubbleCanvas_,t,e,o,this.scale),this.workspaceDragSurface_.translateSurface(l.x,l.y)}},Blockly.WorkspaceSvg.prototype.getBlockDragSurface=function(){return this.blockDragSurface_},Blockly.WorkspaceSvg.prototype.getWidth=function(){var t=this.getMetrics();return t?t.viewWidth/this.scale:0},Blockly.WorkspaceSvg.prototype.setVisible=function(t){if(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&(this.toolbox_.HtmlDiv.style.display=t?"block":"none"),t){for(var e=this.getAllBlocks(!1),o=e.length-1;0<=o;o--)e[o].markDirty();this.render(),this.toolbox_&&this.toolbox_.position()}else Blockly.hideChaff(!0);this.isVisible_=t},Blockly.WorkspaceSvg.prototype.render=function(){for(var t=this.getAllBlocks(!1),e=t.length-1;0<=e;e--)t[e].render(!1);if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),e=0;e<t.length;e++)t[e].render(!1)},Blockly.WorkspaceSvg.prototype.traceOn=function(){console.warn("Deprecated call to traceOn, delete this.")},Blockly.WorkspaceSvg.prototype.highlightBlock=function(t,e){if(void 0===e){for(var o,l=0;o=this.highlightedBlocks_[l];l++)o.setHighlighted(!1);this.highlightedBlocks_.length=0}(o=t?this.getBlockById(t):null)&&((l=void 0===e||e)?-1==this.highlightedBlocks_.indexOf(o)&&this.highlightedBlocks_.push(o):Blockly.utils.arrayRemove(this.highlightedBlocks_,o),o.setHighlighted(l))},Blockly.WorkspaceSvg.prototype.paste=function(t){!this.rendered||t.getElementsByTagName("block").length>=this.remainingCapacity()||(this.currentGesture_&&this.currentGesture_.cancel(),"comment"==t.tagName.toLowerCase()?this.pasteWorkspaceComment_(t):this.pasteBlock_(t))},Blockly.WorkspaceSvg.prototype.pasteBlock_=function(t){Blockly.Events.disable();try{var e=Blockly.Xml.domToBlock(t,this),o=this.getMarker().getCurNode();if(Blockly.keyboardAccessibilityMode&&o)return void Blockly.navigation.insertBlock(e,o.getLocation());var l=parseInt(t.getAttribute("x"),10),i=parseInt(t.getAttribute("y"),10);if(!isNaN(l)&&!isNaN(i)){this.RTL&&(l=-l);do{t=!1;var n,r=this.getAllBlocks(!1);for(o=0;n=r[o];o++){var s=n.getRelativeToSurfaceXY();if(1>=Math.abs(l-s.x)&&1>=Math.abs(i-s.y)){t=!0;break}}if(!t){var c,a=e.getConnections_(!1);for(o=0;c=a[o];o++)if(c.closest(Blockly.SNAP_RADIUS,new Blockly.utils.Coordinate(l,i)).connection){t=!0;break}}t&&(l=this.RTL?l-Blockly.SNAP_RADIUS:l+Blockly.SNAP_RADIUS,i+=2*Blockly.SNAP_RADIUS)}while(t);e.moveBy(l,i)}}finally{Blockly.Events.enable()}Blockly.Events.isEnabled()&&!e.isShadow()&&Blockly.Events.fire(new Blockly.Events.BlockCreate(e)),e.select()},Blockly.WorkspaceSvg.prototype.pasteWorkspaceComment_=function(t){Blockly.Events.disable();try{var e=Blockly.WorkspaceCommentSvg.fromXml(t,this),o=parseInt(t.getAttribute("x"),10),l=parseInt(t.getAttribute("y"),10);isNaN(o)||isNaN(l)||(this.RTL&&(o=-o),e.moveBy(o+50,l+50))}finally{Blockly.Events.enable()}Blockly.Events.isEnabled(),e.select()},Blockly.WorkspaceSvg.prototype.refreshToolboxSelection=function(){var t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.flyout_&&t.toolbox_.refreshSelection()},Blockly.WorkspaceSvg.prototype.renameVariableById=function(t,e){Blockly.WorkspaceSvg.superClass_.renameVariableById.call(this,t,e),this.refreshToolboxSelection()},Blockly.WorkspaceSvg.prototype.deleteVariableById=function(t){Blockly.WorkspaceSvg.superClass_.deleteVariableById.call(this,t),this.refreshToolboxSelection()},Blockly.WorkspaceSvg.prototype.createVariable=function(t,e,o){return t=Blockly.WorkspaceSvg.superClass_.createVariable.call(this,t,e,o),this.refreshToolboxSelection(),t},Blockly.WorkspaceSvg.prototype.recordDeleteAreas=function(){this.deleteAreaTrash_=this.trashcan&&this.svgGroup_.parentNode?this.trashcan.getClientRect():null,this.deleteAreaToolbox_=this.flyout_?this.flyout_.getClientRect():this.toolbox_?this.toolbox_.getClientRect():null},Blockly.WorkspaceSvg.prototype.isDeleteArea=function(t){return this.deleteAreaTrash_&&this.deleteAreaTrash_.contains(t.clientX,t.clientY)?Blockly.DELETE_AREA_TRASH:this.deleteAreaToolbox_&&this.deleteAreaToolbox_.contains(t.clientX,t.clientY)?Blockly.DELETE_AREA_TOOLBOX:Blockly.DELETE_AREA_NONE},Blockly.WorkspaceSvg.prototype.onMouseDown_=function(t){var e=this.getGesture(t);e&&e.handleWsStart(t,this)},Blockly.WorkspaceSvg.prototype.startDrag=function(t,e){var o=Blockly.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM());o.x/=this.scale,o.y/=this.scale,this.dragDeltaXY_=Blockly.utils.Coordinate.difference(e,o)},Blockly.WorkspaceSvg.prototype.moveDrag=function(t){return(t=Blockly.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM())).x/=this.scale,t.y/=this.scale,Blockly.utils.Coordinate.sum(this.dragDeltaXY_,t)},Blockly.WorkspaceSvg.prototype.isDragging=function(){return null!=this.currentGesture_&&this.currentGesture_.isDragging()},Blockly.WorkspaceSvg.prototype.isDraggable=function(){return this.options.moveOptions&&this.options.moveOptions.drag},Blockly.WorkspaceSvg.prototype.isContentBounded=function(){return this.options.moveOptions&&this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.controls||this.options.zoomOptions&&this.options.zoomOptions.wheel},Blockly.WorkspaceSvg.prototype.isMovable=function(){return this.options.moveOptions&&this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel},Blockly.WorkspaceSvg.prototype.onMouseWheel_=function(t){if(Blockly.Gesture.inProgress())t.preventDefault(),t.stopPropagation();else{var e=this.options.zoomOptions&&this.options.zoomOptions.wheel,o=this.options.moveOptions&&this.options.moveOptions.wheel;if(e||o){var l=Blockly.utils.getScrollDeltaPixels(t);!e||!t.ctrlKey&&o?(e=this.scrollX-l.x,o=this.scrollY-l.y,t.shiftKey&&!l.x&&(e=this.scrollX-l.y,o=this.scrollY),this.scroll(e,o)):(l=-l.y/50,e=Blockly.utils.mouseToSvg(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(e.x,e.y,l)),t.preventDefault()}}},Blockly.WorkspaceSvg.prototype.getBlocksBoundingBox=function(){var t=this.getTopBlocks(!1),e=this.getTopComments(!1);if(!(t=t.concat(e)).length)return new Blockly.utils.Rect(0,0,0,0);e=t[0].getBoundingRectangle();for(var o=1;o<t.length;o++){var l=t[o].getBoundingRectangle();l.top<e.top&&(e.top=l.top),l.bottom>e.bottom&&(e.bottom=l.bottom),l.left<e.left&&(e.left=l.left),l.right>e.right&&(e.right=l.right)}return e},Blockly.WorkspaceSvg.prototype.cleanUp=function(){this.setResizesEnabled(!1),Blockly.Events.setGroup(!0);for(var t,e=this.getTopBlocks(!0),o=0,l=0;t=e[l];l++)if(t.isMovable()){var i=t.getRelativeToSurfaceXY();t.moveBy(-i.x,o-i.y),t.snapToGrid(),o=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+Blockly.BlockSvg.MIN_BLOCK_Y}Blockly.Events.setGroup(!1),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.prototype.showContextMenu_=function(t){function e(t){if(t.isDeletable())p=p.concat(t.getDescendants(!1));else{t=t.getChildren(!1);for(var o=0;o<t.length;o++)e(t[o])}}function o(){Blockly.Events.setGroup(n);var t=p.shift();t&&(t.workspace?(t.dispose(!1,!0),setTimeout(o,10)):o()),Blockly.Events.setGroup(!1)}if(!this.options.readOnly&&!this.isFlyout){var l=[],i=this.getTopBlocks(!0),n=Blockly.utils.genUid(),r=this,s={};if(s.text=Blockly.Msg.UNDO,s.enabled=0<this.undoStack_.length,s.callback=this.undo.bind(this,!1),l.push(s),(s={}).text=Blockly.Msg.REDO,s.enabled=0<this.redoStack_.length,s.callback=this.undo.bind(this,!0),l.push(s),this.isMovable()&&((s={}).text=Blockly.Msg.CLEAN_UP,s.enabled=1<i.length,s.callback=this.cleanUp.bind(this),l.push(s)),this.options.collapse){for(var c=s=!1,a=0;a<i.length;a++)for(var u=i[a];u;)u.isCollapsed()?s=!0:c=!0,u=u.getNextBlock();var h=function(t){for(var e=0,o=0;o<i.length;o++)for(var l=i[o];l;)setTimeout(l.setCollapsed.bind(l,t),e),l=l.getNextBlock(),e+=10};(c={enabled:c}).text=Blockly.Msg.COLLAPSE_ALL,c.callback=function(){h(!0)},l.push(c),(s={enabled:s}).text=Blockly.Msg.EXPAND_ALL,s.callback=function(){h(!1)},l.push(s)}var p=[];for(a=0;a<i.length;a++)e(i[a]);s={text:1==p.length?Blockly.Msg.DELETE_BLOCK:Blockly.Msg.DELETE_X_BLOCKS.replace("%1",String(p.length)),enabled:0<p.length,callback:function(){r.currentGesture_&&r.currentGesture_.cancel(),2>p.length?o():Blockly.confirm(Blockly.Msg.DELETE_ALL_BLOCKS.replace("%1",p.length),(function(t){t&&o()}))}},l.push(s),this.configureContextMenu&&this.configureContextMenu(l),Blockly.ContextMenu.show(t,l,this.RTL)}},Blockly.WorkspaceSvg.prototype.updateToolbox=function(t){if(t=Blockly.Options.parseToolboxTree(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(t.getElementsByTagName("category").length){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.renderTree(t)}else{if(!this.flyout_)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout_.show(t.childNodes)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")},Blockly.WorkspaceSvg.prototype.markFocused=function(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(Blockly.mainWorkspace=this,this.setBrowserFocus())},Blockly.WorkspaceSvg.prototype.setBrowserFocus=function(){document.activeElement&&document.activeElement.blur();try{this.getParentSvg().focus()}catch(t){try{this.getParentSvg().parentNode.setActive()}catch(e){this.getParentSvg().parentNode.focus()}}},Blockly.WorkspaceSvg.prototype.zoom=function(t,e,o){if(!this.isFlyout&&!this.isMutator){o=Math.pow(this.options.zoomOptions.scaleSpeed,o);var l=this.scale*o;if(this.scale!=l){l>this.options.zoomOptions.maxScale?o=this.options.zoomOptions.maxScale/this.scale:l<this.options.zoomOptions.minScale&&(o=this.options.zoomOptions.minScale/this.scale);var i=this.getCanvas().getCTM(),n=this.getParentSvg().createSVGPoint();n.x=t,n.y=e,n=n.matrixTransform(i.inverse()),i=i.translate((t=n.x)*(1-o),(e=n.y)*(1-o)).scale(o),this.scrollX=i.e,this.scrollY=i.f,this.setScale(l)}}},Blockly.WorkspaceSvg.prototype.zoomCenter=function(t){var e=this.getMetrics();if(this.flyout_){var o=e.svgWidth/2;e=e.svgHeight/2}else o=e.viewWidth/2+e.absoluteLeft,e=e.viewHeight/2+e.absoluteTop;this.zoom(o,e,t)},Blockly.WorkspaceSvg.prototype.zoomToFit=function(){if(this.isMovable()){var t=this.getMetrics(),e=t.viewWidth;t=t.viewHeight;var o=this.getBlocksBoundingBox(),l=o.right-o.left;o=o.bottom-o.top,l&&(this.flyout_&&(this.horizontalLayout?(t+=this.flyout_.height_,o+=this.flyout_.height_/this.scale):(e+=this.flyout_.getWidth(),l+=this.flyout_.getWidth()/this.scale)),this.setScale(Math.min(e/l,t/o)),this.scrollCenter())}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},Blockly.WorkspaceSvg.prototype.beginCanvasTransition=function(){Blockly.utils.dom.addClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),Blockly.utils.dom.addClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},Blockly.WorkspaceSvg.prototype.endCanvasTransition=function(){Blockly.utils.dom.removeClass(this.svgBlockCanvas_,"blocklyCanvasTransitioning"),Blockly.utils.dom.removeClass(this.svgBubbleCanvas_,"blocklyCanvasTransitioning")},Blockly.WorkspaceSvg.prototype.scrollCenter=function(){if(this.isMovable()){var t=this.getMetrics(),e=(t.contentWidth-t.viewWidth)/2,o=(t.contentHeight-t.viewHeight)/2;this.scroll(e=-e-t.contentLeft,o=-o-t.contentTop)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},Blockly.WorkspaceSvg.prototype.centerOnBlock=function(t){if(this.isMovable()){if(t=this.getBlockById(t)){var e=t.getRelativeToSurfaceXY(),o=t.getHeightWidth(),l=this.scale;t=(e.x+(this.RTL?-1:1)*o.width/2)*l,e=(e.y+o.height/2)*l,t=-(t-(o=this.getMetrics()).contentLeft-o.viewWidth/2)-o.contentLeft,e=-(e-o.contentTop-o.viewHeight/2)-o.contentTop,Blockly.hideChaff(),this.scroll(t,e)}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")},Blockly.WorkspaceSvg.prototype.setScale=function(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,Blockly.hideChaff(!1),this.flyout_&&(this.flyout_.reflow(),this.recordDeleteAreas()),this.grid_&&this.grid_.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout_?(this.scrollbar.hScroll.resizeViewHorizontal(t),this.scrollbar.vScroll.resizeViewVertical(t)):(this.scrollbar.hScroll.resizeContentHorizontal(t),this.scrollbar.vScroll.resizeContentVertical(t)))},Blockly.WorkspaceSvg.prototype.scroll=function(t,e){Blockly.hideChaff(!0);var o=this.getMetrics(),l=o.contentWidth+o.contentLeft-o.viewWidth,i=o.contentHeight+o.contentTop-o.viewHeight;t=Math.min(t,-o.contentLeft),e=Math.min(e,-o.contentTop),t=Math.max(t,-l),e=Math.max(e,-i),this.scrollX=t,this.scrollY=e,this.scrollbar&&(this.scrollbar.hScroll.setHandlePosition(-(t+o.contentLeft)*this.scrollbar.hScroll.ratio_),this.scrollbar.vScroll.setHandlePosition(-(e+o.contentTop)*this.scrollbar.vScroll.ratio_)),this.translate(t+=o.absoluteLeft,e+=o.absoluteTop)},Blockly.WorkspaceSvg.getDimensionsPx_=function(t){var e=0,o=0;return t&&(e=t.getWidth(),o=t.getHeight()),{width:e,height:o}},Blockly.WorkspaceSvg.getContentDimensions_=function(t,e){return t.isContentBounded()?Blockly.WorkspaceSvg.getContentDimensionsBounded_(t,e):Blockly.WorkspaceSvg.getContentDimensionsExact_(t)},Blockly.WorkspaceSvg.getContentDimensionsExact_=function(t){var e=t.getBlocksBoundingBox(),o=t.scale,l=e.bottom*o,i=e.left*o;return{top:t=e.top*o,bottom:l,left:i,right:e=e.right*o,width:e-i,height:l-t}},Blockly.WorkspaceSvg.getContentDimensionsBounded_=function(t,e){var o=Blockly.WorkspaceSvg.getContentDimensionsExact_(t),l=e.width,i=e.height,n=l/2,r=i/2,s=Math.min(o.left-n,o.right-l),c=Math.min(o.top-r,o.bottom-i);return{left:s,top:c,height:Math.max(o.bottom+r,o.top+i)-c,width:Math.max(o.right+n,o.left+l)-s}},Blockly.WorkspaceSvg.getTopLevelWorkspaceMetrics_=function(){var t=Blockly.WorkspaceSvg.getDimensionsPx_(this.toolbox_),e=Blockly.WorkspaceSvg.getDimensionsPx_(this.flyout_),o=Blockly.svgSize(this.getParentSvg()),l={height:o.height,width:o.width};this.toolbox_?this.toolboxPosition==Blockly.TOOLBOX_AT_TOP||this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?l.height-=t.height:this.toolboxPosition!=Blockly.TOOLBOX_AT_LEFT&&this.toolboxPosition!=Blockly.TOOLBOX_AT_RIGHT||(l.width-=t.width):this.flyout_&&(this.toolboxPosition==Blockly.TOOLBOX_AT_TOP||this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?l.height-=e.height:this.toolboxPosition!=Blockly.TOOLBOX_AT_LEFT&&this.toolboxPosition!=Blockly.TOOLBOX_AT_RIGHT||(l.width-=e.width));var i=Blockly.WorkspaceSvg.getContentDimensions_(this,l),n=0;this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT?n=t.width:this.flyout_&&this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT&&(n=e.width);var r=0;return this.toolbox_&&this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?r=t.height:this.flyout_&&this.toolboxPosition==Blockly.TOOLBOX_AT_TOP&&(r=e.height),{contentHeight:i.height,contentWidth:i.width,contentTop:i.top,contentLeft:i.left,viewHeight:l.height,viewWidth:l.width,viewTop:-this.scrollY,viewLeft:-this.scrollX,absoluteTop:r,absoluteLeft:n,svgHeight:o.height,svgWidth:o.width,toolboxWidth:t.width,toolboxHeight:t.height,flyoutWidth:e.width,flyoutHeight:e.height,toolboxPosition:this.toolboxPosition}},Blockly.WorkspaceSvg.setTopLevelWorkspaceMetrics_=function(t){var e=this.getMetrics();"number"==typeof t.x&&(this.scrollX=-e.contentWidth*t.x-e.contentLeft),"number"==typeof t.y&&(this.scrollY=-e.contentHeight*t.y-e.contentTop),this.translate(this.scrollX+e.absoluteLeft,this.scrollY+e.absoluteTop)},Blockly.WorkspaceSvg.prototype.setResizesEnabled=function(t){var e=!this.resizesEnabled_&&t;this.resizesEnabled_=t,e&&this.resizeContents()},Blockly.WorkspaceSvg.prototype.clear=function(){this.setResizesEnabled(!1),Blockly.WorkspaceSvg.superClass_.clear.call(this),this.setResizesEnabled(!0)},Blockly.WorkspaceSvg.prototype.registerButtonCallback=function(t,e){if("function"!=typeof e)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks_[t]=e},Blockly.WorkspaceSvg.prototype.getButtonCallback=function(t){return(t=this.flyoutButtonCallbacks_[t])?t:null},Blockly.WorkspaceSvg.prototype.removeButtonCallback=function(t){this.flyoutButtonCallbacks_[t]=null},Blockly.WorkspaceSvg.prototype.registerToolboxCategoryCallback=function(t,e){if("function"!=typeof e)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks_[t]=e},Blockly.WorkspaceSvg.prototype.getToolboxCategoryCallback=function(t){return this.toolboxCategoryCallbacks_[t]||null},Blockly.WorkspaceSvg.prototype.removeToolboxCategoryCallback=function(t){this.toolboxCategoryCallbacks_[t]=null},Blockly.WorkspaceSvg.prototype.getGesture=function(t){var e="mousedown"==t.type||"touchstart"==t.type||"pointerdown"==t.type,o=this.currentGesture_;return o?e&&o.hasStarted()?(console.warn("Tried to start the same gesture twice."),o.cancel(),null):o:e?this.currentGesture_=new Blockly.TouchGesture(t,this):null},Blockly.WorkspaceSvg.prototype.clearGesture=function(){this.currentGesture_=null},Blockly.WorkspaceSvg.prototype.cancelCurrentGesture=function(){this.currentGesture_&&this.currentGesture_.cancel()},Blockly.WorkspaceSvg.prototype.getAudioManager=function(){return this.audioManager_},Blockly.WorkspaceSvg.prototype.getGrid=function(){return this.grid_},Blockly.WorkspaceSvg.prototype.refreshTheme=function(){Blockly.WorkspaceSvg.superClass_.refreshTheme.call(this),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.updateColourFromTheme()},Blockly.inject=function(t,e){if(Blockly.checkBlockColourConstants(),"string"==typeof t&&(t=document.getElementById(t)||document.querySelector(t)),!Blockly.utils.dom.containsNode(document,t))throw Error("Error: container is not in current document.");var o=new Blockly.Options(e||{}),l=document.createElement("div");l.className="injectionDiv",t.appendChild(l);var i=Blockly.createDom_(l,o),n=new Blockly.BlockDragSurfaceSvg(l);return l=new Blockly.WorkspaceDragSurfaceSvg(l),i=Blockly.createMainWorkspace_(i,o,n,l),Blockly.user.keyMap.setKeyMap(o.keyMap),Blockly.init_(i),Blockly.mainWorkspace=i,Blockly.svgResize(i),i},Blockly.createDom_=function(t,e){t.setAttribute("dir","LTR"),Blockly.Component.defaultRightToLeft=e.RTL,Blockly.Css.inject(e.hasCss,e.pathToMedia);var o=Blockly.utils.dom.createSvgElement("svg",{xmlns:Blockly.utils.dom.SVG_NS,"xmlns:html":Blockly.utils.dom.HTML_NS,"xmlns:xlink":Blockly.utils.dom.XLINK_NS,version:"1.1",class:"blocklySvg"},t),l=Blockly.utils.dom.createSvgElement("defs",{},o),i=String(Math.random()).substring(2),n=Blockly.utils.dom.createSvgElement("filter",{id:"blocklyEmbossFilter"+i},l);Blockly.utils.dom.createSvgElement("feGaussianBlur",{in:"SourceAlpha",stdDeviation:1,result:"blur"},n);var r=Blockly.utils.dom.createSvgElement("feSpecularLighting",{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},n);return Blockly.utils.dom.createSvgElement("fePointLight",{x:-5e3,y:-1e4,z:2e4},r),Blockly.utils.dom.createSvgElement("feComposite",{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},n),Blockly.utils.dom.createSvgElement("feComposite",{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},n),e.embossFilterId=n.id,n=Blockly.utils.dom.createSvgElement("pattern",{id:"blocklyDisabledPattern"+i,patternUnits:"userSpaceOnUse",width:10,height:10},l),Blockly.utils.dom.createSvgElement("rect",{width:10,height:10,fill:"#aaa"},n),Blockly.utils.dom.createSvgElement("path",{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},n),e.disabledPatternId=n.id,e.gridPattern=Blockly.Grid.createDom(i,e.gridOptions,l),o},Blockly.createMainWorkspace_=function(t,e,o,l){e.parentWorkspace=null;var i=new Blockly.WorkspaceSvg(e,o,l);return i.scale=e.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground")),!e.hasCategories&&e.languageTree&&(o=i.addFlyout_("svg"),Blockly.utils.dom.insertAfter(o,t)),e.hasTrashcan&&i.addTrashcan(),e.zoomOptions&&e.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspace","background-color"),i.translate(0,0),Blockly.mainWorkspace=i,e.readOnly||i.isMovable()||i.addChangeListener((function(t){if(!i.isDragging()&&!i.isMovable()&&-1!=Blockly.Events.BUMP_EVENTS.indexOf(t.type)){var e=Object.create(null),o=i.getMetrics(),l=i.scale;if(e.RTL=i.RTL,e.viewLeft=o.viewLeft/l,e.viewTop=o.viewTop/l,e.viewRight=(o.viewLeft+o.viewWidth)/l,e.viewBottom=(o.viewTop+o.viewHeight)/l,i.isContentBounded()?(o=i.getBlocksBoundingBox(),e.contentLeft=o.left,e.contentTop=o.top,e.contentRight=o.right,e.contentBottom=o.bottom):(e.contentLeft=o.contentLeft/l,e.contentTop=o.contentTop/l,e.contentRight=(o.contentLeft+o.contentWidth)/l,e.contentBottom=(o.contentTop+o.contentHeight)/l),e.contentTop<e.viewTop||e.contentBottom>e.viewBottom||e.contentLeft<e.viewLeft||e.contentRight>e.viewRight){switch(o=null,t&&(o=Blockly.Events.getGroup(),Blockly.Events.setGroup(t.group)),t.type){case Blockly.Events.BLOCK_CREATE:case Blockly.Events.BLOCK_MOVE:var n=i.getBlockById(t.blockId);n=n.getRootBlock();break;case Blockly.Events.COMMENT_CREATE:case Blockly.Events.COMMENT_MOVE:n=i.getCommentById(t.commentId)}if(n){(l=n.getBoundingRectangle()).height=l.bottom-l.top,l.width=l.right-l.left;var r=e.viewTop,s=e.viewBottom-l.height;s=Math.max(r,s),r=Blockly.utils.math.clamp(r,l.top,s)-l.top,s=e.viewLeft;var c=e.viewRight-l.width;e.RTL?s=Math.min(c,s):c=Math.max(s,c),e=Blockly.utils.math.clamp(s,l.left,c)-l.left,n.moveBy(e,r)}t&&(t.group||console.log("WARNING: Moved object in bounds but there was no event group. This may break undo."),null!==o&&Blockly.Events.setGroup(o))}}})),Blockly.svgResize(i),Blockly.WidgetDiv.createDom(),Blockly.DropDownDiv.createDom(),Blockly.Tooltip.createDom(),i},Blockly.init_=function(t){var e=t.options,o=t.getParentSvg();Blockly.bindEventWithChecks_(o.parentNode,"contextmenu",null,(function(t){Blockly.utils.isTargetInput(t)||t.preventDefault()})),o=Blockly.bindEventWithChecks_(window,"resize",null,(function(){Blockly.hideChaff(!0),Blockly.svgResize(t)})),t.setResizeHandlerWrapper(o),Blockly.inject.bindDocumentEvents_(),e.languageTree&&(t.toolbox_?t.toolbox_.init(t):t.flyout_&&(t.flyout_.init(t),t.flyout_.show(e.languageTree.childNodes),t.flyout_.scrollToStart())),o=Blockly.Scrollbar.scrollbarThickness,e.hasTrashcan&&(o=t.trashcan.init(o)),e.zoomOptions&&e.zoomOptions.controls&&t.zoomControls_.init(o),e.moveOptions&&e.moveOptions.scrollbars?(t.scrollbar=new Blockly.ScrollbarPair(t),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),e.hasSounds&&Blockly.inject.loadSounds_(e.pathToMedia,t)},Blockly.inject.bindDocumentEvents_=function(){Blockly.documentEventsBound_||(Blockly.bindEventWithChecks_(document,"scroll",null,(function(){for(var t,e=Blockly.Workspace.getAll(),o=0;t=e[o];o++)t.updateInverseScreenCTM&&t.updateInverseScreenCTM()})),Blockly.bindEventWithChecks_(document,"keydown",null,Blockly.onKeyDown_),Blockly.bindEvent_(document,"touchend",null,Blockly.longStop_),Blockly.bindEvent_(document,"touchcancel",null,Blockly.longStop_),Blockly.utils.userAgent.IPAD&&Blockly.bindEventWithChecks_(window,"orientationchange",document,(function(){Blockly.svgResize(Blockly.getMainWorkspace())}))),Blockly.documentEventsBound_=!0},Blockly.inject.loadSounds_=function(t,e){var o=e.getAudioManager();o.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),o.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),o.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");var l=[],i=function(){for(;l.length;)Blockly.unbindEvent_(l.pop());o.preload()};l.push(Blockly.bindEventWithChecks_(document,"mousemove",null,i,!0)),l.push(Blockly.bindEventWithChecks_(document,"touchstart",null,i,!0))},Blockly.Action=function(t,e){this.name=t,this.desc=e},Blockly.ASTNode=function(t,e,o){if(!e)throw Error("Cannot create a node without a location.");this.type_=t,this.isConnection_=Blockly.ASTNode.isConnectionType_(t),this.location_=e,this.processParams_(o||null)},Blockly.ASTNode.types={FIELD:"field",BLOCK:"block",INPUT:"input",OUTPUT:"output",NEXT:"next",PREVIOUS:"previous",STACK:"stack",WORKSPACE:"workspace"},Blockly.ASTNode.DEFAULT_OFFSET_Y=-20,Blockly.ASTNode.isConnectionType_=function(t){switch(t){case Blockly.ASTNode.types.PREVIOUS:case Blockly.ASTNode.types.NEXT:case Blockly.ASTNode.types.INPUT:case Blockly.ASTNode.types.OUTPUT:return!0}return!1},Blockly.ASTNode.createFieldNode=function(t){return new Blockly.ASTNode(Blockly.ASTNode.types.FIELD,t)},Blockly.ASTNode.createConnectionNode=function(t){return t?t.type==Blockly.INPUT_VALUE||t.type==Blockly.NEXT_STATEMENT&&t.getParentInput()?Blockly.ASTNode.createInputNode(t.getParentInput()):t.type==Blockly.NEXT_STATEMENT?new Blockly.ASTNode(Blockly.ASTNode.types.NEXT,t):t.type==Blockly.OUTPUT_VALUE?new Blockly.ASTNode(Blockly.ASTNode.types.OUTPUT,t):t.type==Blockly.PREVIOUS_STATEMENT?new Blockly.ASTNode(Blockly.ASTNode.types.PREVIOUS,t):null:null},Blockly.ASTNode.createInputNode=function(t){return t?new Blockly.ASTNode(Blockly.ASTNode.types.INPUT,t.connection):null},Blockly.ASTNode.createBlockNode=function(t){return new Blockly.ASTNode(Blockly.ASTNode.types.BLOCK,t)},Blockly.ASTNode.createStackNode=function(t){return new Blockly.ASTNode(Blockly.ASTNode.types.STACK,t)},Blockly.ASTNode.createWorkspaceNode=function(t,e){return new Blockly.ASTNode(Blockly.ASTNode.types.WORKSPACE,t,{wsCoordinate:e})},Blockly.ASTNode.prototype.processParams_=function(t){t&&t.wsCoordinate&&(this.wsCoordinate_=t.wsCoordinate)},Blockly.ASTNode.prototype.getLocation=function(){return this.location_},Blockly.ASTNode.prototype.getType=function(){return this.type_},Blockly.ASTNode.prototype.getWsCoordinate=function(){return this.wsCoordinate_},Blockly.ASTNode.prototype.isConnection=function(){return this.isConnection_},Blockly.ASTNode.prototype.findPreviousEditableField_=function(t,e,o){for(t=(e=e.fieldRow).indexOf(t),o=(o?e.length:t)-1;t=e[o];o--)if(t.EDITABLE)return Blockly.ASTNode.createFieldNode(e=t);return null},Blockly.ASTNode.prototype.findNextForInput_=function(){var t,e=this.location_.getParentInput(),o=e.getSourceBlock();for(e=o.inputList.indexOf(e)+1;t=o.inputList[e];e++){for(var l,i=t.fieldRow,n=0;l=i[n];n++)if(l.EDITABLE)return Blockly.ASTNode.createFieldNode(l);if(t.connection)return Blockly.ASTNode.createInputNode(t)}return null},Blockly.ASTNode.prototype.findNextForField_=function(){var t=this.location_,e=t.getParentInput(),o=t.getSourceBlock(),l=o.inputList.indexOf(e);for(t=e.fieldRow.indexOf(t)+1;e=o.inputList[l];l++){for(var i=e.fieldRow;t<i.length;){if(i[t].EDITABLE)return Blockly.ASTNode.createFieldNode(i[t]);t++}if(t=0,e.connection)return Blockly.ASTNode.createInputNode(e)}return null},Blockly.ASTNode.prototype.findPrevForInput_=function(){for(var t,e=this.location_.getParentInput(),o=e.getSourceBlock(),l=o.inputList.indexOf(e);t=o.inputList[l];l--){if(t.connection&&t!==e)return Blockly.ASTNode.createInputNode(t);for(var i,n=(t=t.fieldRow).length-1;i=t[n];n--)if(i.EDITABLE)return Blockly.ASTNode.createFieldNode(i)}return null},Blockly.ASTNode.prototype.findPrevForField_=function(){var t,e=this.location_,o=e.getParentInput(),l=e.getSourceBlock(),i=l.inputList.indexOf(o);for(e=o.fieldRow.indexOf(e)-1;t=l.inputList[i];i--){if(t.connection&&t!==o)return Blockly.ASTNode.createInputNode(t);for(t=t.fieldRow;-1<e;){if(t[e].EDITABLE)return Blockly.ASTNode.createFieldNode(t[e]);e--}0<=i-1&&(e=l.inputList[i-1].fieldRow.length-1)}return null},Blockly.ASTNode.prototype.navigateBetweenStacks_=function(t){var e=this.getLocation();if(e instanceof Blockly.Block||(e=e.getSourceBlock()),!e||!e.workspace)return null;var o=e.getRootBlock();e=o.workspace.getTopBlocks(!0);for(var l,i=0;l=e[i];i++)if(o.id==l.id)return-1==(t=i+(t?1:-1))||t==e.length?null:Blockly.ASTNode.createStackNode(e[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")},Blockly.ASTNode.prototype.findTopASTNodeForBlock_=function(t){var e=t.previousConnection||t.outputConnection;return e?Blockly.ASTNode.createConnectionNode(e):Blockly.ASTNode.createBlockNode(t)},Blockly.ASTNode.prototype.getOutAstNodeForBlock_=function(t){if(!t)return null;var e=(t=t.getTopStackBlock()).previousConnection||t.outputConnection;return e&&e.targetConnection&&e.targetConnection.getParentInput()?Blockly.ASTNode.createInputNode(e.targetConnection.getParentInput()):Blockly.ASTNode.createStackNode(t)},Blockly.ASTNode.prototype.findFirstFieldOrInput_=function(t){t=t.inputList;for(var e,o=0;e=t[o];o++){for(var l,i=e.fieldRow,n=0;l=i[n];n++)if(l.EDITABLE)return Blockly.ASTNode.createFieldNode(l);if(e.connection)return Blockly.ASTNode.createInputNode(e)}return null},Blockly.ASTNode.prototype.next=function(){switch(this.type_){case Blockly.ASTNode.types.STACK:return this.navigateBetweenStacks_(!0);case Blockly.ASTNode.types.OUTPUT:return Blockly.ASTNode.createBlockNode(this.location_.getSourceBlock());case Blockly.ASTNode.types.FIELD:return this.findNextForField_();case Blockly.ASTNode.types.INPUT:return this.findNextForInput_();case Blockly.ASTNode.types.BLOCK:var t=this.location_.nextConnection;if(t)return Blockly.ASTNode.createConnectionNode(t);break;case Blockly.ASTNode.types.PREVIOUS:return Blockly.ASTNode.createBlockNode(this.location_.getSourceBlock());case Blockly.ASTNode.types.NEXT:if(t=this.location_.targetConnection)return Blockly.ASTNode.createConnectionNode(t)}return null},Blockly.ASTNode.prototype.in=function(){switch(this.type_){case Blockly.ASTNode.types.WORKSPACE:var t=this.location_.getTopBlocks(!0);if(0<t.length)return Blockly.ASTNode.createStackNode(t[0]);break;case Blockly.ASTNode.types.STACK:return this.findTopASTNodeForBlock_(this.location_);case Blockly.ASTNode.types.BLOCK:return this.findFirstFieldOrInput_(this.location_);case Blockly.ASTNode.types.INPUT:if(t=this.location_.targetConnection)return Blockly.ASTNode.createConnectionNode(t)}return null},Blockly.ASTNode.prototype.prev=function(){switch(this.type_){case Blockly.ASTNode.types.STACK:return this.navigateBetweenStacks_(!1);case Blockly.ASTNode.types.FIELD:return this.findPrevForField_();case Blockly.ASTNode.types.INPUT:return this.findPrevForInput_();case Blockly.ASTNode.types.BLOCK:var t=this.location_.outputConnection;if(t=this.location_.previousConnection||t)return Blockly.ASTNode.createConnectionNode(t);break;case Blockly.ASTNode.types.PREVIOUS:if((t=this.location_.targetConnection)&&!t.getParentInput())return Blockly.ASTNode.createConnectionNode(t);break;case Blockly.ASTNode.types.NEXT:return Blockly.ASTNode.createBlockNode(this.location_.getSourceBlock())}return null},Blockly.ASTNode.prototype.out=function(){switch(this.type_){case Blockly.ASTNode.types.STACK:var t=this.location_.getRelativeToSurfaceXY();return t=new Blockly.utils.Coordinate(t.x,t.y+Blockly.ASTNode.DEFAULT_OFFSET_Y),Blockly.ASTNode.createWorkspaceNode(this.location_.workspace,t);case Blockly.ASTNode.types.OUTPUT:return(t=this.location_.targetConnection)?Blockly.ASTNode.createConnectionNode(t):Blockly.ASTNode.createStackNode(this.location_.getSourceBlock());case Blockly.ASTNode.types.FIELD:case Blockly.ASTNode.types.INPUT:return Blockly.ASTNode.createBlockNode(this.location_.getSourceBlock());case Blockly.ASTNode.types.BLOCK:return this.getOutAstNodeForBlock_(this.location_);case Blockly.ASTNode.types.PREVIOUS:case Blockly.ASTNode.types.NEXT:return this.getOutAstNodeForBlock_(this.location_.getSourceBlock())}return null},Blockly.utils.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS_SIGN:43,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,FF_DASH:173,FF_HASH:163,QUESTION_MARK:63,AT_SIGN:64,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,MAC_WK_CMD_LEFT:91,MAC_WK_CMD_RIGHT:93,WIN_IME:229,VK_NONAME:252,PHANTOM:255},Blockly.user={},Blockly.user.keyMap={},Blockly.user.keyMap.map_={},Blockly.user.keyMap.modifierKeys={SHIFT:"Shift",CONTROL:"Control",ALT:"Alt",META:"Meta"},Blockly.user.keyMap.setActionForKey=function(t,e){var o=Blockly.user.keyMap.getKeyByAction(e);o&&delete Blockly.user.keyMap.map_[o],Blockly.user.keyMap.map_[t]=e},Blockly.user.keyMap.setKeyMap=function(t){Blockly.user.keyMap.map_=t},Blockly.user.keyMap.getKeyMap=function(){var t={};return Blockly.utils.object.mixin(t,Blockly.user.keyMap.map_),t},Blockly.user.keyMap.getActionByKeyCode=function(t){return Blockly.user.keyMap.map_[t]},Blockly.user.keyMap.getKeyByAction=function(t){for(var e,o=Object.keys(Blockly.user.keyMap.map_),l=0;e=o[l];l++)if(Blockly.user.keyMap.map_[e].name===t.name)return e;return null},Blockly.user.keyMap.serializeKeyEvent=function(t){for(var e,o=Blockly.utils.object.values(Blockly.user.keyMap.modifierKeys),l="",i=0;e=o[i];i++)t.getModifierState(e)&&(l+=e);return l+t.keyCode},Blockly.user.keyMap.createSerializedKey=function(t,e){for(var o,l="",i=Blockly.utils.object.values(Blockly.user.keyMap.modifierKeys),n=0;o=e[n];n++){if(!(-1<i.indexOf(o)))throw Error(o+" is not a valid modifier key.");l+=o}return l+t},Blockly.user.keyMap.createDefaultKeyMap=function(){var t={},e=Blockly.user.keyMap.createSerializedKey(Blockly.utils.KeyCodes.K,[Blockly.user.keyMap.modifierKeys.CONTROL]);return t[Blockly.utils.KeyCodes.W]=Blockly.navigation.ACTION_PREVIOUS,t[Blockly.utils.KeyCodes.A]=Blockly.navigation.ACTION_OUT,t[Blockly.utils.KeyCodes.S]=Blockly.navigation.ACTION_NEXT,t[Blockly.utils.KeyCodes.D]=Blockly.navigation.ACTION_IN,t[Blockly.utils.KeyCodes.I]=Blockly.navigation.ACTION_INSERT,t[Blockly.utils.KeyCodes.ENTER]=Blockly.navigation.ACTION_MARK,t[Blockly.utils.KeyCodes.X]=Blockly.navigation.ACTION_DISCONNECT,t[Blockly.utils.KeyCodes.T]=Blockly.navigation.ACTION_TOOLBOX,t[Blockly.utils.KeyCodes.E]=Blockly.navigation.ACTION_EXIT,t[Blockly.utils.KeyCodes.ESC]=Blockly.navigation.ACTION_EXIT,t[e]=Blockly.navigation.ACTION_TOGGLE_KEYBOARD_NAV,t},Blockly.navigation={},Blockly.navigation.loggingCallback=null,Blockly.navigation.STATE_FLYOUT=1,Blockly.navigation.STATE_WS=2,Blockly.navigation.STATE_TOOLBOX=3,Blockly.navigation.currentState_=Blockly.navigation.STATE_WS,Blockly.navigation.actionNames={PREVIOUS:"previous",NEXT:"next",IN:"in",OUT:"out",INSERT:"insert",MARK:"mark",DISCONNECT:"disconnect",TOOLBOX:"toolbox",EXIT:"exit",TOGGLE_KEYBOARD_NAV:"toggle_keyboard_nav"},Blockly.navigation.focusToolbox_=function(){var t=Blockly.getMainWorkspace(),e=t.getToolbox();e&&(Blockly.navigation.currentState_=Blockly.navigation.STATE_TOOLBOX,Blockly.navigation.resetFlyout_(!1),t.getMarker().getCurNode()||Blockly.navigation.markAtCursor_(),e.selectFirstCategory())},Blockly.navigation.focusFlyout_=function(){Blockly.navigation.currentState_=Blockly.navigation.STATE_FLYOUT;var t=Blockly.getMainWorkspace(),e=t.getToolbox();e=e?e.flyout_:t.getFlyout(),t.getMarker().getCurNode()||Blockly.navigation.markAtCursor_(),e&&e.getWorkspace()&&0<(t=e.getWorkspace().getTopBlocks(!0)).length&&(t=Blockly.ASTNode.createStackNode(t=t[0]),Blockly.navigation.getFlyoutCursor_().setCurNode(t))},Blockly.navigation.focusWorkspace_=function(){Blockly.hideChaff();var t=Blockly.getMainWorkspace(),e=t.getCursor(),o=!!t.getToolbox(),l=t.getTopBlocks(!0);Blockly.navigation.resetFlyout_(o),Blockly.navigation.currentState_=Blockly.navigation.STATE_WS,0<l.length?e.setCurNode(Blockly.navigation.getTopNode(l[0])):(o=new Blockly.utils.Coordinate(100,100),t=Blockly.ASTNode.createWorkspaceNode(t,o),e.setCurNode(t))},Blockly.navigation.getFlyoutCursor_=function(){var t=Blockly.getMainWorkspace(),e=null;return t.rendered&&(e=(t=(e=t.getToolbox())?e.flyout_:t.getFlyout())?t.workspace_.getCursor():null),e},Blockly.navigation.insertFromFlyout=function(){var t=Blockly.getMainWorkspace(),e=t.getFlyout();if(e&&e.isVisible()){var o=Blockly.navigation.getFlyoutCursor_().getCurNode().getLocation();o.isEnabled()?((e=e.createBlock(o)).render(),e.setConnectionsHidden(!1),t.getCursor().setCurNode(Blockly.ASTNode.createBlockNode(e)),Blockly.navigation.modify_()||Blockly.navigation.warn_("Something went wrong while inserting a block from the flyout."),Blockly.navigation.focusWorkspace_(),t.getCursor().setCurNode(Blockly.navigation.getTopNode(e)),Blockly.navigation.removeMark_()):Blockly.navigation.warn_("Can't insert a disabled block.")}else Blockly.navigation.warn_("Trying to insert from the flyout when the flyout does not  exist or is not visible")},Blockly.navigation.resetFlyout_=function(t){Blockly.navigation.getFlyoutCursor_()&&(Blockly.navigation.getFlyoutCursor_().hide(),t&&Blockly.getMainWorkspace().getFlyout().hide())},Blockly.navigation.modifyWarn_=function(){var t=Blockly.getMainWorkspace().getMarker().getCurNode(),e=Blockly.getMainWorkspace().getCursor().getCurNode();return t?e?(t=t.getType(),e=e.getType(),t==Blockly.ASTNode.types.FIELD?(Blockly.navigation.warn_("Should not have been able to mark a field."),!1):t==Blockly.ASTNode.types.BLOCK?(Blockly.navigation.warn_("Should not have been able to mark a block."),!1):t==Blockly.ASTNode.types.STACK?(Blockly.navigation.warn_("Should not have been able to mark a stack."),!1):e==Blockly.ASTNode.types.FIELD?(Blockly.navigation.warn_("Cannot attach a field to anything else."),!1):e!=Blockly.ASTNode.types.WORKSPACE||(Blockly.navigation.warn_("Cannot attach a workspace to anything else."),!1)):(Blockly.navigation.warn_("Cannot insert with no cursor node."),!1):(Blockly.navigation.warn_("Cannot insert with no marked node."),!1)},Blockly.navigation.moveBlockToWorkspace_=function(t,e){return t.isShadow()?(Blockly.navigation.warn_("Cannot move a shadow block to the workspace."),!1):(t.getParent()&&t.unplug(!1),t.moveTo(e.getWsCoordinate()),!0)},Blockly.navigation.modify_=function(){var t=Blockly.getMainWorkspace().getMarker().getCurNode(),e=Blockly.getMainWorkspace().getCursor().getCurNode();if(!Blockly.navigation.modifyWarn_())return!1;var o=t.getType(),l=e.getType(),i=e.getLocation(),n=t.getLocation();return t.isConnection()&&e.isConnection()?Blockly.navigation.connect_(i,n):!t.isConnection()||l!=Blockly.ASTNode.types.BLOCK&&l!=Blockly.ASTNode.types.STACK?o==Blockly.ASTNode.types.WORKSPACE?(e=Blockly.navigation.getSourceBlock_(e),Blockly.navigation.moveBlockToWorkspace_(e,t)):(Blockly.navigation.warn_("Unexpected state in Blockly.navigation.modify_."),!1):Blockly.navigation.insertBlock(i,n)},Blockly.navigation.disconnectChild_=function(t,e){var o=t.getSourceBlock(),l=e.getSourceBlock();o.getRootBlock()==l.getRootBlock()&&(-1<o.getDescendants(!1).indexOf(l)?Blockly.navigation.getInferiorConnection_(e).disconnect():Blockly.navigation.getInferiorConnection_(t).disconnect())},Blockly.navigation.moveAndConnect_=function(t,e){if(!t||!e)return!1;var o=t.getSourceBlock();return e.canConnectWithReason_(t)==Blockly.Connection.CAN_CONNECT&&(Blockly.navigation.disconnectChild_(t,e),e.isSuperior()||o.getRootBlock().positionNearConnection(t,e),e.connect(t),!0)},Blockly.navigation.getInferiorConnection_=function(t){var e=t.getSourceBlock();return t.isSuperior()?e.previousConnection?e.previousConnection:e.outputConnection?e.outputConnection:null:t},Blockly.navigation.getSuperiorConnection_=function(t){return t.isSuperior()?t:t.targetConnection?t.targetConnection:null},Blockly.navigation.connect_=function(t,e){if(!t||!e)return!1;var o=Blockly.navigation.getInferiorConnection_(t),l=Blockly.navigation.getSuperiorConnection_(e),i=Blockly.navigation.getSuperiorConnection_(t),n=Blockly.navigation.getInferiorConnection_(e);if(o&&l&&Blockly.navigation.moveAndConnect_(o,l)||i&&n&&Blockly.navigation.moveAndConnect_(i,n)||Blockly.navigation.moveAndConnect_(t,e))return!0;try{e.checkConnection_(t)}catch(r){Blockly.navigation.warn_("Connection failed with error: "+r)}return!1},Blockly.navigation.insertBlock=function(t,e){switch(e.type){case Blockly.PREVIOUS_STATEMENT:if(Blockly.navigation.connect_(t.nextConnection,e))return!0;break;case Blockly.NEXT_STATEMENT:if(Blockly.navigation.connect_(t.previousConnection,e))return!0;break;case Blockly.INPUT_VALUE:if(Blockly.navigation.connect_(t.outputConnection,e))return!0;break;case Blockly.OUTPUT_VALUE:for(var o=0;o<t.inputList.length;o++){var l=t.inputList[o].connection;if(l&&l.type===Blockly.INPUT_VALUE&&Blockly.navigation.connect_(l,e))return!0}if(t.outputConnection&&Blockly.navigation.connect_(t.outputConnection,e))return!0}return Blockly.navigation.warn_("This block can not be inserted at the marked location."),!1},Blockly.navigation.disconnectBlocks_=function(){var t=Blockly.getMainWorkspace(),e=t.getCursor().getCurNode();if(e.isConnection()){var o=e.getLocation();o.isConnected()?(e=o.isSuperior()?o:o.targetConnection,(o=o.isSuperior()?o.targetConnection:o).getSourceBlock().isShadow()?Blockly.navigation.log_("Cannot disconnect a shadow block"):(e.disconnect(),o.bumpAwayFrom_(e),e.getSourceBlock().getRootBlock().bringToFront(),e=Blockly.ASTNode.createConnectionNode(e),t.getCursor().setCurNode(e))):Blockly.navigation.log_("Cannot disconnect unconnected connection")}else Blockly.navigation.log_("Cannot disconnect blocks when the cursor is not on a connection")},Blockly.navigation.markAtCursor_=function(){var t=Blockly.getMainWorkspace();t.getMarker().setCurNode(t.getCursor().getCurNode())},Blockly.navigation.removeMark_=function(){var t=Blockly.getMainWorkspace();t.getMarker().setCurNode(null),t.getMarker().hide()},Blockly.navigation.setState=function(t){Blockly.navigation.currentState_=t},Blockly.navigation.getSourceBlock_=function(t){return t?t.getType()===Blockly.ASTNode.types.BLOCK?t.getLocation():t.getType()===Blockly.ASTNode.types.STACK?t.getLocation():t.getType()===Blockly.ASTNode.types.WORKSPACE?null:t.getLocation().getSourceBlock():null},Blockly.navigation.getTopNode=function(t){var e=t.previousConnection||t.outputConnection;return e?Blockly.ASTNode.createConnectionNode(e):Blockly.ASTNode.createBlockNode(t)},Blockly.navigation.moveCursorOnBlockDelete=function(t){var e=Blockly.getMainWorkspace();if(e&&(e=e.getCursor())){var o=e.getCurNode();(o=Blockly.navigation.getSourceBlock_(o))===t?o.getParent()?(t=o.previousConnection||o.outputConnection)&&e.setCurNode(Blockly.ASTNode.createConnectionNode(t.targetConnection)):e.setCurNode(Blockly.ASTNode.createWorkspaceNode(o.workspace,o.getRelativeToSurfaceXY())):-1<t.getChildren(!1).indexOf(o)&&e.setCurNode(Blockly.ASTNode.createWorkspaceNode(o.workspace,o.getRelativeToSurfaceXY()))}},Blockly.navigation.moveCursorOnBlockMutation=function(t){var e=Blockly.getMainWorkspace().getCursor();if(e){var o=e.getCurNode();(o=Blockly.navigation.getSourceBlock_(o))===t&&e.setCurNode(Blockly.ASTNode.createBlockNode(o))}},Blockly.navigation.enableKeyboardAccessibility=function(){Blockly.keyboardAccessibilityMode||(Blockly.keyboardAccessibilityMode=!0,Blockly.navigation.focusWorkspace_())},Blockly.navigation.disableKeyboardAccessibility=function(){if(Blockly.keyboardAccessibilityMode){var t=Blockly.getMainWorkspace();Blockly.keyboardAccessibilityMode=!1,t.getCursor().hide(),t.getMarker().hide(),Blockly.navigation.getFlyoutCursor_()&&Blockly.navigation.getFlyoutCursor_().hide()}},Blockly.navigation.log_=function(t){Blockly.navigation.loggingCallback?Blockly.navigation.loggingCallback("log",t):console.log(t)},Blockly.navigation.warn_=function(t){Blockly.navigation.loggingCallback?Blockly.navigation.loggingCallback("warn",t):console.warn(t)},Blockly.navigation.error_=function(t){Blockly.navigation.loggingCallback?Blockly.navigation.loggingCallback("error",t):console.error(t)},Blockly.navigation.onKeyPress=function(t){return t=Blockly.user.keyMap.serializeKeyEvent(t),!!(t=Blockly.user.keyMap.getActionByKeyCode(t))&&Blockly.navigation.onBlocklyAction(t)},Blockly.navigation.onBlocklyAction=function(t){var e=Blockly.getMainWorkspace().options.readOnly,o=!1;return Blockly.keyboardAccessibilityMode?e?-1<Blockly.navigation.READONLY_ACTION_LIST.indexOf(t)&&(o=Blockly.navigation.handleActions_(t)):o=Blockly.navigation.handleActions_(t):t.name===Blockly.navigation.actionNames.TOGGLE_KEYBOARD_NAV&&(Blockly.navigation.enableKeyboardAccessibility(),o=!0),o},Blockly.navigation.handleActions_=function(t){var e=Blockly.getMainWorkspace();if(t.name===Blockly.navigation.actionNames.TOGGLE_KEYBOARD_NAV)return Blockly.navigation.disableKeyboardAccessibility(),!0;if(t.name===Blockly.navigation.actionNames.TOOLBOX)return e.getToolbox()?Blockly.navigation.focusToolbox_():Blockly.navigation.focusFlyout_(),!0;if(Blockly.navigation.currentState_===Blockly.navigation.STATE_WS){var o=!1;return(e=e.getCursor().getCurNode())&&e.getType()===Blockly.ASTNode.types.FIELD&&(o=e.getLocation().onBlocklyAction(t)),o||(o=Blockly.navigation.workspaceOnAction_(t)),o}return Blockly.navigation.currentState_===Blockly.navigation.STATE_FLYOUT?Blockly.navigation.flyoutOnAction_(t):Blockly.navigation.currentState_===Blockly.navigation.STATE_TOOLBOX&&Blockly.navigation.toolboxOnAction_(t)},Blockly.navigation.workspaceOnAction_=function(t){var e=Blockly.getMainWorkspace();switch(t.name){case Blockly.navigation.actionNames.PREVIOUS:return e.getCursor().prev(),!0;case Blockly.navigation.actionNames.OUT:return e.getCursor().out(),!0;case Blockly.navigation.actionNames.NEXT:return e.getCursor().next(),!0;case Blockly.navigation.actionNames.IN:return e.getCursor().in(),!0;case Blockly.navigation.actionNames.INSERT:return Blockly.navigation.modify_(),!0;case Blockly.navigation.actionNames.MARK:return Blockly.navigation.handleEnterForWS_(),!0;case Blockly.navigation.actionNames.DISCONNECT:return Blockly.navigation.disconnectBlocks_(),!0;default:return!1}},Blockly.navigation.flyoutOnAction_=function(t){switch(t.name){case Blockly.navigation.actionNames.PREVIOUS:return Blockly.navigation.getFlyoutCursor_().prev(),!0;case Blockly.navigation.actionNames.OUT:return Blockly.navigation.focusToolbox_(),!0;case Blockly.navigation.actionNames.NEXT:return Blockly.navigation.getFlyoutCursor_().next(),!0;case Blockly.navigation.actionNames.MARK:return Blockly.navigation.insertFromFlyout(),!0;case Blockly.navigation.actionNames.EXIT:return Blockly.navigation.focusWorkspace_(),!0;default:return!1}},Blockly.navigation.toolboxOnAction_=function(t){if(t.name===Blockly.navigation.actionNames.EXIT)return Blockly.navigation.focusWorkspace_(),!0;var e=Blockly.getMainWorkspace().getToolbox().onBlocklyAction(t);return e||t.name!==Blockly.navigation.actionNames.IN?e:(Blockly.navigation.focusFlyout_(),!0)},Blockly.navigation.handleEnterForWS_=function(){var t=Blockly.getMainWorkspace().getCursor().getCurNode(),e=t.getType();e==Blockly.ASTNode.types.FIELD?t.getLocation().showEditor_():t.isConnection()||e==Blockly.ASTNode.types.WORKSPACE?Blockly.navigation.markAtCursor_():e==Blockly.ASTNode.types.BLOCK?Blockly.navigation.warn_("Cannot mark a block."):e==Blockly.ASTNode.types.STACK&&Blockly.navigation.warn_("Cannot mark a stack.")},Blockly.navigation.ACTION_PREVIOUS=new Blockly.Action(Blockly.navigation.actionNames.PREVIOUS,"Go to the previous location."),Blockly.navigation.ACTION_OUT=new Blockly.Action(Blockly.navigation.actionNames.OUT,"Go to the parent of the current location."),Blockly.navigation.ACTION_NEXT=new Blockly.Action(Blockly.navigation.actionNames.NEXT,"Go to the next location."),Blockly.navigation.ACTION_IN=new Blockly.Action(Blockly.navigation.actionNames.IN,"Go to the first child of the current location."),Blockly.navigation.ACTION_INSERT=new Blockly.Action(Blockly.navigation.actionNames.INSERT,"Connect the current location to the marked location."),Blockly.navigation.ACTION_MARK=new Blockly.Action(Blockly.navigation.actionNames.MARK,"Mark the current location."),Blockly.navigation.ACTION_DISCONNECT=new Blockly.Action(Blockly.navigation.actionNames.DISCONNECT,"Dicsonnect the block at thecurrent location from its parent."),Blockly.navigation.ACTION_TOOLBOX=new Blockly.Action(Blockly.navigation.actionNames.TOOLBOX,"Open the toolbox."),Blockly.navigation.ACTION_EXIT=new Blockly.Action(Blockly.navigation.actionNames.EXIT,"Close the current modal, such as a toolbox or field editor."),Blockly.navigation.ACTION_TOGGLE_KEYBOARD_NAV=new Blockly.Action(Blockly.navigation.actionNames.TOGGLE_KEYBOARD_NAV,"Turns on and off keyboard navigation."),Blockly.navigation.READONLY_ACTION_LIST=[Blockly.navigation.ACTION_PREVIOUS,Blockly.navigation.ACTION_OUT,Blockly.navigation.ACTION_IN,Blockly.navigation.ACTION_NEXT,Blockly.navigation.ACTION_TOGGLE_KEYBOARD_NAV],Blockly.Names=function(t,e){if(this.variablePrefix_=e||"",this.reservedDict_=Object.create(null),t)for(var o=t.split(","),l=0;l<o.length;l++)this.reservedDict_[o[l]]=!0;this.reset()},Blockly.Names.DEVELOPER_VARIABLE_TYPE="DEVELOPER_VARIABLE",Blockly.Names.prototype.reset=function(){this.db_=Object.create(null),this.dbReverse_=Object.create(null),this.variableMap_=null},Blockly.Names.prototype.setVariableMap=function(t){this.variableMap_=t},Blockly.Names.prototype.getNameForUserVariable_=function(t){return this.variableMap_?(t=this.variableMap_.getVariableById(t))?t.name:null:(console.log("Deprecated call to Blockly.Names.prototype.getName without defining a variable map. To fix, add the folowing code in your generator's init() function:\nBlockly.YourGeneratorName.variableDB_.setVariableMap(workspace.getVariableMap());"),null)},Blockly.Names.prototype.getName=function(t,e){if(e==Blockly.Variables.NAME_TYPE){var o=this.getNameForUserVariable_(t);o&&(t=o)}o=t.toLowerCase()+"_"+e;var l=e==Blockly.Variables.NAME_TYPE||e==Blockly.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"";if(o in this.db_)return l+this.db_[o];var i=this.getDistinctName(t,e);return this.db_[o]=i.substr(l.length),i},Blockly.Names.prototype.getDistinctName=function(t,e){for(var o=this.safeName_(t),l="";this.dbReverse_[o+l]||o+l in this.reservedDict_;)l=l?l+1:2;return this.dbReverse_[o+=l]=!0,(e==Blockly.Variables.NAME_TYPE||e==Blockly.Names.DEVELOPER_VARIABLE_TYPE?this.variablePrefix_:"")+o},Blockly.Names.prototype.safeName_=function(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),-1!="0123456789".indexOf(t[0])&&(t="my_"+t)):t=Blockly.Msg.UNNAMED_KEY||"unnamed",t},Blockly.Names.equals=function(t,e){return t.toLowerCase()==e.toLowerCase()},Blockly.Procedures={},Blockly.Procedures.NAME_TYPE=Blockly.PROCEDURE_CATEGORY_NAME,Blockly.Procedures.allProcedures=function(t){t=t.getAllBlocks(!1);for(var e=[],o=[],l=0;l<t.length;l++)if(t[l].getProcedureDef){var i=t[l].getProcedureDef();i&&(i[2]?e.push(i):o.push(i))}return o.sort(Blockly.Procedures.procTupleComparator_),e.sort(Blockly.Procedures.procTupleComparator_),[o,e]},Blockly.Procedures.procTupleComparator_=function(t,e){return t[0].toLowerCase().localeCompare(e[0].toLowerCase())},Blockly.Procedures.findLegalName=function(t,e){if(e.isInFlyout)return t;for(t=t||Blockly.Msg.UNNAMED_KEY||"unnamed";!Blockly.Procedures.isLegalName_(t,e.workspace,e);){var o=t.match(/^(.*?)(\d+)$/);t=o?o[1]+(parseInt(o[2],10)+1):t+"2"}return t},Blockly.Procedures.isLegalName_=function(t,e,o){return!Blockly.Procedures.isNameUsed(t,e,o)},Blockly.Procedures.isNameUsed=function(t,e,o){e=e.getAllBlocks(!1);for(var l=0;l<e.length;l++)if(e[l]!=o&&e[l].getProcedureDef){var i=e[l].getProcedureDef();if(Blockly.Names.equals(i[0],t))return!0}return!1},Blockly.Procedures.rename=function(t){t=t.trim();var e=Blockly.Procedures.findLegalName(t,this.getSourceBlock()),o=this.getValue();if(o!=t&&o!=e){t=this.getSourceBlock().workspace.getAllBlocks(!1);for(var l=0;l<t.length;l++)t[l].renameProcedure&&t[l].renameProcedure(o,e)}return e},Blockly.Procedures.flyoutCategory=function(t){function e(t,e){for(var l=0;l<t.length;l++){var i=t[l][0],n=t[l][1],r=Blockly.utils.xml.createElement("block");r.setAttribute("type",e),r.setAttribute("gap",16);var s=Blockly.utils.xml.createElement("mutation");for(s.setAttribute("name",i),r.appendChild(s),i=0;i<n.length;i++){var c=Blockly.utils.xml.createElement("arg");c.setAttribute("name",n[i]),s.appendChild(c)}o.push(r)}}var o=[];if(Blockly.Blocks.procedures_defnoreturn){var l=Blockly.utils.xml.createElement("block");l.setAttribute("type","procedures_defnoreturn"),l.setAttribute("gap",16);var i=Blockly.utils.xml.createElement("field");i.setAttribute("name","NAME"),i.appendChild(Blockly.utils.xml.createTextNode(Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE)),l.appendChild(i),o.push(l)}return Blockly.Blocks.procedures_defreturn&&((l=Blockly.utils.xml.createElement("block")).setAttribute("type","procedures_defreturn"),l.setAttribute("gap",16),(i=Blockly.utils.xml.createElement("field")).setAttribute("name","NAME"),i.appendChild(Blockly.utils.xml.createTextNode(Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE)),l.appendChild(i),o.push(l)),Blockly.Blocks.procedures_ifreturn&&((l=Blockly.utils.xml.createElement("block")).setAttribute("type","procedures_ifreturn"),l.setAttribute("gap",16),o.push(l)),o.length&&o[o.length-1].setAttribute("gap",24),e((t=Blockly.Procedures.allProcedures(t))[0],"procedures_callnoreturn"),e(t[1],"procedures_callreturn"),o},Blockly.Procedures.getCallers=function(t,e){for(var o=[],l=e.getAllBlocks(!1),i=0;i<l.length;i++)if(l[i].getProcedureCall){var n=l[i].getProcedureCall();n&&Blockly.Names.equals(n,t)&&o.push(l[i])}return o},Blockly.Procedures.mutateCallers=function(t){var e,o=Blockly.Events.recordUndo,l=t.getProcedureDef()[0],i=t.mutationToDom(!0);for(t=Blockly.Procedures.getCallers(l,t.workspace),l=0;e=t[l];l++){var n=e.mutationToDom();n=n&&Blockly.Xml.domToText(n),e.domToMutation(i);var r=e.mutationToDom();n!=(r=r&&Blockly.Xml.domToText(r))&&(Blockly.Events.recordUndo=!1,Blockly.Events.fire(new Blockly.Events.BlockChange(e,"mutation",null,n,r)),Blockly.Events.recordUndo=o)}},Blockly.Procedures.getDefinition=function(t,e){for(var o=e.getTopBlocks(!1),l=0;l<o.length;l++)if(o[l].getProcedureDef){var i=o[l].getProcedureDef();if(i&&Blockly.Names.equals(i[0],t))return o[l]}return null},Blockly.VariableModel=function(t,e,o,l){this.workspace=t,this.name=e,this.type=o||"",this.id_=l||Blockly.utils.genUid(),Blockly.Events.fire(new Blockly.Events.VarCreate(this))},Blockly.VariableModel.prototype.getId=function(){return this.id_},Blockly.VariableModel.compareByName=function(t,e){var o=t.name.toLowerCase(),l=e.name.toLowerCase();return o<l?-1:o==l?0:1},Blockly.Variables={},Blockly.Variables.NAME_TYPE=Blockly.VARIABLE_CATEGORY_NAME,Blockly.Variables.allUsedVarModels=function(t){var e=t.getAllBlocks(!1);t=Object.create(null);for(var o=0;o<e.length;o++){var l=e[o].getVarModels();if(l)for(var i=0;i<l.length;i++){var n=l[i],r=n.getId();r&&(t[r]=n)}}for(r in e=[],t)e.push(t[r]);return e},Blockly.Variables.allUsedVariables=function(){console.warn("Deprecated call to Blockly.Variables.allUsedVariables. Use Blockly.Variables.allUsedVarModels instead.\nIf this is a major issue please file a bug on GitHub.")},Blockly.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_={},Blockly.Variables.allDeveloperVariables=function(t){t=t.getAllBlocks(!1);for(var e,o=Object.create(null),l=0;e=t[l];l++){var i=e.getDeveloperVariables;if(!i&&e.getDeveloperVars&&(i=e.getDeveloperVars,Blockly.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[e.type]||(console.warn("Function getDeveloperVars() deprecated. Use getDeveloperVariables() (block type '"+e.type+"')"),Blockly.Variables.ALL_DEVELOPER_VARS_WARNINGS_BY_BLOCK_TYPE_[e.type]=!0)),i)for(e=i(),i=0;i<e.length;i++)o[e[i]]=!0}return Object.keys(o)},Blockly.Variables.flyoutCategory=function(t){var e=[],o=document.createElement("button");return o.setAttribute("text","%{BKY_NEW_VARIABLE}"),o.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",(function(t){Blockly.Variables.createVariableButtonHandler(t.getTargetWorkspace())})),e.push(o),t=Blockly.Variables.flyoutCategoryBlocks(t),e.concat(t)},Blockly.Variables.flyoutCategoryBlocks=function(t){var e=[];if(0<(t=t.getVariablesOfType("")).length){var o=t[t.length-1];if(Blockly.Blocks.variables_set){var l=Blockly.utils.xml.createElement("block");l.setAttribute("type","variables_set"),l.setAttribute("gap",Blockly.Blocks.math_change?8:24),l.appendChild(Blockly.Variables.generateVariableFieldDom(o)),e.push(l)}if(Blockly.Blocks.math_change&&((l=Blockly.utils.xml.createElement("block")).setAttribute("type","math_change"),l.setAttribute("gap",Blockly.Blocks.variables_get?20:8),l.appendChild(Blockly.Variables.generateVariableFieldDom(o)),o=Blockly.Xml.textToDom('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),l.appendChild(o),e.push(l)),Blockly.Blocks.variables_get){t.sort(Blockly.VariableModel.compareByName),o=0;for(var i;i=t[o];o++)(l=Blockly.utils.xml.createElement("block")).setAttribute("type","variables_get"),l.setAttribute("gap",8),l.appendChild(Blockly.Variables.generateVariableFieldDom(i)),e.push(l)}}return e},Blockly.Variables.generateUniqueName=function(t){var e="";if((t=t.getAllVariables()).length)for(var o=1,l=0,i="ijkmnopqrstuvwxyzabcdefgh".charAt(l);!e;){for(var n=!1,r=0;r<t.length;r++)if(t[r].name.toLowerCase()==i){n=!0;break}n?(25==++l&&(l=0,o++),i="ijkmnopqrstuvwxyzabcdefgh".charAt(l),1<o&&(i+=o)):e=i}else e="i";return e},Blockly.Variables.createVariableButtonHandler=function(t,e,o){var l=o||"",i=function(o){Blockly.Variables.promptName(Blockly.Msg.NEW_VARIABLE_TITLE,o,(function(o){if(o){var n=Blockly.Variables.nameUsedWithAnyType_(o,t);if(n){var r=o.toLowerCase();if(n.type==l)var s=Blockly.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",r);else s=(s=Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",r).replace("%2",n.type);Blockly.alert(s,(function(){i(o)}))}else t.createVariable(o,l),e&&e(o)}else e&&e(null)}))};i("")},Blockly.Variables.createVariable=Blockly.Variables.createVariableButtonHandler,Blockly.Variables.renameVariable=function(t,e,o){var l=function(i){var n=Blockly.Msg.RENAME_VARIABLE_TITLE.replace("%1",e.name);Blockly.Variables.promptName(n,i,(function(i){if(i){var n=Blockly.Variables.nameUsedWithOtherType_(i,e.type,t);n?(n=Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",i.toLowerCase()).replace("%2",n.type),Blockly.alert(n,(function(){l(i)}))):(t.renameVariableById(e.getId(),i),o&&o(i))}else o&&o(null)}))};l("")},Blockly.Variables.promptName=function(t,e,o){Blockly.prompt(t,e,(function(t){t&&((t=t.replace(/[\s\xa0]+/g," ").trim())==Blockly.Msg.RENAME_VARIABLE||t==Blockly.Msg.NEW_VARIABLE)&&(t=null),o(t)}))},Blockly.Variables.nameUsedWithOtherType_=function(t,e,o){o=o.getVariableMap().getAllVariables(),t=t.toLowerCase();for(var l,i=0;l=o[i];i++)if(l.name.toLowerCase()==t&&l.type!=e)return l;return null},Blockly.Variables.nameUsedWithAnyType_=function(t,e){var o=e.getVariableMap().getAllVariables();t=t.toLowerCase();for(var l,i=0;l=o[i];i++)if(l.name.toLowerCase()==t)return l;return null},Blockly.Variables.generateVariableFieldDom=function(t){var e=Blockly.utils.xml.createElement("field");return e.setAttribute("name","VAR"),e.setAttribute("id",t.getId()),e.setAttribute("variabletype",t.type),t=Blockly.utils.xml.createTextNode(t.name),e.appendChild(t),e},Blockly.Variables.getOrCreateVariablePackage=function(t,e,o,l){var i=Blockly.Variables.getVariable(t,e,o,l);return i||(i=Blockly.Variables.createVariable_(t,e,o,l)),i},Blockly.Variables.getVariable=function(t,e,o,l){var i=t.getPotentialVariableMap();if(e){var n=t.getVariableById(e);if(!n&&i&&(n=i.getVariableById(e)),n)return n}if(o){if(null==l)throw Error("Tried to look up a variable by name without a type");!(n=t.getVariable(o,l))&&i&&(n=i.getVariable(o,l))}return n},Blockly.Variables.createVariable_=function(t,e,o,l){var i=t.getPotentialVariableMap();return o||(o=Blockly.Variables.generateUniqueName(t.isFlyout?t.targetWorkspace:t)),i?i.createVariable(o,l,e):t.createVariable(o,l,e)},Blockly.Variables.getAddedVariables=function(t,e){var o=t.getAllVariables(),l=[];if(e.length!=o.length)for(var i=0;i<o.length;i++){var n=o[i];-1==e.indexOf(n)&&l.push(n)}return l},Blockly.WidgetDiv={},Blockly.WidgetDiv.DIV=null,Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.dispose_=null,Blockly.WidgetDiv.createDom=function(){Blockly.WidgetDiv.DIV||(Blockly.WidgetDiv.DIV=document.createElement("div"),Blockly.WidgetDiv.DIV.className="blocklyWidgetDiv",document.body.appendChild(Blockly.WidgetDiv.DIV))},Blockly.WidgetDiv.show=function(t,e,o){Blockly.WidgetDiv.hide(),Blockly.WidgetDiv.owner_=t,Blockly.WidgetDiv.dispose_=o,t=Blockly.utils.style.getViewportPageOffset(),Blockly.WidgetDiv.DIV.style.top=t.y+"px",Blockly.WidgetDiv.DIV.style.direction=e?"rtl":"ltr",Blockly.WidgetDiv.DIV.style.display="block"},Blockly.WidgetDiv.hide=function(){Blockly.WidgetDiv.owner_&&(Blockly.WidgetDiv.owner_=null,Blockly.WidgetDiv.DIV.style.display="none",Blockly.WidgetDiv.DIV.style.left="",Blockly.WidgetDiv.DIV.style.top="",Blockly.WidgetDiv.dispose_&&Blockly.WidgetDiv.dispose_(),Blockly.WidgetDiv.dispose_=null,Blockly.WidgetDiv.DIV.innerHTML="")},Blockly.WidgetDiv.isVisible=function(){return!!Blockly.WidgetDiv.owner_},Blockly.WidgetDiv.hideIfOwner=function(t){Blockly.WidgetDiv.owner_==t&&Blockly.WidgetDiv.hide()},Blockly.WidgetDiv.positionInternal_=function(t,e,o){Blockly.WidgetDiv.DIV.style.left=t+"px",Blockly.WidgetDiv.DIV.style.top=e+"px",Blockly.WidgetDiv.DIV.style.height=o+"px"},Blockly.WidgetDiv.positionWithAnchor=function(t,e,o,l){var i=Blockly.WidgetDiv.calculateY_(t,e,o);t=Blockly.WidgetDiv.calculateX_(t,e,o,l),0>i?Blockly.WidgetDiv.positionInternal_(t,0,o.height+i):Blockly.WidgetDiv.positionInternal_(t,i,o.height)},Blockly.WidgetDiv.calculateX_=function(t,e,o,l){return l?(e=Math.max(e.right-o.width,t.left),Math.min(e,t.right-o.width)):(e=Math.min(e.left,t.right-o.width),Math.max(e,t.left))},Blockly.WidgetDiv.calculateY_=function(t,e,o){return e.bottom+o.height>=t.bottom?e.top-o.height:e.bottom},Blockly.VERSION="3.20191014.4",Blockly.mainWorkspace=null,Blockly.selected=null,Blockly.cursor=null,Blockly.keyboardAccessibilityMode=!1,Blockly.draggingConnections_=[],Blockly.clipboardXml_=null,Blockly.clipboardSource_=null,Blockly.clipboardTypeCounts_=null,Blockly.cache3dSupported_=null,Blockly.svgSize=function(t){return{width:t.cachedWidth_,height:t.cachedHeight_}},Blockly.resizeSvgContents=function(t){t.resizeContents()},Blockly.svgResize=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;var e=t.getParentSvg(),o=e.parentNode;if(o){var l=o.offsetWidth;o=o.offsetHeight,e.cachedWidth_!=l&&(e.setAttribute("width",l+"px"),e.cachedWidth_=l),e.cachedHeight_!=o&&(e.setAttribute("height",o+"px"),e.cachedHeight_=o),t.resize()}},Blockly.onKeyDown_=function(t){var e=Blockly.mainWorkspace;if(!(Blockly.utils.isTargetInput(t)||e.rendered&&!e.isVisible()))if(e.options.readOnly)Blockly.navigation.onKeyPress(t);else{var o=!1;if(t.keyCode==Blockly.utils.KeyCodes.ESC)Blockly.hideChaff(),Blockly.navigation.onBlocklyAction(Blockly.navigation.ACTION_EXIT);else{if(Blockly.navigation.onKeyPress(t))return;if(t.keyCode==Blockly.utils.KeyCodes.BACKSPACE||t.keyCode==Blockly.utils.KeyCodes.DELETE){if(t.preventDefault(),Blockly.Gesture.inProgress())return;Blockly.selected&&Blockly.selected.isDeletable()&&(o=!0)}else if(t.altKey||t.ctrlKey||t.metaKey){if(Blockly.Gesture.inProgress())return;Blockly.selected&&Blockly.selected.isDeletable()&&Blockly.selected.isMovable()&&(t.keyCode==Blockly.utils.KeyCodes.C?(Blockly.hideChaff(),Blockly.copy_(Blockly.selected)):t.keyCode!=Blockly.utils.KeyCodes.X||Blockly.selected.workspace.isFlyout||(Blockly.copy_(Blockly.selected),o=!0)),t.keyCode==Blockly.utils.KeyCodes.V?Blockly.clipboardXml_&&((t=Blockly.clipboardSource_).isFlyout&&(t=t.targetWorkspace),Blockly.clipboardTypeCounts_&&t.isCapacityAvailable(Blockly.clipboardTypeCounts_)&&(Blockly.Events.setGroup(!0),t.paste(Blockly.clipboardXml_),Blockly.Events.setGroup(!1))):t.keyCode==Blockly.utils.KeyCodes.Z&&(Blockly.hideChaff(),e.undo(t.shiftKey))}}o&&!Blockly.selected.workspace.isFlyout&&(Blockly.Events.setGroup(!0),Blockly.hideChaff(),Blockly.selected.dispose(!0,!0),Blockly.Events.setGroup(!1))}},Blockly.copy_=function(t){if(t.isComment)var e=t.toXmlWithXY();else{e=Blockly.Xml.blockToDom(t,!0),Blockly.Xml.deleteNext(e);var o=t.getRelativeToSurfaceXY();e.setAttribute("x",t.RTL?-o.x:o.x),e.setAttribute("y",o.y)}Blockly.clipboardXml_=e,Blockly.clipboardSource_=t.workspace,Blockly.clipboardTypeCounts_=t.isComment?null:Blockly.utils.getBlockTypeCounts(t,!0)},Blockly.duplicate_=function(t){var e=Blockly.clipboardXml_,o=Blockly.clipboardSource_;Blockly.copy_(t),t.workspace.paste(Blockly.clipboardXml_),Blockly.clipboardXml_=e,Blockly.clipboardSource_=o},Blockly.onContextMenu_=function(t){Blockly.utils.isTargetInput(t)||t.preventDefault()},Blockly.hideChaff=function(t){Blockly.Tooltip.hide(),Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation(),t||((t=Blockly.getMainWorkspace()).trashcan&&t.trashcan.flyout_&&t.trashcan.flyout_.hide(),t.toolbox_&&t.toolbox_.flyout_&&t.toolbox_.flyout_.autoClose&&t.toolbox_.clearSelection())},Blockly.getMainWorkspace=function(){return Blockly.mainWorkspace},Blockly.alert=function(t,e){alert(t),e&&e()},Blockly.confirm=function(t,e){e(confirm(t))},Blockly.prompt=function(t,e,o){o(prompt(t,e))},Blockly.jsonInitFactory_=function(t){return function(){this.jsonInit(t)}},Blockly.defineBlocksWithJsonArray=function(t){for(var e=0;e<t.length;e++){var o=t[e];if(o){var l=o.type;null==l||""===l?console.warn("Block definition #"+e+" in JSON array is missing a type attribute. Skipping."):(Blockly.Blocks[l]&&console.warn("Block definition #"+e+' in JSON array overwrites prior definition of "'+l+'".'),Blockly.Blocks[l]={init:Blockly.jsonInitFactory_(o)})}else console.warn("Block definition #"+e+" in JSON array is "+o+". Skipping.")}},Blockly.bindEventWithChecks_=function(t,e,o,l,i,n){var r=!1,s=function(t){var e=!i;t=Blockly.Touch.splitEventByTouches(t);for(var n,s=0;n=t[s];s++)e&&!Blockly.Touch.shouldHandleEvent(n)||(Blockly.Touch.setClientFromTouch(n),o?l.call(o,n):l(n),r=!0)},c=[];if(Blockly.utils.global.PointerEvent&&e in Blockly.Touch.TOUCH_MAP)for(var a,u=0;a=Blockly.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(a,s,!1),c.push([t,a,s]);else if(t.addEventListener(e,s,!1),c.push([t,e,s]),e in Blockly.Touch.TOUCH_MAP){var h=function(t){s(t),r&&!n&&t.preventDefault()};for(u=0;a=Blockly.Touch.TOUCH_MAP[e][u];u++)t.addEventListener(a,h,!1),c.push([t,a,h])}return c},Blockly.bindEvent_=function(t,e,o,l){var i=function(t){o?l.call(o,t):l(t)},n=[];if(Blockly.utils.global.PointerEvent&&e in Blockly.Touch.TOUCH_MAP)for(var r,s=0;r=Blockly.Touch.TOUCH_MAP[e][s];s++)t.addEventListener(r,i,!1),n.push([t,r,i]);else if(t.addEventListener(e,i,!1),n.push([t,e,i]),e in Blockly.Touch.TOUCH_MAP){var c=function(t){if(t.changedTouches&&1==t.changedTouches.length){var e=t.changedTouches[0];t.clientX=e.clientX,t.clientY=e.clientY}i(t),t.preventDefault()};for(s=0;r=Blockly.Touch.TOUCH_MAP[e][s];s++)t.addEventListener(r,c,!1),n.push([t,r,c])}return n},Blockly.unbindEvent_=function(t){for(;t.length;){var e=t.pop(),o=e[2];e[0].removeEventListener(e[1],o,!1)}return o},Blockly.isNumber=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},Blockly.hueToHex=function(t){return Blockly.utils.colour.hsvToHex(t,Blockly.HSV_SATURATION,255*Blockly.HSV_VALUE)},Blockly.checkBlockColourConstants=function(){Blockly.checkBlockColourConstant_("LOGIC_HUE",["Blocks","logic","HUE"],void 0),Blockly.checkBlockColourConstant_("LOGIC_HUE",["Constants","Logic","HUE"],210),Blockly.checkBlockColourConstant_("LOOPS_HUE",["Blocks","loops","HUE"],void 0),Blockly.checkBlockColourConstant_("LOOPS_HUE",["Constants","Loops","HUE"],120),Blockly.checkBlockColourConstant_("MATH_HUE",["Blocks","math","HUE"],void 0),Blockly.checkBlockColourConstant_("MATH_HUE",["Constants","Math","HUE"],230),Blockly.checkBlockColourConstant_("TEXTS_HUE",["Blocks","texts","HUE"],void 0),Blockly.checkBlockColourConstant_("TEXTS_HUE",["Constants","Text","HUE"],160),Blockly.checkBlockColourConstant_("LISTS_HUE",["Blocks","lists","HUE"],void 0),Blockly.checkBlockColourConstant_("LISTS_HUE",["Constants","Lists","HUE"],260),Blockly.checkBlockColourConstant_("COLOUR_HUE",["Blocks","colour","HUE"],void 0),Blockly.checkBlockColourConstant_("COLOUR_HUE",["Constants","Colour","HUE"],20),Blockly.checkBlockColourConstant_("VARIABLES_HUE",["Blocks","variables","HUE"],void 0),Blockly.checkBlockColourConstant_("VARIABLES_HUE",["Constants","Variables","HUE"],330),Blockly.checkBlockColourConstant_("VARIABLES_DYNAMIC_HUE",["Constants","VariablesDynamic","HUE"],310),Blockly.checkBlockColourConstant_("PROCEDURES_HUE",["Blocks","procedures","HUE"],void 0)},Blockly.checkBlockColourConstant_=function(t,e,o){for(var l="Blockly",i=Blockly,n=0;n<e.length;++n)l+="."+e[n],i&&(i=i[e[n]]);i&&i!==o&&(t=(void 0===o?'%1 has been removed. Use Blockly.Msg["%2"].':'%1 is deprecated and unused. Override Blockly.Msg["%2"].').replace("%1",l).replace("%2",t),console.warn(t))},Blockly.Comment=function(t){Blockly.Comment.superClass_.constructor.call(this,t),this.model_=t.commentModel,this.model_.text=this.model_.text||"",this.cachedText_="",this.createIcon()},Blockly.utils.object.inherits(Blockly.Comment,Blockly.Icon),Blockly.Comment.prototype.drawIcon_=function(t){Blockly.utils.dom.createSvgElement("circle",{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},t),Blockly.utils.dom.createSvgElement("path",{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},t),Blockly.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},t)},Blockly.Comment.prototype.createEditor_=function(){this.foreignObject_=Blockly.utils.dom.createSvgElement("foreignObject",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null);var t=document.createElementNS(Blockly.utils.dom.HTML_NS,"body");t.setAttribute("xmlns",Blockly.utils.dom.HTML_NS),t.className="blocklyMinimalBody";var e=this.textarea_=document.createElementNS(Blockly.utils.dom.HTML_NS,"textarea");return e.className="blocklyCommentTextarea",e.setAttribute("dir",this.block_.RTL?"RTL":"LTR"),e.value=this.model_.text,this.resizeTextarea_(),t.appendChild(e),this.foreignObject_.appendChild(t),Blockly.bindEventWithChecks_(e,"mouseup",this,this.startEdit_,!0,!0),Blockly.bindEventWithChecks_(e,"wheel",this,(function(t){t.stopPropagation()})),Blockly.bindEventWithChecks_(e,"change",this,(function(t){this.cachedText_!=this.model_.text&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.block_,"comment",null,this.cachedText_,this.model_.text))})),Blockly.bindEventWithChecks_(e,"input",this,(function(t){this.model_.text=e.value})),setTimeout(e.focus.bind(e),0),this.foreignObject_},Blockly.Comment.prototype.updateEditable=function(){Blockly.Comment.superClass_.updateEditable.call(this),this.isVisible()&&(this.disposeBubble_(),this.createBubble_())},Blockly.Comment.prototype.onBubbleResize_=function(){this.isVisible()&&(this.model_.size=this.bubble_.getBubbleSize(),this.resizeTextarea_())},Blockly.Comment.prototype.resizeTextarea_=function(){var t=this.model_.size,e=2*Blockly.Bubble.BORDER_WIDTH,o=t.width-e;t=t.height-e,this.foreignObject_.setAttribute("width",o),this.foreignObject_.setAttribute("height",t),this.textarea_.style.width=o-4+"px",this.textarea_.style.height=t-4+"px"},Blockly.Comment.prototype.setVisible=function(t){t!=this.isVisible()&&(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"commentOpen",!t,t)),(this.model_.pinned=t)?this.createBubble_():this.disposeBubble_())},Blockly.Comment.prototype.createBubble_=function(){!this.block_.isEditable()||Blockly.utils.userAgent.IE?this.createNonEditableBubble_():this.createEditableBubble_()},Blockly.Comment.prototype.createEditableBubble_=function(){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,this.model_.size.width,this.model_.size.height),this.bubble_.setSvgId(this.block_.id),this.bubble_.registerResizeEvent(this.onBubbleResize_.bind(this)),this.updateColour()},Blockly.Comment.prototype.createNonEditableBubble_=function(){Blockly.Warning.prototype.createBubble.call(this)},Blockly.Comment.prototype.disposeBubble_=function(){this.paragraphElement_?Blockly.Warning.prototype.disposeBubble.call(this):(this.bubble_.dispose(),this.foreignObject_=this.textarea_=this.bubble_=null)},Blockly.Comment.prototype.startEdit_=function(t){this.bubble_.promote_()&&this.textarea_.focus(),this.cachedText_=this.model_.text},Blockly.Comment.prototype.getBubbleSize=function(){return this.model_.size},Blockly.Comment.prototype.setBubbleSize=function(t,e){this.bubble_?this.bubble_.setBubbleSize(t,e):(this.model_.size.width=t,this.model_.size.height=e)},Blockly.Comment.prototype.getText=function(){return this.model_.text||""},Blockly.Comment.prototype.setText=function(t){this.model_.text!=t&&(this.model_.text=t,this.updateText())},Blockly.Comment.prototype.updateText=function(){this.textarea_?this.textarea_.value=this.model_.text:this.paragraphElement_&&(this.paragraphElement_.firstChild.textContent=this.model_.text)},Blockly.Comment.prototype.dispose=function(){this.block_.comment=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.tree={},Blockly.tree.BaseNode=function(t,e){Blockly.Component.call(this),this.config_=e,this.content_=t,this.expanded_=this.selected_=!1,this.toolTip_=null,this.isUserCollapsible_=!0,this.depth_=-1};Blockly.utils.object.inherits(Blockly.tree.BaseNode,Blockly.Component),Blockly.tree.BaseNode.allNodes={},Blockly.tree.BaseNode.prototype.disposeInternal=function(){Blockly.tree.BaseNode.superClass_.disposeInternal.call(this),this.tree&&(this.tree=null),this.setElementInternal(null)},Blockly.tree.BaseNode.prototype.initAccessibility=function(){var t=this.getElement();if(t){var e=this.getLabelElement();if(e&&!e.id&&(e.id=this.getId()+".label"),Blockly.utils.aria.setRole(t,Blockly.utils.aria.Role.TREEITEM),Blockly.utils.aria.setState(t,Blockly.utils.aria.State.SELECTED,!1),Blockly.utils.aria.setState(t,Blockly.utils.aria.State.LEVEL,this.getDepth()),e&&Blockly.utils.aria.setState(t,Blockly.utils.aria.State.LABELLEDBY,e.id),(e=this.getIconElement())&&Blockly.utils.aria.setRole(e,Blockly.utils.aria.Role.PRESENTATION),(e=this.getChildrenElement())&&(Blockly.utils.aria.setRole(e,Blockly.utils.aria.Role.GROUP),e.hasChildNodes()))for(Blockly.utils.aria.setState(t,Blockly.utils.aria.State.EXPANDED,!1),t=this.getChildCount(),e=1;e<=t;e++){var o=this.getChildAt(e-1).getElement();Blockly.utils.aria.setState(o,Blockly.utils.aria.State.SETSIZE,t),Blockly.utils.aria.setState(o,Blockly.utils.aria.State.POSINSET,e)}}},Blockly.tree.BaseNode.prototype.createDom=function(){var t=document.createElement("div");t.appendChild(this.toDom()),this.setElementInternal(t)},Blockly.tree.BaseNode.prototype.enterDocument=function(){Blockly.tree.BaseNode.superClass_.enterDocument.call(this),Blockly.tree.BaseNode.allNodes[this.getId()]=this,this.initAccessibility()},Blockly.tree.BaseNode.prototype.exitDocument=function(){Blockly.tree.BaseNode.superClass_.exitDocument.call(this),delete Blockly.tree.BaseNode.allNodes[this.getId()]},Blockly.tree.BaseNode.prototype.addChildAt=function(t,e){var o=this.getChildAt(e-1),l=this.getChildAt(e);Blockly.tree.BaseNode.superClass_.addChildAt.call(this,t,e),t.previousSibling_=o,t.nextSibling_=l,o?o.nextSibling_=t:this.firstChild_=t,l?l.previousSibling_=t:this.lastChild_=t;var i=this.getTree();if(i&&t.setTreeInternal(i),t.setDepth_(this.getDepth()+1),(i=this.getElement())&&(this.updateExpandIcon(),Blockly.utils.aria.setState(i,Blockly.utils.aria.State.EXPANDED,this.getExpanded()),this.getExpanded())){i=this.getChildrenElement(),t.getElement()||t.createDom();var n=t.getElement(),r=l&&l.getElement();i.insertBefore(n,r),this.isInDocument()&&t.enterDocument(),l||(o?o.updateExpandIcon():(Blockly.utils.style.setElementShown(i,!0),this.setExpanded(this.getExpanded())))}},Blockly.tree.BaseNode.prototype.add=function(t){if(t.getParent())throw Error(Blockly.Component.Error.PARENT_UNABLE_TO_BE_SET);this.addChildAt(t,this.getChildCount())},Blockly.tree.BaseNode.prototype.getTree=function(){return null},Blockly.tree.BaseNode.prototype.getDepth=function(){var t=this.depth_;return 0>t&&(t=this.computeDepth_(),this.setDepth_(t)),t},Blockly.tree.BaseNode.prototype.computeDepth_=function(){var t=this.getParent();return t?t.getDepth()+1:0},Blockly.tree.BaseNode.prototype.setDepth_=function(t){if(t!=this.depth_){this.depth_=t;var e=this.getRowElement();if(e){var o=this.getPixelIndent_()+"px";this.isRightToLeft()?e.style.paddingRight=o:e.style.paddingLeft=o}this.forEachChild((function(e){e.setDepth_(t+1)}))}},Blockly.tree.BaseNode.prototype.contains=function(t){for(;t;){if(t==this)return!0;t=t.getParent()}return!1},Blockly.tree.BaseNode.prototype.getChildren=function(){var t=[];return this.forEachChild((function(e){t.push(e)})),t},Blockly.tree.BaseNode.prototype.getFirstChild=function(){return this.getChildAt(0)},Blockly.tree.BaseNode.prototype.getLastChild=function(){return this.getChildAt(this.getChildCount()-1)},Blockly.tree.BaseNode.prototype.getPreviousSibling=function(){return this.previousSibling_},Blockly.tree.BaseNode.prototype.getNextSibling=function(){return this.nextSibling_},Blockly.tree.BaseNode.prototype.isLastSibling=function(){return!this.nextSibling_},Blockly.tree.BaseNode.prototype.isSelected=function(){return this.selected_},Blockly.tree.BaseNode.prototype.select=function(){var t=this.getTree();t&&t.setSelectedItem(this)},Blockly.tree.BaseNode.prototype.selectFirst=function(){var t=this.getTree();t&&this.firstChild_&&t.setSelectedItem(this.firstChild_)},Blockly.tree.BaseNode.prototype.setSelectedInternal=function(t){if(this.selected_!=t){this.selected_=t,this.updateRow();var e=this.getElement();e&&(Blockly.utils.aria.setState(e,Blockly.utils.aria.State.SELECTED,t),t&&(t=this.getTree().getElement(),Blockly.utils.aria.setState(t,Blockly.utils.aria.State.ACTIVEDESCENDANT,this.getId())))}},Blockly.tree.BaseNode.prototype.getExpanded=function(){return this.expanded_},Blockly.tree.BaseNode.prototype.setExpandedInternal=function(t){this.expanded_=t},Blockly.tree.BaseNode.prototype.setExpanded=function(t){var e,o=t!=this.expanded_;this.expanded_=t;var l=this.getTree(),i=this.getElement();this.hasChildren()?(!t&&l&&this.contains(l.getSelectedItem())&&this.select(),i&&((e=this.getChildrenElement())&&(Blockly.utils.style.setElementShown(e,t),Blockly.utils.aria.setState(i,Blockly.utils.aria.State.EXPANDED,t),t&&this.isInDocument()&&!e.hasChildNodes()&&(this.forEachChild((function(t){e.appendChild(t.toDom())})),this.forEachChild((function(t){t.enterDocument()})))),this.updateExpandIcon())):(e=this.getChildrenElement())&&Blockly.utils.style.setElementShown(e,!1),i&&this.updateIcon_(),o&&(t?this.doNodeExpanded():this.doNodeCollapsed())},Blockly.tree.BaseNode.prototype.doNodeExpanded=function(){},Blockly.tree.BaseNode.prototype.doNodeCollapsed=function(){},Blockly.tree.BaseNode.prototype.toggle=function(){this.setExpanded(!this.getExpanded())},Blockly.tree.BaseNode.prototype.isUserCollapsible=function(){return this.isUserCollapsible_},Blockly.tree.BaseNode.prototype.toDom=function(){var t=this.getExpanded()&&this.hasChildren(),e=document.createElement("div");return e.style.backgroundPosition=this.getBackgroundPosition(),t||(e.style.display="none"),t&&this.forEachChild((function(t){e.appendChild(t.toDom())})),(t=document.createElement("div")).id=this.getId(),t.appendChild(this.getRowDom()),t.appendChild(e),t},Blockly.tree.BaseNode.prototype.getPixelIndent_=function(){return Math.max(0,(this.getDepth()-1)*this.config_.indentWidth)},Blockly.tree.BaseNode.prototype.getRowDom=function(){var t=document.createElement("div");return t.className=this.getRowClassName(),t.style["padding-"+(this.isRightToLeft()?"right":"left")]=this.getPixelIndent_()+"px",t.appendChild(this.getIconDom()),t.appendChild(this.getLabelDom()),t},Blockly.tree.BaseNode.prototype.getRowClassName=function(){var t="";return this.isSelected()&&(t=" "+(this.config_.cssSelectedRow||"")),this.config_.cssTreeRow+t},Blockly.tree.BaseNode.prototype.getLabelDom=function(){var t=document.createElement("span");return t.className=this.config_.cssItemLabel||"",t.textContent=this.getText(),t},Blockly.tree.BaseNode.prototype.getIconDom=function(){var t=document.createElement("span");return t.style.display="inline-block",t.className=this.getCalculatedIconClass(),t},Blockly.tree.BaseNode.prototype.getCalculatedIconClass=function(){throw Error("unimplemented abstract method")},Blockly.tree.BaseNode.prototype.getBackgroundPosition=function(){return(this.isLastSibling()?"-100":(this.getDepth()-1)*this.config_.indentWidth)+"px 0"},Blockly.tree.BaseNode.prototype.getElement=function(){var t=Blockly.tree.BaseNode.superClass_.getElement.call(this);return t||(t=document.getElementById(this.getId()),this.setElementInternal(t)),t},Blockly.tree.BaseNode.prototype.getRowElement=function(){var t=this.getElement();return t?t.firstChild:null},Blockly.tree.BaseNode.prototype.getIconElement=function(){var t=this.getRowElement();return t?t.firstChild:null},Blockly.tree.BaseNode.prototype.getLabelElement=function(){var t=this.getRowElement();return t&&t.lastChild?t.lastChild.previousSibling:null},Blockly.tree.BaseNode.prototype.getChildrenElement=function(){var t=this.getElement();return t?t.lastChild:null},Blockly.tree.BaseNode.prototype.getIconClass=function(){return this.iconClass_},Blockly.tree.BaseNode.prototype.getExpandedIconClass=function(){return this.expandedIconClass_},Blockly.tree.BaseNode.prototype.setText=function(t){this.content_=t},Blockly.tree.BaseNode.prototype.getText=function(){return this.content_},Blockly.tree.BaseNode.prototype.updateRow=function(){var t=this.getRowElement();t&&(t.className=this.getRowClassName())},Blockly.tree.BaseNode.prototype.updateExpandIcon=function(){var t=this.getChildrenElement();t&&(t.style.backgroundPosition=this.getBackgroundPosition())},Blockly.tree.BaseNode.prototype.updateIcon_=function(){this.getIconElement().className=this.getCalculatedIconClass()},Blockly.tree.BaseNode.prototype.onMouseDown=function(t){"expand"==t.target.getAttribute("type")&&this.hasChildren()?this.isUserCollapsible_&&this.toggle():(this.select(),this.updateRow())},Blockly.tree.BaseNode.prototype.onClick_=function(t){t.preventDefault()},Blockly.tree.BaseNode.prototype.onKeyDown=function(t){var e=!0;switch(t.keyCode){case Blockly.utils.KeyCodes.RIGHT:if(t.altKey)break;e=this.selectChild();break;case Blockly.utils.KeyCodes.LEFT:if(t.altKey)break;e=this.selectParent();break;case Blockly.utils.KeyCodes.DOWN:e=this.selectNext();break;case Blockly.utils.KeyCodes.UP:e=this.selectPrevious();break;default:e=!1}return e&&t.preventDefault(),e},Blockly.tree.BaseNode.prototype.selectNext=function(){var t=this.getNextShownNode();return t&&t.select(),!0},Blockly.tree.BaseNode.prototype.selectPrevious=function(){var t=this.getPreviousShownNode();return t&&t.select(),!0},Blockly.tree.BaseNode.prototype.selectParent=function(){if(this.hasChildren()&&this.getExpanded()&&this.isUserCollapsible_)this.setExpanded(!1);else{var t=this.getParent(),e=this.getTree();t&&t!=e&&t.select()}return!0},Blockly.tree.BaseNode.prototype.selectChild=function(){return!!this.hasChildren()&&(this.getExpanded()?this.getFirstChild().select():this.setExpanded(!0),!0)},Blockly.tree.BaseNode.prototype.getLastShownDescendant=function(){return this.getExpanded()&&this.hasChildren()?this.getLastChild().getLastShownDescendant():this},Blockly.tree.BaseNode.prototype.getNextShownNode=function(){if(this.hasChildren()&&this.getExpanded())return this.getFirstChild();for(var t,e=this;e!=this.getTree();){if(null!=(t=e.getNextSibling()))return t;e=e.getParent()}return null},Blockly.tree.BaseNode.prototype.getPreviousShownNode=function(){var t=this.getPreviousSibling();if(null!=t)return t.getLastShownDescendant();t=this.getParent();var e=this.getTree();return t==e||this==e?null:t},Blockly.tree.BaseNode.prototype.getConfig=function(){return this.config_},Blockly.tree.BaseNode.prototype.setTreeInternal=function(t){this.tree!=t&&(this.tree=t,this.forEachChild((function(e){e.setTreeInternal(t)})))},Blockly.tree.TreeNode=function(t,e,o){this.toolbox_=t,Blockly.tree.BaseNode.call(this,e,o)},Blockly.utils.object.inherits(Blockly.tree.TreeNode,Blockly.tree.BaseNode),Blockly.tree.TreeNode.prototype.getTree=function(){if(this.tree)return this.tree;var t=this.getParent();return t&&(t=t.getTree())?(this.setTreeInternal(t),t):null},Blockly.tree.TreeNode.prototype.getCalculatedIconClass=function(){var t=this.getExpanded(),e=this.getExpandedIconClass();if(t&&e)return e;if(e=this.getIconClass(),!t&&e)return e;if(e=this.getConfig(),this.hasChildren()){if(t&&e.cssExpandedFolderIcon)return e.cssTreeIcon+" "+e.cssExpandedFolderIcon;if(!t&&e.cssCollapsedFolderIcon)return e.cssTreeIcon+" "+e.cssCollapsedFolderIcon}else if(e.cssFileIcon)return e.cssTreeIcon+" "+e.cssFileIcon;return""},Blockly.tree.TreeNode.prototype.onClick_=function(t){this.hasChildren()&&this.isUserCollapsible()?(this.toggle(),this.select()):this.isSelected()?this.getTree().setSelectedItem(null):this.select(),this.updateRow()},Blockly.tree.TreeNode.prototype.onMouseDown=function(t){},Blockly.tree.TreeNode.prototype.onKeyDown=function(t){if(this.tree.toolbox_.horizontalLayout_){var e={},o=Blockly.utils.KeyCodes.DOWN,l=Blockly.utils.KeyCodes.UP;e[Blockly.utils.KeyCodes.RIGHT]=this.isRightToLeft()?l:o,e[Blockly.utils.KeyCodes.LEFT]=this.isRightToLeft()?o:l,e[Blockly.utils.KeyCodes.UP]=Blockly.utils.KeyCodes.LEFT,e[Blockly.utils.KeyCodes.DOWN]=Blockly.utils.KeyCodes.RIGHT,Object.defineProperties(t,{keyCode:{value:e[t.keyCode]||t.keyCode}})}return Blockly.tree.TreeNode.superClass_.onKeyDown.call(this,t)},Blockly.tree.TreeNode.prototype.onSizeChanged=function(t){this.onSizeChanged_=t},Blockly.tree.TreeNode.prototype.resizeToolbox_=function(){this.onSizeChanged_&&this.onSizeChanged_.call(this.toolbox_)},Blockly.tree.TreeNode.prototype.doNodeExpanded=Blockly.tree.TreeNode.prototype.resizeToolbox_,Blockly.tree.TreeNode.prototype.doNodeCollapsed=Blockly.tree.TreeNode.prototype.resizeToolbox_,Blockly.tree.TreeControl=function(t,e){this.toolbox_=t,Blockly.tree.BaseNode.call(this,"",e),this.setExpandedInternal(!0),this.setSelectedInternal(!0),this.selectedItem_=this},Blockly.utils.object.inherits(Blockly.tree.TreeControl,Blockly.tree.BaseNode),Blockly.tree.TreeControl.prototype.getTree=function(){return this},Blockly.tree.TreeControl.prototype.getToolbox=function(){return this.toolbox_},Blockly.tree.TreeControl.prototype.getDepth=function(){return 0},Blockly.tree.TreeControl.prototype.handleFocus_=function(t){this.focused_=!0,t=this.getElement(),Blockly.utils.dom.addClass(t,"focused"),this.selectedItem_&&this.selectedItem_.select()},Blockly.tree.TreeControl.prototype.handleBlur_=function(t){this.focused_=!1,t=this.getElement(),Blockly.utils.dom.removeClass(t,"focused")},Blockly.tree.TreeControl.prototype.hasFocus=function(){return this.focused_},Blockly.tree.TreeControl.prototype.getExpanded=function(){return!0},Blockly.tree.TreeControl.prototype.setExpanded=function(t){this.setExpandedInternal(t)},Blockly.tree.TreeControl.prototype.getIconElement=function(){var t=this.getRowElement();return t?t.firstChild:null},Blockly.tree.TreeControl.prototype.updateExpandIcon=function(){},Blockly.tree.TreeControl.prototype.getRowClassName=function(){return Blockly.tree.TreeControl.superClass_.getRowClassName.call(this)+" "+this.getConfig().cssHideRoot},Blockly.tree.TreeControl.prototype.getCalculatedIconClass=function(){var t=this.getExpanded(),e=this.getExpandedIconClass();return t&&e?e:(e=this.getIconClass(),!t&&e?e:(e=this.getConfig(),t&&e.cssExpandedRootIcon?e.cssTreeIcon+" "+e.cssExpandedRootIcon:""))},Blockly.tree.TreeControl.prototype.setSelectedItem=function(t){if(t!=this.selectedItem_&&(!this.onBeforeSelected_||this.onBeforeSelected_.call(this.toolbox_,t))){var e=this.getSelectedItem();this.selectedItem_&&this.selectedItem_.setSelectedInternal(!1),(this.selectedItem_=t)&&t.setSelectedInternal(!0),this.onAfterSelected_&&this.onAfterSelected_.call(this.toolbox_,e,t)}},Blockly.tree.TreeControl.prototype.onBeforeSelected=function(t){this.onBeforeSelected_=t},Blockly.tree.TreeControl.prototype.onAfterSelected=function(t){this.onAfterSelected_=t},Blockly.tree.TreeControl.prototype.getSelectedItem=function(){return this.selectedItem_},Blockly.tree.TreeControl.prototype.initAccessibility=function(){Blockly.tree.TreeControl.superClass_.initAccessibility.call(this);var t=this.getElement();Blockly.utils.aria.setRole(t,Blockly.utils.aria.Role.TREE),Blockly.utils.aria.setState(t,Blockly.utils.aria.State.LABELLEDBY,this.getLabelElement().id)},Blockly.tree.TreeControl.prototype.enterDocument=function(){Blockly.tree.TreeControl.superClass_.enterDocument.call(this);var t=this.getElement();t.className=this.getConfig().cssRoot,t.setAttribute("hideFocus","true"),this.attachEvents_(),this.initAccessibility()},Blockly.tree.TreeControl.prototype.exitDocument=function(){Blockly.tree.TreeControl.superClass_.exitDocument.call(this),this.detachEvents_()},Blockly.tree.TreeControl.prototype.attachEvents_=function(){var t=this.getElement();t.tabIndex=0,this.onFocusWrapper_=Blockly.bindEvent_(t,"focus",this,this.handleFocus_),this.onBlurWrapper_=Blockly.bindEvent_(t,"blur",this,this.handleBlur_),this.onClickWrapper_=Blockly.bindEventWithChecks_(t,"click",this,this.handleMouseEvent_),this.onKeydownWrapper_=Blockly.bindEvent_(t,"keydown",this,this.handleKeyEvent_)},Blockly.tree.TreeControl.prototype.detachEvents_=function(){Blockly.unbindEvent_(this.onFocusWrapper_),Blockly.unbindEvent_(this.onBlurWrapper_),Blockly.unbindEvent_(this.onClickWrapper_),Blockly.unbindEvent_(this.onKeydownWrapper_)},Blockly.tree.TreeControl.prototype.handleMouseEvent_=function(t){var e=this.getNodeFromEvent_(t);if(e)switch(t.type){case"mousedown":e.onMouseDown(t);break;case"click":e.onClick_(t)}},Blockly.tree.TreeControl.prototype.handleKeyEvent_=function(t){var e=!1;return(e=this.selectedItem_&&this.selectedItem_.onKeyDown(t)||e)&&(Blockly.utils.style.scrollIntoContainerView(this.selectedItem_.getElement(),this.getElement().parentNode),t.preventDefault()),e},Blockly.tree.TreeControl.prototype.getNodeFromEvent_=function(t){for(var e=t.target;null!=e;){if(t=Blockly.tree.BaseNode.allNodes[e.id])return t;if(e==this.getElement())break;e=e.parentNode}return null},Blockly.tree.TreeControl.prototype.createNode=function(t){return new Blockly.tree.TreeNode(this.toolbox_,t||"",this.getConfig())},Blockly.FieldTextInput=function(t,e,o){this.spellcheck_=!0,null==t&&(t=""),Blockly.FieldTextInput.superClass_.constructor.call(this,t,e,o)},Blockly.utils.object.inherits(Blockly.FieldTextInput,Blockly.Field),Blockly.FieldTextInput.fromJson=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return new Blockly.FieldTextInput(e,void 0,t)},Blockly.FieldTextInput.prototype.SERIALIZABLE=!0,Blockly.FieldTextInput.FONTSIZE=11,Blockly.FieldTextInput.BORDERRADIUS=4,Blockly.FieldTextInput.prototype.CURSOR="text",Blockly.FieldTextInput.prototype.configure_=function(t){Blockly.FieldTextInput.superClass_.configure_.call(this,t),"boolean"==typeof t.spellcheck&&(this.spellcheck_=t.spellcheck)},Blockly.FieldTextInput.prototype.doClassValidation_=function(t){return null==t?null:String(t)},Blockly.FieldTextInput.prototype.doValueInvalid_=function(t){this.isBeingEdited_&&(this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.untypedDefaultValue_,this.sourceBlock_&&Blockly.Events.isEnabled()&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name||null,t,this.value_)))},Blockly.FieldTextInput.prototype.doValueUpdate_=function(t){this.isTextValid_=!0,this.value_=t,this.isBeingEdited_||(this.isDirty_=!0)},Blockly.FieldTextInput.prototype.render_=function(){Blockly.FieldTextInput.superClass_.render_.call(this),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.isTextValid_?(Blockly.utils.dom.removeClass(this.htmlInput_,"blocklyInvalidInput"),Blockly.utils.aria.setState(this.htmlInput_,"invalid",!1)):(Blockly.utils.dom.addClass(this.htmlInput_,"blocklyInvalidInput"),Blockly.utils.aria.setState(this.htmlInput_,"invalid",!0)))},Blockly.FieldTextInput.prototype.setSpellcheck=function(t){t!=this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))},Blockly.FieldTextInput.prototype.showEditor_=function(t){this.workspace_=this.sourceBlock_.workspace,!(t=t||!1)&&(Blockly.utils.userAgent.MOBILE||Blockly.utils.userAgent.ANDROID||Blockly.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(t)},Blockly.FieldTextInput.prototype.showPromptEditor_=function(){var t=this;Blockly.prompt(Blockly.Msg.CHANGE_VALUE_TITLE,this.getText(),(function(e){t.setValue(e)}))},Blockly.FieldTextInput.prototype.showInlineEditor_=function(t){Blockly.WidgetDiv.show(this,this.sourceBlock_.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,t||(this.htmlInput_.focus(),this.htmlInput_.select())},Blockly.FieldTextInput.prototype.widgetCreate_=function(){var t=Blockly.WidgetDiv.DIV,e=document.createElement("input");e.className="blocklyHtmlInput",e.setAttribute("spellcheck",this.spellcheck_);var o=Blockly.FieldTextInput.FONTSIZE*this.workspace_.scale+"pt";return t.style.fontSize=o,e.style.fontSize=o,e.style.borderRadius=Blockly.FieldTextInput.BORDERRADIUS*this.workspace_.scale+"px",t.appendChild(e),e.value=e.defaultValue=this.getEditorText_(this.value_),e.untypedDefaultValue_=this.value_,e.oldValue_=null,Blockly.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(e),e},Blockly.FieldTextInput.prototype.widgetDispose_=function(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_&&this.onFinishEditing_(this.value_),this.unbindInputEvents_();var t=Blockly.WidgetDiv.DIV.style;t.width="auto",t.height="auto",t.fontSize=""},Blockly.FieldTextInput.prototype.bindInputEvents_=function(t){this.onKeyDownWrapper_=Blockly.bindEventWithChecks_(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=Blockly.bindEventWithChecks_(t,"input",this,this.onHtmlInputChange_)},Blockly.FieldTextInput.prototype.unbindInputEvents_=function(){Blockly.unbindEvent_(this.onKeyDownWrapper_),Blockly.unbindEvent_(this.onKeyInputWrapper_)},Blockly.FieldTextInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode==Blockly.utils.KeyCodes.ENTER?(Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation()):t.keyCode==Blockly.utils.KeyCodes.ESC?(this.htmlInput_.value=this.htmlInput_.defaultValue,Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation()):t.keyCode==Blockly.utils.KeyCodes.TAB&&(Blockly.WidgetDiv.hide(),Blockly.DropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())},Blockly.FieldTextInput.prototype.onHtmlInputChange_=function(t){(t=this.htmlInput_.value)!==this.htmlInput_.oldValue_&&(this.htmlInput_.oldValue_=t,Blockly.Events.setGroup(!0),t=this.getValueFromEditorText_(t),this.setValue(t),this.forceRerender(),Blockly.Events.setGroup(!1))},Blockly.FieldTextInput.prototype.setEditorValue_=function(t){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t)},Blockly.FieldTextInput.prototype.resizeEditor_=function(){var t=Blockly.WidgetDiv.DIV,e=this.getScaledBBox_();t.style.width=e.right-e.left+"px",t.style.height=e.bottom-e.top+"px",(e=new Blockly.utils.Coordinate(this.sourceBlock_.RTL?e.right-t.offsetWidth:e.left,e.top)).y+=1,Blockly.utils.userAgent.GECKO&&Blockly.WidgetDiv.DIV.style.top&&(--e.x,--e.y),Blockly.utils.userAgent.WEBKIT&&(e.y-=3),t.style.left=e.x+"px",t.style.top=e.y+"px"},Blockly.FieldTextInput.numberValidator=function(t){return console.warn("Blockly.FieldTextInput.numberValidator is deprecated. Use Blockly.FieldNumber instead."),null===t?null:(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,""),t=Number(t||0),isNaN(t)?null:String(t))},Blockly.FieldTextInput.nonnegativeIntegerValidator=function(t){return(t=Blockly.FieldTextInput.numberValidator(t))&&(t=String(Math.max(0,Math.floor(t)))),t},Blockly.FieldTextInput.prototype.isTabNavigable=function(){return!0},Blockly.FieldTextInput.prototype.getText_=function(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null},Blockly.FieldTextInput.prototype.getEditorText_=function(t){return String(t)},Blockly.FieldTextInput.prototype.getValueFromEditorText_=function(t){return t},Blockly.fieldRegistry.register("field_input",Blockly.FieldTextInput),Blockly.FieldAngle=function(t,e,o){this.clockwise_=Blockly.FieldAngle.CLOCKWISE,this.offset_=Blockly.FieldAngle.OFFSET,this.wrap_=Blockly.FieldAngle.WRAP,this.round_=Blockly.FieldAngle.ROUND,Blockly.FieldAngle.superClass_.constructor.call(this,t||0,e,o)},Blockly.utils.object.inherits(Blockly.FieldAngle,Blockly.FieldTextInput),Blockly.FieldAngle.fromJson=function(t){return new Blockly.FieldAngle(t.angle,void 0,t)},Blockly.FieldAngle.prototype.SERIALIZABLE=!0,Blockly.FieldAngle.ROUND=15,Blockly.FieldAngle.HALF=50,Blockly.FieldAngle.CLOCKWISE=!1,Blockly.FieldAngle.OFFSET=0,Blockly.FieldAngle.WRAP=360,Blockly.FieldAngle.RADIUS=Blockly.FieldAngle.HALF-1,Blockly.FieldAngle.prototype.configure_=function(t){switch(Blockly.FieldAngle.superClass_.configure_.call(this,t),t.mode){case"compass":this.clockwise_=!0,this.offset_=90;break;case"protractor":this.clockwise_=!1,this.offset_=0}var e=t.clockwise;"boolean"==typeof e&&(this.clockwise_=e),null!=(e=t.offset)&&(e=Number(e),isNaN(e)||(this.offset_=e)),null!=(e=t.wrap)&&(e=Number(e),isNaN(e)||(this.wrap_=e)),null!=(t=t.round)&&(t=Number(t),isNaN(t)||(this.round_=t))},Blockly.FieldAngle.prototype.initView=function(){Blockly.FieldAngle.superClass_.initView.call(this),this.symbol_=Blockly.utils.dom.createSvgElement("tspan",{},null),this.symbol_.appendChild(document.createTextNode("°")),this.textElement_.appendChild(this.symbol_)},Blockly.FieldAngle.prototype.render_=function(){Blockly.FieldAngle.superClass_.render_.call(this),this.updateGraph_()},Blockly.FieldAngle.prototype.showEditor_=function(){Blockly.FieldAngle.superClass_.showEditor_.call(this,Blockly.utils.userAgent.MOBILE||Blockly.utils.userAgent.ANDROID||Blockly.utils.userAgent.IPAD);var t=this.dropdownCreate_();Blockly.DropDownDiv.getContentDiv().appendChild(t),t=(t=this.sourceBlock_.getColourBorder()).colourBorder||t.colourLight,Blockly.DropDownDiv.setColour(this.sourceBlock_.getColour(),t),Blockly.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.updateGraph_()},Blockly.FieldAngle.prototype.dropdownCreate_=function(){var t=Blockly.utils.dom.createSvgElement("svg",{xmlns:Blockly.utils.dom.SVG_NS,"xmlns:html":Blockly.utils.dom.HTML_NS,"xmlns:xlink":Blockly.utils.dom.XLINK_NS,version:"1.1",height:2*Blockly.FieldAngle.HALF+"px",width:2*Blockly.FieldAngle.HALF+"px",style:"touch-action: none"},null),e=Blockly.utils.dom.createSvgElement("circle",{cx:Blockly.FieldAngle.HALF,cy:Blockly.FieldAngle.HALF,r:Blockly.FieldAngle.RADIUS,class:"blocklyAngleCircle"},t);this.gauge_=Blockly.utils.dom.createSvgElement("path",{class:"blocklyAngleGauge"},t),this.line_=Blockly.utils.dom.createSvgElement("line",{x1:Blockly.FieldAngle.HALF,y1:Blockly.FieldAngle.HALF,class:"blocklyAngleLine"},t);for(var o=0;360>o;o+=15)Blockly.utils.dom.createSvgElement("line",{x1:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS,y1:Blockly.FieldAngle.HALF,x2:Blockly.FieldAngle.HALF+Blockly.FieldAngle.RADIUS-(0==o%45?10:5),y2:Blockly.FieldAngle.HALF,class:"blocklyAngleMarks",transform:"rotate("+o+","+Blockly.FieldAngle.HALF+","+Blockly.FieldAngle.HALF+")"},t);return this.clickWrapper_=Blockly.bindEventWithChecks_(t,"click",this,this.hide_),this.clickSurfaceWrapper_=Blockly.bindEventWithChecks_(e,"click",this,this.onMouseMove,!0,!0),this.moveSurfaceWrapper_=Blockly.bindEventWithChecks_(e,"mousemove",this,this.onMouseMove,!0,!0),t},Blockly.FieldAngle.prototype.dropdownDispose_=function(){Blockly.unbindEvent_(this.clickWrapper_),Blockly.unbindEvent_(this.clickSurfaceWrapper_),Blockly.unbindEvent_(this.moveSurfaceWrapper_)},Blockly.FieldAngle.prototype.hide_=function(){Blockly.DropDownDiv.hideIfOwner(this),Blockly.WidgetDiv.hide()},Blockly.FieldAngle.prototype.onMouseMove=function(t){var e=this.gauge_.ownerSVGElement.getBoundingClientRect(),o=t.clientX-e.left-Blockly.FieldAngle.HALF;t=t.clientY-e.top-Blockly.FieldAngle.HALF,e=Math.atan(-t/o),isNaN(e)||(e=Blockly.utils.math.toDegrees(e),0>o?e+=180:0<t&&(e+=360),this.displayMouseOrKeyboardValue_(e=this.clockwise_?this.offset_+360-e:360-(this.offset_-e)))},Blockly.FieldAngle.prototype.displayMouseOrKeyboardValue_=function(t){this.round_&&(t=Math.round(t/this.round_)*this.round_),(t=this.wrapValue_(t))!=this.value_&&this.setEditorValue_(t)},Blockly.FieldAngle.prototype.updateGraph_=function(){if(this.gauge_){var t=Number(this.getText())+this.offset_,e=Blockly.utils.math.toRadians(t%360);t=["M ",Blockly.FieldAngle.HALF,",",Blockly.FieldAngle.HALF];var o=Blockly.FieldAngle.HALF,l=Blockly.FieldAngle.HALF;if(!isNaN(e)){var i=Number(this.clockwise_),n=Blockly.utils.math.toRadians(this.offset_),r=Math.cos(n)*Blockly.FieldAngle.RADIUS,s=Math.sin(n)*-Blockly.FieldAngle.RADIUS;i&&(e=2*n-e),o+=Math.cos(e)*Blockly.FieldAngle.RADIUS,l-=Math.sin(e)*Blockly.FieldAngle.RADIUS,e=Math.abs(Math.floor((e-n)/Math.PI)%2),i&&(e=1-e),t.push(" l ",r,",",s," A ",Blockly.FieldAngle.RADIUS,",",Blockly.FieldAngle.RADIUS," 0 ",e," ",i," ",o,",",l," z")}this.gauge_.setAttribute("d",t.join("")),this.line_.setAttribute("x2",o),this.line_.setAttribute("y2",l)}},Blockly.FieldAngle.prototype.onHtmlInputKeyDown_=function(t){var e;if(Blockly.FieldAngle.superClass_.onHtmlInputKeyDown_.call(this,t),t.keyCode===Blockly.utils.KeyCodes.LEFT?e=this.sourceBlock_.RTL?1:-1:t.keyCode===Blockly.utils.KeyCodes.RIGHT?e=this.sourceBlock_.RTL?-1:1:t.keyCode===Blockly.utils.KeyCodes.DOWN?e=-1:t.keyCode===Blockly.utils.KeyCodes.UP&&(e=1),e){var o=this.getValue();this.displayMouseOrKeyboardValue_(o+e*this.round_),t.preventDefault(),t.stopPropagation()}},Blockly.FieldAngle.prototype.doClassValidation_=function(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue_(t)},Blockly.FieldAngle.prototype.wrapValue_=function(t){return 0>(t%=360)&&(t+=360),t>this.wrap_&&(t-=360),t},Blockly.Css.register(".blocklyAngleCircle {,stroke: #444;,stroke-width: 1;,fill: #ddd;,fill-opacity: .8;,},.blocklyAngleMarks {,stroke: #444;,stroke-width: 1;,},.blocklyAngleGauge {,fill: #f88;,fill-opacity: .8;,pointer-events: none;,},.blocklyAngleLine {,stroke: #f00;,stroke-width: 2;,stroke-linecap: round;,pointer-events: none;,}".split(",")),Blockly.fieldRegistry.register("field_angle",Blockly.FieldAngle),Blockly.FieldCheckbox=function(t,e,o){this.checkChar_=null,null==t&&(t="FALSE"),Blockly.FieldCheckbox.superClass_.constructor.call(this,t,e,o),this.size_.width=Blockly.FieldCheckbox.WIDTH},Blockly.utils.object.inherits(Blockly.FieldCheckbox,Blockly.Field),Blockly.FieldCheckbox.fromJson=function(t){return new Blockly.FieldCheckbox(t.checked,void 0,t)},Blockly.FieldCheckbox.WIDTH=15,Blockly.FieldCheckbox.CHECK_CHAR="✓",Blockly.FieldCheckbox.CHECK_X_OFFSET=Blockly.Field.DEFAULT_TEXT_OFFSET-3,Blockly.FieldCheckbox.CHECK_Y_OFFSET=14,Blockly.FieldCheckbox.prototype.SERIALIZABLE=!0,Blockly.FieldCheckbox.prototype.CURSOR="default",Blockly.FieldCheckbox.prototype.isDirty_=!1,Blockly.FieldCheckbox.prototype.configure_=function(t){Blockly.FieldCheckbox.superClass_.configure_.call(this,t),t.checkCharacter&&(this.checkChar_=t.checkCharacter)},Blockly.FieldCheckbox.prototype.initView=function(){Blockly.FieldCheckbox.superClass_.initView.call(this),this.textElement_.setAttribute("x",Blockly.FieldCheckbox.CHECK_X_OFFSET),this.textElement_.setAttribute("y",Blockly.FieldCheckbox.CHECK_Y_OFFSET),Blockly.utils.dom.addClass(this.textElement_,"blocklyCheckbox"),this.textContent_.nodeValue=this.checkChar_||Blockly.FieldCheckbox.CHECK_CHAR,this.textElement_.style.display=this.value_?"block":"none"},Blockly.FieldCheckbox.prototype.setCheckCharacter=function(t){this.checkChar_=t,this.textContent_&&(this.textContent_.nodeValue=t||Blockly.FieldCheckbox.CHECK_CHAR)},Blockly.FieldCheckbox.prototype.showEditor_=function(){this.setValue(!this.value_)},Blockly.FieldCheckbox.prototype.doClassValidation_=function(t){return!0===t||"TRUE"===t?"TRUE":!1===t||"FALSE"===t?"FALSE":null},Blockly.FieldCheckbox.prototype.doValueUpdate_=function(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")},Blockly.FieldCheckbox.prototype.getValue=function(){return this.value_?"TRUE":"FALSE"},Blockly.FieldCheckbox.prototype.getValueBoolean=function(){return this.value_},Blockly.FieldCheckbox.prototype.getText=function(){return String(this.convertValueToBool_(this.value_))},Blockly.FieldCheckbox.prototype.convertValueToBool_=function(t){return"string"==typeof t?"TRUE"==t:!!t},Blockly.fieldRegistry.register("field_checkbox",Blockly.FieldCheckbox),Blockly.FieldColour=function(t,e,o){Blockly.FieldColour.superClass_.constructor.call(this,t||Blockly.FieldColour.COLOURS[0],e,o),this.size_=new Blockly.utils.Size(Blockly.FieldColour.DEFAULT_WIDTH,Blockly.FieldColour.DEFAULT_HEIGHT)},Blockly.utils.object.inherits(Blockly.FieldColour,Blockly.Field),Blockly.FieldColour.fromJson=function(t){return new Blockly.FieldColour(t.colour,void 0,t)},Blockly.FieldColour.DEFAULT_WIDTH=26,Blockly.FieldColour.DEFAULT_HEIGHT=Blockly.Field.BORDER_RECT_DEFAULT_HEIGHT,Blockly.FieldColour.prototype.SERIALIZABLE=!0,Blockly.FieldColour.prototype.CURSOR="default",Blockly.FieldColour.prototype.isDirty_=!1,Blockly.FieldColour.prototype.colours_=null,Blockly.FieldColour.prototype.titles_=null,Blockly.FieldColour.prototype.columns_=0,Blockly.FieldColour.prototype.configure_=function(t){Blockly.FieldColour.superClass_.configure_.call(this,t),t.colourOptions&&(this.colours_=t.colourOptions,this.titles_=t.colourTitles),t.columns&&(this.columns_=t.columns)},Blockly.FieldColour.prototype.initView=function(){this.createBorderRect_(),this.borderRect_.style.fillOpacity=1,this.borderRect_.style.fill=this.value_},Blockly.FieldColour.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:Blockly.utils.colour.parse(t)},Blockly.FieldColour.prototype.doValueUpdate_=function(t){this.value_=t,this.borderRect_&&(this.borderRect_.style.fill=t)},Blockly.FieldColour.prototype.getText=function(){var t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t},Blockly.FieldColour.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),Blockly.FieldColour.TITLES=[],Blockly.FieldColour.COLUMNS=7,Blockly.FieldColour.prototype.setColours=function(t,e){return this.colours_=t,e&&(this.titles_=e),this},Blockly.FieldColour.prototype.setColumns=function(t){return this.columns_=t,this},Blockly.FieldColour.prototype.showEditor_=function(){this.picker_=this.dropdownCreate_(),Blockly.DropDownDiv.getContentDiv().appendChild(this.picker_),Blockly.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.picker_.focus()},Blockly.FieldColour.prototype.onClick_=function(t){null!==(t=(t=t.target)&&t.label)&&(this.setValue(t),Blockly.DropDownDiv.hideIfOwner(this))},Blockly.FieldColour.prototype.onKeyDown_=function(t){var e=!1;t.keyCode===Blockly.utils.KeyCodes.UP?(this.moveHighlightBy_(0,-1),e=!0):t.keyCode===Blockly.utils.KeyCodes.DOWN?(this.moveHighlightBy_(0,1),e=!0):t.keyCode===Blockly.utils.KeyCodes.LEFT?(this.moveHighlightBy_(-1,0),e=!0):t.keyCode===Blockly.utils.KeyCodes.RIGHT?(this.moveHighlightBy_(1,0),e=!0):t.keyCode===Blockly.utils.KeyCodes.ENTER&&((e=this.getHighlighted_())&&null!==(e=e&&e.label)&&this.setValue(e),Blockly.DropDownDiv.hideWithoutAnimation(),e=!0),e&&t.stopPropagation()},Blockly.FieldColour.prototype.onBlocklyAction=function(t){if(this.picker_){if(t===Blockly.navigation.ACTION_PREVIOUS)return this.moveHighlightBy_(0,-1),!0;if(t===Blockly.navigation.ACTION_NEXT)return this.moveHighlightBy_(0,1),!0;if(t===Blockly.navigation.ACTION_OUT)return this.moveHighlightBy_(-1,0),!0;if(t===Blockly.navigation.ACTION_IN)return this.moveHighlightBy_(1,0),!0}return Blockly.FieldColour.superClass_.onBlocklyAction.call(this,t)},Blockly.FieldColour.prototype.moveHighlightBy_=function(t,e){var o=this.colours_||Blockly.FieldColour.COLOURS,l=this.columns_||Blockly.FieldColour.COLUMNS,i=this.highlightedIndex_%l,n=Math.floor(this.highlightedIndex_/l);i+=t,n+=e,0>t?0>i&&0<n?(i=l-1,n--):0>i&&(i=0):0<t?i>l-1&&n<Math.floor(o.length/l)-1?(i=0,n++):i>l-1&&i--:0>e?0>n&&(n=0):0<e&&n>Math.floor(o.length/l)-1&&(n=Math.floor(o.length/l)-1),this.setHighlightedCell_(this.picker_.childNodes[n].childNodes[i],n*l+i)},Blockly.FieldColour.prototype.onMouseMove_=function(t){var e=(t=t.target)&&t.getAttribute("data-index");null!==e&&e!==this.highlightedIndex_&&this.setHighlightedCell_(t,Number(e))},Blockly.FieldColour.prototype.onMouseEnter_=function(){this.picker_.focus()},Blockly.FieldColour.prototype.onMouseLeave_=function(){this.picker_.blur();var t=this.getHighlighted_();t&&Blockly.utils.dom.removeClass(t,"blocklyColourHighlighted")},Blockly.FieldColour.prototype.getHighlighted_=function(){var t=this.columns_||Blockly.FieldColour.COLUMNS,e=this.picker_.childNodes[Math.floor(this.highlightedIndex_/t)];return e?e.childNodes[this.highlightedIndex_%t]:null},Blockly.FieldColour.prototype.setHighlightedCell_=function(t,e){var o=this.getHighlighted_();o&&Blockly.utils.dom.removeClass(o,"blocklyColourHighlighted"),Blockly.utils.dom.addClass(t,"blocklyColourHighlighted"),this.highlightedIndex_=e,Blockly.utils.aria.setState(this.picker_,Blockly.utils.aria.State.ACTIVEDESCENDANT,t.getAttribute("id"))},Blockly.FieldColour.prototype.dropdownCreate_=function(){var t=this.columns_||Blockly.FieldColour.COLUMNS,e=this.colours_||Blockly.FieldColour.COLOURS,o=this.titles_||Blockly.FieldColour.TITLES,l=this.getValue(),i=document.createElement("table");i.className="blocklyColourTable",i.tabIndex=0,i.dir="ltr",Blockly.utils.aria.setRole(i,Blockly.utils.aria.Role.GRID),Blockly.utils.aria.setState(i,Blockly.utils.aria.State.EXPANDED,!0),Blockly.utils.aria.setState(i,"rowcount",Math.floor(e.length/t)),Blockly.utils.aria.setState(i,"colcount",t);for(var n,r=0;r<e.length;r++){0==r%t&&(n=document.createElement("tr"),Blockly.utils.aria.setRole(n,Blockly.utils.aria.Role.ROW),i.appendChild(n));var s=document.createElement("td");n.appendChild(s),s.label=e[r],s.title=o[r]||e[r],s.id=Blockly.utils.IdGenerator.getNextUniqueId(),s.setAttribute("data-index",r),Blockly.utils.aria.setRole(s,Blockly.utils.aria.Role.GRIDCELL),Blockly.utils.aria.setState(s,Blockly.utils.aria.State.LABEL,e[r]),Blockly.utils.aria.setState(s,Blockly.utils.aria.State.SELECTED,e[r]==l),s.style.backgroundColor=e[r],e[r]==l&&(s.className="blocklyColourSelected",this.highlightedIndex_=r)}return this.onClickWrapper_=Blockly.bindEventWithChecks_(i,"click",this,this.onClick_,!0),this.onMouseMoveWrapper_=Blockly.bindEventWithChecks_(i,"mousemove",this,this.onMouseMove_,!0),this.onMouseEnterWrapper_=Blockly.bindEventWithChecks_(i,"mouseenter",this,this.onMouseEnter_,!0),this.onMouseLeaveWrapper_=Blockly.bindEventWithChecks_(i,"mouseleave",this,this.onMouseLeave_,!0),this.onKeyDownWrapper_=Blockly.bindEventWithChecks_(i,"keydown",this,this.onKeyDown_),i},Blockly.FieldColour.prototype.dropdownDispose_=function(){Blockly.unbindEvent_(this.onClickWrapper_),Blockly.unbindEvent_(this.onMouseMoveWrapper_),Blockly.unbindEvent_(this.onMouseEnterWrapper_),Blockly.unbindEvent_(this.onMouseLeaveWrapper_),Blockly.unbindEvent_(this.onKeyDownWrapper_),this.picker_=null},Blockly.Css.register([".blocklyColourTable {","border-collapse: collapse;","display: block;","outline: none;","padding: 1px;","}",".blocklyColourTable>tr>td {","border: .5px solid #888;","box-sizing: border-box;","cursor: pointer;","display: inline-block;","height: 20px;","padding: 0;","width: 20px;","}",".blocklyColourTable>tr>td.blocklyColourHighlighted {","border-color: #eee;","box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);","position: relative;","}",".blocklyColourSelected, .blocklyColourSelected:hover {","border-color: #eee !important;","outline: 1px solid #333;","position: relative;","}"]),Blockly.fieldRegistry.register("field_colour",Blockly.FieldColour),Blockly.FieldDropdown=function(t,e,o){"function"!=typeof t&&Blockly.FieldDropdown.validateOptions_(t),this.menuGenerator_=t,this.generatedOptions_=null,this.selectedIndex_=0,this.trimOptions_(),t=this.getOptions(!1)[0],Blockly.FieldDropdown.superClass_.constructor.call(this,t[1],e,o),this.selectedMenuItem_=this.imageElement_=null},Blockly.utils.object.inherits(Blockly.FieldDropdown,Blockly.Field),Blockly.FieldDropdown.fromJson=function(t){return new Blockly.FieldDropdown(t.options,void 0,t)},Blockly.FieldDropdown.prototype.SERIALIZABLE=!0,Blockly.FieldDropdown.CHECKMARK_OVERHANG=25,Blockly.FieldDropdown.MAX_MENU_HEIGHT_VH=.45,Blockly.FieldDropdown.IMAGE_Y_OFFSET=5,Blockly.FieldDropdown.IMAGE_Y_PADDING=2*Blockly.FieldDropdown.IMAGE_Y_OFFSET,Blockly.FieldDropdown.ARROW_CHAR=Blockly.utils.userAgent.ANDROID?"▼":"▾",Blockly.FieldDropdown.prototype.CURSOR="default",Blockly.FieldDropdown.prototype.initView=function(){Blockly.FieldDropdown.superClass_.initView.call(this),this.imageElement_=Blockly.utils.dom.createSvgElement("image",{y:Blockly.FieldDropdown.IMAGE_Y_OFFSET},this.fieldGroup_),this.arrow_=Blockly.utils.dom.createSvgElement("tspan",{},this.textElement_),this.arrow_.appendChild(document.createTextNode(this.sourceBlock_.RTL?Blockly.FieldDropdown.ARROW_CHAR+" ":" "+Blockly.FieldDropdown.ARROW_CHAR)),this.sourceBlock_.RTL?this.textElement_.insertBefore(this.arrow_,this.textContent_):this.textElement_.appendChild(this.arrow_)},Blockly.FieldDropdown.prototype.showEditor_=function(){this.menu_=this.dropdownCreate_(),this.menu_.render(Blockly.DropDownDiv.getContentDiv()),Blockly.utils.dom.addClass(this.menu_.getElement(),"blocklyDropdownMenu"),Blockly.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem_&&Blockly.utils.style.scrollIntoContainerView(this.selectedMenuItem_.getElement(),this.menu_.getElement())},Blockly.FieldDropdown.prototype.dropdownCreate_=function(){var t=new Blockly.Menu;t.setRightToLeft(this.sourceBlock_.RTL),t.setRole("listbox");var e=this.getOptions(!1);this.selectedMenuItem_=null;for(var o=0;o<e.length;o++){var l=e[o][0],i=e[o][1];if("object"==typeof l){var n=new Image(l.width,l.height);n.src=l.src,n.alt=l.alt||"",l=n}(l=new Blockly.MenuItem(l)).setRole("option"),l.setRightToLeft(this.sourceBlock_.RTL),l.setValue(i),l.setCheckable(!0),t.addChild(l,!0),l.setChecked(i==this.value_),i==this.value_&&(this.selectedMenuItem_=l),l.onAction(this.handleMenuActionEvent_,this)}return Blockly.utils.aria.setState(t.getElement(),Blockly.utils.aria.State.ACTIVEDESCENDANT,this.selectedMenuItem_?this.selectedMenuItem_.getId():""),t},Blockly.FieldDropdown.prototype.dropdownDispose_=function(){this.menu_.dispose(),this.menu_=null},Blockly.FieldDropdown.prototype.handleMenuActionEvent_=function(t){Blockly.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected(this.menu_,t)},Blockly.FieldDropdown.prototype.onItemSelected=function(t,e){this.setValue(e.getValue())},Blockly.FieldDropdown.prototype.trimOptions_=function(){this.suffixField=this.prefixField=null;var t=this.menuGenerator_;if(Array.isArray(t)){for(var e=!1,o=0;o<t.length;o++){var l=t[o][0];"string"==typeof l?t[o][0]=Blockly.utils.replaceMessageReferences(l):(null!=l.alt&&(t[o][0].alt=Blockly.utils.replaceMessageReferences(l.alt)),e=!0)}if(!(e||2>t.length)){for(e=[],o=0;o<t.length;o++)e.push(t[o][0]);o=Blockly.utils.string.shortestStringLength(e),l=Blockly.utils.string.commonWordPrefix(e,o);var i=Blockly.utils.string.commonWordSuffix(e,o);!l&&!i||o<=l+i||(l&&(this.prefixField=e[0].substring(0,l-1)),i&&(this.suffixField=e[0].substr(1-i)),this.menuGenerator_=Blockly.FieldDropdown.applyTrim_(t,l,i))}}},Blockly.FieldDropdown.applyTrim_=function(t,e,o){for(var l=[],i=0;i<t.length;i++){var n=t[i][0],r=t[i][1];n=n.substring(e,n.length-o),l[i]=[n,r]}return l},Blockly.FieldDropdown.prototype.isOptionListDynamic=function(){return"function"==typeof this.menuGenerator_},Blockly.FieldDropdown.prototype.getOptions=function(t){return this.isOptionListDynamic()?(this.generatedOptions_&&t||(this.generatedOptions_=this.menuGenerator_.call(this),Blockly.FieldDropdown.validateOptions_(this.generatedOptions_)),this.generatedOptions_):this.menuGenerator_},Blockly.FieldDropdown.prototype.doClassValidation_=function(t){for(var e,o=!1,l=this.getOptions(!0),i=0;e=l[i];i++)if(e[1]==t){o=!0;break}return o?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)},Blockly.FieldDropdown.prototype.doValueUpdate_=function(t){Blockly.FieldDropdown.superClass_.doValueUpdate_.call(this,t),t=this.getOptions(!0);for(var e,o=0;e=t[o];o++)e[1]==this.value_&&(this.selectedIndex_=o)},Blockly.FieldDropdown.prototype.updateColour=function(){this.sourceBlock_&&this.arrow_&&(this.arrow_.style.fill=this.sourceBlock_.isShadow()?this.sourceBlock_.getColourShadow():this.sourceBlock_.getColour())},Blockly.FieldDropdown.prototype.render_=function(){this.textContent_.nodeValue="",this.imageElement_.style.display="none";var t=this.getOptions(!0);(t=0<=this.selectedIndex_&&t[this.selectedIndex_][0])&&"object"==typeof t?this.renderSelectedImage_(t):this.renderSelectedText_(),this.borderRect_.setAttribute("height",this.size_.height),this.borderRect_.setAttribute("width",this.size_.width)},Blockly.FieldDropdown.prototype.renderSelectedImage_=function(t){this.imageElement_.style.display="",this.imageElement_.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",t.src),this.imageElement_.setAttribute("height",t.height),this.imageElement_.setAttribute("width",t.width);var e=Blockly.utils.dom.getTextWidth(this.arrow_),o=Number(t.width);this.size_.height=Number(t.height)+Blockly.FieldDropdown.IMAGE_Y_PADDING,this.size_.width=o+e+Blockly.Field.X_PADDING,this.sourceBlock_.RTL?(t=Blockly.Field.DEFAULT_TEXT_OFFSET-1,this.imageElement_.setAttribute("x",Blockly.Field.DEFAULT_TEXT_OFFSET+e),this.textElement_.setAttribute("x",t)):(t=o+e+Blockly.Field.DEFAULT_TEXT_OFFSET+1,this.textElement_.setAttribute("text-anchor","end"),this.textElement_.setAttribute("x",t),this.imageElement_.setAttribute("x",Blockly.Field.DEFAULT_TEXT_OFFSET))},Blockly.FieldDropdown.prototype.renderSelectedText_=function(){this.textContent_.nodeValue=this.getDisplayText_(),this.textElement_.setAttribute("text-anchor","start"),this.textElement_.setAttribute("x",Blockly.Field.DEFAULT_TEXT_OFFSET),this.size_.height=Blockly.Field.BORDER_RECT_DEFAULT_HEIGHT,this.size_.width=Blockly.utils.dom.getTextWidth(this.textElement_)+Blockly.Field.X_PADDING},Blockly.FieldDropdown.prototype.getText_=function(){if(0>this.selectedIndex_)return null;var t=this.getOptions(!0)[this.selectedIndex_][0];return"object"==typeof t?t.alt:t},Blockly.FieldDropdown.validateOptions_=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");for(var e=!1,o=0;o<t.length;++o){var l=t[o];Array.isArray(l)?"string"!=typeof l[1]?(e=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option id must be a string. Found "+l[1]+" in: ",l)):l[0]&&"string"!=typeof l[0]&&"string"!=typeof l[0].src&&(e=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must have a string label or image description. Found"+l[0]+" in: ",l)):(e=!0,console.error("Invalid option["+o+"]: Each FieldDropdown option must be an array. Found: ",l))}if(e)throw TypeError("Found invalid FieldDropdown options.")},Blockly.FieldDropdown.prototype.onBlocklyAction=function(t){if(this.menu_){if(t===Blockly.navigation.ACTION_PREVIOUS)return this.menu_.highlightPrevious(),!0;if(t===Blockly.navigation.ACTION_NEXT)return this.menu_.highlightNext(),!0}return Blockly.FieldDropdown.superClass_.onBlocklyAction.call(this,t)},Blockly.fieldRegistry.register("field_dropdown",Blockly.FieldDropdown),Blockly.FieldImage=function(t,e,o,l,i,n,r){if(!t)throw Error("Src value of an image field is required");if(t=Blockly.utils.replaceMessageReferences(t),o=Number(Blockly.utils.replaceMessageReferences(o)),e=Number(Blockly.utils.replaceMessageReferences(e)),isNaN(o)||isNaN(e))throw Error("Height and width values of an image field must cast to numbers.");if(0>=o||0>=e)throw Error("Height and width values of an image field must be greater than 0.");this.flipRtl_=!1,this.altText_="",Blockly.FieldImage.superClass_.constructor.call(this,t||"",null,r),r||(this.flipRtl_=!!n,this.altText_=Blockly.utils.replaceMessageReferences(l)||""),this.size_=new Blockly.utils.Size(e,o+Blockly.FieldImage.Y_PADDING),this.imageHeight_=o,this.clickHandler_=null,"function"==typeof i&&(this.clickHandler_=i)},Blockly.utils.object.inherits(Blockly.FieldImage,Blockly.Field),Blockly.FieldImage.fromJson=function(t){return new Blockly.FieldImage(t.src,t.width,t.height,void 0,void 0,void 0,t)},Blockly.FieldImage.Y_PADDING=1,Blockly.FieldImage.prototype.EDITABLE=!1,Blockly.FieldImage.prototype.isDirty_=!1,Blockly.FieldImage.prototype.configure_=function(t){Blockly.FieldImage.superClass_.configure_.call(this,t),this.flipRtl_=!!t.flipRtl,this.altText_=Blockly.utils.replaceMessageReferences(t.alt)||""},Blockly.FieldImage.prototype.initView=function(){this.imageElement_=Blockly.utils.dom.createSvgElement("image",{height:this.imageHeight_+"px",width:this.size_.width+"px",alt:this.altText_},this.fieldGroup_),this.imageElement_.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",this.value_)},Blockly.FieldImage.prototype.doClassValidation_=function(t){return"string"!=typeof t?null:t},Blockly.FieldImage.prototype.doValueUpdate_=function(t){this.value_=t,this.imageElement_&&this.imageElement_.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",this.value_||"")},Blockly.FieldImage.prototype.getFlipRtl=function(){return this.flipRtl_},Blockly.FieldImage.prototype.setAlt=function(t){t!=this.altText_&&(this.altText_=t||"",this.imageElement_&&this.imageElement_.setAttribute("alt",this.altText_))},Blockly.FieldImage.prototype.showEditor_=function(){this.clickHandler_&&this.clickHandler_(this)},Blockly.FieldImage.prototype.setOnClickHandler=function(t){this.clickHandler_=t},Blockly.FieldImage.prototype.getText_=function(){return this.altText_},Blockly.fieldRegistry.register("field_image",Blockly.FieldImage),Blockly.FieldLabelSerializable=function(t,e,o){Blockly.FieldLabelSerializable.superClass_.constructor.call(this,t,e,o)},Blockly.utils.object.inherits(Blockly.FieldLabelSerializable,Blockly.FieldLabel),Blockly.FieldLabelSerializable.fromJson=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return new Blockly.FieldLabelSerializable(e,void 0,t)},Blockly.FieldLabelSerializable.prototype.EDITABLE=!1,Blockly.FieldLabelSerializable.prototype.SERIALIZABLE=!0,Blockly.fieldRegistry.register("field_label_serializable",Blockly.FieldLabelSerializable),Blockly.FieldMultilineInput=function(t,e,o){null==t&&(t=""),Blockly.FieldMultilineInput.superClass_.constructor.call(this,t,e,o)},Blockly.utils.object.inherits(Blockly.FieldMultilineInput,Blockly.FieldTextInput),Blockly.FieldMultilineInput.LINE_HEIGHT=20,Blockly.FieldMultilineInput.fromJson=function(t){var e=Blockly.utils.replaceMessageReferences(t.text);return new Blockly.FieldMultilineInput(e,void 0,t)},Blockly.FieldMultilineInput.prototype.initView=function(){this.createBorderRect_(),this.textGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyEditableText"},this.fieldGroup_)},Blockly.FieldMultilineInput.prototype.getDisplayText_=function(){var t=this.value_;if(!t)return Blockly.Field.NBSP;var e=t.split("\n");t="";for(var o=0;o<e.length;o++){var l=e[o];l.length>this.maxDisplayLength&&(l=l.substring(0,this.maxDisplayLength-4)+"..."),t+=l=l.replace(/\s/g,Blockly.Field.NBSP),o!==e.length-1&&(t+="\n")}return this.sourceBlock_.RTL&&(t+="‏"),t},Blockly.FieldMultilineInput.prototype.render_=function(){for(var t;t=this.textGroup_.firstChild;)this.textGroup_.removeChild(t);t=this.getDisplayText_().split("\n");for(var e=Blockly.Field.Y_PADDING/2,o=0,l=0;l<t.length;l++)Blockly.utils.dom.createSvgElement("text",{class:"blocklyText blocklyMultilineText",x:Blockly.Field.DEFAULT_TEXT_OFFSET,y:o+e,dy:Blockly.FieldMultilineInput.LINE_HEIGHT/2},this.textGroup_).appendChild(document.createTextNode(t[l])),o+=Blockly.FieldMultilineInput.LINE_HEIGHT;this.updateSize_(),this.isBeingEdited_&&(this.sourceBlock_.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.isTextValid_?(Blockly.utils.dom.removeClass(this.htmlInput_,"blocklyInvalidInput"),Blockly.utils.aria.setState(this.htmlInput_,"invalid",!1)):(Blockly.utils.dom.addClass(this.htmlInput_,"blocklyInvalidInput"),Blockly.utils.aria.setState(this.htmlInput_,"invalid",!0)))},Blockly.FieldMultilineInput.prototype.updateSize_=function(){for(var t=this.textGroup_.childNodes,e=0,o=0,l=0;l<t.length;l++){var i=Blockly.utils.dom.getTextWidth(t[l]);i>e&&(e=i),o+=Blockly.FieldMultilineInput.LINE_HEIGHT}this.borderRect_&&(this.borderRect_.setAttribute("width",e+=Blockly.Field.X_PADDING),this.borderRect_.setAttribute("height",o)),this.size_.width=e,this.size_.height=o},Blockly.FieldMultilineInput.prototype.resizeEditor_=function(){var t=Blockly.WidgetDiv.DIV,e=this.getScaledBBox_();t.style.width=e.right-e.left+"px",t.style.height=e.bottom-e.top+"px",e=new Blockly.utils.Coordinate(this.sourceBlock_.RTL?e.right-t.offsetWidth:e.left,e.top),t.style.left=e.x+"px",t.style.top=e.y+"px"},Blockly.FieldMultilineInput.prototype.widgetCreate_=function(){var t=Blockly.WidgetDiv.DIV,e=this.workspace_.scale,o=document.createElement("textarea");o.className="blocklyHtmlInput blocklyHtmlTextAreaInput",o.setAttribute("spellcheck",this.spellcheck_);var l=Blockly.FieldTextInput.FONTSIZE*e+"pt";return t.style.fontSize=l,o.style.fontSize=l,o.style.borderRadius=Blockly.FieldTextInput.BORDERRADIUS*e+"px",o.style.paddingLeft=(l=Blockly.Field.DEFAULT_TEXT_OFFSET*e)+"px",o.style.width="calc(100% - "+l+"px)",o.style.lineHeight=Blockly.FieldMultilineInput.LINE_HEIGHT*e+"px",t.appendChild(o),o.value=o.defaultValue=this.getEditorText_(this.value_),o.untypedDefaultValue_=this.value_,o.oldValue_=null,Blockly.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(o),o},Blockly.FieldMultilineInput.prototype.onHtmlInputKeyDown_=function(t){t.keyCode!==Blockly.utils.KeyCodes.ENTER&&Blockly.FieldMultilineInput.superClass_.onHtmlInputKeyDown_.call(this,t)},Blockly.Css.register(".blocklyHtmlTextAreaInput {,font-family: monospace;,resize: none;,overflow: hidden;,height: 100%;,text-align: left;,}".split(",")),Blockly.fieldRegistry.register("field_multilinetext",Blockly.FieldMultilineInput),Blockly.FieldNumber=function(t,e,o,l,i,n){this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces_=null,Blockly.FieldNumber.superClass_.constructor.call(this,t||0,i,n),n||this.setConstraints(e,o,l)},Blockly.utils.object.inherits(Blockly.FieldNumber,Blockly.FieldTextInput),Blockly.FieldNumber.fromJson=function(t){return new Blockly.FieldNumber(t.value,void 0,void 0,void 0,void 0,t)},Blockly.FieldNumber.prototype.SERIALIZABLE=!0,Blockly.FieldNumber.prototype.configure_=function(t){Blockly.FieldNumber.superClass_.configure_.call(this,t),this.setMinInternal_(t.min),this.setMaxInternal_(t.max),this.setPrecisionInternal_(t.precision)},Blockly.FieldNumber.prototype.setConstraints=function(t,e,o){this.setMinInternal_(t),this.setMaxInternal_(e),this.setPrecisionInternal_(o),this.setValue(this.getValue())},Blockly.FieldNumber.prototype.setMin=function(t){this.setMinInternal_(t),this.setValue(this.getValue())},Blockly.FieldNumber.prototype.setMinInternal_=function(t){null==t?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))},Blockly.FieldNumber.prototype.getMin=function(){return this.min_},Blockly.FieldNumber.prototype.setMax=function(t){this.setMaxInternal_(t),this.setValue(this.getValue())},Blockly.FieldNumber.prototype.setMaxInternal_=function(t){null==t?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))},Blockly.FieldNumber.prototype.getMax=function(){return this.max_},Blockly.FieldNumber.prototype.setPrecision=function(t){this.setPrecisionInternal_(t),this.setValue(this.getValue())},Blockly.FieldNumber.prototype.setPrecisionInternal_=function(t){null==t?this.precision_=0:(t=Number(t),isNaN(t)||(this.precision_=t));var e=this.precision_.toString(),o=e.indexOf(".");this.decimalPlaces_=-1==o?t?0:null:e.length-o-1},Blockly.FieldNumber.prototype.getPrecision=function(){return this.precision_},Blockly.FieldNumber.prototype.doClassValidation_=function(t){return null===t?null:(t=(t=(t=String(t)).replace(/O/gi,"0")).replace(/,/g,""),t=Number(t||0),isNaN(t)?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),null!=this.decimalPlaces_&&(t=Number(t.toFixed(this.decimalPlaces_))),t))},Blockly.FieldNumber.prototype.widgetCreate_=function(){var t=Blockly.FieldNumber.superClass_.widgetCreate_.call(this);return-1/0<this.min_&&Blockly.utils.aria.setState(t,Blockly.utils.aria.State.VALUEMIN,this.min_),1/0>this.max_&&Blockly.utils.aria.setState(t,Blockly.utils.aria.State.VALUEMAX,this.max_),t},Blockly.fieldRegistry.register("field_number",Blockly.FieldNumber),Blockly.FieldVariable=function(t,e,o,l,i){this.menuGenerator_=Blockly.FieldVariable.dropdownCreate,this.defaultVariableName=t||"",this.size_=new Blockly.utils.Size(0,Blockly.BlockSvg.MIN_BLOCK_Y),i&&this.configure_(i),e&&this.setValidator(e),i||this.setTypes_(o,l)},Blockly.utils.object.inherits(Blockly.FieldVariable,Blockly.FieldDropdown),Blockly.FieldVariable.fromJson=function(t){var e=Blockly.utils.replaceMessageReferences(t.variable);return new Blockly.FieldVariable(e,void 0,void 0,void 0,t)},Blockly.FieldVariable.prototype.workspace_=null,Blockly.FieldVariable.prototype.SERIALIZABLE=!0,Blockly.FieldVariable.prototype.configure_=function(t){Blockly.FieldVariable.superClass_.configure_.call(this,t),this.setTypes_(t.variableTypes,t.defaultType)},Blockly.FieldVariable.prototype.initModel=function(){if(!this.variable_){var t=Blockly.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,null,this.defaultVariableName,this.defaultType_);Blockly.Events.disable(),this.setValue(t.getId()),Blockly.Events.enable()}},Blockly.FieldVariable.prototype.fromXml=function(t){var e=t.getAttribute("id"),o=t.textContent,l=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(e=Blockly.Variables.getOrCreateVariablePackage(this.sourceBlock_.workspace,e,o,l),null!=l&&l!==e.type)throw Error("Serialized variable type with id '"+e.getId()+"' had type "+e.type+", and does not match variable field that references it: "+Blockly.Xml.domToText(t)+".");this.setValue(e.getId())},Blockly.FieldVariable.prototype.toXml=function(t){return this.initModel(),t.id=this.variable_.getId(),t.textContent=this.variable_.name,this.variable_.type&&t.setAttribute("variabletype",this.variable_.type),t},Blockly.FieldVariable.prototype.setSourceBlock=function(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");Blockly.FieldVariable.superClass_.setSourceBlock.call(this,t)},Blockly.FieldVariable.prototype.getValue=function(){return this.variable_?this.variable_.getId():null},Blockly.FieldVariable.prototype.getText=function(){return this.variable_?this.variable_.name:""},Blockly.FieldVariable.prototype.getVariable=function(){return this.variable_},Blockly.FieldVariable.prototype.getValidator=function(){return this.variable_?this.validator_:null},Blockly.FieldVariable.prototype.doClassValidation_=function(t){if(null===t)return null;var e=Blockly.Variables.getVariable(this.sourceBlock_.workspace,t);return e?this.typeIsAllowed_(e=e.type)?t:(console.warn("Variable type doesn't match this field!  Type was "+e),null):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)},Blockly.FieldVariable.prototype.doValueUpdate_=function(t){this.variable_=Blockly.Variables.getVariable(this.sourceBlock_.workspace,t),Blockly.FieldVariable.superClass_.doValueUpdate_.call(this,t)},Blockly.FieldVariable.prototype.typeIsAllowed_=function(t){var e=this.getVariableTypes_();if(!e)return!0;for(var o=0;o<e.length;o++)if(t==e[o])return!0;return!1},Blockly.FieldVariable.prototype.getVariableTypes_=function(){var t=this.variableTypes;if(null===t&&this.sourceBlock_&&this.sourceBlock_.workspace)return this.sourceBlock_.workspace.getVariableTypes();if(0==(t=t||[""]).length)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t},Blockly.FieldVariable.prototype.setTypes_=function(t,e){var o=e||"";if(null==t||null==t)var l=null;else{if(!Array.isArray(t))throw Error("'variableTypes' was not an array in the definition of a FieldVariable");l=t;for(var i=!1,n=0;n<l.length;n++)l[n]==o&&(i=!0);if(!i)throw Error("Invalid default type '"+o+"' in the definition of a FieldVariable")}this.defaultType_=o,this.variableTypes=l},Blockly.FieldVariable.prototype.refreshVariableName=function(){this.forceRerender()},Blockly.FieldVariable.dropdownCreate=function(){if(!this.variable_)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var t=this.getText(),e=[];if(this.sourceBlock_&&this.sourceBlock_.workspace)for(var o=this.getVariableTypes_(),l=0;l<o.length;l++){var i=this.sourceBlock_.workspace.getVariablesOfType(o[l]);e=e.concat(i)}for(e.sort(Blockly.VariableModel.compareByName),o=[],l=0;l<e.length;l++)o[l]=[e[l].name,e[l].getId()];return o.push([Blockly.Msg.RENAME_VARIABLE,Blockly.RENAME_VARIABLE_ID]),Blockly.Msg.DELETE_VARIABLE&&o.push([Blockly.Msg.DELETE_VARIABLE.replace("%1",t),Blockly.DELETE_VARIABLE_ID]),o},Blockly.FieldVariable.prototype.onItemSelected=function(t,e){var o=e.getValue();if(this.sourceBlock_&&this.sourceBlock_.workspace){if(o==Blockly.RENAME_VARIABLE_ID)return void Blockly.Variables.renameVariable(this.sourceBlock_.workspace,this.variable_);if(o==Blockly.DELETE_VARIABLE_ID)return void this.sourceBlock_.workspace.deleteVariableById(this.variable_.getId())}this.setValue(o)},Blockly.FieldVariable.prototype.referencesVariables=function(){return!0},Blockly.fieldRegistry.register("field_variable",Blockly.FieldVariable),Blockly.FlyoutCursor=function(){Blockly.FlyoutCursor.superClass_.constructor.call(this)},Blockly.utils.object.inherits(Blockly.FlyoutCursor,Blockly.Cursor),Blockly.FlyoutCursor.prototype.next=function(){var t=this.getCurNode();return t?((t=t.next())&&this.setCurNode(t),t):null},Blockly.FlyoutCursor.prototype.in=function(){return null},Blockly.FlyoutCursor.prototype.prev=function(){var t=this.getCurNode();return t?((t=t.prev())&&this.setCurNode(t),t):null},Blockly.FlyoutCursor.prototype.out=function(){return null},Blockly.Flyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Blockly.WorkspaceSvg(t),this.workspace_.isFlyout=!0,this.workspace_.setCursor(new Blockly.FlyoutCursor),this.workspace_.setMarker(new Blockly.MarkerCursor),this.RTL=!!t.RTL,this.toolboxPosition_=t.toolboxPosition,this.eventWrappers_=[],this.mats_=[],this.buttons_=[],this.listeners_=[],this.permanentlyDisabled_=[],this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH},Blockly.Flyout.prototype.autoClose=!0,Blockly.Flyout.prototype.isVisible_=!1,Blockly.Flyout.prototype.containerVisible_=!0,Blockly.Flyout.prototype.CORNER_RADIUS=8,Blockly.Flyout.prototype.MARGIN=Blockly.Flyout.prototype.CORNER_RADIUS,Blockly.Flyout.prototype.GAP_X=3*Blockly.Flyout.prototype.MARGIN,Blockly.Flyout.prototype.GAP_Y=3*Blockly.Flyout.prototype.MARGIN,Blockly.Flyout.prototype.SCROLLBAR_PADDING=2,Blockly.Flyout.prototype.width_=0,Blockly.Flyout.prototype.height_=0,Blockly.Flyout.prototype.dragAngleRange_=70,Blockly.Flyout.prototype.createDom=function(t){return this.svgGroup_=Blockly.utils.dom.createSvgElement(t,{class:"blocklyFlyout",style:"display: none"},null),this.svgBackground_=Blockly.utils.dom.createSvgElement("path",{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyout","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_},Blockly.Flyout.prototype.init=function(t){this.targetWorkspace_=t,this.workspace_.targetWorkspace=t,this.scrollbar_=new Blockly.Scrollbar(this.workspace_,this.horizontalLayout_,!1,"blocklyFlyoutScrollbar"),this.hide(),Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgGroup_,"wheel",this,this.wheel_)),this.autoClose||(this.filterWrapper_=this.filterForCapacity_.bind(this),this.targetWorkspace_.addChangeListener(this.filterWrapper_)),Array.prototype.push.apply(this.eventWrappers_,Blockly.bindEventWithChecks_(this.svgBackground_,"mousedown",this,this.onMouseDown_)),this.workspace_.getGesture=this.targetWorkspace_.getGesture.bind(this.targetWorkspace_),this.workspace_.variableMap_=this.targetWorkspace_.getVariableMap(),this.workspace_.createPotentialVariableMap()},Blockly.Flyout.prototype.dispose=function(){this.hide(),Blockly.unbindEvent_(this.eventWrappers_),this.filterWrapper_&&(this.targetWorkspace_.removeChangeListener(this.filterWrapper_),this.filterWrapper_=null),this.scrollbar_&&(this.scrollbar_.dispose(),this.scrollbar_=null),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.targetWorkspace=null,this.workspace_.dispose(),this.workspace_=null),this.svgGroup_&&(Blockly.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.targetWorkspace_=this.svgBackground_=null},Blockly.Flyout.prototype.getWidth=function(){return this.width_},Blockly.Flyout.prototype.getHeight=function(){return this.height_},Blockly.Flyout.prototype.getWorkspace=function(){return this.workspace_},Blockly.Flyout.prototype.isVisible=function(){return this.isVisible_},Blockly.Flyout.prototype.setVisible=function(t){var e=t!=this.isVisible();this.isVisible_=t,e&&this.updateDisplay_()},Blockly.Flyout.prototype.setContainerVisible=function(t){var e=t!=this.containerVisible_;this.containerVisible_=t,e&&this.updateDisplay_()},Blockly.Flyout.prototype.updateDisplay_=function(){var t=!!this.containerVisible_&&this.isVisible();this.svgGroup_.style.display=t?"block":"none",this.scrollbar_.setContainerVisible(t)},Blockly.Flyout.prototype.positionAt_=function(t,e,o,l){this.svgGroup_.setAttribute("width",t),this.svgGroup_.setAttribute("height",e),"svg"==this.svgGroup_.tagName?Blockly.utils.dom.setCssTransform(this.svgGroup_,"translate("+o+"px,"+l+"px)"):this.svgGroup_.setAttribute("transform","translate("+o+","+l+")"),this.scrollbar_&&(this.scrollbar_.setOrigin(o,l),this.scrollbar_.resize(),this.scrollbar_.setPosition_(this.scrollbar_.position_.x,this.scrollbar_.position_.y))},Blockly.Flyout.prototype.hide=function(){if(this.isVisible()){this.setVisible(!1);for(var t,e=0;t=this.listeners_[e];e++)Blockly.unbindEvent_(t);this.listeners_.length=0,this.reflowWrapper_&&(this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowWrapper_=null)}},Blockly.Flyout.prototype.show=function(t){if(this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks_(),"string"==typeof t){if("function"!=typeof(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");if(t=t(this.workspace_.targetWorkspace),!Array.isArray(t))throw TypeError("Result of toolbox category callback must be an array.")}this.setVisible(!0);var e=[],o=[];this.permanentlyDisabled_.length=0;for(var l,i=this.horizontalLayout_?this.GAP_X:this.GAP_Y,n=0;l=t[n];n++)if(l.tagName)switch(l.tagName.toUpperCase()){case"BLOCK":var r=Blockly.Xml.domToBlock(l,this.workspace_);r.isEnabled()||this.permanentlyDisabled_.push(r),e.push({type:"block",block:r}),l=parseInt(l.getAttribute("gap"),10),o.push(isNaN(l)?i:l);break;case"SEP":l=parseInt(l.getAttribute("gap"),10),!isNaN(l)&&0<o.length?o[o.length-1]=l:o.push(i);break;case"LABEL":case"BUTTON":if(r="LABEL"==l.tagName.toUpperCase(),!Blockly.FlyoutButton)throw Error("Missing require for Blockly.FlyoutButton");l=new Blockly.FlyoutButton(this.workspace_,this.targetWorkspace_,l,r),e.push({type:"button",button:l}),o.push(i)}this.layout_(e,o),this.listeners_.push(Blockly.bindEventWithChecks_(this.svgBackground_,"mouseover",this,(function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)t.removeSelect()}))),this.horizontalLayout_?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity_(),this.position(),this.reflowWrapper_=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper_)},Blockly.Flyout.prototype.clearOldBlocks_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)t.workspace==this.workspace_&&t.dispose(!1,!1);for(o=0;o<this.mats_.length;o++)(e=this.mats_[o])&&Blockly.utils.dom.removeNode(e);for(o=this.mats_.length=0;e=this.buttons_[o];o++)e.dispose();this.buttons_.length=0,this.workspace_.getPotentialVariableMap().clear()},Blockly.Flyout.prototype.addBlockListeners_=function(t,e,o){this.listeners_.push(Blockly.bindEventWithChecks_(t,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(Blockly.bindEventWithChecks_(o,"mousedown",null,this.blockMouseDown_(e))),this.listeners_.push(Blockly.bindEvent_(t,"mouseover",e,e.addSelect)),this.listeners_.push(Blockly.bindEvent_(t,"mouseout",e,e.removeSelect)),this.listeners_.push(Blockly.bindEvent_(o,"mouseover",e,e.addSelect)),this.listeners_.push(Blockly.bindEvent_(o,"mouseout",e,e.removeSelect))},Blockly.Flyout.prototype.blockMouseDown_=function(t){var e=this;return function(o){var l=e.targetWorkspace_.getGesture(o);l&&(l.setStartBlock(t),l.handleFlyoutStart(o,e))}},Blockly.Flyout.prototype.onMouseDown_=function(t){var e=this.targetWorkspace_.getGesture(t);e&&e.handleFlyoutStart(t,this)},Blockly.Flyout.prototype.isBlockCreatable_=function(t){return t.isEnabled()},Blockly.Flyout.prototype.createBlock=function(t){var e=null;Blockly.Events.disable();var o=this.targetWorkspace_.getAllVariables();this.targetWorkspace_.setResizesEnabled(!1);try{e=this.placeNewBlock_(t),Blockly.hideChaff()}finally{Blockly.Events.enable()}if(t=Blockly.Variables.getAddedVariables(this.targetWorkspace_,o),Blockly.Events.isEnabled())for(Blockly.Events.setGroup(!0),Blockly.Events.fire(new Blockly.Events.Create(e)),o=0;o<t.length;o++)Blockly.Events.fire(new Blockly.Events.VarCreate(t[o]));return this.autoClose?this.hide():this.filterForCapacity_(),e},Blockly.Flyout.prototype.initFlyoutButton_=function(t,e,o){var l=t.createDom();t.moveTo(e,o),t.show(),this.listeners_.push(Blockly.bindEventWithChecks_(l,"mousedown",this,this.onMouseDown_)),this.buttons_.push(t)},Blockly.Flyout.prototype.createRect_=function(t,e,o,l,i){return(e=Blockly.utils.dom.createSvgElement("rect",{"fill-opacity":0,x:e,y:o,height:l.height,width:l.width},null)).tooltip=t,Blockly.Tooltip.bindMouseEvents(e),this.workspace_.getCanvas().insertBefore(e,t.getSvgRoot()),t.flyoutRect_=e,this.mats_[i]=e},Blockly.Flyout.prototype.moveRectToBlock_=function(t,e){var o=e.getHeightWidth();t.setAttribute("width",o.width),t.setAttribute("height",o.height);var l=e.getRelativeToSurfaceXY();t.setAttribute("y",l.y),t.setAttribute("x",this.RTL?l.x-o.width:l.x)},Blockly.Flyout.prototype.filterForCapacity_=function(){for(var t,e=this.workspace_.getTopBlocks(!1),o=0;t=e[o];o++)if(-1==this.permanentlyDisabled_.indexOf(t))for(var l=this.targetWorkspace_.isCapacityAvailable(Blockly.utils.getBlockTypeCounts(t));t;)t.setEnabled(l),t=t.getNextBlock()},Blockly.Flyout.prototype.reflow=function(){this.reflowWrapper_&&this.workspace_.removeChangeListener(this.reflowWrapper_),this.reflowInternal_(),this.reflowWrapper_&&this.workspace_.addChangeListener(this.reflowWrapper_)},Blockly.Flyout.prototype.isScrollable=function(){return!!this.scrollbar_&&this.scrollbar_.isVisible()},Blockly.Flyout.prototype.placeNewBlock_=function(t){var e=this.targetWorkspace_;if(!t.getSvgRoot())throw Error("oldBlock is not rendered.");var o=Blockly.Xml.blockToDom(t,!0);if(e.setResizesEnabled(!1),!(o=Blockly.Xml.domToBlock(o,e)).getSvgRoot())throw Error("block is not rendered.");var l=e.getOriginOffsetInPixels(),i=this.workspace_.getOriginOffsetInPixels();return(t=t.getRelativeToSurfaceXY()).scale(this.workspace_.scale),t=Blockly.utils.Coordinate.sum(i,t),(l=Blockly.utils.Coordinate.difference(t,l)).scale(1/e.scale),o.moveBy(l.x,l.y),o},Blockly.FlyoutButton=function(t,e,o,l){this.workspace_=t,this.targetWorkspace_=e,this.text_=o.getAttribute("text"),this.position_=new Blockly.utils.Coordinate(0,0),this.isLabel_=l,this.callbackKey_=o.getAttribute("callbackKey")||o.getAttribute("callbackkey"),this.cssClass_=o.getAttribute("web-class")||null},Blockly.FlyoutButton.MARGIN=5,Blockly.FlyoutButton.prototype.width=0,Blockly.FlyoutButton.prototype.height=0,Blockly.FlyoutButton.prototype.onMouseUpWrapper_=null,Blockly.FlyoutButton.prototype.createDom=function(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";if(this.cssClass_&&(t+=" "+this.cssClass_),this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{class:t},this.workspace_.getCanvas()),!this.isLabel_)var e=Blockly.utils.dom.createSvgElement("rect",{class:"blocklyFlyoutButtonShadow",rx:4,ry:4,x:1,y:1},this.svgGroup_);t=Blockly.utils.dom.createSvgElement("rect",{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:4,ry:4},this.svgGroup_);var o=Blockly.utils.dom.createSvgElement("text",{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup_);return o.textContent=Blockly.utils.replaceMessageReferences(this.text_),this.isLabel_&&(this.svgText_=o,this.workspace_.getThemeManager().subscribe(this.svgText_,"flyoutText","fill")),this.width=Blockly.utils.dom.getTextWidth(o),this.height=20,this.isLabel_||(this.width+=2*Blockly.FlyoutButton.MARGIN,e.setAttribute("width",this.width),e.setAttribute("height",this.height)),t.setAttribute("width",this.width),t.setAttribute("height",this.height),o.setAttribute("x",this.width/2),o.setAttribute("y",this.height-Blockly.FlyoutButton.MARGIN),this.updateTransform_(),this.onMouseUpWrapper_=Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.onMouseUp_),this.svgGroup_},Blockly.FlyoutButton.prototype.show=function(){this.updateTransform_(),this.svgGroup_.setAttribute("display","block")},Blockly.FlyoutButton.prototype.updateTransform_=function(){this.svgGroup_.setAttribute("transform","translate("+this.position_.x+","+this.position_.y+")")},Blockly.FlyoutButton.prototype.moveTo=function(t,e){this.position_.x=t,this.position_.y=e,this.updateTransform_()},Blockly.FlyoutButton.prototype.getPosition=function(){return this.position_},Blockly.FlyoutButton.prototype.getTargetWorkspace=function(){return this.targetWorkspace_},Blockly.FlyoutButton.prototype.dispose=function(){this.onMouseUpWrapper_&&Blockly.unbindEvent_(this.onMouseUpWrapper_),this.svgGroup_&&Blockly.utils.dom.removeNode(this.svgGroup_),this.svgText_&&this.workspace_.getThemeManager().unsubscribe(this.svgText_)},Blockly.FlyoutButton.prototype.onMouseUp_=function(t){(t=this.targetWorkspace_.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey_?console.warn("Labels should not have callbacks. Label text: "+this.text_):this.isLabel_||this.callbackKey_&&this.targetWorkspace_.getButtonCallback(this.callbackKey_)?this.isLabel_||this.targetWorkspace_.getButtonCallback(this.callbackKey_)(this):console.warn("Buttons should have callbacks. Button text: "+this.text_)},Blockly.Css.register(".blocklyFlyoutButton {,fill: #888;,cursor: default;,},.blocklyFlyoutButtonShadow {,fill: #666;,},.blocklyFlyoutButton:hover {,fill: #aaa;,},.blocklyFlyoutLabel {,cursor: default;,},.blocklyFlyoutLabelBackground {,opacity: 0;,},.blocklyFlyoutLabelText {,fill: #000;,}".split(",")),Blockly.HorizontalFlyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),Blockly.HorizontalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout_=!0},Blockly.utils.object.inherits(Blockly.HorizontalFlyout,Blockly.Flyout),Blockly.HorizontalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var t=this.workspace_.getCanvas().getBBox()}catch(l){t={height:0,y:0,width:0,x:0}}var e=this.SCROLLBAR_PADDING;this.toolboxPosition_==Blockly.TOOLBOX_AT_BOTTOM&&(e=0);var o=this.height_;return this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP&&(o-=this.SCROLLBAR_PADDING),{viewHeight:o,viewWidth:this.width_-2*this.SCROLLBAR_PADDING,contentHeight:(t.height+2*this.MARGIN)*this.workspace_.scale,contentWidth:(t.width+2*this.MARGIN)*this.workspace_.scale,viewTop:-this.workspace_.scrollY,viewLeft:-this.workspace_.scrollX,contentTop:0,contentLeft:0,absoluteTop:e,absoluteLeft:this.SCROLLBAR_PADDING}},Blockly.HorizontalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&("number"==typeof t.x&&(this.workspace_.scrollX=-e.contentWidth*t.x),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},Blockly.HorizontalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace_.getMetrics();t&&(this.width_=t.viewWidth,this.setBackgroundPath_(t.viewWidth-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),this.positionAt_(this.width_,this.height_,0,this.targetWorkspace_.toolboxPosition==this.toolboxPosition_?t.toolboxHeight?this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?t.toolboxHeight:t.viewHeight-this.height_:this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?0:t.viewHeight:this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?0:t.viewHeight+t.absoluteTop-this.height_))}},Blockly.HorizontalFlyout.prototype.setBackgroundPath_=function(t,e){var o=this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP,l=["M 0,"+(o?0:this.CORNER_RADIUS)];o?(l.push("h",t+2*this.CORNER_RADIUS),l.push("v",e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("h",-1*t),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),l.push("h",t),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("v",e),l.push("h",-t-2*this.CORNER_RADIUS)),l.push("z"),this.svgBackground_.setAttribute("d",l.join(" "))},Blockly.HorizontalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(this.RTL?1/0:0)},Blockly.HorizontalFlyout.prototype.wheel_=function(t){var e=Blockly.utils.getScrollDeltaPixels(t),o=e.x||e.y;o&&(o=(e=this.getMetrics_()).viewLeft+o,o=Math.min(o,e.contentWidth-e.viewWidth),o=Math.max(o,0),this.scrollbar_.set(o),Blockly.WidgetDiv.hide()),t.preventDefault(),t.stopPropagation()},Blockly.HorizontalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace_.scale;var o=this.MARGIN,l=o+this.tabWidth_;this.RTL&&(t=t.reverse());for(var i,n=0;i=t[n];n++)if("block"==i.type){for(var r,s=(i=i.block).getDescendants(!1),c=0;r=s[c];c++)r.isInFlyout=!0;i.render(),s=i.getSvgRoot(),c=i.getHeightWidth(),r=i.outputConnection?this.tabWidth_:0,i.moveBy(r=this.RTL?l+c.width:l-r,o),r=this.createRect_(i,r,o,c,n),l+=c.width+e[n],this.addBlockListeners_(s,i,r)}else"button"==i.type&&(this.initFlyoutButton_(i.button,l,o),l+=i.button.width+e[n])},Blockly.HorizontalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=this.dragAngleRange_;return t<90+e&&t>90-e||t>-90-e&&t<-90+e},Blockly.HorizontalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top;return this.toolboxPosition_==Blockly.TOOLBOX_AT_TOP?new Blockly.utils.Rect(-1e9,e+t.height,-1e9,1e9):new Blockly.utils.Rect(e,-1e9,-1e9,1e9)},Blockly.HorizontalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace_.scale;for(var t,e=0,o=this.workspace_.getTopBlocks(!1),l=0;t=o[l];l++)e=Math.max(e,t.getHeightWidth().height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,this.height_!=(e+=Blockly.Scrollbar.scrollbarThickness)){for(l=0;t=o[l];l++)t.flyoutRect_&&this.moveRectToBlock_(t.flyoutRect_,t);this.height_=e,this.position()}},Blockly.VerticalFlyout=function(t){t.getMetrics=this.getMetrics_.bind(this),t.setMetrics=this.setMetrics_.bind(this),Blockly.VerticalFlyout.superClass_.constructor.call(this,t),this.horizontalLayout_=!1},Blockly.utils.object.inherits(Blockly.VerticalFlyout,Blockly.Flyout),Blockly.VerticalFlyout.prototype.getMetrics_=function(){if(!this.isVisible())return null;try{var t=this.workspace_.getCanvas().getBBox()}catch(o){t={height:0,y:0,width:0,x:0}}var e=this.width_;return this.RTL||(e-=this.SCROLLBAR_PADDING),{viewHeight:this.height_-2*this.SCROLLBAR_PADDING,viewWidth:e,contentHeight:t.height*this.workspace_.scale+2*this.MARGIN,contentWidth:t.width*this.workspace_.scale+2*this.MARGIN,viewTop:-this.workspace_.scrollY+t.y,viewLeft:-this.workspace_.scrollX,contentTop:t.y,contentLeft:t.x,absoluteTop:this.SCROLLBAR_PADDING,absoluteLeft:0}},Blockly.VerticalFlyout.prototype.setMetrics_=function(t){var e=this.getMetrics_();e&&("number"==typeof t.y&&(this.workspace_.scrollY=-e.contentHeight*t.y),this.workspace_.translate(this.workspace_.scrollX+e.absoluteLeft,this.workspace_.scrollY+e.absoluteTop))},Blockly.VerticalFlyout.prototype.position=function(){if(this.isVisible()){var t=this.targetWorkspace_.getMetrics();t&&(this.height_=t.viewHeight,this.setBackgroundPath_(this.width_-this.CORNER_RADIUS,t.viewHeight-2*this.CORNER_RADIUS),this.positionAt_(this.width_,this.height_,this.targetWorkspace_.toolboxPosition==this.toolboxPosition_?t.toolboxWidth?this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?t.toolboxWidth:t.viewWidth-this.width_:this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?0:t.viewWidth:this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?0:t.viewWidth+t.absoluteLeft-this.width_,0))}},Blockly.VerticalFlyout.prototype.setBackgroundPath_=function(t,e){var o=this.toolboxPosition_==Blockly.TOOLBOX_AT_RIGHT,l=t+this.CORNER_RADIUS;(l=["M "+(o?l:0)+",0"]).push("h",o?-t:t),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("v",Math.max(0,e)),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,o?0:1,o?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("h",o?t:-t),l.push("z"),this.svgBackground_.setAttribute("d",l.join(" "))},Blockly.VerticalFlyout.prototype.scrollToStart=function(){this.scrollbar_.set(0)},Blockly.VerticalFlyout.prototype.wheel_=function(t){var e=Blockly.utils.getScrollDeltaPixels(t);if(e.y){var o=this.getMetrics_();e=o.viewTop-o.contentTop+e.y,e=Math.min(e,o.contentHeight-o.viewHeight),e=Math.max(e,0),this.scrollbar_.set(e),Blockly.WidgetDiv.hide()}t.preventDefault(),t.stopPropagation()},Blockly.VerticalFlyout.prototype.layout_=function(t,e){this.workspace_.scale=this.targetWorkspace_.scale;for(var o,l=this.MARGIN,i=this.RTL?l:l+this.tabWidth_,n=0;o=t[n];n++)if("block"==o.type){for(var r,s=(o=o.block).getDescendants(!1),c=0;r=s[c];c++)r.isInFlyout=!0;o.render(),s=o.getSvgRoot(),c=o.getHeightWidth(),o.moveBy(r=o.outputConnection?i-this.tabWidth_:i,l),r=this.createRect_(o,this.RTL?r-c.width:r,l,c,n),this.addBlockListeners_(s,o,r),l+=c.height+e[n]}else"button"==o.type&&(this.initFlyoutButton_(o.button,i,l),l+=o.button.height+e[n])},Blockly.VerticalFlyout.prototype.isDragTowardWorkspace=function(t){t=Math.atan2(t.y,t.x)/Math.PI*180;var e=this.dragAngleRange_;return t<e&&t>-e||t<-180+e||t>180-e},Blockly.VerticalFlyout.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.left;return this.toolboxPosition_==Blockly.TOOLBOX_AT_LEFT?new Blockly.utils.Rect(-1e9,1e9,-1e9,e+t.width):(Blockly.utils.userAgent.GECKO&&this.targetWorkspace_&&this.targetWorkspace_.isMutator&&(t=this.targetWorkspace_.svgGroup_.getBoundingClientRect().x,10>Math.abs(t-e)&&(e+=this.leftEdge_*this.targetWorkspace_.options.parentWorkspace.scale)),new Blockly.utils.Rect(-1e9,1e9,e,1e9))},Blockly.VerticalFlyout.prototype.reflowInternal_=function(){this.workspace_.scale=this.targetWorkspace_.scale;for(var t,e=0,o=this.workspace_.getTopBlocks(!1),l=0;t=o[l];l++){var i=t.getHeightWidth().width;t.outputConnection&&(i-=this.tabWidth_),e=Math.max(e,i)}for(l=0;t=this.buttons_[l];l++)e=Math.max(e,t.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,this.width_!=(e+=Blockly.Scrollbar.scrollbarThickness)){for(l=0;t=o[l];l++){if(this.RTL){i=t.getRelativeToSurfaceXY().x;var n=e/this.workspace_.scale-this.MARGIN;t.outputConnection||(n-=this.tabWidth_),t.moveBy(n-i,0)}t.flyoutRect_&&this.moveRectToBlock_(t.flyoutRect_,t)}if(this.RTL)for(l=0;t=this.buttons_[l];l++)o=t.getPosition().y,t.moveTo(e/this.workspace_.scale-t.width-this.MARGIN-this.tabWidth_,o);this.width_=e,this.position()}},Blockly.Generator=function(t){this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")},Blockly.Generator.NAME_TYPE="generated_function",Blockly.Generator.prototype.INFINITE_LOOP_TRAP=null,Blockly.Generator.prototype.STATEMENT_PREFIX=null,Blockly.Generator.prototype.STATEMENT_SUFFIX=null,Blockly.Generator.prototype.INDENT="  ",Blockly.Generator.prototype.COMMENT_WRAP=60,Blockly.Generator.prototype.ORDER_OVERRIDES=[],Blockly.Generator.prototype.workspaceToCode=function(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=Blockly.getMainWorkspace());var e=[];this.init(t),t=t.getTopBlocks(!0);for(var o,l=0;o=t[l];l++){var i=this.blockToCode(o);Array.isArray(i)&&(i=i[0]),i&&(o.outputConnection&&(i=this.scrubNakedValue(i),this.STATEMENT_PREFIX&&!o.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,o)+i),this.STATEMENT_SUFFIX&&!o.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,o))),e.push(i))}return e=e.join("\n"),(e=(e=(e=this.finish(e)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")},Blockly.Generator.prototype.prefixLines=function(t,e){return e+t.replace(/(?!\n$)\n/g,"\n"+e)},Blockly.Generator.prototype.allNestedComments=function(t){var e=[];t=t.getDescendants(!0);for(var o=0;o<t.length;o++){var l=t[o].getCommentText();l&&e.push(l)}return e.length&&e.push(""),e.join("\n")},Blockly.Generator.prototype.blockToCode=function(t,e){if(!t)return"";if(!t.isEnabled())return e?"":this.blockToCode(t.getNextBlock());var o=this[t.type];if("function"!=typeof o)throw Error('Language "'+this.name_+'" does not know how to generate  code for block type "'+t.type+'".');if(o=o.call(t,t),Array.isArray(o)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,o[0],e),o[1]]}if("string"==typeof o)return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(o=this.injectId(this.STATEMENT_PREFIX,t)+o),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(o+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,o,e);if(null===o)return"";throw SyntaxError("Invalid code generated: "+o)},Blockly.Generator.prototype.valueToCode=function(t,e,o){if(isNaN(o))throw TypeError("Expecting valid order from block: "+t.type);var l=t.getInputTargetBlock(e);if(!l)return"";if(""===(e=this.blockToCode(l)))return"";if(!Array.isArray(e))throw TypeError("Expecting tuple from value block: "+l.type);if(t=e[0],e=e[1],isNaN(e))throw TypeError("Expecting valid order from value block: "+l.type);if(!t)return"";l=!1;var i=Math.floor(o),n=Math.floor(e);if(i<=n&&(i!=n||0!=i&&99!=i))for(l=!0,i=0;i<this.ORDER_OVERRIDES.length;i++)if(this.ORDER_OVERRIDES[i][0]==o&&this.ORDER_OVERRIDES[i][1]==e){l=!1;break}return l&&(t="("+t+")"),t},Blockly.Generator.prototype.statementToCode=function(t,e){var o=t.getInputTargetBlock(e),l=this.blockToCode(o);if("string"!=typeof l)throw TypeError("Expecting code from statement block: "+(o&&o.type));return l&&(l=this.prefixLines(l,this.INDENT)),l},Blockly.Generator.prototype.addLoopTrap=function(t,e){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,e),this.INDENT)+t),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,e),this.INDENT)+t),this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,e),this.INDENT)),t},Blockly.Generator.prototype.injectId=function(t,e){var o=e.id.replace(/\$/g,"$$$$");return t.replace(/%1/g,"'"+o+"'")},Blockly.Generator.prototype.RESERVED_WORDS_="",Blockly.Generator.prototype.addReservedWords=function(t){this.RESERVED_WORDS_+=t+","},Blockly.Generator.prototype.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",Blockly.Generator.prototype.provideFunction_=function(t,e){if(!this.definitions_[t]){var o,l=this.variableDB_.getDistinctName(t,Blockly.Procedures.NAME_TYPE);for(this.functionNames_[t]=l,l=e.join("\n").replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,l);o!=l;)o=l,l=l.replace(/^(( {2})*) {2}/gm,"$1\0");l=l.replace(/\0/g,this.INDENT),this.definitions_[t]=l}return this.functionNames_[t]},Blockly.Generator.prototype.init=function(t){},Blockly.Generator.prototype.scrub_=function(t,e){return e},Blockly.Generator.prototype.finish=function(t){return t},Blockly.Generator.prototype.scrubNakedValue=function(t){return t},Blockly.CursorSvg=function(t,e){this.workspace_=t,this.isMarker_=e,this.parent_=null,this.constants_=t.getRenderer().getConstants()},Blockly.CursorSvg.CURSOR_HEIGHT=5,Blockly.CursorSvg.CURSOR_WIDTH=100,Blockly.CursorSvg.NOTCH_START_LENGTH=24,Blockly.CursorSvg.VERTICAL_PADDING=5,Blockly.CursorSvg.STACK_PADDING=10,Blockly.CursorSvg.BLOCK_PADDING=2,Blockly.CursorSvg.HEIGHT_MULTIPLIER=.75,Blockly.CursorSvg.CURSOR_COLOR="#cc0a0a",Blockly.CursorSvg.MARKER_COLOR="#4286f4",Blockly.CursorSvg.CURSOR_CLASS="blocklyCursor",Blockly.CursorSvg.MARKER_CLASS="blocklyMarker",Blockly.CursorSvg.prototype.currentCursorSvg=null,Blockly.CursorSvg.prototype.getSvgRoot=function(){return this.svgGroup_},Blockly.CursorSvg.prototype.createDom=function(){return this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{class:this.isMarker_?Blockly.CursorSvg.MARKER_CLASS:Blockly.CursorSvg.CURSOR_CLASS},null),this.createCursorSvg_(),this.svgGroup_},Blockly.CursorSvg.prototype.setParent_=function(t){this.isMarker_?(this.parent_&&this.parent_.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())):(this.parent_&&this.parent_.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())),this.parent_=t},Blockly.CursorSvg.prototype.showWithBlockPrevOutput_=function(t){if(t){var e=t.width,o=t.height,l=o*Blockly.CursorSvg.HEIGHT_MULTIPLIER,i=Blockly.CursorSvg.BLOCK_PADDING;t.previousConnection?this.positionPrevious_(e,i,l):t.outputConnection?this.positionOutput_(e,o):this.positionBlock_(e,i,l),this.setParent_(t),this.showCurrent_()}},Blockly.CursorSvg.prototype.showWithCoordinates_=function(t){var e=t.getWsCoordinate();t=e.x,this.workspace_.RTL&&(t-=Blockly.CursorSvg.CURSOR_WIDTH),this.positionLine_(t,e=e.y,Blockly.CursorSvg.CURSOR_WIDTH),this.setParent_(this.workspace_),this.showCurrent_()},Blockly.CursorSvg.prototype.showWithField_=function(t){var e=(t=t.getLocation()).getSize().width,o=t.getSize().height;this.positionRect_(0,0,e,o),this.setParent_(t),this.showCurrent_()},Blockly.CursorSvg.prototype.showWithInput_=function(t){var e=(t=t.getLocation()).getSourceBlock();this.positionInput_(t),this.setParent_(e),this.showCurrent_()},Blockly.CursorSvg.prototype.showWithNext_=function(t){var e=t.getLocation();t=e.getSourceBlock();var o=0;e=e.getOffsetInBlock().y;var l=t.getHeightWidth().width;this.workspace_.RTL&&(o=-l),this.positionLine_(o,e,l),this.setParent_(t),this.showCurrent_()},Blockly.CursorSvg.prototype.showWithStack_=function(t){var e=(t=t.getLocation()).getHeightWidth(),o=e.width+Blockly.CursorSvg.STACK_PADDING,l=-1*Blockly.CursorSvg.STACK_PADDING/2,i=l;this.workspace_.RTL&&(i=-(o+l)),this.positionRect_(i,-1*Blockly.CursorSvg.STACK_PADDING/2,o,e=e.height+Blockly.CursorSvg.STACK_PADDING),this.setParent_(t),this.showCurrent_()},Blockly.CursorSvg.prototype.showCurrent_=function(){this.hide(),this.currentCursorSvg.style.display=""},Blockly.CursorSvg.prototype.positionBlock_=function(t,e,o){t=Blockly.utils.svgPaths.moveBy(-1*e,o)+Blockly.utils.svgPaths.lineOnAxis("V",-1*e)+Blockly.utils.svgPaths.lineOnAxis("H",t+2*e)+Blockly.utils.svgPaths.lineOnAxis("V",o),this.cursorBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.cursorBlock_),this.currentCursorSvg=this.cursorBlock_},Blockly.CursorSvg.prototype.positionInput_=function(t){var e=t.getOffsetInBlock().x;t=t.getOffsetInBlock().y;var o=Blockly.utils.svgPaths.moveTo(0,0)+this.constants_.PUZZLE_TAB.pathDown;this.cursorInput_.setAttribute("d",o),this.cursorInput_.setAttribute("transform","translate("+e+","+t+")"+(this.workspace_.RTL?" scale(-1 1)":"")),this.currentCursorSvg=this.cursorInput_},Blockly.CursorSvg.prototype.positionLine_=function(t,e,o){this.cursorSvgLine_.setAttribute("x",t),this.cursorSvgLine_.setAttribute("y",e),this.cursorSvgLine_.setAttribute("width",o),this.currentCursorSvg=this.cursorSvgLine_},Blockly.CursorSvg.prototype.positionOutput_=function(t,e){var o=Blockly.utils.svgPaths.moveBy(t,0)+Blockly.utils.svgPaths.lineOnAxis("h",-1*(t-this.constants_.PUZZLE_TAB.width))+Blockly.utils.svgPaths.lineOnAxis("v",this.constants_.TAB_OFFSET_FROM_TOP)+this.constants_.PUZZLE_TAB.pathDown+Blockly.utils.svgPaths.lineOnAxis("V",e)+Blockly.utils.svgPaths.lineOnAxis("H",t);this.cursorBlock_.setAttribute("d",o),this.workspace_.RTL&&this.flipRtl_(this.cursorBlock_),this.currentCursorSvg=this.cursorBlock_},Blockly.CursorSvg.prototype.positionPrevious_=function(t,e,o){t=Blockly.utils.svgPaths.moveBy(-1*e,o)+Blockly.utils.svgPaths.lineOnAxis("V",-1*e)+Blockly.utils.svgPaths.lineOnAxis("H",this.constants_.NOTCH_OFFSET_LEFT)+this.constants_.NOTCH.pathLeft+Blockly.utils.svgPaths.lineOnAxis("H",t+2*e)+Blockly.utils.svgPaths.lineOnAxis("V",o),this.cursorBlock_.setAttribute("d",t),this.workspace_.RTL&&this.flipRtl_(this.cursorBlock_),this.currentCursorSvg=this.cursorBlock_},Blockly.CursorSvg.prototype.positionRect_=function(t,e,o,l){this.cursorSvgRect_.setAttribute("x",t),this.cursorSvgRect_.setAttribute("y",e),this.cursorSvgRect_.setAttribute("width",o),this.cursorSvgRect_.setAttribute("height",l),this.currentCursorSvg=this.cursorSvgRect_},Blockly.CursorSvg.prototype.flipRtl_=function(t){t.setAttribute("transform","scale(-1 1)")},Blockly.CursorSvg.prototype.hide=function(){this.cursorSvgLine_.style.display="none",this.cursorSvgRect_.style.display="none",this.cursorInput_.style.display="none",this.cursorBlock_.style.display="none"},Blockly.CursorSvg.prototype.draw=function(t){t?t.getType()===Blockly.ASTNode.types.BLOCK?(t=t.getLocation(),this.showWithBlockPrevOutput_(t)):t.getType()===Blockly.ASTNode.types.OUTPUT?(t=t.getLocation().getSourceBlock(),this.showWithBlockPrevOutput_(t)):t.getLocation().type===Blockly.INPUT_VALUE?this.showWithInput_(t):t.getLocation().type===Blockly.NEXT_STATEMENT?this.showWithNext_(t):t.getType()===Blockly.ASTNode.types.PREVIOUS?(t=t.getLocation().getSourceBlock(),this.showWithBlockPrevOutput_(t)):t.getType()===Blockly.ASTNode.types.FIELD?this.showWithField_(t):t.getType()===Blockly.ASTNode.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()===Blockly.ASTNode.types.STACK&&this.showWithStack_(t):this.hide()},Blockly.CursorSvg.prototype.createCursorSvg_=function(){var t=this.isMarker_?Blockly.CursorSvg.MARKER_COLOR:Blockly.CursorSvg.CURSOR_COLOR;return this.cursorSvg_=Blockly.utils.dom.createSvgElement("g",{width:Blockly.CursorSvg.CURSOR_WIDTH,height:Blockly.CursorSvg.CURSOR_HEIGHT},this.svgGroup_),this.cursorSvgLine_=Blockly.utils.dom.createSvgElement("rect",{x:"0",y:"0",fill:t,width:Blockly.CursorSvg.CURSOR_WIDTH,height:Blockly.CursorSvg.CURSOR_HEIGHT,style:"display: none;"},this.cursorSvg_),this.cursorSvgRect_=Blockly.utils.dom.createSvgElement("rect",{class:"blocklyVerticalCursor",x:"0",y:"0",rx:"10",ry:"10",style:"display: none;",stroke:t},this.cursorSvg_),this.cursorInput_=Blockly.utils.dom.createSvgElement("path",{width:Blockly.CursorSvg.CURSOR_WIDTH,height:Blockly.CursorSvg.CURSOR_HEIGHT,transform:"",style:"display: none;",fill:t},this.cursorSvg_),this.cursorBlock_=Blockly.utils.dom.createSvgElement("path",{width:Blockly.CursorSvg.CURSOR_WIDTH,height:Blockly.CursorSvg.CURSOR_HEIGHT,transform:"",style:"display: none;",fill:"none",stroke:t,"stroke-width":"4"},this.cursorSvg_),this.isMarker_||(Blockly.utils.dom.createSvgElement("animate",{attributeType:"XML",attributeName:"fill",dur:"1s",values:Blockly.CursorSvg.CURSOR_COLOR+";transparent;transparent;",repeatCount:"indefinite"},this.cursorSvgLine_),Blockly.utils.dom.createSvgElement("animate",{attributeType:"XML",attributeName:"fill",dur:"1s",values:Blockly.CursorSvg.CURSOR_COLOR+";transparent;transparent;",repeatCount:"indefinite"},this.cursorInput_),Blockly.utils.dom.createSvgElement("animate",{attributeType:"XML",attributeName:"stroke",dur:"1s",values:Blockly.CursorSvg.CURSOR_COLOR+";transparent;transparent;",repeatCount:"indefinite"},this.cursorBlock_)),this.cursorSvg_},Blockly.CursorSvg.prototype.dispose=function(){this.svgGroup_&&Blockly.utils.dom.removeNode(this.svgGroup_)},Blockly.Mutator=function(t){Blockly.Mutator.superClass_.constructor.call(this,null),this.quarkNames_=t},Blockly.utils.object.inherits(Blockly.Mutator,Blockly.Icon),Blockly.Mutator.prototype.workspaceWidth_=0,Blockly.Mutator.prototype.workspaceHeight_=0,Blockly.Mutator.prototype.drawIcon_=function(t){Blockly.utils.dom.createSvgElement("rect",{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},t),Blockly.utils.dom.createSvgElement("path",{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},t),Blockly.utils.dom.createSvgElement("circle",{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},t)},Blockly.Mutator.prototype.iconClick_=function(t){this.block_.isEditable()&&Blockly.Icon.prototype.iconClick_.call(this,t)},Blockly.Mutator.prototype.createEditor_=function(){if(this.svgDialog_=Blockly.utils.dom.createSvgElement("svg",{x:Blockly.Bubble.BORDER_WIDTH,y:Blockly.Bubble.BORDER_WIDTH},null),this.quarkNames_.length)for(var t,e=Blockly.utils.xml.createElement("xml"),o=0;t=this.quarkNames_[o];o++){var l=Blockly.utils.xml.createElement("block");l.setAttribute("type",t),e.appendChild(l)}else e=null;return e={disable:!1,disabledPatternId:this.block_.workspace.options.disabledPatternId,languageTree:e,parentWorkspace:this.block_.workspace,pathToMedia:this.block_.workspace.options.pathToMedia,RTL:this.block_.RTL,toolboxPosition:this.block_.RTL?Blockly.TOOLBOX_AT_RIGHT:Blockly.TOOLBOX_AT_LEFT,horizontalLayout:!1,getMetrics:this.getFlyoutMetrics_.bind(this),setMetrics:null,renderer:this.block_.workspace.options.renderer},this.workspace_=new Blockly.WorkspaceSvg(e),this.workspace_.isMutator=!0,this.workspace_.addChangeListener(Blockly.Events.disableOrphans),e=this.workspace_.addFlyout_("g"),(o=this.workspace_.createDom("blocklyMutatorBackground")).insertBefore(e,this.workspace_.svgBlockCanvas_),this.svgDialog_.appendChild(o),this.svgDialog_},Blockly.Mutator.prototype.updateEditable=function(){Blockly.Mutator.superClass_.updateEditable.call(this),this.block_.isInFlyout||(this.block_.isEditable()?this.iconGroup_&&Blockly.utils.dom.removeClass(this.iconGroup_,"blocklyIconGroupReadonly"):(this.setVisible(!1),this.iconGroup_&&Blockly.utils.dom.addClass(this.iconGroup_,"blocklyIconGroupReadonly")))},Blockly.Mutator.prototype.resizeBubble_=function(){var t=2*Blockly.Bubble.BORDER_WIDTH,e=this.workspace_.getCanvas().getBBox(),o=this.block_.RTL?-e.x:e.width+e.x;if(e=e.height+3*t,this.workspace_.flyout_){var l=this.workspace_.flyout_.getMetrics_();e=Math.max(e,l.contentHeight+20)}o+=3*t,(Math.abs(this.workspaceWidth_-o)>t||Math.abs(this.workspaceHeight_-e)>t)&&(this.workspaceWidth_=o,this.workspaceHeight_=e,this.bubble_.setBubbleSize(o+t,e+t),this.svgDialog_.setAttribute("width",this.workspaceWidth_),this.svgDialog_.setAttribute("height",this.workspaceHeight_)),this.block_.RTL&&(t="translate("+this.workspaceWidth_+",0)",this.workspace_.getCanvas().setAttribute("transform",t)),this.workspace_.resize()},Blockly.Mutator.prototype.setVisible=function(t){if(t!=this.isVisible())if(Blockly.Events.fire(new Blockly.Events.Ui(this.block_,"mutatorOpen",!t,t)),t){this.bubble_=new Blockly.Bubble(this.block_.workspace,this.createEditor_(),this.block_.svgPath_,this.iconXY_,null,null),this.bubble_.setSvgId(this.block_.id),(t=this.workspace_.options.languageTree)&&(this.workspace_.flyout_.init(this.workspace_),this.workspace_.flyout_.show(t.childNodes)),this.rootBlock_=this.block_.decompose(this.workspace_),t=this.rootBlock_.getDescendants(!1);for(var e,o=0;e=t[o];o++)e.render();if(this.rootBlock_.setMovable(!1),this.rootBlock_.setDeletable(!1),this.workspace_.flyout_?(t=2*this.workspace_.flyout_.CORNER_RADIUS,o=this.workspace_.getFlyout().getWidth()+t):o=t=16,this.block_.RTL&&(o=-o),this.rootBlock_.moveBy(o,t),this.block_.saveConnections){var l=this;this.block_.saveConnections(this.rootBlock_),this.sourceListener_=function(){l.block_.saveConnections(l.rootBlock_)},this.block_.workspace.addChangeListener(this.sourceListener_)}this.resizeBubble_(),this.workspace_.addChangeListener(this.workspaceChanged_.bind(this)),this.updateColour()}else this.svgDialog_=null,this.workspace_.dispose(),this.rootBlock_=this.workspace_=null,this.bubble_.dispose(),this.bubble_=null,this.workspaceHeight_=this.workspaceWidth_=0,this.sourceListener_&&(this.block_.workspace.removeChangeListener(this.sourceListener_),this.sourceListener_=null)},Blockly.Mutator.prototype.workspaceChanged_=function(t){if(t.type!=Blockly.Events.UI&&(t.type!=Blockly.Events.CHANGE||"disabled"!=t.element)){if(!this.workspace_.isDragging()){t=this.workspace_.getTopBlocks(!1);for(var e,o=0;e=t[o];o++){var l=e.getRelativeToSurfaceXY(),i=e.getHeightWidth();20>l.y+i.height&&e.moveBy(0,20-i.height-l.y)}}if(this.rootBlock_.workspace==this.workspace_){if(Blockly.Events.setGroup(!0),t=(t=(e=this.block_).mutationToDom())&&Blockly.Xml.domToText(t),o=e.rendered,e.rendered=!1,e.compose(this.rootBlock_),e.rendered=o,e.initSvg(),t!=(o=(o=e.mutationToDom())&&Blockly.Xml.domToText(o))){Blockly.Events.fire(new Blockly.Events.BlockChange(e,"mutation",null,t,o));var n=Blockly.Events.getGroup();setTimeout((function(){Blockly.Events.setGroup(n),e.bumpNeighbours(),Blockly.Events.setGroup(!1)}),Blockly.BUMP_DELAY)}e.rendered&&e.render(),t!=o&&Blockly.keyboardAccessibilityMode&&Blockly.navigation.moveCursorOnBlockMutation(e),this.workspace_.isDragging()||this.resizeBubble_(),Blockly.Events.setGroup(!1)}}},Blockly.Mutator.prototype.getFlyoutMetrics_=function(){return{viewHeight:this.workspaceHeight_,viewWidth:this.workspaceWidth_-this.workspace_.getFlyout().getWidth(),absoluteTop:0,absoluteLeft:this.workspace_.RTL?0:this.workspace_.getFlyout().getWidth()}},Blockly.Mutator.prototype.dispose=function(){this.block_.mutator=null,Blockly.Icon.prototype.dispose.call(this)},Blockly.Mutator.prototype.updateBlockStyle=function(){var t=this.workspace_;if(t&&t.getAllBlocks()){for(var e=t.getAllBlocks(),o=0;o<e.length;o++){var l=e[o];l.setStyle(l.getStyleName())}for(t=t.flyout_.workspace_.getAllBlocks(),o=0;o<t.length;o++)(l=t[o]).setStyle(l.getStyleName())}},Blockly.Mutator.reconnect=function(t,e,o){if(!t||!t.getSourceBlock().workspace)return!1;o=e.getInput(o).connection;var l=t.targetBlock();return!(l&&l!=e||o.targetConnection==t||(o.isConnected()&&o.disconnect(),o.connect(t),0))},Blockly.Mutator.findParentWs=function(t){var e=null;if(t&&t.options){var o=t.options.parentWorkspace;t.isFlyout?o&&o.options&&(e=o.options.parentWorkspace):o&&(e=o)}return e},Blockly.utils.svgPaths={},Blockly.utils.svgPaths.point=function(t,e){return" "+t+","+e+" "},Blockly.utils.svgPaths.curve=function(t,e){return" "+t+e.join("")},Blockly.utils.svgPaths.moveTo=function(t,e){return" M "+t+","+e+" "},Blockly.utils.svgPaths.moveBy=function(t,e){return" m "+t+","+e+" "},Blockly.utils.svgPaths.lineTo=function(t,e){return" l "+t+","+e+" "},Blockly.utils.svgPaths.line=function(t){return" l"+t.join("")},Blockly.utils.svgPaths.lineOnAxis=function(t,e){return" "+t+" "+e+" "},Blockly.utils.svgPaths.arc=function(t,e,o,l){return t+" "+o+" "+o+" "+e+l},Blockly.blockRendering.ConstantProvider=function(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.MAX_BOTTOM_WIDTH=66.5,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=Blockly.utils.svgPaths.moveBy(0,0),this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6},Blockly.blockRendering.ConstantProvider.prototype.init=function(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()},Blockly.blockRendering.ConstantProvider.prototype.makeJaggedTeeth=function(){return{height:this.JAGGED_TEETH_HEIGHT,width:this.JAGGED_TEETH_WIDTH,path:Blockly.utils.svgPaths.line([Blockly.utils.svgPaths.point(6,3),Blockly.utils.svgPaths.point(-12,6),Blockly.utils.svgPaths.point(6,3)])}},Blockly.blockRendering.ConstantProvider.prototype.makeStartHat=function(){var t=this.START_HAT_HEIGHT,e=this.START_HAT_WIDTH;return{height:t,width:e,path:Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(30,-t),Blockly.utils.svgPaths.point(70,-t),Blockly.utils.svgPaths.point(e,0)])}},Blockly.blockRendering.ConstantProvider.prototype.makePuzzleTab=function(){function t(t){var l=-(t=t?-1:1),i=o/2,n=i+2.5,r=i+.5,s=Blockly.utils.svgPaths.point(-e,t*i);return i=Blockly.utils.svgPaths.point(e,t*i),Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(0,t*n),Blockly.utils.svgPaths.point(-e,l*r),s])+Blockly.utils.svgPaths.curve("s",[Blockly.utils.svgPaths.point(e,2.5*l),i])}var e=this.TAB_WIDTH,o=this.TAB_HEIGHT,l=t(!0),i=t(!1);return{width:e,height:o,pathDown:i,pathUp:l}},Blockly.blockRendering.ConstantProvider.prototype.makeNotch=function(){function t(t){return Blockly.utils.svgPaths.line([Blockly.utils.svgPaths.point(t*l,o),Blockly.utils.svgPaths.point(3*t,0),Blockly.utils.svgPaths.point(t*l,-o)])}var e=this.NOTCH_WIDTH,o=this.NOTCH_HEIGHT,l=(e-3)/2,i=t(1),n=t(-1);return{width:e,height:o,pathLeft:i,pathRight:n}},Blockly.blockRendering.ConstantProvider.prototype.makeInsideCorners=function(){var t=this.CORNER_RADIUS;return{width:t,height:t,pathTop:Blockly.utils.svgPaths.arc("a","0 0,0",t,Blockly.utils.svgPaths.point(-t,t)),pathBottom:Blockly.utils.svgPaths.arc("a","0 0,0",t,Blockly.utils.svgPaths.point(t,t))}},Blockly.blockRendering.ConstantProvider.prototype.makeOutsideCorners=function(){var t=this.CORNER_RADIUS;return{topLeft:Blockly.utils.svgPaths.moveBy(0,t)+Blockly.utils.svgPaths.arc("a","0 0,1",t,Blockly.utils.svgPaths.point(t,-t)),bottomLeft:t=Blockly.utils.svgPaths.arc("a","0 0,1",t,Blockly.utils.svgPaths.point(-t,-t))}},Blockly.blockRendering.ConstantProvider.prototype.shapeFor=function(t){switch(t.type){case Blockly.INPUT_VALUE:case Blockly.OUTPUT_VALUE:return this.PUZZLE_TAB;case Blockly.PREVIOUS_STATEMENT:case Blockly.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}},Blockly.blockRendering.Types={NONE:0,FIELD:1,HAT:2,ICON:4,SPACER:8,BETWEEN_ROW_SPACER:16,IN_ROW_SPACER:32,EXTERNAL_VALUE_INPUT:64,INPUT:128,INLINE_INPUT:256,STATEMENT_INPUT:512,CONNECTION:1024,PREVIOUS_CONNECTION:2048,NEXT_CONNECTION:4096,OUTPUT_CONNECTION:8192,CORNER:16384,LEFT_SQUARE_CORNER:32768,LEFT_ROUND_CORNER:65536,RIGHT_SQUARE_CORNER:131072,RIGHT_ROUND_CORNER:262144,JAGGED_EDGE:524288,ROW:1048576,TOP_ROW:2097152,BOTTOM_ROW:4194304,INPUT_ROW:8388608},Blockly.blockRendering.Types.LEFT_CORNER=Blockly.blockRendering.Types.LEFT_SQUARE_CORNER|Blockly.blockRendering.Types.LEFT_ROUND_CORNER,Blockly.blockRendering.Types.RIGHT_CORNER=Blockly.blockRendering.Types.RIGHT_SQUARE_CORNER|Blockly.blockRendering.Types.RIGHT_ROUND_CORNER,Blockly.blockRendering.Types.nextTypeValue_=16777216,Blockly.blockRendering.Types.getType=function(t){return Blockly.blockRendering.Types.hasOwnProperty(t)||(Blockly.blockRendering.Types[t]=Blockly.blockRendering.Types.nextTypeValue_,Blockly.blockRendering.Types.nextTypeValue_<<=1),Blockly.blockRendering.Types[t]},Blockly.blockRendering.Types.isField=function(t){return t.type&Blockly.blockRendering.Types.FIELD},Blockly.blockRendering.Types.isHat=function(t){return t.type&Blockly.blockRendering.Types.HAT},Blockly.blockRendering.Types.isIcon=function(t){return t.type&Blockly.blockRendering.Types.ICON},Blockly.blockRendering.Types.isSpacer=function(t){return t.type&Blockly.blockRendering.Types.SPACER},Blockly.blockRendering.Types.isInRowSpacer=function(t){return t.type&Blockly.blockRendering.Types.IN_ROW_SPACER},Blockly.blockRendering.Types.isInput=function(t){return t.type&Blockly.blockRendering.Types.INPUT},Blockly.blockRendering.Types.isExternalInput=function(t){return t.type&Blockly.blockRendering.Types.EXTERNAL_VALUE_INPUT},Blockly.blockRendering.Types.isInlineInput=function(t){return t.type&Blockly.blockRendering.Types.INLINE_INPUT},Blockly.blockRendering.Types.isStatementInput=function(t){return t.type&Blockly.blockRendering.Types.STATEMENT_INPUT},Blockly.blockRendering.Types.isPreviousConnection=function(t){return t.type&Blockly.blockRendering.Types.PREVIOUS_CONNECTION},Blockly.blockRendering.Types.isNextConnection=function(t){return t.type&Blockly.blockRendering.Types.NEXT_CONNECTION},Blockly.blockRendering.Types.isPreviousOrNextConnection=function(t){return t.type&(Blockly.blockRendering.Types.PREVIOUS_CONNECTION|Blockly.blockRendering.Types.NEXT_CONNECTION)},Blockly.blockRendering.Types.isLeftRoundedCorner=function(t){return t.type&Blockly.blockRendering.Types.LEFT_ROUND_CORNER},Blockly.blockRendering.Types.isRightRoundedCorner=function(t){return t.type&Blockly.blockRendering.Types.RIGHT_ROUND_CORNER},Blockly.blockRendering.Types.isLeftSquareCorner=function(t){return t.type&Blockly.blockRendering.Types.LEFT_SQUARE_CORNER},Blockly.blockRendering.Types.isRightSquareCorner=function(t){return t.type&Blockly.blockRendering.Types.RIGHT_SQUARE_CORNER},Blockly.blockRendering.Types.isCorner=function(t){return t.type&Blockly.blockRendering.Types.CORNER},Blockly.blockRendering.Types.isJaggedEdge=function(t){return t.type&Blockly.blockRendering.Types.JAGGED_EDGE},Blockly.blockRendering.Types.isRow=function(t){return t.type&Blockly.blockRendering.Types.ROW},Blockly.blockRendering.Types.isBetweenRowSpacer=function(t){return t.type&Blockly.blockRendering.Types.BETWEEN_ROW_SPACER},Blockly.blockRendering.Types.isTopRow=function(t){return t.type&Blockly.blockRendering.Types.TOP_ROW},Blockly.blockRendering.Types.isBottomRow=function(t){return t.type&Blockly.blockRendering.Types.BOTTOM_ROW},Blockly.blockRendering.Types.isTopOrBottomRow=function(t){return t.type&(Blockly.blockRendering.Types.TOP_ROW|Blockly.blockRendering.Types.BOTTOM_ROW)},Blockly.blockRendering.Types.isInputRow=function(t){return t.type&Blockly.blockRendering.Types.INPUT_ROW},Blockly.blockRendering.Measurable=function(t){this.height=this.width=0,this.type=Blockly.blockRendering.Types.NONE,this.centerline=this.xPos=0,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},Blockly.blockRendering.Connection=function(t,e){Blockly.blockRendering.Connection.superClass_.constructor.call(this,t),this.connectionModel=e,this.shape=this.constants_.shapeFor(e),this.type|=Blockly.blockRendering.Types.CONNECTION},Blockly.utils.object.inherits(Blockly.blockRendering.Connection,Blockly.blockRendering.Measurable),Blockly.blockRendering.OutputConnection=function(t,e){Blockly.blockRendering.OutputConnection.superClass_.constructor.call(this,t,e),this.type|=Blockly.blockRendering.Types.OUTPUT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.startX=this.width},Blockly.utils.object.inherits(Blockly.blockRendering.OutputConnection,Blockly.blockRendering.Connection),Blockly.blockRendering.OutputConnection.prototype.isDynamic=function(){return this.shape.isDynamic},Blockly.blockRendering.PreviousConnection=function(t,e){Blockly.blockRendering.PreviousConnection.superClass_.constructor.call(this,t,e),this.type|=Blockly.blockRendering.Types.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},Blockly.utils.object.inherits(Blockly.blockRendering.PreviousConnection,Blockly.blockRendering.Connection),Blockly.blockRendering.NextConnection=function(t,e){Blockly.blockRendering.NextConnection.superClass_.constructor.call(this,t,e),this.type|=Blockly.blockRendering.Types.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width},Blockly.utils.object.inherits(Blockly.blockRendering.NextConnection,Blockly.blockRendering.Connection),Blockly.blockRendering.InputConnection=function(t,e){if(Blockly.blockRendering.InputConnection.superClass_.constructor.call(this,t,e.connection),this.type|=Blockly.blockRendering.Types.INPUT,this.input=e,this.align=e.align,this.connectedBlock=e.connection&&e.connection.targetBlock()?e.connection.targetBlock():null){var o=this.connectedBlock.getHeightWidth();this.connectedBlockWidth=o.width,this.connectedBlockHeight=o.height}else this.connectedBlockHeight=this.connectedBlockWidth=0;this.connection=e.connection,this.connectionOffsetY=this.connectionOffsetX=0},Blockly.utils.object.inherits(Blockly.blockRendering.InputConnection,Blockly.blockRendering.Connection),Blockly.blockRendering.InlineInput=function(t,e){Blockly.blockRendering.InlineInput.superClass_.constructor.call(this,t,e),this.type|=Blockly.blockRendering.Types.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.shape.width+this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},Blockly.utils.object.inherits(Blockly.blockRendering.InlineInput,Blockly.blockRendering.InputConnection),Blockly.blockRendering.StatementInput=function(t,e){Blockly.blockRendering.StatementInput.superClass_.constructor.call(this,t,e),this.type|=Blockly.blockRendering.Types.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.NOTCH_OFFSET_LEFT+this.shape.width},Blockly.utils.object.inherits(Blockly.blockRendering.StatementInput,Blockly.blockRendering.InputConnection),Blockly.blockRendering.ExternalValueInput=function(t,e){Blockly.blockRendering.ExternalValueInput.superClass_.constructor.call(this,t,e),this.type|=Blockly.blockRendering.Types.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-2*this.constants_.TAB_OFFSET_FROM_TOP:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width},Blockly.utils.object.inherits(Blockly.blockRendering.ExternalValueInput,Blockly.blockRendering.InputConnection),Blockly.blockRendering.Icon=function(t,e){Blockly.blockRendering.Icon.superClass_.constructor.call(this,t),this.icon=e,this.isVisible=e.isVisible(),this.type|=Blockly.blockRendering.Types.ICON;var o=e.getCorrectedSize();this.height=o.height,this.width=o.width},Blockly.utils.object.inherits(Blockly.blockRendering.Icon,Blockly.blockRendering.Measurable),Blockly.blockRendering.JaggedEdge=function(t){Blockly.blockRendering.JaggedEdge.superClass_.constructor.call(this,t),this.type|=Blockly.blockRendering.Types.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width},Blockly.utils.object.inherits(Blockly.blockRendering.JaggedEdge,Blockly.blockRendering.Measurable),Blockly.blockRendering.Field=function(t,e,o){Blockly.blockRendering.Field.superClass_.constructor.call(this,t),this.field=e,this.isEditable=e.isCurrentlyEditable(),this.flipRtl=e.getFlipRtl(),this.type|=Blockly.blockRendering.Types.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width,this.parentInput=o},Blockly.utils.object.inherits(Blockly.blockRendering.Field,Blockly.blockRendering.Measurable),Blockly.blockRendering.Hat=function(t){Blockly.blockRendering.Hat.superClass_.constructor.call(this,t),this.type|=Blockly.blockRendering.Types.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height},Blockly.utils.object.inherits(Blockly.blockRendering.Hat,Blockly.blockRendering.Measurable),Blockly.blockRendering.SquareCorner=function(t,e){Blockly.blockRendering.SquareCorner.superClass_.constructor.call(this,t),this.type=(e&&"left"!=e?Blockly.blockRendering.Types.RIGHT_SQUARE_CORNER:Blockly.blockRendering.Types.LEFT_SQUARE_CORNER)|Blockly.blockRendering.Types.CORNER,this.width=this.height=this.constants_.NO_PADDING},Blockly.utils.object.inherits(Blockly.blockRendering.SquareCorner,Blockly.blockRendering.Measurable),Blockly.blockRendering.RoundCorner=function(t,e){Blockly.blockRendering.RoundCorner.superClass_.constructor.call(this,t),this.type=(e&&"left"!=e?Blockly.blockRendering.Types.RIGHT_ROUND_CORNER:Blockly.blockRendering.Types.LEFT_ROUND_CORNER)|Blockly.blockRendering.Types.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2},Blockly.utils.object.inherits(Blockly.blockRendering.RoundCorner,Blockly.blockRendering.Measurable),Blockly.blockRendering.InRowSpacer=function(t,e){Blockly.blockRendering.InRowSpacer.superClass_.constructor.call(this,t),this.type=this.type|Blockly.blockRendering.Types.SPACER|Blockly.blockRendering.Types.IN_ROW_SPACER,this.width=e,this.height=this.constants_.SPACER_DEFAULT_HEIGHT},Blockly.utils.object.inherits(Blockly.blockRendering.InRowSpacer,Blockly.blockRendering.Measurable),Blockly.blockRendering.Row=function(t){this.type=Blockly.blockRendering.Types.ROW,this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=this.hasStatement=this.hasExternalInput=!1,this.constants_=t,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT},Blockly.blockRendering.Row.prototype.measure=function(){throw Error("Unexpected attempt to measure a base Row.")},Blockly.blockRendering.Row.prototype.getLastInput=function(){for(var t,e=this.elements.length-1;t=this.elements[e];e--)if(Blockly.blockRendering.Types.isInput(t))return t;return null},Blockly.blockRendering.Row.prototype.startsWithElemSpacer=function(){return!0},Blockly.blockRendering.Row.prototype.endsWithElemSpacer=function(){return!0},Blockly.blockRendering.Row.prototype.getFirstSpacer=function(){for(var t,e=0;t=this.elements[e];e++)if(Blockly.blockRendering.Types.isSpacer(t))return t;return null},Blockly.blockRendering.Row.prototype.getLastSpacer=function(){for(var t,e=this.elements.length-1;t=this.elements[e];e--)if(Blockly.blockRendering.Types.isSpacer(t))return t;return null},Blockly.blockRendering.TopRow=function(t){Blockly.blockRendering.TopRow.superClass_.constructor.call(this,t),this.type|=Blockly.blockRendering.Types.TOP_ROW,this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null},Blockly.utils.object.inherits(Blockly.blockRendering.TopRow,Blockly.blockRendering.Row),Blockly.blockRendering.TopRow.prototype.hasLeftSquareCorner=function(t){var e=(t.hat?"cap"===t.hat:Blockly.BlockSvg.START_HAT)&&!t.outputConnection&&!t.previousConnection,o=t.getPreviousBlock();return!!t.outputConnection||e||!!o&&o.getNextBlock()==t},Blockly.blockRendering.TopRow.prototype.measure=function(){for(var t,e=0,o=0,l=0,i=0;t=this.elements[i];i++)o+=t.width,Blockly.blockRendering.Types.isSpacer(t)||(Blockly.blockRendering.Types.isHat(t)?l=Math.max(l,t.ascenderHeight):e=Math.max(e,t.height));this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,e)+l,this.capline=this.ascenderHeight=l,this.widthWithConnectedBlocks=this.width},Blockly.blockRendering.TopRow.prototype.startsWithElemSpacer=function(){return!1},Blockly.blockRendering.BottomRow=function(t){Blockly.blockRendering.BottomRow.superClass_.constructor.call(this,t),this.type|=Blockly.blockRendering.Types.BOTTOM_ROW,this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0},Blockly.utils.object.inherits(Blockly.blockRendering.BottomRow,Blockly.blockRendering.Row),Blockly.blockRendering.BottomRow.prototype.hasLeftSquareCorner=function(t){return!!t.outputConnection||!!t.getNextBlock()},Blockly.blockRendering.BottomRow.prototype.measure=function(){for(var t,e=0,o=0,l=0,i=0;t=this.elements[i];i++)o+=t.width,Blockly.blockRendering.Types.isSpacer(t)||(Blockly.blockRendering.Types.isNextConnection(t)?l=Math.max(l,t.height):e=Math.max(e,t.height));this.width=Math.max(this.minWidth,o),this.height=Math.max(this.minHeight,e)+l,this.descenderHeight=l,this.widthWithConnectedBlocks=this.width},Blockly.blockRendering.BottomRow.prototype.startsWithElemSpacer=function(){return!1},Blockly.blockRendering.SpacerRow=function(t,e,o){Blockly.blockRendering.SpacerRow.superClass_.constructor.call(this,t),this.type=this.type|Blockly.blockRendering.Types.SPACER|Blockly.blockRendering.Types.BETWEEN_ROW_SPACER,this.width=o,this.height=e,this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.elements=[new Blockly.blockRendering.InRowSpacer(this.constants_,o)]},Blockly.utils.object.inherits(Blockly.blockRendering.SpacerRow,Blockly.blockRendering.Row),Blockly.blockRendering.SpacerRow.prototype.measure=function(){},Blockly.blockRendering.InputRow=function(t){Blockly.blockRendering.InputRow.superClass_.constructor.call(this,t),this.type|=Blockly.blockRendering.Types.INPUT_ROW,this.connectedBlockWidths=0},Blockly.utils.object.inherits(Blockly.blockRendering.InputRow,Blockly.blockRendering.Row),Blockly.blockRendering.InputRow.prototype.measure=function(){this.width=this.minWidth,this.height=this.minHeight;for(var t,e=0,o=0;t=this.elements[o];o++)this.width+=t.width,Blockly.blockRendering.Types.isInput(t)&&(Blockly.blockRendering.Types.isStatementInput(t)?e+=t.connectedBlockWidth:Blockly.blockRendering.Types.isExternalInput(t)&&0!=t.connectedBlockWidth&&(e+=t.connectedBlockWidth-t.connectionWidth)),Blockly.blockRendering.Types.isSpacer(t)||(this.height=Math.max(this.height,t.height));this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e},Blockly.blockRendering.InputRow.prototype.endsWithElemSpacer=function(){return!this.hasExternalInput&&!this.hasStatement},Blockly.blockRendering.RenderInfo=function(t,e){this.block_=e,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=e.outputConnection?new Blockly.blockRendering.OutputConnection(this.constants_,e.outputConnection):null,this.isInline=e.getInputsInline()&&!e.isCollapsed(),this.isCollapsed=e.isCollapsed(),this.isInsertionMarker=e.isInsertionMarker(),this.RTL=e.RTL,this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.hiddenIcons=[],this.topRow=new Blockly.blockRendering.TopRow(this.constants_),this.bottomRow=new Blockly.blockRendering.BottomRow(this.constants_),this.startY=this.startX=0},Blockly.blockRendering.RenderInfo.prototype.getRenderer=function(){return this.renderer_},Blockly.blockRendering.RenderInfo.prototype.measure=function(){this.createRows_(),this.addElemSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.addRowSpacing_(),this.finalize_()},Blockly.blockRendering.RenderInfo.prototype.createRows_=function(){this.populateTopRow_(),this.rows.push(this.topRow);var t=new Blockly.blockRendering.InputRow(this.constants_),e=this.block_.getIcons();if(e.length)for(var o,l=0;o=e[l];l++){var i=new Blockly.blockRendering.Icon(this.constants_,o);this.isCollapsed&&o.collapseHidden?this.hiddenIcons.push(i):t.elements.push(i)}for(o=null,l=0;e=this.block_.inputList[l];l++)if(e.isVisible()){for(this.shouldStartNewRow_(e,o)&&(this.rows.push(t),t=new Blockly.blockRendering.InputRow(this.constants_)),o=0;i=e.fieldRow[o];o++)t.elements.push(new Blockly.blockRendering.Field(this.constants_,i,e));this.addInput_(e,t),o=e}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new Blockly.blockRendering.JaggedEdge(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)},Blockly.blockRendering.RenderInfo.prototype.populateTopRow_=function(){var t=!!this.block_.previousConnection,e=(this.block_.hat?"cap"===this.block_.hat:Blockly.BlockSvg.START_HAT)&&!this.outputConnection&&!t;this.topRow.hasLeftSquareCorner(this.block_)?this.topRow.elements.push(new Blockly.blockRendering.SquareCorner(this.constants_)):this.topRow.elements.push(new Blockly.blockRendering.RoundCorner(this.constants_)),e?(t=new Blockly.blockRendering.Hat(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new Blockly.blockRendering.PreviousConnection(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.topRow.minHeight=this.block_.inputList.length&&this.block_.inputList[0].type==Blockly.NEXT_STATEMENT&&!this.block_.isCollapsed()?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},Blockly.blockRendering.RenderInfo.prototype.populateBottomRow_=function(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1].type==Blockly.NEXT_STATEMENT?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING-1,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new Blockly.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new Blockly.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Blockly.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection))},Blockly.blockRendering.RenderInfo.prototype.addInput_=function(t,e){this.isInline&&t.type==Blockly.INPUT_VALUE?(e.elements.push(new Blockly.blockRendering.InlineInput(this.constants_,t)),e.hasInlineInput=!0):t.type==Blockly.NEXT_STATEMENT?(e.elements.push(new Blockly.blockRendering.StatementInput(this.constants_,t)),e.hasStatement=!0):t.type==Blockly.INPUT_VALUE?(e.elements.push(new Blockly.blockRendering.ExternalValueInput(this.constants_,t)),e.hasExternalInput=!0):t.type==Blockly.DUMMY_INPUT&&(e.minHeight=Math.max(e.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),e.align=t.align},Blockly.blockRendering.RenderInfo.prototype.shouldStartNewRow_=function(t,e){return!(!e||t.type!=Blockly.NEXT_STATEMENT&&e.type!=Blockly.NEXT_STATEMENT&&(t.type!=Blockly.INPUT_VALUE&&t.type!=Blockly.DUMMY_INPUT||this.isInline))},Blockly.blockRendering.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=0;t=this.rows[e];e++){var o=t.elements;t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,o[0])));for(var l=0;l<o.length-1;l++){t.elements.push(o[l]);var i=this.getInRowSpacing_(o[l],o[l+1]);t.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,i))}t.elements.push(o[o.length-1]),t.endsWithElemSpacer()&&t.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(o[o.length-1],null)))}},Blockly.blockRendering.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(t&&Blockly.blockRendering.Types.isInput(t)&&!e){if(Blockly.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(Blockly.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(Blockly.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}return t&&Blockly.blockRendering.Types.isLeftSquareCorner(t)&&e&&(Blockly.blockRendering.Types.isPreviousConnection(e)||Blockly.blockRendering.Types.isNextConnection(e))?e.notchOffset:t&&Blockly.blockRendering.Types.isLeftRoundedCorner(t)&&e&&(Blockly.blockRendering.Types.isPreviousConnection(e)||Blockly.blockRendering.Types.isNextConnection(e))?e.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING},Blockly.blockRendering.RenderInfo.prototype.computeBounds_=function(){for(var t,e=0,o=0,l=0,i=0;t=this.rows[i];i++){if(t.measure(),o=Math.max(o,t.width),t.hasStatement){var n=t.getLastInput();e=Math.max(e,t.width-n.width)}l=Math.max(l,t.widthWithConnectedBlocks)}for(this.statementEdge=e,this.width=o,i=0;t=this.rows[i];i++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(o,l),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)},Blockly.blockRendering.RenderInfo.prototype.alignRowElements_=function(){for(var t,e=0;t=this.rows[e];e++)if(t.hasStatement)this.alignStatementRow_(t);else{var o=this.width-this.startX-t.width;o&&this.addAlignmentPadding_(t,o)}},Blockly.blockRendering.RenderInfo.prototype.addAlignmentPadding_=function(t,e){var o=t.getLastSpacer();o&&(o.width+=e,t.width+=e)},Blockly.blockRendering.RenderInfo.prototype.alignStatementRow_=function(t){var e=t.getLastInput(),o=t.width-e.width,l=this.statementEdge;(o=l-o)&&this.addAlignmentPadding_(t,o),e.width+=(l=this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0))-(o=t.width),t.width+=l-o,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)},Blockly.blockRendering.RenderInfo.prototype.addRowSpacing_=function(){var t=this.rows;this.rows=[];for(var e=0;e<t.length;e++)this.rows.push(t[e]),e!=t.length-1&&this.rows.push(this.makeSpacerRow_(t[e],t[e+1]))},Blockly.blockRendering.RenderInfo.prototype.makeSpacerRow_=function(t,e){var o=this.getSpacerRowHeight_(t,e),l=this.getSpacerRowWidth_(t,e);return o=new Blockly.blockRendering.SpacerRow(this.constants_,o,l),t.hasStatement&&(o.followsStatement=!0),o},Blockly.blockRendering.RenderInfo.prototype.getSpacerRowWidth_=function(t,e){return this.width-this.startX},Blockly.blockRendering.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return this.constants_.MEDIUM_PADDING},Blockly.blockRendering.RenderInfo.prototype.getElemCenterline_=function(t,e){if(Blockly.blockRendering.Types.isSpacer(e))return t.yPos+e.height/2;if(Blockly.blockRendering.Types.isBottomRow(t)){var o=t.yPos+t.height-t.descenderHeight;return Blockly.blockRendering.Types.isNextConnection(e)?o+e.height/2:o-e.height/2}return Blockly.blockRendering.Types.isTopRow(t)?Blockly.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2:t.yPos+t.height/2},Blockly.blockRendering.RenderInfo.prototype.recordElemPositions_=function(t){for(var e,o=t.xPos,l=0;e=t.elements[l];l++)Blockly.blockRendering.Types.isSpacer(e)&&(e.height=t.height),e.xPos=o,e.centerline=this.getElemCenterline_(t,e),o+=e.width},Blockly.blockRendering.RenderInfo.prototype.finalize_=function(){for(var t,e=0,o=0,l=0;t=this.rows[l];l++)t.yPos=o,t.xPos=this.startX,o+=t.height,e=Math.max(e,t.widthWithConnectedBlocks),this.recordElemPositions_(t);this.widthWithChildren=e+this.startX,this.height=o,this.startY=this.topRow.capline,this.bottomRow.baseline=o-this.bottomRow.descenderHeight},Blockly.blockRendering.Drawer=function(t,e){this.block_=t,this.info_=e,this.topLeft_=t.getRelativeToSurfaceXY(),this.inlinePath_=this.outlinePath_="",this.constants_=e.getRenderer().getConstants()},Blockly.blockRendering.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPaths(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),Blockly.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},Blockly.blockRendering.Drawer.prototype.recordSizeOnBlock_=function(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren},Blockly.blockRendering.Drawer.prototype.hideHiddenIcons_=function(){for(var t,e=0;t=this.info_.hiddenIcons[e];e++)t.icon.iconGroup_.setAttribute("display","none")},Blockly.blockRendering.Drawer.prototype.drawOutline_=function(){this.drawTop_();for(var t=1;t<this.info_.rows.length-1;t++){var e=this.info_.rows[t];e.hasJaggedEdge?this.drawJaggedEdge_(e):e.hasStatement?this.drawStatementInput_(e):e.hasExternalInput?this.drawValueInput_(e):this.drawRightSideRow_(e)}this.drawBottom_(),this.drawLeft_()},Blockly.blockRendering.Drawer.prototype.drawTop_=function(){var t=this.info_.topRow,e=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=Blockly.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var o,l=0;o=e[l];l++)Blockly.blockRendering.Types.isLeftRoundedCorner(o)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:Blockly.blockRendering.Types.isPreviousConnection(o)?this.outlinePath_+=o.shape.pathLeft:Blockly.blockRendering.Types.isHat(o)?this.outlinePath_+=this.constants_.START_HAT.path:Blockly.blockRendering.Types.isSpacer(o)&&(this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("h",o.width));this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("v",t.height)},Blockly.blockRendering.Drawer.prototype.drawJaggedEdge_=function(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+Blockly.utils.svgPaths.lineOnAxis("v",t.height-this.constants_.JAGGED_TEETH.height)},Blockly.blockRendering.Drawer.prototype.drawValueInput_=function(t){var e=t.getLastInput();this.positionExternalValueConnection_(t);var o="function"==typeof e.shape.pathDown?e.shape.pathDown(e.height):e.shape.pathDown;this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("H",e.xPos+e.width)+o+Blockly.utils.svgPaths.lineOnAxis("v",t.height-e.connectionHeight)},Blockly.blockRendering.Drawer.prototype.drawStatementInput_=function(t){var e=t.getLastInput(),o=e.xPos+e.notchOffset+e.shape.width;e=e.shape.pathRight+Blockly.utils.svgPaths.lineOnAxis("h",-(e.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var l=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("H",o)+e+Blockly.utils.svgPaths.lineOnAxis("v",l)+this.constants_.INSIDE_CORNERS.pathBottom+Blockly.utils.svgPaths.lineOnAxis("H",t.xPos+t.width),this.positionStatementInputConnection_(t)},Blockly.blockRendering.Drawer.prototype.drawRightSideRow_=function(t){this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("V",t.yPos+t.height)},Blockly.blockRendering.Drawer.prototype.drawBottom_=function(){var t=this.info_.bottomRow,e=t.elements;this.positionNextConnection_(),this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("V",t.baseline);for(var o,l=e.length-1;o=e[l];l--)Blockly.blockRendering.Types.isNextConnection(o)?this.outlinePath_+=o.shape.pathRight:Blockly.blockRendering.Types.isLeftSquareCorner(o)?this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("H",t.xPos):Blockly.blockRendering.Types.isLeftRoundedCorner(o)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.bottomLeft:Blockly.blockRendering.Types.isSpacer(o)&&(this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("h",-1*o.width))},Blockly.blockRendering.Drawer.prototype.drawLeft_=function(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){var e=t.connectionOffsetY+t.height;t="function"==typeof t.shape.pathUp?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=Blockly.utils.svgPaths.lineOnAxis("V",e)+t}this.outlinePath_+="z"},Blockly.blockRendering.Drawer.prototype.drawInternals_=function(){for(var t,e=0;t=this.info_.rows[e];e++)for(var o,l=0;o=t.elements[l];l++)Blockly.blockRendering.Types.isInlineInput(o)?this.drawInlineInput_(o):(Blockly.blockRendering.Types.isIcon(o)||Blockly.blockRendering.Types.isField(o))&&this.layoutField_(o)},Blockly.blockRendering.Drawer.prototype.layoutField_=function(t){if(Blockly.blockRendering.Types.isField(t))var e=t.field.getSvgRoot();else Blockly.blockRendering.Types.isIcon(t)&&(e=t.icon.iconGroup_);var o=t.centerline-t.height/2,l=t.xPos,i="";this.info_.RTL&&(l=-(l+t.width),t.flipRtl&&(l+=t.width,i="scale(-1 1)")),Blockly.blockRendering.Types.isIcon(t)?(e.setAttribute("display","block"),e.setAttribute("transform","translate("+l+","+o+")"),t.icon.computeIconLocation()):e.setAttribute("transform","translate("+l+","+o+")"+i),this.info_.isInsertionMarker&&e.setAttribute("display","none")},Blockly.blockRendering.Drawer.prototype.drawInlineInput_=function(t){var e=t.width,o=t.height,l=t.connectionOffsetY,i=t.connectionHeight+l;this.inlinePath_+=Blockly.utils.svgPaths.moveTo(t.xPos+t.connectionWidth,t.centerline-o/2)+Blockly.utils.svgPaths.lineOnAxis("v",l)+t.shape.pathDown+Blockly.utils.svgPaths.lineOnAxis("v",o-i)+Blockly.utils.svgPaths.lineOnAxis("h",e-t.connectionWidth)+Blockly.utils.svgPaths.lineOnAxis("v",-o)+"z",this.positionInlineInputConnection_(t)},Blockly.blockRendering.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connection){var e=t.xPos+t.connectionWidth;this.info_.RTL&&(e*=-1),t.connection.setOffsetInBlock(e,t.centerline-t.height/2+t.connectionOffsetY)}},Blockly.blockRendering.Drawer.prototype.positionStatementInputConnection_=function(t){var e=t.getLastInput();if(e.connection){var o=t.xPos+t.statementEdge+e.notchOffset;this.info_.RTL&&(o*=-1),e.connection.setOffsetInBlock(o,t.yPos)}},Blockly.blockRendering.Drawer.prototype.positionExternalValueConnection_=function(t){var e=t.getLastInput();if(e.connection){var o=t.xPos+t.width;this.info_.RTL&&(o*=-1),e.connection.setOffsetInBlock(o,t.yPos)}},Blockly.blockRendering.Drawer.prototype.positionPreviousConnection_=function(){var t=this.info_.topRow;if(t.connection){var e=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,0)}},Blockly.blockRendering.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var e=(t=t.connection).xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,t.centerline-t.height/2)}},Blockly.blockRendering.Drawer.prototype.positionOutputConnection_=function(){if(this.info_.outputConnection){var t=this.info_.startX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}},Blockly.blockRendering.Renderer=function(){this.constants_=null},Blockly.blockRendering.Renderer.prototype.init=function(){this.constants_=this.makeConstants_(),this.constants_.init()},Blockly.blockRendering.Renderer.prototype.makeConstants_=function(){return new Blockly.blockRendering.ConstantProvider},Blockly.blockRendering.Renderer.prototype.makeRenderInfo_=function(t){return new Blockly.blockRendering.RenderInfo(this,t)},Blockly.blockRendering.Renderer.prototype.makeDrawer_=function(t,e){return new Blockly.blockRendering.Drawer(t,e)},Blockly.blockRendering.Renderer.prototype.makeDebugger_=function(){if(!Blockly.blockRendering.Debug)throw Error("Missing require for Blockly.blockRendering.Debug");return new Blockly.blockRendering.Debug},Blockly.blockRendering.Renderer.prototype.makeCursorDrawer=function(t,e){return new Blockly.CursorSvg(t,e)},Blockly.blockRendering.Renderer.prototype.makePathObject=function(t){return new Blockly.blockRendering.PathObject(t)},Blockly.blockRendering.Renderer.prototype.getConstants=function(){return this.constants_},Blockly.blockRendering.Renderer.prototype.render=function(t){Blockly.blockRendering.useDebugger&&!t.renderingDebugger&&(t.renderingDebugger=this.makeDebugger_());var e=this.makeRenderInfo_(t);e.measure(),this.makeDrawer_(t,e).draw()},Blockly.geras={},Blockly.geras.ConstantProvider=function(){Blockly.geras.ConstantProvider.superClass_.constructor.call(this),this.DARK_PATH_OFFSET=1},Blockly.utils.object.inherits(Blockly.geras.ConstantProvider,Blockly.blockRendering.ConstantProvider),Blockly.geras.Highlighter=function(t){this.info_=t,this.inlineSteps_=this.steps_="",this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset_=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH},Blockly.geras.Highlighter.prototype.getPath=function(){return this.steps_+"\n"+this.inlineSteps_},Blockly.geras.Highlighter.prototype.drawTopCorner=function(t){this.steps_+=Blockly.utils.svgPaths.moveBy(t.xPos,this.info_.startY);for(var e,o=0;e=t.elements[o];o++)Blockly.blockRendering.Types.isLeftSquareCorner(e)?this.steps_+=this.highlightConstants_.START_POINT:Blockly.blockRendering.Types.isLeftRoundedCorner(e)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):Blockly.blockRendering.Types.isPreviousConnection(e)?this.steps_+=this.notchPaths_.pathLeft:Blockly.blockRendering.Types.isHat(e)?this.steps_+=this.startPaths_.path(this.RTL_):Blockly.blockRendering.Types.isSpacer(e)&&0!=e.width&&(this.steps_+=Blockly.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.highlightOffset_));this.steps_+=Blockly.utils.svgPaths.lineOnAxis("H",t.xPos+t.width-this.highlightOffset_)},Blockly.geras.Highlighter.prototype.drawJaggedEdge_=function(t){this.info_.RTL&&(this.steps_+=Blockly.utils.svgPaths.lineOnAxis("H",t.width-this.highlightOffset_),this.steps_+=this.jaggedTeethPaths_.pathLeft,this.steps_+=Blockly.utils.svgPaths.lineOnAxis("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset_))},Blockly.geras.Highlighter.prototype.drawValueInput=function(t){var e=t.getLastInput();if(this.RTL_){var o=t.height-e.connectionHeight;this.steps_+=Blockly.utils.svgPaths.moveTo(e.xPos+e.width-this.highlightOffset_,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+Blockly.utils.svgPaths.lineOnAxis("v",o)}else this.steps_+=Blockly.utils.svgPaths.moveTo(e.xPos+e.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)},Blockly.geras.Highlighter.prototype.drawStatementInput=function(t){var e=t.getLastInput();if(this.RTL_){var o=t.height-2*this.insideCornerPaths_.height;this.steps_+=Blockly.utils.svgPaths.moveTo(e.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+Blockly.utils.svgPaths.lineOnAxis("v",o)+this.insideCornerPaths_.pathBottom(this.RTL_)+Blockly.utils.svgPaths.lineTo(t.width-e.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Blockly.utils.svgPaths.moveTo(e.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Blockly.utils.svgPaths.lineTo(t.width-e.xPos-this.insideCornerPaths_.width,0)},Blockly.geras.Highlighter.prototype.drawRightSideRow=function(t){var e=t.xPos+t.width-this.highlightOffset_;t.followsStatement&&(this.steps_+=Blockly.utils.svgPaths.lineOnAxis("H",e)),this.RTL_&&(this.steps_+=Blockly.utils.svgPaths.lineOnAxis("H",e),t.height>this.highlightOffset_&&(this.steps_+=Blockly.utils.svgPaths.lineOnAxis("V",t.yPos+t.height-this.highlightOffset_)))},Blockly.geras.Highlighter.prototype.drawBottomRow=function(t){if(this.RTL_)this.steps_+=Blockly.utils.svgPaths.lineOnAxis("V",t.baseline-this.highlightOffset_);else{var e=this.info_.bottomRow.elements[0];Blockly.blockRendering.Types.isLeftSquareCorner(e)?this.steps_+=Blockly.utils.svgPaths.moveTo(t.xPos+this.highlightOffset_,t.baseline-this.highlightOffset_):Blockly.blockRendering.Types.isLeftRoundedCorner(e)&&(this.steps_+=Blockly.utils.svgPaths.moveTo(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}},Blockly.geras.Highlighter.prototype.drawLeft=function(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=Blockly.utils.svgPaths.moveTo(this.info_.startX,t):(this.steps_+=Blockly.utils.svgPaths.moveTo(this.info_.startX+this.highlightOffset_,this.info_.bottomRow.baseline-this.highlightOffset_),this.steps_+=Blockly.utils.svgPaths.lineOnAxis("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(Blockly.blockRendering.Types.isLeftRoundedCorner((t=this.info_.topRow).elements[0])?this.steps_+=Blockly.utils.svgPaths.lineOnAxis("V",this.outsideCornerPaths_.height):this.steps_+=Blockly.utils.svgPaths.lineOnAxis("V",t.capline+this.highlightOffset_))},Blockly.geras.Highlighter.prototype.drawInlineInput=function(t){var e=this.highlightOffset_,o=t.xPos+t.connectionWidth,l=t.centerline-t.height/2,i=t.width-t.connectionWidth,n=l+e;this.RTL_?(l=t.connectionOffsetY-e,t=t.height-(t.connectionOffsetY+t.connectionHeight)+e,this.inlineSteps_+=Blockly.utils.svgPaths.moveTo(o-e,n)+Blockly.utils.svgPaths.lineOnAxis("v",l)+this.puzzleTabPaths_.pathDown(this.RTL_)+Blockly.utils.svgPaths.lineOnAxis("v",t)+Blockly.utils.svgPaths.lineOnAxis("h",i)):this.inlineSteps_+=Blockly.utils.svgPaths.moveTo(t.xPos+t.width+e,n)+Blockly.utils.svgPaths.lineOnAxis("v",t.height)+Blockly.utils.svgPaths.lineOnAxis("h",-i)+Blockly.utils.svgPaths.moveTo(o,l+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)},Blockly.geras.PathObject=function(t){this.svgRoot=t,this.svgPathDark=Blockly.utils.dom.createSvgElement("path",{class:"blocklyPathDark",transform:"translate(1,1)"},this.svgRoot),this.svgPath=Blockly.utils.dom.createSvgElement("path",{class:"blocklyPath"},this.svgRoot),this.svgPathLight=Blockly.utils.dom.createSvgElement("path",{class:"blocklyPathLight"},this.svgRoot)},Blockly.geras.PathObject.prototype.setPaths=function(t,e){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t),this.svgPathLight.setAttribute("d",e)},Blockly.geras.PathObject.prototype.flipRTL=function(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")},Blockly.geras.InlineInput=function(t,e){Blockly.geras.InlineInput.superClass_.constructor.call(this,t,e),this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)},Blockly.utils.object.inherits(Blockly.geras.InlineInput,Blockly.blockRendering.InlineInput),Blockly.geras.StatementInput=function(t,e){Blockly.geras.StatementInput.superClass_.constructor.call(this,t,e),this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)},Blockly.utils.object.inherits(Blockly.geras.StatementInput,Blockly.blockRendering.StatementInput),Blockly.geras.RenderInfo=function(t,e){Blockly.geras.RenderInfo.superClass_.constructor.call(this,t,e)},Blockly.utils.object.inherits(Blockly.geras.RenderInfo,Blockly.blockRendering.RenderInfo),Blockly.geras.RenderInfo.prototype.getRenderer=function(){return this.renderer_},Blockly.geras.RenderInfo.prototype.addInput_=function(t,e){this.isInline&&t.type==Blockly.INPUT_VALUE?(e.elements.push(new Blockly.geras.InlineInput(this.constants_,t)),e.hasInlineInput=!0):t.type==Blockly.NEXT_STATEMENT?(e.elements.push(new Blockly.geras.StatementInput(this.constants_,t)),e.hasStatement=!0):t.type==Blockly.INPUT_VALUE?(e.elements.push(new Blockly.blockRendering.ExternalValueInput(this.constants_,t)),e.hasExternalInput=!0):t.type==Blockly.DUMMY_INPUT&&(e.minHeight=Math.max(e.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),e.hasDummyInput=!0),e.align=t.align},Blockly.geras.RenderInfo.prototype.addElemSpacing_=function(){for(var t,e=!1,o=0;t=this.rows[o];o++)t.hasExternalInput&&(e=!0);for(o=0;t=this.rows[o];o++){var l=t.elements;t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,this.getInRowSpacing_(null,l[0])));for(var i=0;i<l.length-1;i++){t.elements.push(l[i]);var n=this.getInRowSpacing_(l[i],l[i+1]);t.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,n))}t.elements.push(l[l.length-1]),t.endsWithElemSpacer()&&(n=this.getInRowSpacing_(l[l.length-1],null),e&&t.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),t.elements.push(new Blockly.blockRendering.InRowSpacer(this.constants_,n)))}},Blockly.geras.RenderInfo.prototype.getInRowSpacing_=function(t,e){if(!t)return e&&Blockly.blockRendering.Types.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:e&&Blockly.blockRendering.Types.isInlineInput(e)?this.constants_.MEDIUM_LARGE_PADDING:e&&Blockly.blockRendering.Types.isStatementInput(e)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!Blockly.blockRendering.Types.isInput(t)&&!e)return Blockly.blockRendering.Types.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:Blockly.blockRendering.Types.isIcon(t)?2*this.constants_.LARGE_PADDING+1:Blockly.blockRendering.Types.isHat(t)?this.constants_.NO_PADDING:Blockly.blockRendering.Types.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:Blockly.blockRendering.Types.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:Blockly.blockRendering.Types.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(Blockly.blockRendering.Types.isInput(t)&&!e){if(Blockly.blockRendering.Types.isExternalInput(t))return this.constants_.NO_PADDING;if(Blockly.blockRendering.Types.isInlineInput(t))return this.constants_.LARGE_PADDING;if(Blockly.blockRendering.Types.isStatementInput(t))return this.constants_.NO_PADDING}if(!Blockly.blockRendering.Types.isInput(t)&&e&&Blockly.blockRendering.Types.isInput(e)){if(t.isEditable){if(Blockly.blockRendering.Types.isInlineInput(e)||Blockly.blockRendering.Types.isExternalInput(e))return this.constants_.SMALL_PADDING}else{if(Blockly.blockRendering.Types.isInlineInput(e)||Blockly.blockRendering.Types.isExternalInput(e))return this.constants_.MEDIUM_LARGE_PADDING;if(Blockly.blockRendering.Types.isStatementInput(e))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(Blockly.blockRendering.Types.isIcon(t)&&e&&!Blockly.blockRendering.Types.isInput(e))return this.constants_.LARGE_PADDING;if(Blockly.blockRendering.Types.isInlineInput(t)&&e&&!Blockly.blockRendering.Types.isInput(e))return e.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(Blockly.blockRendering.Types.isLeftSquareCorner(t)&&e){if(Blockly.blockRendering.Types.isHat(e))return this.constants_.NO_PADDING;if(Blockly.blockRendering.Types.isPreviousConnection(e))return e.notchOffset;if(Blockly.blockRendering.Types.isNextConnection(e))return e.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(Blockly.blockRendering.Types.isLeftRoundedCorner(t)&&e){if(Blockly.blockRendering.Types.isPreviousConnection(e))return e.notchOffset-this.constants_.CORNER_RADIUS;if(Blockly.blockRendering.Types.isNextConnection(e))return e.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return!Blockly.blockRendering.Types.isInput(t)&&e&&!Blockly.blockRendering.Types.isInput(e)&&t.isEditable==e.isEditable||e&&Blockly.blockRendering.Types.isJaggedEdge(e)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},Blockly.geras.RenderInfo.prototype.addAlignmentPadding_=function(t,e){var o=t.getFirstSpacer(),l=t.getLastSpacer();(t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=e),t.align==Blockly.ALIGN_LEFT?l.width+=e:t.align==Blockly.ALIGN_CENTRE?(o.width+=e/2,l.width+=e/2):t.align==Blockly.ALIGN_RIGHT?o.width+=e:l.width+=e,t.width+=e},Blockly.geras.RenderInfo.prototype.getSpacerRowHeight_=function(t,e){return Blockly.blockRendering.Types.isTopRow(t)&&Blockly.blockRendering.Types.isBottomRow(e)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:Blockly.blockRendering.Types.isTopRow(t)||Blockly.blockRendering.Types.isBottomRow(e)?this.constants_.NO_PADDING:t.hasExternalInput&&e.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&e.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&e.hasStatement||!t.hasStatement&&e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING},Blockly.geras.RenderInfo.prototype.getElemCenterline_=function(t,e){if(Blockly.blockRendering.Types.isSpacer(e))return t.yPos+e.height/2;if(Blockly.blockRendering.Types.isBottomRow(t)){var o=t.yPos+t.height-t.descenderHeight;return Blockly.blockRendering.Types.isNextConnection(e)?o+e.height/2:o-e.height/2}return Blockly.blockRendering.Types.isTopRow(t)?Blockly.blockRendering.Types.isHat(e)?t.capline-e.height/2:t.capline+e.height/2:(o=t.yPos,Blockly.blockRendering.Types.isField(e)||Blockly.blockRendering.Types.isIcon(e)?(o+=e.height/2,(t.hasInlineInput||t.hasStatement)&&e.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(o+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):o=Blockly.blockRendering.Types.isInlineInput(e)?o+e.height/2:o+t.height/2,o)},Blockly.geras.RenderInfo.prototype.finalize_=function(){for(var t,e=0,o=0,l=0;t=this.rows[l];l++){t.yPos=o,t.xPos=this.startX,o+=t.height,e=Math.max(e,t.widthWithConnectedBlocks);var i=o-this.topRow.ascenderHeight;t==this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(this.bottomRow.height+=i=this.constants_.MIN_BLOCK_HEIGHT-i,o+=i),this.recordElemPositions_(t)}this.bottomRow.baseline=o-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=o+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline},Blockly.geras.Drawer=function(t,e){Blockly.geras.Drawer.superClass_.constructor.call(this,t,e),this.highlighter_=new Blockly.geras.Highlighter(e)},Blockly.utils.object.inherits(Blockly.geras.Drawer,Blockly.blockRendering.Drawer),Blockly.geras.Drawer.prototype.draw=function(){this.hideHiddenIcons_(),this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPaths(this.outlinePath_+"\n"+this.inlinePath_,this.highlighter_.getPath()),this.info_.RTL&&this.block_.pathObject.flipRTL(),Blockly.blockRendering.useDebugger&&this.block_.renderingDebugger.drawDebug(this.block_,this.info_),this.recordSizeOnBlock_()},Blockly.geras.Drawer.prototype.drawTop_=function(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),Blockly.geras.Drawer.superClass_.drawTop_.call(this)},Blockly.geras.Drawer.prototype.drawJaggedEdge_=function(t){this.highlighter_.drawJaggedEdge_(t),Blockly.geras.Drawer.superClass_.drawJaggedEdge_.call(this,t)},Blockly.geras.Drawer.prototype.drawValueInput_=function(t){this.highlighter_.drawValueInput(t),Blockly.geras.Drawer.superClass_.drawValueInput_.call(this,t)},Blockly.geras.Drawer.prototype.drawStatementInput_=function(t){this.highlighter_.drawStatementInput(t),Blockly.geras.Drawer.superClass_.drawStatementInput_.call(this,t)},Blockly.geras.Drawer.prototype.drawRightSideRow_=function(t){this.highlighter_.drawRightSideRow(t),Blockly.geras.Drawer.superClass_.drawRightSideRow_.call(this,t)},Blockly.geras.Drawer.prototype.drawBottom_=function(){this.highlighter_.drawBottomRow(this.info_.bottomRow),Blockly.geras.Drawer.superClass_.drawBottom_.call(this)},Blockly.geras.Drawer.prototype.drawLeft_=function(){this.highlighter_.drawLeft(),Blockly.geras.Drawer.superClass_.drawLeft_.call(this)},Blockly.geras.Drawer.prototype.drawInlineInput_=function(t){this.highlighter_.drawInlineInput(t),Blockly.geras.Drawer.superClass_.drawInlineInput_.call(this,t)},Blockly.geras.Drawer.prototype.positionInlineInputConnection_=function(t){if(t.connection){var e=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(e*=-1),t.connection.setOffsetInBlock(e,t.centerline-t.height/2+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}},Blockly.geras.Drawer.prototype.positionStatementInputConnection_=function(t){var e=t.getLastInput();if(e.connection){var o=t.xPos+t.statementEdge+e.notchOffset;e.connection.setOffsetInBlock(o=this.info_.RTL?-1*o:o+this.constants_.DARK_PATH_OFFSET,t.yPos+this.constants_.DARK_PATH_OFFSET)}},Blockly.geras.Drawer.prototype.positionExternalValueConnection_=function(t){var e=t.getLastInput();if(e.connection){var o=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(o*=-1),e.connection.setOffsetInBlock(o,t.yPos)}},Blockly.geras.Drawer.prototype.positionNextConnection_=function(){var t=this.info_.bottomRow;if(t.connection){var e=(t=t.connection).xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-e:e)+this.constants_.DARK_PATH_OFFSET/2,t.centerline-t.height/2+this.constants_.DARK_PATH_OFFSET)}},Blockly.geras.HighlightConstantProvider=function(t){this.constantProvider=t,this.OFFSET=.5,this.START_POINT=Blockly.utils.svgPaths.moveBy(this.OFFSET,this.OFFSET),this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()},Blockly.geras.HighlightConstantProvider.prototype.makeInsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,o=(1-Math.SQRT1_2)*(t+e)-e,l=Blockly.utils.svgPaths.moveBy(o,o)+Blockly.utils.svgPaths.arc("a","0 0,0",t,Blockly.utils.svgPaths.point(-o-e,t-o)),i=Blockly.utils.svgPaths.arc("a","0 0,0",t+e,Blockly.utils.svgPaths.point(t+e,t+e)),n=Blockly.utils.svgPaths.moveBy(o,-o)+Blockly.utils.svgPaths.arc("a","0 0,0",t+e,Blockly.utils.svgPaths.point(t-o,o+e));return{width:t+e,height:t,pathTop:function(t){return t?l:""},pathBottom:function(t){return t?i:n}}},Blockly.geras.HighlightConstantProvider.prototype.makeOutsideCorner=function(){var t=this.constantProvider.CORNER_RADIUS,e=this.OFFSET,o=(1-Math.SQRT1_2)*(t-e)+e,l=Blockly.utils.svgPaths.moveBy(o,o)+Blockly.utils.svgPaths.arc("a","0 0,1",t-e,Blockly.utils.svgPaths.point(t-o,-o+e)),i=Blockly.utils.svgPaths.moveBy(e,t)+Blockly.utils.svgPaths.arc("a","0 0,1",t-e,Blockly.utils.svgPaths.point(t,-t+e)),n=-o,r=Blockly.utils.svgPaths.moveBy(o,n)+Blockly.utils.svgPaths.arc("a","0 0,1",t-e,Blockly.utils.svgPaths.point(-o+e,-n-t));return{height:t,topLeft:function(t){return t?l:i},bottomLeft:function(){return r}}},Blockly.geras.HighlightConstantProvider.prototype.makePuzzleTab=function(){var t=this.constantProvider.TAB_WIDTH,e=this.constantProvider.TAB_HEIGHT,o=Blockly.utils.svgPaths.moveBy(-2,3.4-e)+Blockly.utils.svgPaths.lineTo(-.45*t,-2.1),l=Blockly.utils.svgPaths.lineOnAxis("v",2.5)+Blockly.utils.svgPaths.moveBy(.97*-t,2.5)+Blockly.utils.svgPaths.curve("q",[Blockly.utils.svgPaths.point(.05*-t,10),Blockly.utils.svgPaths.point(.3*t,9.5)])+Blockly.utils.svgPaths.moveBy(.67*t,-1.9)+Blockly.utils.svgPaths.lineOnAxis("v",2.5),i=Blockly.utils.svgPaths.lineOnAxis("v",-1.5)+Blockly.utils.svgPaths.moveBy(-.92*t,-.5)+Blockly.utils.svgPaths.curve("q",[Blockly.utils.svgPaths.point(-.19*t,-5.5),Blockly.utils.svgPaths.point(0,-11)])+Blockly.utils.svgPaths.moveBy(.92*t,1),n=Blockly.utils.svgPaths.moveBy(-5,e-.7)+Blockly.utils.svgPaths.lineTo(.46*t,-2.1);return{width:t,height:e,pathUp:function(t){return t?o:i},pathDown:function(t){return t?l:n}}},Blockly.geras.HighlightConstantProvider.prototype.makeNotch=function(){return{pathLeft:Blockly.utils.svgPaths.lineOnAxis("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}},Blockly.geras.HighlightConstantProvider.prototype.makeJaggedTeeth=function(){return{pathLeft:Blockly.utils.svgPaths.lineTo(5.1,2.6)+Blockly.utils.svgPaths.moveBy(-10.2,6.8)+Blockly.utils.svgPaths.lineTo(5.1,2.6)}},Blockly.geras.HighlightConstantProvider.prototype.makeStartHat=function(){var t=this.constantProvider.START_HAT.height,e=Blockly.utils.svgPaths.moveBy(25,-8.7)+Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(29.7,-6.2),Blockly.utils.svgPaths.point(57.2,-.5),Blockly.utils.svgPaths.point(75,8.7)]),o=Blockly.utils.svgPaths.curve("c",[Blockly.utils.svgPaths.point(17.8,-9.2),Blockly.utils.svgPaths.point(45.3,-14.9),Blockly.utils.svgPaths.point(75,-8.7)])+Blockly.utils.svgPaths.moveTo(100.5,t+.5);return{path:function(t){return t?e:o}}},Blockly.geras.Renderer=function(){Blockly.geras.Renderer.superClass_.constructor.call(this),this.highlightConstants_=null},Blockly.utils.object.inherits(Blockly.geras.Renderer,Blockly.blockRendering.Renderer),Blockly.geras.Renderer.prototype.init=function(){Blockly.geras.Renderer.superClass_.init.call(this),this.highlightConstants_=this.makeHighlightConstants_()},Blockly.geras.Renderer.prototype.makeConstants_=function(){return new Blockly.geras.ConstantProvider},Blockly.geras.Renderer.prototype.makeRenderInfo_=function(t){return new Blockly.geras.RenderInfo(this,t)},Blockly.geras.Renderer.prototype.makeDrawer_=function(t,e){return new Blockly.geras.Drawer(t,e)},Blockly.geras.Renderer.prototype.makePathObject=function(t){return new Blockly.geras.PathObject(t)},Blockly.blockRendering.Renderer.prototype.makeHighlightConstants_=function(){return new Blockly.geras.HighlightConstantProvider(this.getConstants())},Blockly.geras.Renderer.prototype.getHighlightConstants=function(){return this.highlightConstants_},Blockly.blockRendering.register("geras",Blockly.geras.Renderer),Blockly.Toolbox=function(t){this.workspace_=t,this.RTL=t.options.RTL,this.horizontalLayout_=t.options.horizontalLayout,this.toolboxPosition=t.options.toolboxPosition,this.config_={indentWidth:19,cssRoot:"blocklyTreeRoot",cssHideRoot:"blocklyHidden",cssTreeRow:"blocklyTreeRow",cssItemLabel:"blocklyTreeLabel",cssTreeIcon:"blocklyTreeIcon",cssExpandedFolderIcon:"blocklyTreeIconOpen",cssFileIcon:"blocklyTreeIconNone",cssSelectedRow:"blocklyTreeSelected"},this.treeSeparatorConfig_={cssTreeRow:"blocklyTreeSeparator"},this.horizontalLayout_&&(this.config_.cssTreeRow+=t.RTL?" blocklyHorizontalTreeRtl":" blocklyHorizontalTree",this.treeSeparatorConfig_.cssTreeRow="blocklyTreeSeparatorHorizontal "+(t.RTL?"blocklyHorizontalTreeRtl":"blocklyHorizontalTree"),this.config_.cssTreeIcon="")},Blockly.Toolbox.prototype.width=0,Blockly.Toolbox.prototype.height=0,Blockly.Toolbox.prototype.selectedOption_=null,Blockly.Toolbox.prototype.lastCategory_=null,Blockly.Toolbox.prototype.init=function(){var t=this.workspace_,e=this.workspace_.getParentSvg();if(this.HtmlDiv=document.createElement("div"),this.HtmlDiv.className="blocklyToolboxDiv blocklyNonSelectable",this.HtmlDiv.setAttribute("dir",t.RTL?"RTL":"LTR"),e.parentNode.insertBefore(this.HtmlDiv,e),(e=t.getThemeManager()).subscribe(this.HtmlDiv,"toolbox","background-color"),e.subscribe(this.HtmlDiv,"toolboxText","color"),Blockly.bindEventWithChecks_(this.HtmlDiv,"mousedown",this,(function(t){Blockly.utils.isRightButton(t)||t.target==this.HtmlDiv?Blockly.hideChaff(!1):Blockly.hideChaff(!0),Blockly.Touch.clearTouchIdentifier()}),!1,!0),e={disabledPatternId:t.options.disabledPatternId,parentWorkspace:t,RTL:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,toolboxPosition:t.options.toolboxPosition,renderer:t.options.renderer},this.flyout_=null,t.horizontalLayout){if(!Blockly.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout_=new Blockly.HorizontalFlyout(e)}else{if(!Blockly.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout_=new Blockly.VerticalFlyout(e)}Blockly.utils.dom.insertAfter(this.flyout_.createDom("svg"),this.workspace_.getParentSvg()),this.flyout_.init(t),this.config_.cleardotPath=t.options.pathToMedia+"1x1.gif",this.config_.cssCollapsedFolderIcon="blocklyTreeIconClosed"+(t.RTL?"Rtl":"Ltr"),this.renderTree(t.options.languageTree)},Blockly.Toolbox.prototype.renderTree=function(t){this.tree_&&(this.tree_.dispose(),this.lastCategory_=null);var e=new Blockly.tree.TreeControl(this,this.config_);this.tree_=e,e.setSelectedItem(null),e.onBeforeSelected(this.handleBeforeTreeSelected_),e.onAfterSelected(this.handleAfterTreeSelected_);var o=null;if(t){if(this.tree_.blocks=[],this.hasColours_=!1,o=this.syncTrees_(t,this.tree_,this.workspace_.options.pathToMedia),this.tree_.blocks.length)throw Error("Toolbox cannot have both blocks and categories in the root level.");this.workspace_.resizeContents()}e.render(this.HtmlDiv),o&&e.setSelectedItem(o),this.addColour_(),this.position(),this.horizontalLayout_&&Blockly.utils.aria.setState(this.tree_.getElement(),Blockly.utils.aria.State.ORIENTATION,"horizontal")},Blockly.Toolbox.prototype.handleBeforeTreeSelected_=function(t){if(t==this.tree_)return!1;if(this.lastCategory_&&(this.lastCategory_.getRowElement().style.backgroundColor=""),t){var e=t.hexColour||"#57e";t.getRowElement().style.backgroundColor=e,this.addColour_(t)}return!0},Blockly.Toolbox.prototype.handleAfterTreeSelected_=function(t,e){if(e&&e.blocks&&e.blocks.length?(this.flyout_.show(e.blocks),this.lastCategory_!=e&&this.flyout_.scrollToStart(),Blockly.keyboardAccessibilityMode&&Blockly.navigation.setState(Blockly.navigation.STATE_TOOLBOX)):(this.flyout_.hide(),!Blockly.keyboardAccessibilityMode||e instanceof Blockly.Toolbox.TreeSeparator||Blockly.navigation.setState(Blockly.navigation.STATE_WS)),t!=e&&t!=this){var o=new Blockly.Events.Ui(null,"category",t&&t.getText(),e&&e.getText());o.workspaceId=this.workspace_.id,Blockly.Events.fire(o)}e&&(this.lastCategory_=e)},Blockly.Toolbox.prototype.handleNodeSizeChanged_=function(){Blockly.svgResize(this.workspace_)},Blockly.Toolbox.prototype.onBlocklyAction=function(t){var e=this.tree_.getSelectedItem();if(!e)return!1;switch(t.name){case Blockly.navigation.actionNames.PREVIOUS:return e.selectPrevious();case Blockly.navigation.actionNames.OUT:return e.selectParent();case Blockly.navigation.actionNames.NEXT:return e.selectNext();case Blockly.navigation.actionNames.IN:return e.selectChild();default:return!1}},Blockly.Toolbox.prototype.dispose=function(){this.flyout_.dispose(),this.tree_.dispose(),this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),Blockly.utils.dom.removeNode(this.HtmlDiv),this.lastCategory_=this.workspace_=null},Blockly.Toolbox.prototype.getWidth=function(){return this.width},Blockly.Toolbox.prototype.getHeight=function(){return this.height},Blockly.Toolbox.prototype.position=function(){var t=this.HtmlDiv;if(t){var e=this.workspace_.getParentSvg();e=Blockly.svgSize(e),this.horizontalLayout_?(t.style.left="0",t.style.height="auto",t.style.width=e.width+"px",this.height=t.offsetHeight,this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?t.style.right="0":t.style.left="0",t.style.height=e.height+"px",this.width=t.offsetWidth),this.flyout_.position()}},Blockly.Toolbox.prototype.syncTrees_=function(t,e,o){for(var l,i=null,n=null,r=0;l=t.childNodes[r];r++)if(l.tagName)switch(l.tagName.toUpperCase()){case"CATEGORY":n=Blockly.utils.replaceMessageReferences(l.getAttribute("name"));var s=this.tree_.createNode(n);s.onSizeChanged(this.handleNodeSizeChanged_),s.blocks=[],e.add(s);var c=l.getAttribute("custom");c?s.blocks=c:(c=this.syncTrees_(l,s,o))&&(i=c),c=l.getAttribute("categorystyle");var a=l.getAttribute("colour");a&&c?(s.hexColour="",console.warn('Toolbox category "'+n+'" can not have both a style and a colour')):c?this.setColourFromStyle_(c,s,n):this.setColour_(a,s,n),"true"==l.getAttribute("expanded")?(s.blocks.length&&(i=s),s.setExpanded(!0)):s.setExpanded(!1),n=l;break;case"SEP":if(n&&"CATEGORY"==n.tagName.toUpperCase()){e.add(new Blockly.Toolbox.TreeSeparator(this.treeSeparatorConfig_));break}case"BLOCK":case"SHADOW":case"LABEL":case"BUTTON":e.blocks.push(l),n=l}return i},Blockly.Toolbox.prototype.setColour_=function(t,e,o){if(null===(t=Blockly.utils.replaceMessageReferences(t))||""===t)e.hexColour="";else{var l=Number(t);isNaN(l)?(l=Blockly.utils.colour.parse(t))?(e.hexColour=l,this.hasColours_=!0):(e.hexColour="",console.warn('Toolbox category "'+o+'" has unrecognized colour attribute: '+t)):(e.hexColour=Blockly.hueToHex(l),this.hasColours_=!0)}},Blockly.Toolbox.prototype.setColourFromStyle_=function(t,e,o){e.styleName=t;var l=this.workspace_.getTheme();t&&l&&((l=l.getCategoryStyle(t))&&l.colour?this.setColour_(l.colour,e,o):console.warn('Style "'+t+'" must exist and contain a colour value'))},Blockly.Toolbox.prototype.updateColourFromTheme_=function(t){if(t=t||this.tree_){t=t.getChildren(!1);for(var e,o=0;e=t[o];o++)e.styleName&&(this.setColourFromStyle_(e.styleName,e,""),this.addColour_()),this.updateColourFromTheme_(e)}},Blockly.Toolbox.prototype.updateColourFromTheme=function(){var t=this.tree_;t&&(this.updateColourFromTheme_(t),this.updateSelectedItemColour_(t))},Blockly.Toolbox.prototype.updateSelectedItemColour_=function(t){if(t=t.getSelectedItem()){var e=t.hexColour||"#57e";t.getRowElement().style.backgroundColor=e,this.addColour_(t)}},Blockly.Toolbox.prototype.addColour_=function(t){t=(t||this.tree_).getChildren(!1);for(var e,o=0;e=t[o];o++){var l=e.getRowElement();if(l){var i=this.hasColours_?"8px solid "+(e.hexColour||"#ddd"):"none";this.workspace_.RTL?l.style.borderRight=i:l.style.borderLeft=i}this.addColour_(e)}},Blockly.Toolbox.prototype.clearSelection=function(){this.tree_.setSelectedItem(null)},Blockly.Toolbox.prototype.addStyle=function(t){Blockly.utils.dom.addClass(this.HtmlDiv,t)},Blockly.Toolbox.prototype.removeStyle=function(t){Blockly.utils.dom.removeClass(this.HtmlDiv,t)},Blockly.Toolbox.prototype.getClientRect=function(){if(!this.HtmlDiv)return null;var t=this.HtmlDiv.getBoundingClientRect(),e=t.top,o=e+t.height,l=t.left;return t=l+t.width,this.toolboxPosition==Blockly.TOOLBOX_AT_TOP?new Blockly.utils.Rect(-1e7,o,-1e7,1e7):this.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?new Blockly.utils.Rect(e,1e7,-1e7,1e7):this.toolboxPosition==Blockly.TOOLBOX_AT_LEFT?new Blockly.utils.Rect(-1e7,1e7,-1e7,t):new Blockly.utils.Rect(-1e7,1e7,l,1e7)},Blockly.Toolbox.prototype.refreshSelection=function(){var t=this.tree_.getSelectedItem();t&&t.blocks&&this.flyout_.show(t.blocks)},Blockly.Toolbox.prototype.selectFirstCategory=function(){this.tree_.getSelectedItem()||this.tree_.selectFirst()},Blockly.Toolbox.TreeSeparator=function(t){Blockly.tree.TreeNode.call(this,null,"",t)},Blockly.utils.object.inherits(Blockly.Toolbox.TreeSeparator,Blockly.tree.TreeNode),Blockly.Css.register([".blocklyToolboxDelete {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyToolboxGrab {",'cursor: url("<<<PATH>>>/handclosed.cur"), auto;',"cursor: grabbing;","cursor: -webkit-grabbing;","}",".blocklyToolboxDiv {","background-color: #ddd;","overflow-x: visible;","overflow-y: auto;","position: absolute;","z-index: 70;","-webkit-tap-highlight-color: transparent;","}",".blocklyTreeRoot {","padding: 4px 0;","}",".blocklyTreeRoot:focus {","outline: none;","}",".blocklyTreeRow {","height: 22px;","line-height: 22px;","margin-bottom: 3px;","padding-right: 8px;","white-space: nowrap;","}",".blocklyHorizontalTree {","float: left;","margin: 1px 5px 8px 0;","}",".blocklyHorizontalTreeRtl {","float: right;","margin: 1px 0 8px 5px;","}",'.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {',"margin-left: 8px;","}",".blocklyTreeRow:not(.blocklyTreeSelected):hover {","background-color: #e4e4e4;","}",".blocklyTreeSeparator {","border-bottom: solid #e5e5e5 1px;","height: 0;","margin: 5px 0;","}",".blocklyTreeSeparatorHorizontal {","border-right: solid #e5e5e5 1px;","width: 0;","padding: 5px 0;","margin: 0 5px;","}",".blocklyTreeIcon {","background-image: url(<<<PATH>>>/sprites.png);","height: 16px;","vertical-align: middle;","width: 16px;","}",".blocklyTreeIconClosedLtr {","background-position: -32px -1px;","}",".blocklyTreeIconClosedRtl {","background-position: 0 -1px;","}",".blocklyTreeIconOpen {","background-position: -16px -1px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedLtr {","background-position: -32px -17px;","}",".blocklyTreeSelected>.blocklyTreeIconClosedRtl {","background-position: 0 -17px;","}",".blocklyTreeSelected>.blocklyTreeIconOpen {","background-position: -16px -17px;","}",".blocklyTreeIconNone,",".blocklyTreeSelected>.blocklyTreeIconNone {","background-position: -48px -1px;","}",".blocklyTreeLabel {","cursor: default;","font-family: sans-serif;","font-size: 16px;","padding: 0 3px;","vertical-align: middle;","}",".blocklyToolboxDelete .blocklyTreeLabel {",'cursor: url("<<<PATH>>>/handdelete.cur"), auto;',"}",".blocklyTreeSelected .blocklyTreeLabel {","color: #fff;","}"]),Blockly.Trashcan=function(t){if(this.workspace_=t,this.contents_=[],!(0>=this.workspace_.options.maxTrashcanContents)){if(t={scrollbars:!0,disabledPatternId:this.workspace_.options.disabledPatternId,parentWorkspace:this.workspace_,RTL:this.workspace_.RTL,oneBasedIndex:this.workspace_.options.oneBasedIndex,renderer:this.workspace_.options.renderer},this.workspace_.horizontalLayout){if(t.toolboxPosition=this.workspace_.toolboxPosition==Blockly.TOOLBOX_AT_TOP?Blockly.TOOLBOX_AT_BOTTOM:Blockly.TOOLBOX_AT_TOP,!Blockly.HorizontalFlyout)throw Error("Missing require for Blockly.HorizontalFlyout");this.flyout_=new Blockly.HorizontalFlyout(t)}else{if(t.toolboxPosition=this.workspace_.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT?Blockly.TOOLBOX_AT_LEFT:Blockly.TOOLBOX_AT_RIGHT,!Blockly.VerticalFlyout)throw Error("Missing require for Blockly.VerticalFlyout");this.flyout_=new Blockly.VerticalFlyout(t)}this.workspace_.addChangeListener(this.onDelete_.bind(this))}},Blockly.Trashcan.prototype.WIDTH_=47,Blockly.Trashcan.prototype.BODY_HEIGHT_=44,Blockly.Trashcan.prototype.LID_HEIGHT_=16,Blockly.Trashcan.prototype.MARGIN_BOTTOM_=20,Blockly.Trashcan.prototype.MARGIN_SIDE_=20,Blockly.Trashcan.prototype.MARGIN_HOTSPOT_=10,Blockly.Trashcan.prototype.SPRITE_LEFT_=0,Blockly.Trashcan.prototype.SPRITE_TOP_=32,Blockly.Trashcan.prototype.HAS_BLOCKS_LID_ANGLE=.1,Blockly.Trashcan.prototype.isOpen=!1,Blockly.Trashcan.prototype.minOpenness_=0,Blockly.Trashcan.prototype.svgGroup_=null,Blockly.Trashcan.prototype.svgLid_=null,Blockly.Trashcan.prototype.lidTask_=0,Blockly.Trashcan.prototype.lidOpen_=0,Blockly.Trashcan.prototype.left_=0,Blockly.Trashcan.prototype.top_=0,Blockly.Trashcan.prototype.createDom=function(){this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyTrash"},null);var t=String(Math.random()).substring(2),e=Blockly.utils.dom.createSvgElement("clipPath",{id:"blocklyTrashBodyClipPath"+t},this.svgGroup_);Blockly.utils.dom.createSvgElement("rect",{width:this.WIDTH_,height:this.BODY_HEIGHT_,y:this.LID_HEIGHT_},e);var o=Blockly.utils.dom.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup_);return o.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url),e=Blockly.utils.dom.createSvgElement("clipPath",{id:"blocklyTrashLidClipPath"+t},this.svgGroup_),Blockly.utils.dom.createSvgElement("rect",{width:this.WIDTH_,height:this.LID_HEIGHT_},e),this.svgLid_=Blockly.utils.dom.createSvgElement("image",{width:Blockly.SPRITE.width,x:-this.SPRITE_LEFT_,height:Blockly.SPRITE.height,y:-this.SPRITE_TOP_,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup_),this.svgLid_.setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",this.workspace_.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(this.svgGroup_,"mouseup",this,this.click),Blockly.bindEvent_(o,"mouseover",this,this.mouseOver_),Blockly.bindEvent_(o,"mouseout",this,this.mouseOut_),this.animateLid_(),this.svgGroup_},Blockly.Trashcan.prototype.init=function(t){return 0<this.workspace_.options.maxTrashcanContents&&(Blockly.utils.dom.insertAfter(this.flyout_.createDom("svg"),this.workspace_.getParentSvg()),this.flyout_.init(this.workspace_),this.flyout_.isBlockCreatable_=function(){return!0}),this.verticalSpacing_=this.MARGIN_BOTTOM_+t,this.setOpen_(!1),this.verticalSpacing_+this.BODY_HEIGHT_+this.LID_HEIGHT_},Blockly.Trashcan.prototype.dispose=function(){this.svgGroup_&&(Blockly.utils.dom.removeNode(this.svgGroup_),this.svgGroup_=null),this.workspace_=this.svgLid_=null,clearTimeout(this.lidTask_)},Blockly.Trashcan.prototype.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=t.toolboxPosition==Blockly.TOOLBOX_AT_LEFT||this.workspace_.horizontalLayout&&!this.workspace_.RTL?t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness:this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,this.top_=t.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?this.verticalSpacing_:t.viewHeight+t.absoluteTop-(this.BODY_HEIGHT_+this.LID_HEIGHT_)-this.verticalSpacing_,this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},Blockly.Trashcan.prototype.getClientRect=function(){if(!this.svgGroup_)return null;var t=this.svgGroup_.getBoundingClientRect(),e=t.top+this.SPRITE_TOP_-this.MARGIN_HOTSPOT_;return new Blockly.utils.Rect(e,e+this.LID_HEIGHT_+this.BODY_HEIGHT_+2*this.MARGIN_HOTSPOT_,t=t.left+this.SPRITE_LEFT_-this.MARGIN_HOTSPOT_,t+this.WIDTH_+2*this.MARGIN_HOTSPOT_)},Blockly.Trashcan.prototype.setOpen_=function(t){this.isOpen!=t&&(clearTimeout(this.lidTask_),this.isOpen=t,this.animateLid_())},Blockly.Trashcan.prototype.animateLid_=function(){this.lidOpen_+=this.isOpen?.2:-.2,this.lidOpen_=Math.min(Math.max(this.lidOpen_,this.minOpenness_),1),this.setLidAngle_(45*this.lidOpen_),this.svgGroup_.style.opacity=.4+.4*this.lidOpen_,this.lidOpen_>this.minOpenness_&&1>this.lidOpen_&&(this.lidTask_=setTimeout(this.animateLid_.bind(this),20))},Blockly.Trashcan.prototype.setLidAngle_=function(t){var e=this.workspace_.toolboxPosition==Blockly.TOOLBOX_AT_RIGHT||this.workspace_.horizontalLayout&&this.workspace_.RTL;this.svgLid_.setAttribute("transform","rotate("+(e?-t:t)+","+(e?4:this.WIDTH_-4)+","+(this.LID_HEIGHT_-2)+")")},Blockly.Trashcan.prototype.close=function(){this.setOpen_(!1)},Blockly.Trashcan.prototype.click=function(){if(this.contents_.length){for(var t,e=[],o=0;t=this.contents_[o];o++)e[o]=Blockly.Xml.textToDom(t);this.flyout_.show(e)}},Blockly.Trashcan.prototype.mouseOver_=function(){this.contents_.length&&this.setOpen_(!0)},Blockly.Trashcan.prototype.mouseOut_=function(){this.setOpen_(!1)},Blockly.Trashcan.prototype.onDelete_=function(t){if(!(0>=this.workspace_.options.maxTrashcanContents)&&t.type==Blockly.Events.BLOCK_DELETE&&"shadow"!=t.oldXml.tagName.toLowerCase()&&(t=this.cleanBlockXML_(t.oldXml),-1==this.contents_.indexOf(t))){for(this.contents_.unshift(t);this.contents_.length>this.workspace_.options.maxTrashcanContents;)this.contents_.pop();this.minOpenness_=this.HAS_BLOCKS_LID_ANGLE,this.setLidAngle_(45*this.minOpenness_)}},Blockly.Trashcan.prototype.cleanBlockXML_=function(t){for(var e=t=t.cloneNode(!0);e;){e.removeAttribute&&(e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("id"));var o=e.firstChild||e.nextSibling;if(!o)for(o=e.parentNode;o;){if(o.nextSibling){o=o.nextSibling;break}o=o.parentNode}e=o}return Blockly.Xml.domToText(t)},Blockly.VariablesDynamic={},Blockly.VariablesDynamic.onCreateVariableButtonClick_String=function(t){Blockly.Variables.createVariableButtonHandler(t.getTargetWorkspace(),null,"String")},Blockly.VariablesDynamic.onCreateVariableButtonClick_Number=function(t){Blockly.Variables.createVariableButtonHandler(t.getTargetWorkspace(),null,"Number")},Blockly.VariablesDynamic.onCreateVariableButtonClick_Colour=function(t){Blockly.Variables.createVariableButtonHandler(t.getTargetWorkspace(),null,"Colour")},Blockly.VariablesDynamic.flyoutCategory=function(t){var e=[],o=document.createElement("button");return o.setAttribute("text",Blockly.Msg.NEW_STRING_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),e.push(o),(o=document.createElement("button")).setAttribute("text",Blockly.Msg.NEW_NUMBER_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),e.push(o),(o=document.createElement("button")).setAttribute("text",Blockly.Msg.NEW_COLOUR_VARIABLE),o.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),e.push(o),t.registerButtonCallback("CREATE_VARIABLE_STRING",Blockly.VariablesDynamic.onCreateVariableButtonClick_String),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",Blockly.VariablesDynamic.onCreateVariableButtonClick_Number),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",Blockly.VariablesDynamic.onCreateVariableButtonClick_Colour),t=Blockly.VariablesDynamic.flyoutCategoryBlocks(t),e.concat(t)},Blockly.VariablesDynamic.flyoutCategoryBlocks=function(t){var e=[];if(0<(t=t.getAllVariables()).length){if(Blockly.Blocks.variables_set_dynamic){var o=t[t.length-1],l=Blockly.utils.xml.createElement("block");l.setAttribute("type","variables_set_dynamic"),l.setAttribute("gap",24),l.appendChild(Blockly.Variables.generateVariableFieldDom(o)),e.push(l)}if(Blockly.Blocks.variables_get_dynamic){t.sort(Blockly.VariableModel.compareByName),o=0;for(var i;i=t[o];o++)(l=Blockly.utils.xml.createElement("block")).setAttribute("type","variables_get_dynamic"),l.setAttribute("gap",8),l.appendChild(Blockly.Variables.generateVariableFieldDom(i)),e.push(l)}}return e},Blockly.ZoomControls=function(t){this.workspace_=t},Blockly.ZoomControls.prototype.WIDTH_=32,Blockly.ZoomControls.prototype.HEIGHT_=110,Blockly.ZoomControls.prototype.MARGIN_BOTTOM_=20,Blockly.ZoomControls.prototype.MARGIN_SIDE_=20,Blockly.ZoomControls.prototype.svgGroup_=null,Blockly.ZoomControls.prototype.left_=0,Blockly.ZoomControls.prototype.top_=0,Blockly.ZoomControls.prototype.createDom=function(){this.svgGroup_=Blockly.utils.dom.createSvgElement("g",{},null);var t=String(Math.random()).substring(2);return this.createZoomOutSvg_(t),this.createZoomInSvg_(t),this.workspace_.isMovable()&&this.createZoomResetSvg_(t),this.svgGroup_},Blockly.ZoomControls.prototype.init=function(t){return this.verticalSpacing_=this.MARGIN_BOTTOM_+t,this.verticalSpacing_+this.HEIGHT_},Blockly.ZoomControls.prototype.dispose=function(){this.svgGroup_&&Blockly.utils.dom.removeNode(this.svgGroup_)},Blockly.ZoomControls.prototype.position=function(){if(this.verticalSpacing_){var t=this.workspace_.getMetrics();t&&(this.left_=t.toolboxPosition==Blockly.TOOLBOX_AT_LEFT||this.workspace_.horizontalLayout&&!this.workspace_.RTL?t.viewWidth+t.absoluteLeft-this.WIDTH_-this.MARGIN_SIDE_-Blockly.Scrollbar.scrollbarThickness:this.MARGIN_SIDE_+Blockly.Scrollbar.scrollbarThickness,t.toolboxPosition==Blockly.TOOLBOX_AT_BOTTOM?(this.top_=this.verticalSpacing_,this.zoomInGroup_.setAttribute("transform","translate(0, 34)"),this.zoomResetGroup_&&this.zoomResetGroup_.setAttribute("transform","translate(0, 77)")):(this.top_=t.viewHeight+t.absoluteTop-this.HEIGHT_-this.verticalSpacing_,this.zoomInGroup_.setAttribute("transform","translate(0, 43)"),this.zoomOutGroup_.setAttribute("transform","translate(0, 77)")),this.svgGroup_.setAttribute("transform","translate("+this.left_+","+this.top_+")"))}},Blockly.ZoomControls.prototype.createZoomOutSvg_=function(t){var e=this.workspace_;this.zoomOutGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyZoom"},this.svgGroup_);var o=Blockly.utils.dom.createSvgElement("clipPath",{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup_);Blockly.utils.dom.createSvgElement("rect",{width:32,height:32},o),(t=Blockly.utils.dom.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup_)).setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",e.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(t,"mousedown",null,(function(t){e.markFocused(),e.zoomCenter(-1),Blockly.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()}))},Blockly.ZoomControls.prototype.createZoomInSvg_=function(t){var e=this.workspace_;this.zoomInGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyZoom"},this.svgGroup_);var o=Blockly.utils.dom.createSvgElement("clipPath",{id:"blocklyZoominClipPath"+t},this.zoomInGroup_);Blockly.utils.dom.createSvgElement("rect",{width:32,height:32},o),(t=Blockly.utils.dom.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup_)).setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",e.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(t,"mousedown",null,(function(t){e.markFocused(),e.zoomCenter(1),Blockly.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()}))},Blockly.ZoomControls.prototype.createZoomResetSvg_=function(t){var e=this.workspace_;this.zoomResetGroup_=Blockly.utils.dom.createSvgElement("g",{class:"blocklyZoom"},this.svgGroup_);var o=Blockly.utils.dom.createSvgElement("clipPath",{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup_);Blockly.utils.dom.createSvgElement("rect",{width:32,height:32},o),(t=Blockly.utils.dom.createSvgElement("image",{width:Blockly.SPRITE.width,height:Blockly.SPRITE.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup_)).setAttributeNS(Blockly.utils.dom.XLINK_NS,"xlink:href",e.options.pathToMedia+Blockly.SPRITE.url),Blockly.bindEventWithChecks_(t,"mousedown",null,(function(t){e.markFocused(),e.setScale(e.options.zoomOptions.startScale),e.beginCanvasTransition(),e.scrollCenter(),setTimeout(e.endCanvasTransition.bind(e),500),Blockly.Touch.clearTouchIdentifier(),t.stopPropagation(),t.preventDefault()}))},Blockly.Css.register([".blocklyZoom>image, .blocklyZoom>svg>image {","opacity: .4;","}",".blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {","opacity: .6;","}",".blocklyZoom>image:active, .blocklyZoom>svg>image:active {","opacity: .8;","}"]),Blockly.Themes.Dark={},Blockly.Themes.Dark.defaultBlockStyles={colour_blocks:{colourPrimary:"#a5745b",colourSecondary:"#dbc7bd",colourTertiary:"#845d49"},list_blocks:{colourPrimary:"#745ba5",colourSecondary:"#c7bddb",colourTertiary:"#5d4984"},logic_blocks:{colourPrimary:"#5b80a5",colourSecondary:"#bdccdb",colourTertiary:"#496684"},loop_blocks:{colourPrimary:"#5ba55b",colourSecondary:"#bddbbd",colourTertiary:"#498449"},math_blocks:{colourPrimary:"#5b67a5",colourSecondary:"#bdc2db",colourTertiary:"#495284"},procedure_blocks:{colourPrimary:"#995ba5",colourSecondary:"#d6bddb",colourTertiary:"#7a4984"},text_blocks:{colourPrimary:"#5ba58c",colourSecondary:"#bddbd1",colourTertiary:"#498470"},variable_blocks:{colourPrimary:"#a55b99",colourSecondary:"#dbbdd6",colourTertiary:"#84497a"},variable_dynamic_blocks:{colourPrimary:"#a55b99",colourSecondary:"#dbbdd6",colourTertiary:"#84497a"},hat_blocks:{colourPrimary:"#a55b99",colourSecondary:"#dbbdd6",colourTertiary:"#84497a",hat:"cap"}},Blockly.Themes.Dark.categoryStyles={colour_category:{colour:"#a5745b"},list_category:{colour:"#745ba5"},logic_category:{colour:"#5b80a5"},loop_category:{colour:"#5ba55b"},math_category:{colour:"#5b67a5"},procedure_category:{colour:"#995ba5"},text_category:{colour:"#5ba58c"},variable_category:{colour:"#a55b99"},variable_dynamic_category:{colour:"#a55b99"}},Blockly.Themes.Dark=new Blockly.Theme(Blockly.Themes.Dark.defaultBlockStyles,Blockly.Themes.Dark.categoryStyles),Blockly.Themes.Dark.setComponentStyle("workspace","#1e1e1e"),Blockly.Themes.Dark.setComponentStyle("toolbox","#333"),Blockly.Themes.Dark.setComponentStyle("toolboxText","#fff"),Blockly.Themes.Dark.setComponentStyle("flyout","#252526"),Blockly.Themes.Dark.setComponentStyle("flyoutText","#ccc"),Blockly.Themes.Dark.setComponentStyle("flyoutOpacity",1),Blockly.Themes.Dark.setComponentStyle("scrollbar","#797979"),Blockly.Themes.Dark.setComponentStyle("scrollbarOpacity",.4),Blockly.Themes.HighContrast={},Blockly.Themes.HighContrast.defaultBlockStyles={colour_blocks:{colourPrimary:"#a52714",colourSecondary:"#FB9B8C",colourTertiary:"#FBE1DD"},list_blocks:{colourPrimary:"#4a148c",colourSecondary:"#AD7BE9",colourTertiary:"#CDB6E9"},logic_blocks:{colourPrimary:"#01579b",colourSecondary:"#64C7FF",colourTertiary:"#C5EAFF"},loop_blocks:{colourPrimary:"#33691e",colourSecondary:"#9AFF78",colourTertiary:"#E1FFD7"},math_blocks:{colourPrimary:"#1a237e",colourSecondary:"#8A9EFF",colourTertiary:"#DCE2FF"},procedure_blocks:{colourPrimary:"#006064",colourSecondary:"#77E6EE",colourTertiary:"#CFECEE"},text_blocks:{colourPrimary:"#004d40",colourSecondary:"#5ae27c",colourTertiary:"#D2FFDD"},variable_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},variable_dynamic_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB"},hat_blocks:{colourPrimary:"#880e4f",colourSecondary:"#FF73BE",colourTertiary:"#FFD4EB",hat:"cap"}},Blockly.Themes.HighContrast.categoryStyles={colour_category:{colour:"#a52714"},list_category:{colour:"#4a148c"},logic_category:{colour:"#01579b"},loop_category:{colour:"#33691e"},math_category:{colour:"#1a237e"},procedure_category:{colour:"#006064"},text_category:{colour:"#004d40"},variable_category:{colour:"#880e4f"},variable_dynamic_category:{colour:"#880e4f"}},Blockly.Themes.HighContrast=new Blockly.Theme(Blockly.Themes.HighContrast.defaultBlockStyles,Blockly.Themes.HighContrast.categoryStyles),Blockly.Themes.Modern={},Blockly.Themes.Modern.defaultBlockStyles={colour_blocks:{colourPrimary:"#a5745b",colourSecondary:"#dbc7bd",colourTertiary:"#845d49"},list_blocks:{colourPrimary:"#745ba5",colourSecondary:"#c7bddb",colourTertiary:"#5d4984"},logic_blocks:{colourPrimary:"#5b80a5",colourSecondary:"#bdccdb",colourTertiary:"#496684"},loop_blocks:{colourPrimary:"#5ba55b",colourSecondary:"#bddbbd",colourTertiary:"#498449"},math_blocks:{colourPrimary:"#5b67a5",colourSecondary:"#bdc2db",colourTertiary:"#495284"},procedure_blocks:{colourPrimary:"#995ba5",colourSecondary:"#d6bddb",colourTertiary:"#7a4984"},text_blocks:{colourPrimary:"#5ba58c",colourSecondary:"#bddbd1",colourTertiary:"#498470"},variable_blocks:{colourPrimary:"#a55b99",colourSecondary:"#dbbdd6",colourTertiary:"#84497a"},variable_dynamic_blocks:{colourPrimary:"#a55b99",colourSecondary:"#dbbdd6",colourTertiary:"#84497a"},hat_blocks:{colourPrimary:"#a55b99",colourSecondary:"#dbbdd6",colourTertiary:"#84497a",hat:"cap"}},Blockly.Themes.Modern.categoryStyles={colour_category:{colour:"#a5745b"},list_category:{colour:"#745ba5"},logic_category:{colour:"#5b80a5"},loop_category:{colour:"#5ba55b"},math_category:{colour:"#5b67a5"},procedure_category:{colour:"#995ba5"},text_category:{colour:"#5ba58c"},variable_category:{colour:"#a55b99"},variable_dynamic_category:{colour:"#a55b99"}},Blockly.Themes.Modern=new Blockly.Theme(Blockly.Themes.Modern.defaultBlockStyles,Blockly.Themes.Modern.categoryStyles),Blockly.requires={},Blockly.Blocks.colour={};Blockly.Constants={},Blockly.Constants.Colour={},Blockly.Constants.Colour.HUE=20,Blockly.defineBlocksWithJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]),Blockly.Blocks.lists={},Blockly.Constants.Lists={},Blockly.Constants.Lists.HUE=260,Blockly.defineBlocksWithJsonArray([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),Blockly.Blocks.lists_create_with={init:function(){this.setHelpUrl(Blockly.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new Blockly.Mutator(["lists_create_with_item"])),this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose:function(t){var e=t.newBlock("lists_create_with_container");e.initSvg();for(var o=e.getInput("STACK").connection,l=0;l<this.itemCount_;l++){var i=t.newBlock("lists_create_with_item");i.initSvg(),o.connect(i.previousConnection),o=i.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e;)t.push(e.valueConnection_),e=e.nextConnection&&e.nextConnection.targetBlock();for(e=0;e<this.itemCount_;e++){var o=this.getInput("ADD"+e).connection.targetConnection;o&&-1==t.indexOf(o)&&o.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++)Blockly.Mutator.reconnect(t[e],this,"ADD"+e)},saveConnections:function(t){t=t.getInputTargetBlock("STACK");for(var e=0;t;){var o=this.getInput("ADD"+e);t.valueConnection_=o&&o.connection.targetConnection,e++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(Blockly.Msg.LISTS_CREATE_EMPTY_TITLE);for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var e=this.appendValueInput("ADD"+t);0==t&&e.appendField(Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},Blockly.Blocks.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},Blockly.Blocks.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(Blockly.Msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(Blockly.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},Blockly.Blocks.lists_indexOf={init:function(){var t=[[Blockly.Msg.LISTS_INDEX_OF_FIRST,"FIRST"],[Blockly.Msg.LISTS_INDEX_OF_LAST,"LAST"]];this.setHelpUrl(Blockly.Msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(Blockly.Msg.LISTS_INDEX_OF_INPUT_IN_LIST),this.appendValueInput("FIND").appendField(new Blockly.FieldDropdown(t),"END"),this.setInputsInline(!0);var e=this;this.setTooltip((function(){return Blockly.Msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",e.workspace.options.oneBasedIndex?"0":"-1")}))}},Blockly.Blocks.lists_getIndex={init:function(){var t=[[Blockly.Msg.LISTS_GET_INDEX_GET,"GET"],[Blockly.Msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[Blockly.Msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[Blockly.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[Blockly.Msg.LISTS_GET_INDEX_LAST,"LAST"],[Blockly.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(Blockly.Msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),t=new Blockly.FieldDropdown(t,(function(t){t="REMOVE"==t,this.getSourceBlock().updateStatement_(t)})),this.appendValueInput("VALUE").setCheck("Array").appendField(Blockly.Msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(t,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),Blockly.Msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(Blockly.Msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0);var e=this;this.setTooltip((function(){var t=e.getFieldValue("MODE"),o=e.getFieldValue("WHERE"),l="";switch(t+" "+o){case"GET FROM_START":case"GET FROM_END":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":l=Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!=o&&"FROM_END"!=o||(l+="  "+("FROM_START"==o?Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP:Blockly.Msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",e.workspace.options.oneBasedIndex?"#1":"#0")),l}))},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");t.setAttribute("statement",!this.outputConnection);var e=this.getInput("AT").type==Blockly.INPUT_VALUE;return t.setAttribute("at",e),t},domToMutation:function(t){var e="true"==t.getAttribute("statement");this.updateStatement_(e),t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateStatement_:function(t){t!=!this.outputConnection&&(this.unplug(!0,!0),t?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var e=new Blockly.FieldDropdown(this.WHERE_OPTIONS,(function(e){var o="FROM_START"==e||"FROM_END"==e;if(o!=t){var l=this.getSourceBlock();return l.updateAt_(o),l.setFieldValue(e,"WHERE"),null}}));this.getInput("AT").appendField(e,"WHERE"),Blockly.Msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},Blockly.Blocks.lists_setIndex={init:function(){var t=[[Blockly.Msg.LISTS_SET_INDEX_SET,"SET"],[Blockly.Msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[Blockly.Msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_INDEX_FIRST,"FIRST"],[Blockly.Msg.LISTS_GET_INDEX_LAST,"LAST"],[Blockly.Msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(Blockly.Msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(Blockly.Msg.LISTS_SET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(new Blockly.FieldDropdown(t),"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(Blockly.Msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(Blockly.Msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0);var e=this;this.setTooltip((function(){var t=e.getFieldValue("MODE"),o=e.getFieldValue("WHERE"),l="";switch(t+" "+o){case"SET FROM_START":case"SET FROM_END":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":l=Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!=o&&"FROM_END"!=o||(l+="  "+Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",e.workspace.options.oneBasedIndex?"#1":"#0")),l}))},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation"),e=this.getInput("AT").type==Blockly.INPUT_VALUE;return t.setAttribute("at",e),t},domToMutation:function(t){t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(t){this.removeInput("AT"),this.removeInput("ORDINAL",!0),t?(this.appendValueInput("AT").setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");var e=new Blockly.FieldDropdown(this.WHERE_OPTIONS,(function(e){var o="FROM_START"==e||"FROM_END"==e;if(o!=t){var l=this.getSourceBlock();return l.updateAt_(o),l.setFieldValue(e,"WHERE"),null}}));this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(e,"WHERE")}},Blockly.Blocks.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[Blockly.Msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(Blockly.Msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(Blockly.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),Blockly.Msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(Blockly.Msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(Blockly.Msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation"),e=this.getInput("AT1").type==Blockly.INPUT_VALUE;return t.setAttribute("at1",e),e=this.getInput("AT2").type==Blockly.INPUT_VALUE,t.setAttribute("at2",e),t},domToMutation:function(t){var e="true"==t.getAttribute("at1");t="true"==t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(t,e){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),e?(this.appendValueInput("AT"+t).setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t);var o=new Blockly.FieldDropdown(this["WHERE_OPTIONS_"+t],(function(o){var l="FROM_START"==o||"FROM_END"==o;if(l!=e){var i=this.getSourceBlock();return i.updateAt_(t,l),i.setFieldValue(o,"WHERE"+t),null}}));this.getInput("AT"+t).appendField(o,"WHERE"+t),1==t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),Blockly.Msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},Blockly.Blocks.lists_sort={init:function(){this.jsonInit({message0:Blockly.Msg.LISTS_SORT_TITLE,args0:[{type:"field_dropdown",name:"TYPE",options:[[Blockly.Msg.LISTS_SORT_TYPE_NUMERIC,"NUMERIC"],[Blockly.Msg.LISTS_SORT_TYPE_TEXT,"TEXT"],[Blockly.Msg.LISTS_SORT_TYPE_IGNORECASE,"IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[[Blockly.Msg.LISTS_SORT_ORDER_ASCENDING,"1"],[Blockly.Msg.LISTS_SORT_ORDER_DESCENDING,"-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:Blockly.Msg.LISTS_SORT_TOOLTIP,helpUrl:Blockly.Msg.LISTS_SORT_HELPURL})}},Blockly.Blocks.lists_split={init:function(){var t=this,e=new Blockly.FieldDropdown([[Blockly.Msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[Blockly.Msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]],(function(e){t.updateType_(e)}));this.setHelpUrl(Blockly.Msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(Blockly.Msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip((function(){var e=t.getFieldValue("MODE");if("SPLIT"==e)return Blockly.Msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"==e)return Blockly.Msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)}))},updateType_:function(t){if(this.getFieldValue("MODE")!=t){var e=this.getInput("INPUT").connection;e.setShadowDom(null);var o=e.targetBlock();o&&(e.disconnect(),o.isShadow()?o.dispose():this.bumpNeighbours())}"SPLIT"==t?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("mode",this.getFieldValue("MODE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("mode"))}},Blockly.Blocks.logic={},Blockly.Constants.Logic={},Blockly.Constants.Logic.HUE=210,Blockly.defineBlocksWithJsonArray([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]}]),Blockly.defineBlocksWithJsonArray([{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),Blockly.Constants.Logic.TOOLTIPS_BY_OP={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"},Blockly.Extensions.register("logic_op_tooltip",Blockly.Extensions.buildTooltipForDropdown("OP",Blockly.Constants.Logic.TOOLTIPS_BY_OP)),Blockly.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN={elseifCount_:0,elseCount_:0,suppressPrefixSuffix:!0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;var t=Blockly.utils.xml.createElement("mutation");return this.elseifCount_&&t.setAttribute("elseif",this.elseifCount_),this.elseCount_&&t.setAttribute("else",1),t},domToMutation:function(t){this.elseifCount_=parseInt(t.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(t.getAttribute("else"),10)||0,this.rebuildShape_()},decompose:function(t){var e=t.newBlock("controls_if_if");e.initSvg();for(var o=e.nextConnection,l=1;l<=this.elseifCount_;l++){var i=t.newBlock("controls_if_elseif");i.initSvg(),o.connect(i.previousConnection),o=i.nextConnection}return this.elseCount_&&((t=t.newBlock("controls_if_else")).initSvg(),o.connect(t.previousConnection)),e},compose:function(t){t=t.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;for(var e=[null],o=[null],l=null;t;){switch(t.type){case"controls_if_elseif":this.elseifCount_++,e.push(t.valueConnection_),o.push(t.statementConnection_);break;case"controls_if_else":this.elseCount_++,l=t.statementConnection_;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.nextConnection&&t.nextConnection.targetBlock()}this.updateShape_(),this.reconnectChildBlocks_(e,o,l)},saveConnections:function(t){t=t.nextConnection.targetBlock();for(var e=1;t;){switch(t.type){case"controls_if_elseif":var o=this.getInput("IF"+e),l=this.getInput("DO"+e);t.valueConnection_=o&&o.connection.targetConnection,t.statementConnection_=l&&l.connection.targetConnection,e++;break;case"controls_if_else":l=this.getInput("ELSE"),t.statementConnection_=l&&l.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+t.type)}t=t.nextConnection&&t.nextConnection.targetBlock()}},rebuildShape_:function(){var t=[null],e=[null],o=null;this.getInput("ELSE")&&(o=this.getInput("ELSE").connection.targetConnection);for(var l=1;this.getInput("IF"+l);){var i=this.getInput("IF"+l),n=this.getInput("DO"+l);t.push(i.connection.targetConnection),e.push(n.connection.targetConnection),l++}this.updateShape_(),this.reconnectChildBlocks_(t,e,o)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var t=1;this.getInput("IF"+t);)this.removeInput("IF"+t),this.removeInput("DO"+t),t++;for(t=1;t<=this.elseifCount_;t++)this.appendValueInput("IF"+t).setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+t).appendField(Blockly.Msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(Blockly.Msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(t,e,o){for(var l=1;l<=this.elseifCount_;l++)Blockly.Mutator.reconnect(t[l],this,"IF"+l),Blockly.Mutator.reconnect(e[l],this,"DO"+l);Blockly.Mutator.reconnect(o,this,"ELSE")}},Blockly.Extensions.registerMutator("controls_if_mutator",Blockly.Constants.Logic.CONTROLS_IF_MUTATOR_MIXIN,null,["controls_if_elseif","controls_if_else"]),Blockly.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION=function(){this.setTooltip((function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?Blockly.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?Blockly.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?Blockly.Msg.CONTROLS_IF_TOOLTIP_4:"":Blockly.Msg.CONTROLS_IF_TOOLTIP_1}).bind(this))},Blockly.Extensions.register("controls_if_tooltip",Blockly.Constants.Logic.CONTROLS_IF_TOOLTIP_EXTENSION),Blockly.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN={onchange:function(t){this.prevBlocks_||(this.prevBlocks_=[null,null]);var e=this.getInputTargetBlock("A"),o=this.getInputTargetBlock("B");e&&o&&!e.outputConnection.checkType_(o.outputConnection)&&(Blockly.Events.setGroup(t.group),(t=this.prevBlocks_[0])!==e&&(e.unplug(),t&&!t.isShadow()&&this.getInput("A").connection.connect(t.outputConnection)),(e=this.prevBlocks_[1])!==o&&(o.unplug(),e&&!e.isShadow()&&this.getInput("B").connection.connect(e.outputConnection)),this.bumpNeighbours(),Blockly.Events.setGroup(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},Blockly.Constants.Logic.LOGIC_COMPARE_EXTENSION=function(){this.mixin(Blockly.Constants.Logic.LOGIC_COMPARE_ONCHANGE_MIXIN)},Blockly.Extensions.register("logic_compare",Blockly.Constants.Logic.LOGIC_COMPARE_EXTENSION),Blockly.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN={prevParentConnection_:null,onchange:function(t){var e=this.getInputTargetBlock("THEN"),o=this.getInputTargetBlock("ELSE"),l=this.outputConnection.targetConnection;if((e||o)&&l)for(var i=0;2>i;i++){var n=1==i?e:o;n&&!n.outputConnection.checkType_(l)&&(Blockly.Events.setGroup(t.group),l===this.prevParentConnection_?(this.unplug(),l.getSourceBlock().bumpNeighbours()):(n.unplug(),n.bumpNeighbours()),Blockly.Events.setGroup(!1))}this.prevParentConnection_=l}},Blockly.Extensions.registerMixin("logic_ternary",Blockly.Constants.Logic.LOGIC_TERNARY_ONCHANGE_MIXIN),Blockly.Blocks.loops={},Blockly.Constants.Loops={},Blockly.Constants.Loops.HUE=120,Blockly.defineBlocksWithJsonArray([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),Blockly.Constants.Loops.WHILE_UNTIL_TOOLTIPS={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"},Blockly.Extensions.register("controls_whileUntil_tooltip",Blockly.Extensions.buildTooltipForDropdown("MODE",Blockly.Constants.Loops.WHILE_UNTIL_TOOLTIPS)),Blockly.Constants.Loops.BREAK_CONTINUE_TOOLTIPS={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"},Blockly.Extensions.register("controls_flow_tooltip",Blockly.Extensions.buildTooltipForDropdown("FLOW",Blockly.Constants.Loops.BREAK_CONTINUE_TOOLTIPS)),Blockly.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN={customContextMenu:function(t){if(!this.isInFlyout){var e=this.getField("VAR").getVariable(),o=e.name;if(!this.isCollapsed()&&null!=o){var l={enabled:!0};l.text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",o),e=Blockly.Variables.generateVariableFieldDom(e),(o=Blockly.utils.xml.createElement("block")).setAttribute("type","variables_get"),o.appendChild(e),l.callback=Blockly.ContextMenu.callbackFactory(this,o),t.push(l)}}}},Blockly.Extensions.registerMixin("contextMenu_newGetVariableBlock",Blockly.Constants.Loops.CUSTOM_CONTEXT_MENU_CREATE_VARIABLES_GET_MIXIN),Blockly.Extensions.register("controls_for_tooltip",Blockly.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),Blockly.Extensions.register("controls_forEach_tooltip",Blockly.Extensions.buildTooltipWithFieldText("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN={LOOP_TYPES:["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"],suppressPrefixSuffix:!0,getSurroundLoop:function(t){do{if(-1!=Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.LOOP_TYPES.indexOf(t.type))return t;t=t.getSurroundParent()}while(t);return null},onchange:function(t){this.workspace.isDragging&&!this.workspace.isDragging()&&(Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(this)?(this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(Blockly.Msg.CONTROLS_FLOW_STATEMENTS_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1)))}},Blockly.Extensions.registerMixin("controls_flow_in_loop_check",Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN),Blockly.Blocks.math={},Blockly.Constants.Math={},Blockly.Constants.Math.HUE=230,Blockly.defineBlocksWithJsonArray([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),Blockly.Constants.Math.TOOLTIPS_BY_OP={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"},Blockly.Extensions.register("math_op_tooltip",Blockly.Extensions.buildTooltipForDropdown("OP",Blockly.Constants.Math.TOOLTIPS_BY_OP)),Blockly.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN={mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation"),e="DIVISIBLE_BY"==this.getFieldValue("PROPERTY");return t.setAttribute("divisor_input",e),t},domToMutation:function(t){t="true"==t.getAttribute("divisor_input"),this.updateShape_(t)},updateShape_:function(t){var e=this.getInput("DIVISOR");t?e||this.appendValueInput("DIVISOR").setCheck("Number"):e&&this.removeInput("DIVISOR")}},Blockly.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION=function(){this.getField("PROPERTY").setValidator((function(t){t="DIVISIBLE_BY"==t,this.getSourceBlock().updateShape_(t)}))},Blockly.Extensions.registerMutator("math_is_divisibleby_mutator",Blockly.Constants.Math.IS_DIVISIBLEBY_MUTATOR_MIXIN,Blockly.Constants.Math.IS_DIVISIBLE_MUTATOR_EXTENSION),Blockly.Extensions.register("math_change_tooltip",Blockly.Extensions.buildTooltipWithFieldText("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),Blockly.Constants.Math.LIST_MODES_MUTATOR_MIXIN={updateType_:function(t){this.outputConnection.setCheck("MODE"==t?"Array":"Number")},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("op",this.getFieldValue("OP")),t},domToMutation:function(t){this.updateType_(t.getAttribute("op"))}},Blockly.Constants.Math.LIST_MODES_MUTATOR_EXTENSION=function(){this.getField("OP").setValidator((function(t){this.updateType_(t)}).bind(this))},Blockly.Extensions.registerMutator("math_modes_of_list_mutator",Blockly.Constants.Math.LIST_MODES_MUTATOR_MIXIN,Blockly.Constants.Math.LIST_MODES_MUTATOR_EXTENSION),Blockly.Blocks.procedures={},Blockly.Blocks.procedures_defnoreturn={init:function(){var t=new Blockly.FieldTextInput("",Blockly.Procedures.rename);t.setSpellcheck(!1),this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.setMutator(new Blockly.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(Blockly.Msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:function(t){this.hasStatements_!==t&&(t?(this.appendStatementInput("STACK").appendField(Blockly.Msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=t)},updateParams_:function(){var t="";this.arguments_.length&&(t=Blockly.Msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),Blockly.Events.disable();try{this.setFieldValue(t,"PARAMS")}finally{Blockly.Events.enable()}},mutationToDom:function(t){var e=Blockly.utils.xml.createElement("mutation");t&&e.setAttribute("name",this.getFieldValue("NAME"));for(var o=0;o<this.argumentVarModels_.length;o++){var l=Blockly.utils.xml.createElement("arg"),i=this.argumentVarModels_[o];l.setAttribute("name",i.name),l.setAttribute("varid",i.getId()),t&&this.paramIds_&&l.setAttribute("paramId",this.paramIds_[o]),e.appendChild(l)}return this.hasStatements_||e.setAttribute("statements","false"),e},domToMutation:function(t){this.arguments_=[],this.argumentVarModels_=[];for(var e,o=0;e=t.childNodes[o];o++)if("arg"==e.nodeName.toLowerCase()){var l=e.getAttribute("name");e=e.getAttribute("varid")||e.getAttribute("varId"),this.arguments_.push(l),null!=(e=Blockly.Variables.getOrCreateVariablePackage(this.workspace,e,l,""))?this.argumentVarModels_.push(e):console.log("Failed to create a variable with name "+l+", ignoring.")}this.updateParams_(),Blockly.Procedures.mutateCallers(this),this.setStatements_("false"!==t.getAttribute("statements"))},decompose:function(t){var e=Blockly.utils.xml.createElement("block");e.setAttribute("type","procedures_mutatorcontainer");var o=Blockly.utils.xml.createElement("statement");o.setAttribute("name","STACK"),e.appendChild(o);for(var l=0;l<this.arguments_.length;l++){var i=Blockly.utils.xml.createElement("block");i.setAttribute("type","procedures_mutatorarg");var n=Blockly.utils.xml.createElement("field");n.setAttribute("name","NAME");var r=Blockly.utils.xml.createTextNode(this.arguments_[l]);n.appendChild(r),i.appendChild(n),n=Blockly.utils.xml.createElement("next"),i.appendChild(n),o.appendChild(i),o=n}return t=Blockly.Xml.domToBlock(e,t),"procedures_defreturn"==this.type?t.setFieldValue(this.hasStatements_,"STATEMENTS"):t.removeInput("STATEMENT_INPUT"),Blockly.Procedures.mutateCallers(this),t},compose:function(t){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];for(var e=t.getInputTargetBlock("STACK");e;){var o=e.getFieldValue("NAME");this.arguments_.push(o),o=this.workspace.getVariable(o,""),this.argumentVarModels_.push(o),this.paramIds_.push(e.id),e=e.nextConnection&&e.nextConnection.targetBlock()}this.updateParams_(),Blockly.Procedures.mutateCallers(this),null!==(t=t.getFieldValue("STATEMENTS"))&&this.hasStatements_!=(t="TRUE"==t)&&(t?(this.setStatements_(!0),Blockly.Mutator.reconnect(this.statementConnection_,this,"STACK"),this.statementConnection_=null):(t=this.getInput("STACK").connection,(this.statementConnection_=t.targetConnection)&&((t=t.targetBlock()).unplug(),t.bumpNeighbours()),this.setStatements_(!1)))},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(t,e){var o=this.workspace.getVariableById(t);if(""==o.type){o=o.name;for(var l=this.workspace.getVariableById(e),i=!1,n=0;n<this.argumentVarModels_.length;n++)this.argumentVarModels_[n].getId()==t&&(this.arguments_[n]=l.name,this.argumentVarModels_[n]=l,i=!0);i&&(this.displayRenamedVar_(o,l.name),Blockly.Procedures.mutateCallers(this))}},updateVarName:function(t){for(var e=t.name,o=!1,l=0;l<this.argumentVarModels_.length;l++)if(this.argumentVarModels_[l].getId()==t.getId()){var i=this.arguments_[l];this.arguments_[l]=e,o=!0}o&&(this.displayRenamedVar_(i,e),Blockly.Procedures.mutateCallers(this))},displayRenamedVar_:function(t,e){if(this.updateParams_(),this.mutator&&this.mutator.isVisible())for(var o,l=this.mutator.workspace_.getAllBlocks(!1),i=0;o=l[i];i++)"procedures_mutatorarg"==o.type&&Blockly.Names.equals(t,o.getFieldValue("NAME"))&&o.setFieldValue(e,"NAME")},customContextMenu:function(t){if(!this.isInFlyout){var e={enabled:!0},o=this.getFieldValue("NAME");e.text=Blockly.Msg.PROCEDURES_CREATE_DO.replace("%1",o);var l=Blockly.utils.xml.createElement("mutation");for(l.setAttribute("name",o),o=0;o<this.arguments_.length;o++){var i=Blockly.utils.xml.createElement("arg");i.setAttribute("name",this.arguments_[o]),l.appendChild(i)}if((o=Blockly.utils.xml.createElement("block")).setAttribute("type",this.callType_),o.appendChild(l),e.callback=Blockly.ContextMenu.callbackFactory(this,o),t.push(e),!this.isCollapsed())for(o=0;o<this.argumentVarModels_.length;o++)(e={enabled:!0}).text=Blockly.Msg.VARIABLES_SET_CREATE_GET.replace("%1",(l=this.argumentVarModels_[o]).name),l=Blockly.Variables.generateVariableFieldDom(l),(i=Blockly.utils.xml.createElement("block")).setAttribute("type","variables_get"),i.appendChild(l),e.callback=Blockly.ContextMenu.callbackFactory(this,i),t.push(e)}},callType_:"procedures_callnoreturn"},Blockly.Blocks.procedures_defreturn={init:function(){var t=new Blockly.FieldTextInput("",Blockly.Procedures.rename);t.setSpellcheck(!1),this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_DEFRETURN_TITLE).appendField(t,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(Blockly.ALIGN_RIGHT).appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new Blockly.Mutator(["procedures_mutatorarg"])),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(Blockly.Msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(Blockly.Msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},setStatements_:Blockly.Blocks.procedures_defnoreturn.setStatements_,updateParams_:Blockly.Blocks.procedures_defnoreturn.updateParams_,mutationToDom:Blockly.Blocks.procedures_defnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_defnoreturn.domToMutation,decompose:Blockly.Blocks.procedures_defnoreturn.decompose,compose:Blockly.Blocks.procedures_defnoreturn.compose,getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},getVars:Blockly.Blocks.procedures_defnoreturn.getVars,getVarModels:Blockly.Blocks.procedures_defnoreturn.getVarModels,renameVarById:Blockly.Blocks.procedures_defnoreturn.renameVarById,updateVarName:Blockly.Blocks.procedures_defnoreturn.updateVarName,displayRenamedVar_:Blockly.Blocks.procedures_defnoreturn.displayRenamedVar_,customContextMenu:Blockly.Blocks.procedures_defnoreturn.customContextMenu,callType_:"procedures_callreturn"},Blockly.Blocks.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(Blockly.Msg.PROCEDURES_ALLOW_STATEMENTS).appendField(new Blockly.FieldCheckbox("TRUE"),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&(t.type==Blockly.Events.BLOCK_DELETE||t.type==Blockly.Events.BLOCK_CREATE)){var e=this.workspace.getAllBlocks(),o=this.workspace.getAllVariables();if(t.type==Blockly.Events.BLOCK_DELETE){t=[];for(var l=0;l<e.length;l+=1)e[l].getFieldValue("NAME")&&t.push(e[l].getFieldValue("NAME"));for(e=0;e<o.length;e+=1)-1==t.indexOf(o[e].name)&&this.workspace.deleteVariableById(o[e].getId())}else if(t.type==Blockly.Events.BLOCK_CREATE&&(o=this.workspace.getBlockById(t.blockId)).getField("NAME")&&(l=o.getFieldValue("NAME"),(t=this.workspace.getVariable(l))||(t=this.workspace.createVariable(l)),!o.previousConnection.isConnected()&&!o.nextConnection.isConnected()))for(l=0;l<e.length;l+=1)if(o.id!=e[l].id&&e[l].getFieldValue("NAME")==t.name){l=Blockly.Variables.generateUniqueName(this.workspace),t=this.workspace.createVariable(l),o.setFieldValue(t.name,"NAME");break}}}},Blockly.Blocks.procedures_mutatorarg={init:function(){var t=new Blockly.FieldTextInput("x",this.validator_);t.oldShowEditorFn_=t.showEditor_,t.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(Blockly.Msg.PROCEDURES_MUTATORARG_TITLE).appendField(t,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(Blockly.Msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,t.onFinishEditing_=this.deleteIntermediateVars_,t.createdVariables_=[],t.onFinishEditing_("x")},validator_:function(t){var e=this.getSourceBlock(),o=Blockly.Mutator.findParentWs(e.workspace);if(!(t=t.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;e=e.workspace.getAllBlocks();for(var l=0;l<e.length;l++)if(e[l].id!=this.getSourceBlock().id&&e[l].getFieldValue("NAME")==t)return null;return(e=o.getVariable(t,""))&&e.name!=t&&o.renameVariableById(e.getId(),t),e||(e=o.createVariable(t,""))&&this.createdVariables_&&this.createdVariables_.push(e),t},deleteIntermediateVars_:function(t){var e=Blockly.Mutator.findParentWs(this.getSourceBlock().workspace);if(e)for(var o=0;o<this.createdVariables_.length;o++){var l=this.createdVariables_[o];l.name!=t&&e.deleteVariableById(l.getId())}}},Blockly.Blocks.procedures_callnoreturn={init:function(){this.appendDummyInput("TOPROW").appendField(this.id,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(t,e){Blockly.Names.equals(t,this.getProcedureCall())&&(this.setFieldValue(e,"NAME"),this.setTooltip((this.outputConnection?Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP:Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",e)))},setProcedureParameters_:function(t,e){var o=Blockly.Procedures.getDefinition(this.getProcedureCall(),this.workspace),l=o&&o.mutator&&o.mutator.isVisible();if(l||(this.quarkConnections_={},this.quarkIds_=null),e)if(t.join("\n")==this.arguments_.join("\n"))this.quarkIds_=e;else{if(e.length!=t.length)throw RangeError("paramNames and paramIds must be the same length.");this.setCollapsed(!1),this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]),o=this.rendered,this.rendered=!1;for(var i=0;i<this.arguments_.length;i++){var n=this.getInput("ARG"+i);n&&(this.quarkConnections_[this.quarkIds_[i]]=n=n.connection.targetConnection,l&&n&&-1==e.indexOf(this.quarkIds_[i])&&(n.disconnect(),n.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(t),this.argumentVarModels_=[],i=0;i<this.arguments_.length;i++)l=Blockly.Variables.getOrCreateVariablePackage(this.workspace,null,this.arguments_[i],""),this.argumentVarModels_.push(l);if(this.updateShape_(),this.quarkIds_=e)for(i=0;i<this.arguments_.length;i++)(l=this.quarkIds_[i])in this.quarkConnections_&&(Blockly.Mutator.reconnect(n=this.quarkConnections_[l],this,"ARG"+i)||delete this.quarkConnections_[l]);(this.rendered=o)&&this.render()}},updateShape_:function(){for(var t=0;t<this.arguments_.length;t++){var e=this.getField("ARGNAME"+t);if(e){Blockly.Events.disable();try{e.setValue(this.arguments_[t])}finally{Blockly.Events.enable()}}else e=new Blockly.FieldLabel(this.arguments_[t]),this.appendValueInput("ARG"+t).setAlign(Blockly.ALIGN_RIGHT).appendField(e,"ARGNAME"+t).init()}for(;this.getInput("ARG"+t);)this.removeInput("ARG"+t),t++;(t=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(t.appendField(Blockly.Msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),t.init()):this.getField("WITH")&&t.removeField("WITH"))},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");t.setAttribute("name",this.getProcedureCall());for(var e=0;e<this.arguments_.length;e++){var o=Blockly.utils.xml.createElement("arg");o.setAttribute("name",this.arguments_[e]),t.appendChild(o)}return t},domToMutation:function(t){var e=t.getAttribute("name");this.renameProcedure(this.getProcedureCall(),e),e=[];for(var o,l=[],i=0;o=t.childNodes[i];i++)"arg"==o.nodeName.toLowerCase()&&(e.push(o.getAttribute("name")),l.push(o.getAttribute("paramId")));this.setProcedureParameters_(e,l)},getVarModels:function(){return this.argumentVarModels_},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&t.recordUndo)if(t.type==Blockly.Events.BLOCK_CREATE&&-1!=t.ids.indexOf(this.id)){var e=this.getProcedureCall();if(!(e=Blockly.Procedures.getDefinition(e,this.workspace))||e.type==this.defType_&&JSON.stringify(e.arguments_)==JSON.stringify(this.arguments_)||(e=null),!e){Blockly.Events.setGroup(t.group),t=Blockly.utils.xml.createElement("xml"),(e=Blockly.utils.xml.createElement("block")).setAttribute("type",this.defType_);var o=this.getRelativeToSurfaceXY(),l=o.y+2*Blockly.SNAP_RADIUS;e.setAttribute("x",o.x+Blockly.SNAP_RADIUS*(this.RTL?-1:1)),e.setAttribute("y",l),o=this.mutationToDom(),e.appendChild(o),(o=Blockly.utils.xml.createElement("field")).setAttribute("name","NAME"),o.appendChild(Blockly.utils.xml.createTextNode(this.getProcedureCall())),e.appendChild(o),t.appendChild(e),Blockly.Xml.domToWorkspace(t,this.workspace),Blockly.Events.setGroup(!1)}}else t.type==Blockly.Events.BLOCK_DELETE?(e=this.getProcedureCall(),(e=Blockly.Procedures.getDefinition(e,this.workspace))||(Blockly.Events.setGroup(t.group),this.dispose(!0,!1),Blockly.Events.setGroup(!1))):t.type==Blockly.Events.CHANGE&&"disabled"==t.element&&(e=this.getProcedureCall(),(e=Blockly.Procedures.getDefinition(e,this.workspace))&&e.id==t.blockId&&((e=Blockly.Events.getGroup())&&console.log("Saw an existing group while responding to a definition change"),Blockly.Events.setGroup(t.group),t.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),Blockly.Events.setGroup(e)))},customContextMenu:function(t){if(this.workspace.isMovable()){var e={enabled:!0};e.text=Blockly.Msg.PROCEDURES_HIGHLIGHT_DEF;var o=this.getProcedureCall(),l=this.workspace;e.callback=function(){var t=Blockly.Procedures.getDefinition(o,l);t&&(l.centerOnBlock(t.id),t.select())},t.push(e)}},defType_:"procedures_defnoreturn"},Blockly.Blocks.procedures_callreturn={init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(Blockly.Msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},getProcedureCall:Blockly.Blocks.procedures_callnoreturn.getProcedureCall,renameProcedure:Blockly.Blocks.procedures_callnoreturn.renameProcedure,setProcedureParameters_:Blockly.Blocks.procedures_callnoreturn.setProcedureParameters_,updateShape_:Blockly.Blocks.procedures_callnoreturn.updateShape_,mutationToDom:Blockly.Blocks.procedures_callnoreturn.mutationToDom,domToMutation:Blockly.Blocks.procedures_callnoreturn.domToMutation,getVarModels:Blockly.Blocks.procedures_callnoreturn.getVarModels,onchange:Blockly.Blocks.procedures_callnoreturn.onchange,customContextMenu:Blockly.Blocks.procedures_callnoreturn.customContextMenu,defType_:"procedures_defreturn"},Blockly.Blocks.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(Blockly.Msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(Blockly.Msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(Blockly.Msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("value",Number(this.hasReturnValue_)),t},domToMutation:function(t){this.hasReturnValue_=1==t.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(t){if(this.workspace.isDragging&&!this.workspace.isDragging()){t=!1;var e=this;do{if(-1!=this.FUNCTION_TYPES.indexOf(e.type)){t=!0;break}e=e.getSurroundParent()}while(e);t?("procedures_defnoreturn"==e.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!=e.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(Blockly.Msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null),this.isInFlyout||this.setEnabled(!0)):(this.setWarningText(Blockly.Msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||this.getInheritedDisabled()||this.setEnabled(!1))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},Blockly.Blocks.texts={},Blockly.Constants.Text={},Blockly.Constants.Text.HUE=160,Blockly.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:"¶"},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),Blockly.Blocks.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[Blockly.Msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[Blockly.Msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(Blockly.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),Blockly.Msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(Blockly.Msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(Blockly.Msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation"),e=this.getInput("AT1").type==Blockly.INPUT_VALUE;return t.setAttribute("at1",e),e=this.getInput("AT2").type==Blockly.INPUT_VALUE,t.setAttribute("at2",e),t},domToMutation:function(t){var e="true"==t.getAttribute("at1");t="true"==t.getAttribute("at2"),this.updateAt_(1,e),this.updateAt_(2,t)},updateAt_:function(t,e){this.removeInput("AT"+t),this.removeInput("ORDINAL"+t,!0),e?(this.appendValueInput("AT"+t).setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+t).appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+t),2==t&&Blockly.Msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(Blockly.Msg.TEXT_GET_SUBSTRING_TAIL));var o=new Blockly.FieldDropdown(this["WHERE_OPTIONS_"+t],(function(o){var l="FROM_START"==o||"FROM_END"==o;if(l!=e){var i=this.getSourceBlock();return i.updateAt_(t,l),i.setFieldValue(o,"WHERE"+t),null}}));this.getInput("AT"+t).appendField(o,"WHERE"+t),1==t&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}},Blockly.Blocks.text_changeCase={init:function(){var t=[[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[Blockly.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(Blockly.Msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new Blockly.FieldDropdown(t),"CASE"),this.setOutput(!0,"String"),this.setTooltip(Blockly.Msg.TEXT_CHANGECASE_TOOLTIP)}},Blockly.Blocks.text_trim={init:function(){var t=[[Blockly.Msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[Blockly.Msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[Blockly.Msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(Blockly.Msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(new Blockly.FieldDropdown(t),"MODE"),this.setOutput(!0,"String"),this.setTooltip(Blockly.Msg.TEXT_TRIM_TOOLTIP)}},Blockly.Blocks.text_print={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:Blockly.Msg.TEXT_PRINT_TOOLTIP,helpUrl:Blockly.Msg.TEXT_PRINT_HELPURL})}},Blockly.Blocks.text_prompt_ext={init:function(){var t=[[Blockly.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(Blockly.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks");var e=this;t=new Blockly.FieldDropdown(t,(function(t){e.updateType_(t)})),this.appendValueInput("TEXT").appendField(t,"TYPE"),this.setOutput(!0,"String"),this.setTooltip((function(){return"TEXT"==e.getFieldValue("TYPE")?Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT:Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER}))},updateType_:function(t){this.outputConnection.setCheck("NUMBER"==t?"Number":"String")},mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("type",this.getFieldValue("TYPE")),t},domToMutation:function(t){this.updateType_(t.getAttribute("type"))}},Blockly.Blocks.text_prompt={init:function(){this.mixin(Blockly.Constants.Text.QUOTE_IMAGE_MIXIN);var t=[[Blockly.Msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]],e=this;this.setHelpUrl(Blockly.Msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),t=new Blockly.FieldDropdown(t,(function(t){e.updateType_(t)})),this.appendDummyInput().appendField(t,"TYPE").appendField(this.newQuote_(!0)).appendField(new Blockly.FieldTextInput(""),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip((function(){return"TEXT"==e.getFieldValue("TYPE")?Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT:Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER}))},updateType_:Blockly.Blocks.text_prompt_ext.updateType_,mutationToDom:Blockly.Blocks.text_prompt_ext.mutationToDom,domToMutation:Blockly.Blocks.text_prompt_ext.domToMutation},Blockly.Blocks.text_count={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:Blockly.Msg.TEXT_COUNT_TOOLTIP,helpUrl:Blockly.Msg.TEXT_COUNT_HELPURL})}},Blockly.Blocks.text_replace={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:Blockly.Msg.TEXT_REPLACE_TOOLTIP,helpUrl:Blockly.Msg.TEXT_REPLACE_HELPURL})}},Blockly.Blocks.text_reverse={init:function(){this.jsonInit({message0:Blockly.Msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:Blockly.Msg.TEXT_REVERSE_TOOLTIP,helpUrl:Blockly.Msg.TEXT_REVERSE_HELPURL})}},Blockly.Constants.Text.QUOTE_IMAGE_MIXIN={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(t){for(var e,o=0;e=this.inputList[o];o++)for(var l,i=0;l=e.fieldRow[i];i++)if(t==l.name)return e.insertFieldAt(i,this.newQuote_(!0)),void e.insertFieldAt(i+2,this.newQuote_(!1));console.warn('field named "'+t+'" not found in '+this.toDevString())},newQuote_:function(t){return new Blockly.FieldImage((t=this.RTL?!t:t)?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,this.QUOTE_IMAGE_WIDTH,this.QUOTE_IMAGE_HEIGHT,t?"“":"”")}},Blockly.Constants.Text.TEXT_QUOTES_EXTENSION=function(){this.mixin(Blockly.Constants.Text.QUOTE_IMAGE_MIXIN),this.quoteField_("TEXT")},Blockly.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN={mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("items",this.itemCount_),t},domToMutation:function(t){this.itemCount_=parseInt(t.getAttribute("items"),10),this.updateShape_()},decompose:function(t){var e=t.newBlock("text_create_join_container");e.initSvg();for(var o=e.getInput("STACK").connection,l=0;l<this.itemCount_;l++){var i=t.newBlock("text_create_join_item");i.initSvg(),o.connect(i.previousConnection),o=i.nextConnection}return e},compose:function(t){var e=t.getInputTargetBlock("STACK");for(t=[];e;)t.push(e.valueConnection_),e=e.nextConnection&&e.nextConnection.targetBlock();for(e=0;e<this.itemCount_;e++){var o=this.getInput("ADD"+e).connection.targetConnection;o&&-1==t.indexOf(o)&&o.disconnect()}for(this.itemCount_=t.length,this.updateShape_(),e=0;e<this.itemCount_;e++)Blockly.Mutator.reconnect(t[e],this,"ADD"+e)},saveConnections:function(t){t=t.getInputTargetBlock("STACK");for(var e=0;t;){var o=this.getInput("ADD"+e);t.valueConnection_=o&&o.connection.targetConnection,e++,t=t.nextConnection&&t.nextConnection.targetBlock()}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var t=0;t<this.itemCount_;t++)if(!this.getInput("ADD"+t)){var e=this.appendValueInput("ADD"+t);0==t&&e.appendField(Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH)}for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++}},Blockly.Constants.Text.TEXT_JOIN_EXTENSION=function(){this.mixin(Blockly.Constants.Text.QUOTE_IMAGE_MIXIN),this.itemCount_=2,this.updateShape_(),this.setMutator(new Blockly.Mutator(["text_create_join_item"]))},Blockly.Extensions.register("text_append_tooltip",Blockly.Extensions.buildTooltipWithFieldText("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),Blockly.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION=function(){var t=this;this.setTooltip((function(){return Blockly.Msg.TEXT_INDEXOF_TOOLTIP.replace("%1",t.workspace.options.oneBasedIndex?"0":"-1")}))},Blockly.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN={mutationToDom:function(){var t=Blockly.utils.xml.createElement("mutation");return t.setAttribute("at",!!this.isAt_),t},domToMutation:function(t){t="false"!=t.getAttribute("at"),this.updateAt_(t)},updateAt_:function(t){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),t&&(this.appendValueInput("AT").setCheck("Number"),Blockly.Msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(Blockly.Msg.ORDINAL_NUMBER_SUFFIX)),Blockly.Msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(Blockly.Msg.TEXT_CHARAT_TAIL)),this.isAt_=t}},Blockly.Constants.Text.TEXT_CHARAT_EXTENSION=function(){this.getField("WHERE").setValidator((function(t){(t="FROM_START"==t||"FROM_END"==t)!=this.isAt_&&this.getSourceBlock().updateAt_(t)})),this.updateAt_(!0);var t=this;this.setTooltip((function(){var e=t.getFieldValue("WHERE"),o=Blockly.Msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"==e||"FROM_END"==e)&&(e="FROM_START"==e?Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP:Blockly.Msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(o+="  "+e.replace("%1",t.workspace.options.oneBasedIndex?"#1":"#0")),o}))},Blockly.Extensions.register("text_indexOf_tooltip",Blockly.Constants.Text.TEXT_INDEXOF_TOOLTIP_EXTENSION),Blockly.Extensions.register("text_quotes",Blockly.Constants.Text.TEXT_QUOTES_EXTENSION),Blockly.Extensions.registerMutator("text_join_mutator",Blockly.Constants.Text.TEXT_JOIN_MUTATOR_MIXIN,Blockly.Constants.Text.TEXT_JOIN_EXTENSION),Blockly.Extensions.registerMutator("text_charAt_mutator",Blockly.Constants.Text.TEXT_CHARAT_MUTATOR_MIXIN,Blockly.Constants.Text.TEXT_CHARAT_EXTENSION),Blockly.Blocks.variables={},Blockly.Constants.Variables={},Blockly.Constants.Variables.HUE=330,Blockly.defineBlocksWithJsonArray([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),Blockly.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(t){if(this.isInFlyout)"variables_get"!=this.type&&"variables_get_reporter"!=this.type||(e={text:Blockly.Msg.RENAME_VARIABLE,enabled:!0,callback:Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},i=this.getField("VAR").getText(),l={text:Blockly.Msg.DELETE_VARIABLE.replace("%1",i),enabled:!0,callback:Blockly.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},t.unshift(e),t.unshift(l));else{if("variables_get"==this.type)var e="variables_set",o=Blockly.Msg.VARIABLES_GET_CREATE_SET;else e="variables_get",o=Blockly.Msg.VARIABLES_SET_CREATE_GET;var l={enabled:0<this.workspace.remainingCapacity()},i=this.getField("VAR").getText();l.text=o.replace("%1",i),(o=Blockly.utils.xml.createElement("field")).setAttribute("name","VAR"),o.appendChild(Blockly.utils.xml.createTextNode(i)),(i=Blockly.utils.xml.createElement("block")).setAttribute("type",e),i.appendChild(o),l.callback=Blockly.ContextMenu.callbackFactory(this,i),t.push(l)}}},Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,o=t.getField("VAR").getVariable();Blockly.Variables.renameVariable(e,o)}},Blockly.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,o=t.getField("VAR").getVariable();e.deleteVariableById(o.getId()),e.refreshToolboxSelection()}},Blockly.Extensions.registerMixin("contextMenu_variableSetterGetter",Blockly.Constants.Variables.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),Blockly.Constants.VariablesDynamic={},Blockly.Constants.VariablesDynamic.HUE=310,Blockly.defineBlocksWithJsonArray([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),Blockly.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN={customContextMenu:function(t){if(this.isInFlyout)"variables_get_dynamic"!=this.type&&"variables_get_reporter_dynamic"!=this.type||(e={text:Blockly.Msg.RENAME_VARIABLE,enabled:!0,callback:Blockly.Constants.Variables.RENAME_OPTION_CALLBACK_FACTORY(this)},n=this.getField("VAR").getText(),i={text:Blockly.Msg.DELETE_VARIABLE.replace("%1",n),enabled:!0,callback:Blockly.Constants.Variables.DELETE_OPTION_CALLBACK_FACTORY(this)},t.unshift(e),t.unshift(i));else{var e=this.getFieldValue("VAR"),o=this.workspace.getVariableById(e).type;if("variables_get_dynamic"==this.type){e="variables_set_dynamic";var l=Blockly.Msg.VARIABLES_GET_CREATE_SET}else e="variables_get_dynamic",l=Blockly.Msg.VARIABLES_SET_CREATE_GET;var i={enabled:0<this.workspace.remainingCapacity()},n=this.getField("VAR").getText();i.text=l.replace("%1",n),(l=Blockly.utils.xml.createElement("field")).setAttribute("name","VAR"),l.setAttribute("variabletype",o),l.appendChild(Blockly.utils.xml.createTextNode(n)),(n=Blockly.utils.xml.createElement("block")).setAttribute("type",e),n.appendChild(l),i.callback=Blockly.ContextMenu.callbackFactory(this,n),t.push(i)}},onchange:function(t){t=this.getFieldValue("VAR"),t=Blockly.Variables.getVariable(this.workspace,t),"variables_get_dynamic"==this.type?this.outputConnection.setCheck(t.type):this.getInput("VALUE").connection.setCheck(t.type)}},Blockly.Constants.VariablesDynamic.RENAME_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,o=t.getField("VAR").getVariable();Blockly.Variables.renameVariable(e,o)}},Blockly.Constants.VariablesDynamic.DELETE_OPTION_CALLBACK_FACTORY=function(t){return function(){var e=t.workspace,o=t.getField("VAR").getVariable();e.deleteVariableById(o.getId()),e.refreshToolboxSelection()}},Blockly.Extensions.registerMixin("contextMenu_variableDynamicSetterGetter",Blockly.Constants.VariablesDynamic.CUSTOM_CONTEXT_MENU_VARIABLE_GETTER_SETTER_MIXIN),Blockly.JavaScript=new Blockly.Generator("JavaScript"),Blockly.JavaScript.addReservedWords("Blockly,break,case,catch,continue,debugger,default,delete,do,else,finally,for,function,if,in,instanceof,new,return,switch,this,throw,try,typeof,var,void,while,with,class,enum,export,extends,import,super,implements,interface,let,package,private,protected,public,static,yield,const,null,true,false,Array,ArrayBuffer,Boolean,Date,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Error,eval,EvalError,Float32Array,Float64Array,Function,Infinity,Int16Array,Int32Array,Int8Array,isFinite,isNaN,Iterator,JSON,Math,NaN,Number,Object,parseFloat,parseInt,RangeError,ReferenceError,RegExp,StopIteration,String,SyntaxError,TypeError,Uint16Array,Uint32Array,Uint8Array,Uint8ClampedArray,undefined,uneval,URIError,applicationCache,closed,Components,content,_content,controllers,crypto,defaultStatus,dialogArguments,directories,document,frameElement,frames,fullScreen,globalStorage,history,innerHeight,innerWidth,length,location,locationbar,localStorage,menubar,messageManager,mozAnimationStartTime,mozInnerScreenX,mozInnerScreenY,mozPaintCount,name,navigator,opener,outerHeight,outerWidth,pageXOffset,pageYOffset,parent,performance,personalbar,pkcs11,returnValue,screen,screenX,screenY,scrollbars,scrollMaxX,scrollMaxY,scrollX,scrollY,self,sessionStorage,sidebar,status,statusbar,toolbar,top,URL,window,addEventListener,alert,atob,back,blur,btoa,captureEvents,clearImmediate,clearInterval,clearTimeout,close,confirm,disableExternalCapture,dispatchEvent,dump,enableExternalCapture,escape,find,focus,forward,GeckoActiveXObject,getAttention,getAttentionWithCycleCount,getComputedStyle,getSelection,home,matchMedia,maximize,minimize,moveBy,moveTo,mozRequestAnimationFrame,open,openDialog,postMessage,print,prompt,QueryInterface,releaseEvents,removeEventListener,resizeBy,resizeTo,restore,routeEvent,scroll,scrollBy,scrollByLines,scrollByPages,scrollTo,setCursor,setImmediate,setInterval,setResizable,setTimeout,showModalDialog,sizeToContent,stop,unescape,updateCommands,XPCNativeWrapper,XPCSafeJSObjectWrapper,onabort,onbeforeunload,onblur,onchange,onclick,onclose,oncontextmenu,ondevicemotion,ondeviceorientation,ondragdrop,onerror,onfocus,onhashchange,onkeydown,onkeypress,onkeyup,onload,onmousedown,onmousemove,onmouseout,onmouseover,onmouseup,onmozbeforepaint,onpaint,onpopstate,onreset,onresize,onscroll,onselect,onsubmit,onunload,onpageshow,onpagehide,Image,Option,Worker,Event,Range,File,FileReader,Blob,BlobBuilder,Attr,CDATASection,CharacterData,Comment,console,DocumentFragment,DocumentType,DomConfiguration,DOMError,DOMErrorHandler,DOMException,DOMImplementation,DOMImplementationList,DOMImplementationRegistry,DOMImplementationSource,DOMLocator,DOMObject,DOMString,DOMStringList,DOMTimeStamp,DOMUserData,Entity,EntityReference,MediaQueryList,MediaQueryListListener,NameList,NamedNodeMap,Node,NodeFilter,NodeIterator,NodeList,Notation,Plugin,PluginArray,ProcessingInstruction,SharedWorker,Text,TimeRanges,Treewalker,TypeInfo,UserDataHandler,Worker,WorkerGlobalScope,HTMLDocument,HTMLElement,HTMLAnchorElement,HTMLAppletElement,HTMLAudioElement,HTMLAreaElement,HTMLBaseElement,HTMLBaseFontElement,HTMLBodyElement,HTMLBRElement,HTMLButtonElement,HTMLCanvasElement,HTMLDirectoryElement,HTMLDivElement,HTMLDListElement,HTMLEmbedElement,HTMLFieldSetElement,HTMLFontElement,HTMLFormElement,HTMLFrameElement,HTMLFrameSetElement,HTMLHeadElement,HTMLHeadingElement,HTMLHtmlElement,HTMLHRElement,HTMLIFrameElement,HTMLImageElement,HTMLInputElement,HTMLKeygenElement,HTMLLabelElement,HTMLLIElement,HTMLLinkElement,HTMLMapElement,HTMLMenuElement,HTMLMetaElement,HTMLModElement,HTMLObjectElement,HTMLOListElement,HTMLOptGroupElement,HTMLOptionElement,HTMLOutputElement,HTMLParagraphElement,HTMLParamElement,HTMLPreElement,HTMLQuoteElement,HTMLScriptElement,HTMLSelectElement,HTMLSourceElement,HTMLSpanElement,HTMLStyleElement,HTMLTableElement,HTMLTableCaptionElement,HTMLTableCellElement,HTMLTableDataCellElement,HTMLTableHeaderCellElement,HTMLTableColElement,HTMLTableRowElement,HTMLTableSectionElement,HTMLTextAreaElement,HTMLTimeElement,HTMLTitleElement,HTMLTrackElement,HTMLUListElement,HTMLUnknownElement,HTMLVideoElement,HTMLCanvasElement,CanvasRenderingContext2D,CanvasGradient,CanvasPattern,TextMetrics,ImageData,CanvasPixelArray,HTMLAudioElement,HTMLVideoElement,NotifyAudioAvailableEvent,HTMLCollection,HTMLAllCollection,HTMLFormControlsCollection,HTMLOptionsCollection,HTMLPropertiesCollection,DOMTokenList,DOMSettableTokenList,DOMStringMap,RadioNodeList,SVGDocument,SVGElement,SVGAElement,SVGAltGlyphElement,SVGAltGlyphDefElement,SVGAltGlyphItemElement,SVGAnimationElement,SVGAnimateElement,SVGAnimateColorElement,SVGAnimateMotionElement,SVGAnimateTransformElement,SVGSetElement,SVGCircleElement,SVGClipPathElement,SVGColorProfileElement,SVGCursorElement,SVGDefsElement,SVGDescElement,SVGEllipseElement,SVGFilterElement,SVGFilterPrimitiveStandardAttributes,SVGFEBlendElement,SVGFEColorMatrixElement,SVGFEComponentTransferElement,SVGFECompositeElement,SVGFEConvolveMatrixElement,SVGFEDiffuseLightingElement,SVGFEDisplacementMapElement,SVGFEDistantLightElement,SVGFEFloodElement,SVGFEGaussianBlurElement,SVGFEImageElement,SVGFEMergeElement,SVGFEMergeNodeElement,SVGFEMorphologyElement,SVGFEOffsetElement,SVGFEPointLightElement,SVGFESpecularLightingElement,SVGFESpotLightElement,SVGFETileElement,SVGFETurbulenceElement,SVGComponentTransferFunctionElement,SVGFEFuncRElement,SVGFEFuncGElement,SVGFEFuncBElement,SVGFEFuncAElement,SVGFontElement,SVGFontFaceElement,SVGFontFaceFormatElement,SVGFontFaceNameElement,SVGFontFaceSrcElement,SVGFontFaceUriElement,SVGForeignObjectElement,SVGGElement,SVGGlyphElement,SVGGlyphRefElement,SVGGradientElement,SVGLinearGradientElement,SVGRadialGradientElement,SVGHKernElement,SVGImageElement,SVGLineElement,SVGMarkerElement,SVGMaskElement,SVGMetadataElement,SVGMissingGlyphElement,SVGMPathElement,SVGPathElement,SVGPatternElement,SVGPolylineElement,SVGPolygonElement,SVGRectElement,SVGScriptElement,SVGStopElement,SVGStyleElement,SVGSVGElement,SVGSwitchElement,SVGSymbolElement,SVGTextElement,SVGTextPathElement,SVGTitleElement,SVGTRefElement,SVGTSpanElement,SVGUseElement,SVGViewElement,SVGVKernElement,SVGAngle,SVGColor,SVGICCColor,SVGElementInstance,SVGElementInstanceList,SVGLength,SVGLengthList,SVGMatrix,SVGNumber,SVGNumberList,SVGPaint,SVGPoint,SVGPointList,SVGPreserveAspectRatio,SVGRect,SVGStringList,SVGTransform,SVGTransformList,SVGAnimatedAngle,SVGAnimatedBoolean,SVGAnimatedEnumeration,SVGAnimatedInteger,SVGAnimatedLength,SVGAnimatedLengthList,SVGAnimatedNumber,SVGAnimatedNumberList,SVGAnimatedPreserveAspectRatio,SVGAnimatedRect,SVGAnimatedString,SVGAnimatedTransformList,SVGPathSegList,SVGPathSeg,SVGPathSegArcAbs,SVGPathSegArcRel,SVGPathSegClosePath,SVGPathSegCurvetoCubicAbs,SVGPathSegCurvetoCubicRel,SVGPathSegCurvetoCubicSmoothAbs,SVGPathSegCurvetoCubicSmoothRel,SVGPathSegCurvetoQuadraticAbs,SVGPathSegCurvetoQuadraticRel,SVGPathSegCurvetoQuadraticSmoothAbs,SVGPathSegCurvetoQuadraticSmoothRel,SVGPathSegLinetoAbs,SVGPathSegLinetoHorizontalAbs,SVGPathSegLinetoHorizontalRel,SVGPathSegLinetoRel,SVGPathSegLinetoVerticalAbs,SVGPathSegLinetoVerticalRel,SVGPathSegMovetoAbs,SVGPathSegMovetoRel,ElementTimeControl,TimeEvent,SVGAnimatedPathData,SVGAnimatedPoints,SVGColorProfileRule,SVGCSSRule,SVGExternalResourcesRequired,SVGFitToViewBox,SVGLangSpace,SVGLocatable,SVGRenderingIntent,SVGStylable,SVGTests,SVGTextContentElement,SVGTextPositioningElement,SVGTransformable,SVGUnitTypes,SVGURIReference,SVGViewSpec,SVGZoomAndPan"),Blockly.JavaScript.ORDER_ATOMIC=0,Blockly.JavaScript.ORDER_NEW=1.1,Blockly.JavaScript.ORDER_MEMBER=1.2,Blockly.JavaScript.ORDER_FUNCTION_CALL=2,Blockly.JavaScript.ORDER_INCREMENT=3,Blockly.JavaScript.ORDER_DECREMENT=3,Blockly.JavaScript.ORDER_BITWISE_NOT=4.1,Blockly.JavaScript.ORDER_UNARY_PLUS=4.2,Blockly.JavaScript.ORDER_UNARY_NEGATION=4.3,Blockly.JavaScript.ORDER_LOGICAL_NOT=4.4,Blockly.JavaScript.ORDER_TYPEOF=4.5,Blockly.JavaScript.ORDER_VOID=4.6,Blockly.JavaScript.ORDER_DELETE=4.7,Blockly.JavaScript.ORDER_AWAIT=4.8,Blockly.JavaScript.ORDER_EXPONENTIATION=5,Blockly.JavaScript.ORDER_MULTIPLICATION=5.1,Blockly.JavaScript.ORDER_DIVISION=5.2,Blockly.JavaScript.ORDER_MODULUS=5.3,Blockly.JavaScript.ORDER_SUBTRACTION=6.1,Blockly.JavaScript.ORDER_ADDITION=6.2,Blockly.JavaScript.ORDER_BITWISE_SHIFT=7,Blockly.JavaScript.ORDER_RELATIONAL=8,Blockly.JavaScript.ORDER_IN=8,Blockly.JavaScript.ORDER_INSTANCEOF=8,Blockly.JavaScript.ORDER_EQUALITY=9,Blockly.JavaScript.ORDER_BITWISE_AND=10,Blockly.JavaScript.ORDER_BITWISE_XOR=11,Blockly.JavaScript.ORDER_BITWISE_OR=12,Blockly.JavaScript.ORDER_LOGICAL_AND=13,Blockly.JavaScript.ORDER_LOGICAL_OR=14,Blockly.JavaScript.ORDER_CONDITIONAL=15,Blockly.JavaScript.ORDER_ASSIGNMENT=16,Blockly.JavaScript.ORDER_YIELD=17,Blockly.JavaScript.ORDER_COMMA=18,Blockly.JavaScript.ORDER_NONE=99,Blockly.JavaScript.ORDER_OVERRIDES=[[Blockly.JavaScript.ORDER_FUNCTION_CALL,Blockly.JavaScript.ORDER_MEMBER],[Blockly.JavaScript.ORDER_FUNCTION_CALL,Blockly.JavaScript.ORDER_FUNCTION_CALL],[Blockly.JavaScript.ORDER_MEMBER,Blockly.JavaScript.ORDER_MEMBER],[Blockly.JavaScript.ORDER_MEMBER,Blockly.JavaScript.ORDER_FUNCTION_CALL],[Blockly.JavaScript.ORDER_LOGICAL_NOT,Blockly.JavaScript.ORDER_LOGICAL_NOT],[Blockly.JavaScript.ORDER_MULTIPLICATION,Blockly.JavaScript.ORDER_MULTIPLICATION],[Blockly.JavaScript.ORDER_ADDITION,Blockly.JavaScript.ORDER_ADDITION],[Blockly.JavaScript.ORDER_LOGICAL_AND,Blockly.JavaScript.ORDER_LOGICAL_AND],[Blockly.JavaScript.ORDER_LOGICAL_OR,Blockly.JavaScript.ORDER_LOGICAL_OR]],Blockly.JavaScript.init=function(t){Blockly.JavaScript.definitions_=Object.create(null),Blockly.JavaScript.functionNames_=Object.create(null),Blockly.JavaScript.variableDB_?Blockly.JavaScript.variableDB_.reset():Blockly.JavaScript.variableDB_=new Blockly.Names(Blockly.JavaScript.RESERVED_WORDS_),Blockly.JavaScript.variableDB_.setVariableMap(t.getVariableMap());for(var e=[],o=Blockly.Variables.allDeveloperVariables(t),l=0;l<o.length;l++)e.push(Blockly.JavaScript.variableDB_.getName(o[l],Blockly.Names.DEVELOPER_VARIABLE_TYPE));for(t=Blockly.Variables.allUsedVarModels(t),l=0;l<t.length;l++)e.push(Blockly.JavaScript.variableDB_.getName(t[l].getId(),Blockly.Variables.NAME_TYPE));e.length&&(Blockly.JavaScript.definitions_.variables="var "+e.join(", ")+";")},Blockly.JavaScript.finish=function(t){var e,o=[];for(e in Blockly.JavaScript.definitions_)o.push(Blockly.JavaScript.definitions_[e]);return delete Blockly.JavaScript.definitions_,delete Blockly.JavaScript.functionNames_,Blockly.JavaScript.variableDB_.reset(),o.join("\n\n")+"\n\n\n"+t},Blockly.JavaScript.scrubNakedValue=function(t){return t+";\n"},Blockly.JavaScript.quote_=function(t){return"'"+(t=t.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n").replace(/'/g,"\\'"))+"'"},Blockly.JavaScript.multiline_quote_=function(t){return t.split(/\n/g).map(Blockly.JavaScript.quote_).join(" + '\\n' +\n")},Blockly.JavaScript.scrub_=function(t,e,o){var l="";if(!t.outputConnection||!t.outputConnection.targetConnection){var i=t.getCommentText();i&&(i=Blockly.utils.string.wrap(i,Blockly.JavaScript.COMMENT_WRAP-3),l+=Blockly.JavaScript.prefixLines(i+"\n","// "));for(var n=0;n<t.inputList.length;n++)t.inputList[n].type==Blockly.INPUT_VALUE&&(i=t.inputList[n].connection.targetBlock())&&(i=Blockly.JavaScript.allNestedComments(i))&&(l+=Blockly.JavaScript.prefixLines(i,"// "))}return t=t.nextConnection&&t.nextConnection.targetBlock(),l+e+(o?"":Blockly.JavaScript.blockToCode(t))},Blockly.JavaScript.getAdjusted=function(t,e,o,l,i){o=o||0,i=i||Blockly.JavaScript.ORDER_NONE,t.workspace.options.oneBasedIndex&&o--;var n=t.workspace.options.oneBasedIndex?"1":"0";if(t=0<o?Blockly.JavaScript.valueToCode(t,e,Blockly.JavaScript.ORDER_ADDITION)||n:0>o?Blockly.JavaScript.valueToCode(t,e,Blockly.JavaScript.ORDER_SUBTRACTION)||n:l?Blockly.JavaScript.valueToCode(t,e,Blockly.JavaScript.ORDER_UNARY_NEGATION)||n:Blockly.JavaScript.valueToCode(t,e,i)||n,Blockly.isNumber(t))t=Number(t)+o,l&&(t=-t);else{if(0<o){t=t+" + "+o;var r=Blockly.JavaScript.ORDER_ADDITION}else 0>o&&(t=t+" - "+-o,r=Blockly.JavaScript.ORDER_SUBTRACTION);l&&(t=o?"-("+t+")":"-"+t,r=Blockly.JavaScript.ORDER_UNARY_NEGATION),r=Math.floor(r),i=Math.floor(i),r&&i>=r&&(t="("+t+")")}return t},Blockly.JavaScript.colour={},Blockly.JavaScript.colour_picker=function(t){return[Blockly.JavaScript.quote_(t.getFieldValue("COLOUR")),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.colour_random=function(t){return[Blockly.JavaScript.provideFunction_("colourRandom",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"() {","  var num = Math.floor(Math.random() * Math.pow(2, 24));","  return '#' + ('00000' + num.toString(16)).substr(-6);","}"])+"()",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.colour_rgb=function(t){var e=Blockly.JavaScript.valueToCode(t,"RED",Blockly.JavaScript.ORDER_COMMA)||0,o=Blockly.JavaScript.valueToCode(t,"GREEN",Blockly.JavaScript.ORDER_COMMA)||0;return t=Blockly.JavaScript.valueToCode(t,"BLUE",Blockly.JavaScript.ORDER_COMMA)||0,[Blockly.JavaScript.provideFunction_("colourRgb",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(r, g, b) {","  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;","  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;","  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;","  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);","  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);","  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+e+", "+o+", "+t+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.colour_blend=function(t){var e=Blockly.JavaScript.valueToCode(t,"COLOUR1",Blockly.JavaScript.ORDER_COMMA)||"'#000000'",o=Blockly.JavaScript.valueToCode(t,"COLOUR2",Blockly.JavaScript.ORDER_COMMA)||"'#000000'";return t=Blockly.JavaScript.valueToCode(t,"RATIO",Blockly.JavaScript.ORDER_COMMA)||.5,[Blockly.JavaScript.provideFunction_("colourBlend",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(c1, c2, ratio) {","  ratio = Math.max(Math.min(Number(ratio), 1), 0);","  var r1 = parseInt(c1.substring(1, 3), 16);","  var g1 = parseInt(c1.substring(3, 5), 16);","  var b1 = parseInt(c1.substring(5, 7), 16);","  var r2 = parseInt(c2.substring(1, 3), 16);","  var g2 = parseInt(c2.substring(3, 5), 16);","  var b2 = parseInt(c2.substring(5, 7), 16);","  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);","  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);","  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);","  r = ('0' + (r || 0).toString(16)).slice(-2);","  g = ('0' + (g || 0).toString(16)).slice(-2);","  b = ('0' + (b || 0).toString(16)).slice(-2);","  return '#' + r + g + b;","}"])+"("+e+", "+o+", "+t+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists={},Blockly.JavaScript.lists_create_empty=function(t){return["[]",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.lists_create_with=function(t){for(var e=Array(t.itemCount_),o=0;o<t.itemCount_;o++)e[o]=Blockly.JavaScript.valueToCode(t,"ADD"+o,Blockly.JavaScript.ORDER_COMMA)||"null";return["["+e.join(", ")+"]",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.lists_repeat=function(t){return[Blockly.JavaScript.provideFunction_("listsRepeat",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(value, n) {","  var array = [];","  for (var i = 0; i < n; i++) {","    array[i] = value;","  }","  return array;","}"])+"("+(Blockly.JavaScript.valueToCode(t,"ITEM",Blockly.JavaScript.ORDER_COMMA)||"null")+", "+(t=Blockly.JavaScript.valueToCode(t,"NUM",Blockly.JavaScript.ORDER_COMMA)||"0")+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists_length=function(t){return[(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]")+".length",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.lists_isEmpty=function(t){return["!"+(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]")+".length",Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.JavaScript.lists_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",o=Blockly.JavaScript.valueToCode(t,"FIND",Blockly.JavaScript.ORDER_NONE)||"''";return e=(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"[]")+"."+e+"("+o+")",t.workspace.options.oneBasedIndex?[e+" + 1",Blockly.JavaScript.ORDER_ADDITION]:[e,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists_getIndex=function(t){var e=t.getFieldValue("MODE")||"GET",o=t.getFieldValue("WHERE")||"FROM_START",l=Blockly.JavaScript.valueToCode(t,"VALUE","RANDOM"==o?Blockly.JavaScript.ORDER_COMMA:Blockly.JavaScript.ORDER_MEMBER)||"[]";switch(o){case"FIRST":if("GET"==e)return[l+"[0]",Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[l+".shift()",Blockly.JavaScript.ORDER_MEMBER];if("REMOVE"==e)return l+".shift();\n";break;case"LAST":if("GET"==e)return[l+".slice(-1)[0]",Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[l+".pop()",Blockly.JavaScript.ORDER_MEMBER];if("REMOVE"==e)return l+".pop();\n";break;case"FROM_START":if(t=Blockly.JavaScript.getAdjusted(t,"AT"),"GET"==e)return[l+"["+t+"]",Blockly.JavaScript.ORDER_MEMBER];if("GET_REMOVE"==e)return[l+".splice("+t+", 1)[0]",Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return l+".splice("+t+", 1);\n";break;case"FROM_END":if(t=Blockly.JavaScript.getAdjusted(t,"AT",1,!0),"GET"==e)return[l+".slice("+t+")[0]",Blockly.JavaScript.ORDER_FUNCTION_CALL];if("GET_REMOVE"==e)return[l+".splice("+t+", 1)[0]",Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return l+".splice("+t+", 1);";break;case"RANDOM":if(l=Blockly.JavaScript.provideFunction_("listsGetRandomItem",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list, remove) {","  var x = Math.floor(Math.random() * list.length);","  if (remove) {","    return list.splice(x, 1)[0];","  } else {","    return list[x];","  }","}"])+"("+l+", "+("GET"!=e)+")","GET"==e||"GET_REMOVE"==e)return[l,Blockly.JavaScript.ORDER_FUNCTION_CALL];if("REMOVE"==e)return l+";\n"}throw Error("Unhandled combination (lists_getIndex).")},Blockly.JavaScript.lists_setIndex=function(t){function e(){if(o.match(/^\w+$/))return"";var t=Blockly.JavaScript.variableDB_.getDistinctName("tmpList",Blockly.Variables.NAME_TYPE),e="var "+t+" = "+o+";\n";return o=t,e}var o=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",l=t.getFieldValue("MODE")||"GET",i=t.getFieldValue("WHERE")||"FROM_START",n=Blockly.JavaScript.valueToCode(t,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"null";switch(i){case"FIRST":if("SET"==l)return o+"[0] = "+n+";\n";if("INSERT"==l)return o+".unshift("+n+");\n";break;case"LAST":if("SET"==l)return(t=e())+(o+"[")+o+".length - 1] = "+n+";\n";if("INSERT"==l)return o+".push("+n+");\n";break;case"FROM_START":if(i=Blockly.JavaScript.getAdjusted(t,"AT"),"SET"==l)return o+"["+i+"] = "+n+";\n";if("INSERT"==l)return o+".splice("+i+", 0, "+n+");\n";break;case"FROM_END":if(i=Blockly.JavaScript.getAdjusted(t,"AT",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION),t=e(),"SET"==l)return t+(o+"[")+o+".length - "+i+"] = "+n+";\n";if("INSERT"==l)return t+(o+".splice(")+o+".length - "+i+", 0, "+n+");\n";break;case"RANDOM":if(t=e(),t+="var "+(i=Blockly.JavaScript.variableDB_.getDistinctName("tmpX",Blockly.Variables.NAME_TYPE))+" = Math.floor(Math.random() * "+o+".length);\n","SET"==l)return t+(o+"[")+i+"] = "+n+";\n";if("INSERT"==l)return t+(o+".splice(")+i+", 0, "+n+");\n"}throw Error("Unhandled combination (lists_setIndex).")},Blockly.JavaScript.lists.getIndex_=function(t,e,o){return"FIRST"==e?"0":"FROM_END"==e?t+".length - 1 - "+o:"LAST"==e?t+".length - 1":o},Blockly.JavaScript.lists_getSublist=function(t){var e=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",o=t.getFieldValue("WHERE1"),l=t.getFieldValue("WHERE2");if("FIRST"==o&&"LAST"==l)e+=".slice(0)";else if(e.match(/^\w+$/)||"FROM_END"!=o&&"FROM_START"==l){switch(o){case"FROM_START":var i=Blockly.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":i=e+".length - "+(i=Blockly.JavaScript.getAdjusted(t,"AT1",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":i="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(l){case"FROM_START":t=Blockly.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=e+".length - "+(t=Blockly.JavaScript.getAdjusted(t,"AT2",0,!1,Blockly.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=e+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}e=e+".slice("+i+", "+t+")"}else{i=Blockly.JavaScript.getAdjusted(t,"AT1"),t=Blockly.JavaScript.getAdjusted(t,"AT2");var n=Blockly.JavaScript.lists.getIndex_,r={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=Blockly.JavaScript.provideFunction_("subsequence"+r[o]+r[l],["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==l||"FROM_START"==l?", at2":"")+") {","  var start = "+n("sequence",o,"at1")+";","  var end = "+n("sequence",l,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+e+("FROM_END"==o||"FROM_START"==o?", "+i:"")+("FROM_END"==l||"FROM_START"==l?", "+t:"")+")"}return[e,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists_sort=function(t){var e=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"[]",o="1"===t.getFieldValue("DIRECTION")?1:-1;return t=t.getFieldValue("TYPE"),[e+".slice().sort("+Blockly.JavaScript.provideFunction_("listsGetSortCompare",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(type, direction) {","  var compareFuncs = {",'    "NUMERIC": function(a, b) {',"        return Number(a) - Number(b); },",'    "TEXT": function(a, b) {',"        return a.toString() > b.toString() ? 1 : -1; },",'    "IGNORE_CASE": function(a, b) {',"        return a.toString().toLowerCase() > b.toString().toLowerCase() ? 1 : -1; },","  };","  var compare = compareFuncs[type];","  return function(a, b) { return compare(a, b) * direction; }","}"])+'("'+t+'", '+o+"))",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists_split=function(t){var e=Blockly.JavaScript.valueToCode(t,"INPUT",Blockly.JavaScript.ORDER_MEMBER),o=Blockly.JavaScript.valueToCode(t,"DELIM",Blockly.JavaScript.ORDER_NONE)||"''";if("SPLIT"==(t=t.getFieldValue("MODE")))e||(e="''"),t="split";else{if("JOIN"!=t)throw Error("Unknown mode: "+t);e||(e="[]"),t="join"}return[e+"."+t+"("+o+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.lists_reverse=function(t){return[(Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"[]")+".slice().reverse()",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.logic={},Blockly.JavaScript.controls_if=function(t){var e=0,o="";Blockly.JavaScript.STATEMENT_PREFIX&&(o+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,t));do{var l=Blockly.JavaScript.valueToCode(t,"IF"+e,Blockly.JavaScript.ORDER_NONE)||"false",i=Blockly.JavaScript.statementToCode(t,"DO"+e);Blockly.JavaScript.STATEMENT_SUFFIX&&(i=Blockly.JavaScript.prefixLines(Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,t),Blockly.JavaScript.INDENT)+i),o+=(0<e?" else ":"")+"if ("+l+") {\n"+i+"}",++e}while(t.getInput("IF"+e));return(t.getInput("ELSE")||Blockly.JavaScript.STATEMENT_SUFFIX)&&(i=Blockly.JavaScript.statementToCode(t,"ELSE"),Blockly.JavaScript.STATEMENT_SUFFIX&&(i=Blockly.JavaScript.prefixLines(Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,t),Blockly.JavaScript.INDENT)+i),o+=" else {\n"+i+"}"),o+"\n"},Blockly.JavaScript.controls_ifelse=Blockly.JavaScript.controls_if,Blockly.JavaScript.logic_compare=function(t){var e={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[t.getFieldValue("OP")],o="=="==e||"!="==e?Blockly.JavaScript.ORDER_EQUALITY:Blockly.JavaScript.ORDER_RELATIONAL;return[(Blockly.JavaScript.valueToCode(t,"A",o)||"0")+" "+e+" "+(t=Blockly.JavaScript.valueToCode(t,"B",o)||"0"),o]},Blockly.JavaScript.logic_operation=function(t){var e="AND"==t.getFieldValue("OP")?"&&":"||",o="&&"==e?Blockly.JavaScript.ORDER_LOGICAL_AND:Blockly.JavaScript.ORDER_LOGICAL_OR,l=Blockly.JavaScript.valueToCode(t,"A",o);if(t=Blockly.JavaScript.valueToCode(t,"B",o),l||t){var i="&&"==e?"true":"false";l||(l=i),t||(t=i)}else t=l="false";return[l+" "+e+" "+t,o]},Blockly.JavaScript.logic_negate=function(t){var e=Blockly.JavaScript.ORDER_LOGICAL_NOT;return["!"+(Blockly.JavaScript.valueToCode(t,"BOOL",e)||"true"),e]},Blockly.JavaScript.logic_boolean=function(t){return["TRUE"==t.getFieldValue("BOOL")?"true":"false",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.logic_null=function(t){return["null",Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.logic_ternary=function(t){return[(Blockly.JavaScript.valueToCode(t,"IF",Blockly.JavaScript.ORDER_CONDITIONAL)||"false")+" ? "+(Blockly.JavaScript.valueToCode(t,"THEN",Blockly.JavaScript.ORDER_CONDITIONAL)||"null")+" : "+(t=Blockly.JavaScript.valueToCode(t,"ELSE",Blockly.JavaScript.ORDER_CONDITIONAL)||"null"),Blockly.JavaScript.ORDER_CONDITIONAL]},Blockly.JavaScript.loops={},Blockly.JavaScript.controls_repeat_ext=function(t){var e=t.getField("TIMES")?String(Number(t.getFieldValue("TIMES"))):Blockly.JavaScript.valueToCode(t,"TIMES",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",o=Blockly.JavaScript.statementToCode(t,"DO");o=Blockly.JavaScript.addLoopTrap(o,t),t="";var l=Blockly.JavaScript.variableDB_.getDistinctName("count",Blockly.Variables.NAME_TYPE),i=e;return e.match(/^\w+$/)||Blockly.isNumber(e)||(t+="var "+(i=Blockly.JavaScript.variableDB_.getDistinctName("repeat_end",Blockly.Variables.NAME_TYPE))+" = "+e+";\n"),t+"for (var "+l+" = 0; "+l+" < "+i+"; "+l+"++) {\n"+o+"}\n"},Blockly.JavaScript.controls_repeat=Blockly.JavaScript.controls_repeat_ext,Blockly.JavaScript.controls_whileUntil=function(t){var e="UNTIL"==t.getFieldValue("MODE"),o=Blockly.JavaScript.valueToCode(t,"BOOL",e?Blockly.JavaScript.ORDER_LOGICAL_NOT:Blockly.JavaScript.ORDER_NONE)||"false",l=Blockly.JavaScript.statementToCode(t,"DO");return e&&(o="!"+o),"while ("+o+") {\n"+(l=Blockly.JavaScript.addLoopTrap(l,t))+"}\n"},Blockly.JavaScript.controls_for=function(t){var e=Blockly.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(t,"FROM",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",l=Blockly.JavaScript.valueToCode(t,"TO",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0",i=Blockly.JavaScript.valueToCode(t,"BY",Blockly.JavaScript.ORDER_ASSIGNMENT)||"1",n=Blockly.JavaScript.statementToCode(t,"DO");if(n=Blockly.JavaScript.addLoopTrap(n,t),Blockly.isNumber(o)&&Blockly.isNumber(l)&&Blockly.isNumber(i)){var r=Number(o)<=Number(l);t="for ("+e+" = "+o+"; "+e+(r?" <= ":" >= ")+l+"; "+e,t=(1==(e=Math.abs(Number(i)))?t+(r?"++":"--"):t+(r?" += ":" -= ")+e)+") {\n"+n+"}\n"}else t="",r=o,o.match(/^\w+$/)||Blockly.isNumber(o)||(t+="var "+(r=Blockly.JavaScript.variableDB_.getDistinctName(e+"_start",Blockly.Variables.NAME_TYPE))+" = "+o+";\n"),o=l,l.match(/^\w+$/)||Blockly.isNumber(l)||(t+="var "+(o=Blockly.JavaScript.variableDB_.getDistinctName(e+"_end",Blockly.Variables.NAME_TYPE))+" = "+l+";\n"),t+="var "+(l=Blockly.JavaScript.variableDB_.getDistinctName(e+"_inc",Blockly.Variables.NAME_TYPE))+" = ",t=(t=Blockly.isNumber(i)?t+(Math.abs(i)+";\n"):t+"Math.abs("+i+");\n")+"if ("+r+" > "+o+") {\n"+(Blockly.JavaScript.INDENT+l)+" = -"+l+";\n",t+="}\n",t+="for ("+e+" = "+r+"; "+l+" >= 0 ? "+e+" <= "+o+" : "+e+" >= "+o+"; "+e+" += "+l+") {\n"+n+"}\n";return t},Blockly.JavaScript.controls_forEach=function(t){var e=Blockly.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),o=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_ASSIGNMENT)||"[]",l=Blockly.JavaScript.statementToCode(t,"DO");l=Blockly.JavaScript.addLoopTrap(l,t),t="";var i=o;return o.match(/^\w+$/)||(t+="var "+(i=Blockly.JavaScript.variableDB_.getDistinctName(e+"_list",Blockly.Variables.NAME_TYPE))+" = "+o+";\n"),t+"for (var "+(o=Blockly.JavaScript.variableDB_.getDistinctName(e+"_index",Blockly.Variables.NAME_TYPE))+" in "+i+") {\n"+(l=Blockly.JavaScript.INDENT+e+" = "+i+"["+o+"];\n"+l)+"}\n"},Blockly.JavaScript.controls_flow_statements=function(t){var e="";if(Blockly.JavaScript.STATEMENT_PREFIX&&(e+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,t)),Blockly.JavaScript.STATEMENT_SUFFIX&&(e+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,t)),Blockly.JavaScript.STATEMENT_PREFIX){var o=Blockly.Constants.Loops.CONTROL_FLOW_IN_LOOP_CHECK_MIXIN.getSurroundLoop(t);o&&!o.suppressPrefixSuffix&&(e+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,o))}switch(t.getFieldValue("FLOW")){case"BREAK":return e+"break;\n";case"CONTINUE":return e+"continue;\n"}throw Error("Unknown flow statement.")},Blockly.JavaScript.math={},Blockly.JavaScript.math_number=function(t){return[t=Number(t.getFieldValue("NUM")),0<=t?Blockly.JavaScript.ORDER_ATOMIC:Blockly.JavaScript.ORDER_UNARY_NEGATION]},Blockly.JavaScript.math_arithmetic=function(t){var e={ADD:[" + ",Blockly.JavaScript.ORDER_ADDITION],MINUS:[" - ",Blockly.JavaScript.ORDER_SUBTRACTION],MULTIPLY:[" * ",Blockly.JavaScript.ORDER_MULTIPLICATION],DIVIDE:[" / ",Blockly.JavaScript.ORDER_DIVISION],POWER:[null,Blockly.JavaScript.ORDER_COMMA]}[t.getFieldValue("OP")],o=e[0],l=Blockly.JavaScript.valueToCode(t,"A",e=e[1])||"0";return t=Blockly.JavaScript.valueToCode(t,"B",e)||"0",o?[l+o+t,e]:["Math.pow("+l+", "+t+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_single=function(t){var e=t.getFieldValue("OP");if("NEG"==e)return"-"==(t=Blockly.JavaScript.valueToCode(t,"NUM",Blockly.JavaScript.ORDER_UNARY_NEGATION)||"0")[0]&&(t=" "+t),["-"+t,Blockly.JavaScript.ORDER_UNARY_NEGATION];switch(t="SIN"==e||"COS"==e||"TAN"==e?Blockly.JavaScript.valueToCode(t,"NUM",Blockly.JavaScript.ORDER_DIVISION)||"0":Blockly.JavaScript.valueToCode(t,"NUM",Blockly.JavaScript.ORDER_NONE)||"0",e){case"ABS":var o="Math.abs("+t+")";break;case"ROOT":o="Math.sqrt("+t+")";break;case"LN":o="Math.log("+t+")";break;case"EXP":o="Math.exp("+t+")";break;case"POW10":o="Math.pow(10,"+t+")";break;case"ROUND":o="Math.round("+t+")";break;case"ROUNDUP":o="Math.ceil("+t+")";break;case"ROUNDDOWN":o="Math.floor("+t+")";break;case"SIN":o="Math.sin("+t+" / 180 * Math.PI)";break;case"COS":o="Math.cos("+t+" / 180 * Math.PI)";break;case"TAN":o="Math.tan("+t+" / 180 * Math.PI)"}if(o)return[o,Blockly.JavaScript.ORDER_FUNCTION_CALL];switch(e){case"LOG10":o="Math.log("+t+") / Math.log(10)";break;case"ASIN":o="Math.asin("+t+") / Math.PI * 180";break;case"ACOS":o="Math.acos("+t+") / Math.PI * 180";break;case"ATAN":o="Math.atan("+t+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+e)}return[o,Blockly.JavaScript.ORDER_DIVISION]},Blockly.JavaScript.math_constant=function(t){return{PI:["Math.PI",Blockly.JavaScript.ORDER_MEMBER],E:["Math.E",Blockly.JavaScript.ORDER_MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",Blockly.JavaScript.ORDER_DIVISION],SQRT2:["Math.SQRT2",Blockly.JavaScript.ORDER_MEMBER],SQRT1_2:["Math.SQRT1_2",Blockly.JavaScript.ORDER_MEMBER],INFINITY:["Infinity",Blockly.JavaScript.ORDER_ATOMIC]}[t.getFieldValue("CONSTANT")]},Blockly.JavaScript.math_number_property=function(t){var e=Blockly.JavaScript.valueToCode(t,"NUMBER_TO_CHECK",Blockly.JavaScript.ORDER_MODULUS)||"0",o=t.getFieldValue("PROPERTY");if("PRIME"==o)return[Blockly.JavaScript.provideFunction_("mathIsPrime",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(n) {","  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods","  if (n == 2 || n == 3) {","    return true;","  }","  // False if n is NaN, negative, is 1, or not whole.","  // And false if n is divisible by 2 or 3.","  if (isNaN(n) || n <= 1 || n % 1 != 0 || n % 2 == 0 || n % 3 == 0) {","    return false;","  }","  // Check all the numbers of form 6k +/- 1, up to sqrt(n).","  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {","    if (n % (x - 1) == 0 || n % (x + 1) == 0) {","      return false;","    }","  }","  return true;","}"])+"("+e+")",Blockly.JavaScript.ORDER_FUNCTION_CALL];switch(o){case"EVEN":var l=e+" % 2 == 0";break;case"ODD":l=e+" % 2 == 1";break;case"WHOLE":l=e+" % 1 == 0";break;case"POSITIVE":l=e+" > 0";break;case"NEGATIVE":l=e+" < 0";break;case"DIVISIBLE_BY":l=e+" % "+(t=Blockly.JavaScript.valueToCode(t,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0")+" == 0"}return[l,Blockly.JavaScript.ORDER_EQUALITY]},Blockly.JavaScript.math_change=function(t){var e=Blockly.JavaScript.valueToCode(t,"DELTA",Blockly.JavaScript.ORDER_ADDITION)||"0";return(t=Blockly.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE))+" = (typeof "+t+" == 'number' ? "+t+" : 0) + "+e+";\n"},Blockly.JavaScript.math_round=Blockly.JavaScript.math_single,Blockly.JavaScript.math_trig=Blockly.JavaScript.math_single,Blockly.JavaScript.math_on_list=function(t){var e=t.getFieldValue("OP");switch(e){case"SUM":t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_MEMBER)||"[]",t+=".reduce(function(x, y) {return x + y;})";break;case"MIN":t="Math.min.apply(null, "+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]")+")";break;case"MAX":t="Math.max.apply(null, "+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_COMMA)||"[]")+")";break;case"AVERAGE":t=(e=Blockly.JavaScript.provideFunction_("mathMean",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  return myList.reduce(function(x, y) {return x + y;}) / myList.length;","}"]))+"("+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"MEDIAN":t=(e=Blockly.JavaScript.provideFunction_("mathMedian",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(myList) {","  var localList = myList.filter(function (x) {return typeof x == 'number';});","  if (!localList.length) return null;","  localList.sort(function(a, b) {return b - a;});","  if (localList.length % 2 == 0) {","    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;","  } else {","    return localList[(localList.length - 1) / 2];","  }","}"]))+"("+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"MODE":t=(e=Blockly.JavaScript.provideFunction_("mathModes",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(values) {","  var modes = [];","  var counts = [];","  var maxCount = 0;","  for (var i = 0; i < values.length; i++) {","    var value = values[i];","    var found = false;","    var thisCount;","    for (var j = 0; j < counts.length; j++) {","      if (counts[j][0] === value) {","        thisCount = ++counts[j][1];","        found = true;","        break;","      }","    }","    if (!found) {","      counts.push([value, 1]);","      thisCount = 1;","    }","    maxCount = Math.max(thisCount, maxCount);","  }","  for (var j = 0; j < counts.length; j++) {","    if (counts[j][1] == maxCount) {","        modes.push(counts[j][0]);","    }","  }","  return modes;","}"]))+"("+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"STD_DEV":t=(e=Blockly.JavaScript.provideFunction_("mathStandardDeviation",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(numbers) {","  var n = numbers.length;","  if (!n) return null;","  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;","  var variance = 0;","  for (var j = 0; j < n; j++) {","    variance += Math.pow(numbers[j] - mean, 2);","  }","  variance = variance / n;","  return Math.sqrt(variance);","}"]))+"("+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;case"RANDOM":t=(e=Blockly.JavaScript.provideFunction_("mathRandomList",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(list) {","  var x = Math.floor(Math.random() * list.length);","  return list[x];","}"]))+"("+(t=Blockly.JavaScript.valueToCode(t,"LIST",Blockly.JavaScript.ORDER_NONE)||"[]")+")";break;default:throw Error("Unknown operator: "+e)}return[t,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_modulo=function(t){return[(Blockly.JavaScript.valueToCode(t,"DIVIDEND",Blockly.JavaScript.ORDER_MODULUS)||"0")+" % "+(t=Blockly.JavaScript.valueToCode(t,"DIVISOR",Blockly.JavaScript.ORDER_MODULUS)||"0"),Blockly.JavaScript.ORDER_MODULUS]},Blockly.JavaScript.math_constrain=function(t){return["Math.min(Math.max("+(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_COMMA)||"0")+", "+(Blockly.JavaScript.valueToCode(t,"LOW",Blockly.JavaScript.ORDER_COMMA)||"0")+"), "+(t=Blockly.JavaScript.valueToCode(t,"HIGH",Blockly.JavaScript.ORDER_COMMA)||"Infinity")+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_random_int=function(t){var e=Blockly.JavaScript.valueToCode(t,"FROM",Blockly.JavaScript.ORDER_COMMA)||"0";return t=Blockly.JavaScript.valueToCode(t,"TO",Blockly.JavaScript.ORDER_COMMA)||"0",[Blockly.JavaScript.provideFunction_("mathRandomInt",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(a, b) {","  if (a > b) {","    // Swap a and b to ensure a is smaller.","    var c = a;","    a = b;","    b = c;","  }","  return Math.floor(Math.random() * (b - a + 1) + a);","}"])+"("+e+", "+t+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_random_float=function(t){return["Math.random()",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.math_atan2=function(t){var e=Blockly.JavaScript.valueToCode(t,"X",Blockly.JavaScript.ORDER_COMMA)||"0";return["Math.atan2("+(Blockly.JavaScript.valueToCode(t,"Y",Blockly.JavaScript.ORDER_COMMA)||"0")+", "+e+") / Math.PI * 180",Blockly.JavaScript.ORDER_DIVISION]},Blockly.JavaScript.procedures={},Blockly.JavaScript.procedures_defreturn=function(t){var e=Blockly.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),o="";Blockly.JavaScript.STATEMENT_PREFIX&&(o+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_PREFIX,t)),Blockly.JavaScript.STATEMENT_SUFFIX&&(o+=Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,t)),o&&(o=Blockly.JavaScript.prefixLines(o,Blockly.JavaScript.INDENT));var l="";Blockly.JavaScript.INFINITE_LOOP_TRAP&&(l=Blockly.JavaScript.prefixLines(Blockly.JavaScript.injectId(Blockly.JavaScript.INFINITE_LOOP_TRAP,t),Blockly.JavaScript.INDENT));var i=Blockly.JavaScript.statementToCode(t,"STACK"),n=Blockly.JavaScript.valueToCode(t,"RETURN",Blockly.JavaScript.ORDER_NONE)||"",r="";i&&n&&(r=o),n&&(n=Blockly.JavaScript.INDENT+"return "+n+";\n");for(var s=[],c=0;c<t.arguments_.length;c++)s[c]=Blockly.JavaScript.variableDB_.getName(t.arguments_[c],Blockly.Variables.NAME_TYPE);return o="function "+e+"("+s.join(", ")+") {\n"+o+l+i+r+n+"}",o=Blockly.JavaScript.scrub_(t,o),Blockly.JavaScript.definitions_["%"+e]=o,null},Blockly.JavaScript.procedures_defnoreturn=Blockly.JavaScript.procedures_defreturn,Blockly.JavaScript.procedures_callreturn=function(t){for(var e=Blockly.JavaScript.variableDB_.getName(t.getFieldValue("NAME"),Blockly.Procedures.NAME_TYPE),o=[],l=0;l<t.arguments_.length;l++)o[l]=Blockly.JavaScript.valueToCode(t,"ARG"+l,Blockly.JavaScript.ORDER_COMMA)||"null";return[e+"("+o.join(", ")+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.procedures_callnoreturn=function(t){return Blockly.JavaScript.procedures_callreturn(t)[0]+";\n"},Blockly.JavaScript.procedures_ifreturn=function(t){var e="if ("+(Blockly.JavaScript.valueToCode(t,"CONDITION",Blockly.JavaScript.ORDER_NONE)||"false")+") {\n";return Blockly.JavaScript.STATEMENT_SUFFIX&&(e+=Blockly.JavaScript.prefixLines(Blockly.JavaScript.injectId(Blockly.JavaScript.STATEMENT_SUFFIX,t),Blockly.JavaScript.INDENT)),t.hasReturnValue_?(t=Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_NONE)||"null",e+=Blockly.JavaScript.INDENT+"return "+t+";\n"):e+=Blockly.JavaScript.INDENT+"return;\n",e+"}\n"},Blockly.JavaScript.texts={},Blockly.JavaScript.text=function(t){return[Blockly.JavaScript.quote_(t.getFieldValue("TEXT")),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.text_multiline=function(t){return(t=Blockly.JavaScript.multiline_quote_(t.getFieldValue("TEXT"))).includes("\n")&&(t="("+t+")"),[t,Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.text.forceString_=function(t){return Blockly.JavaScript.text.forceString_.strRegExp.test(t)?t:"String("+t+")"},Blockly.JavaScript.text.forceString_.strRegExp=/^\s*'([^']|\\')*'\s*$/,Blockly.JavaScript.text_join=function(t){switch(t.itemCount_){case 0:return["''",Blockly.JavaScript.ORDER_ATOMIC];case 1:return t=Blockly.JavaScript.valueToCode(t,"ADD0",Blockly.JavaScript.ORDER_NONE)||"''",[t=Blockly.JavaScript.text.forceString_(t),Blockly.JavaScript.ORDER_FUNCTION_CALL];case 2:var e=Blockly.JavaScript.valueToCode(t,"ADD0",Blockly.JavaScript.ORDER_NONE)||"''";return t=Blockly.JavaScript.valueToCode(t,"ADD1",Blockly.JavaScript.ORDER_NONE)||"''",[t=Blockly.JavaScript.text.forceString_(e)+" + "+Blockly.JavaScript.text.forceString_(t),Blockly.JavaScript.ORDER_ADDITION];default:e=Array(t.itemCount_);for(var o=0;o<t.itemCount_;o++)e[o]=Blockly.JavaScript.valueToCode(t,"ADD"+o,Blockly.JavaScript.ORDER_COMMA)||"''";return[t="["+e.join(",")+"].join('')",Blockly.JavaScript.ORDER_FUNCTION_CALL]}},Blockly.JavaScript.text_append=function(t){var e=Blockly.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE);return t=Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''",e+" += "+Blockly.JavaScript.text.forceString_(t)+";\n"},Blockly.JavaScript.text_length=function(t){return[(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''")+".length",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.text_isEmpty=function(t){return["!"+(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''")+".length",Blockly.JavaScript.ORDER_LOGICAL_NOT]},Blockly.JavaScript.text_indexOf=function(t){var e="FIRST"==t.getFieldValue("END")?"indexOf":"lastIndexOf",o=Blockly.JavaScript.valueToCode(t,"FIND",Blockly.JavaScript.ORDER_NONE)||"''";return e=(Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_MEMBER)||"''")+"."+e+"("+o+")",t.workspace.options.oneBasedIndex?[e+" + 1",Blockly.JavaScript.ORDER_ADDITION]:[e,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_charAt=function(t){var e=t.getFieldValue("WHERE")||"FROM_START",o=Blockly.JavaScript.valueToCode(t,"VALUE","RANDOM"==e?Blockly.JavaScript.ORDER_NONE:Blockly.JavaScript.ORDER_MEMBER)||"''";switch(e){case"FIRST":return[o+".charAt(0)",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"LAST":return[o+".slice(-1)",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"FROM_START":return[o+".charAt("+(t=Blockly.JavaScript.getAdjusted(t,"AT"))+")",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"FROM_END":return[o+".slice("+(t=Blockly.JavaScript.getAdjusted(t,"AT",1,!0))+").charAt(0)",Blockly.JavaScript.ORDER_FUNCTION_CALL];case"RANDOM":return[Blockly.JavaScript.provideFunction_("textRandomLetter",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(text) {","  var x = Math.floor(Math.random() * text.length);","  return text[x];","}"])+"("+o+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},Blockly.JavaScript.text.getIndex_=function(t,e,o){return"FIRST"==e?"0":"FROM_END"==e?t+".length - 1 - "+o:"LAST"==e?t+".length - 1":o},Blockly.JavaScript.text_getSubstring=function(t){var e=Blockly.JavaScript.valueToCode(t,"STRING",Blockly.JavaScript.ORDER_FUNCTION_CALL)||"''",o=t.getFieldValue("WHERE1"),l=t.getFieldValue("WHERE2");if("FIRST"!=o||"LAST"!=l)if(e.match(/^'?\w+'?$/)||"FROM_END"!=o&&"LAST"!=o&&"FROM_END"!=l&&"LAST"!=l){switch(o){case"FROM_START":var i=Blockly.JavaScript.getAdjusted(t,"AT1");break;case"FROM_END":i=e+".length - "+(i=Blockly.JavaScript.getAdjusted(t,"AT1",1,!1,Blockly.JavaScript.ORDER_SUBTRACTION));break;case"FIRST":i="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(l){case"FROM_START":t=Blockly.JavaScript.getAdjusted(t,"AT2",1);break;case"FROM_END":t=e+".length - "+(t=Blockly.JavaScript.getAdjusted(t,"AT2",0,!1,Blockly.JavaScript.ORDER_SUBTRACTION));break;case"LAST":t=e+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}e=e+".slice("+i+", "+t+")"}else{i=Blockly.JavaScript.getAdjusted(t,"AT1"),t=Blockly.JavaScript.getAdjusted(t,"AT2");var n=Blockly.JavaScript.text.getIndex_,r={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};e=Blockly.JavaScript.provideFunction_("subsequence"+r[o]+r[l],["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(sequence"+("FROM_END"==o||"FROM_START"==o?", at1":"")+("FROM_END"==l||"FROM_START"==l?", at2":"")+") {","  var start = "+n("sequence",o,"at1")+";","  var end = "+n("sequence",l,"at2")+" + 1;","  return sequence.slice(start, end);","}"])+"("+e+("FROM_END"==o||"FROM_START"==o?", "+i:"")+("FROM_END"==l||"FROM_START"==l?", "+t:"")+")"}return[e,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_changeCase=function(t){var e={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[t.getFieldValue("CASE")];return t=Blockly.JavaScript.valueToCode(t,"TEXT",e?Blockly.JavaScript.ORDER_MEMBER:Blockly.JavaScript.ORDER_NONE)||"''",[e?t+e:Blockly.JavaScript.provideFunction_("textToTitleCase",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(str) {","  return str.replace(/\\S+/g,","      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});","}"])+"("+t+")",Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_trim=function(t){var e={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[t.getFieldValue("MODE")];return[(Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''")+e,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_print=function(t){return"window.alert("+(Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''")+");\n"},Blockly.JavaScript.text_prompt_ext=function(t){var e="window.prompt("+(t.getField("TEXT")?Blockly.JavaScript.quote_(t.getFieldValue("TEXT")):Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_NONE)||"''")+")";return"NUMBER"==t.getFieldValue("TYPE")&&(e="Number("+e+")"),[e,Blockly.JavaScript.ORDER_FUNCTION_CALL]},Blockly.JavaScript.text_prompt=Blockly.JavaScript.text_prompt_ext,Blockly.JavaScript.text_count=function(t){var e=Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''";return t=Blockly.JavaScript.valueToCode(t,"SUB",Blockly.JavaScript.ORDER_NONE)||"''",[Blockly.JavaScript.provideFunction_("textCount",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle) {","  if (needle.length === 0) {","    return haystack.length + 1;","  } else {","    return haystack.split(needle).length - 1;","  }","}"])+"("+e+", "+t+")",Blockly.JavaScript.ORDER_SUBTRACTION]},Blockly.JavaScript.text_replace=function(t){var e=Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''",o=Blockly.JavaScript.valueToCode(t,"FROM",Blockly.JavaScript.ORDER_NONE)||"''";return t=Blockly.JavaScript.valueToCode(t,"TO",Blockly.JavaScript.ORDER_NONE)||"''",[Blockly.JavaScript.provideFunction_("textReplace",["function "+Blockly.JavaScript.FUNCTION_NAME_PLACEHOLDER_+"(haystack, needle, replacement) {",'  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g,"\\\\$1")','                 .replace(/\\x08/g,"\\\\x08");',"  return haystack.replace(new RegExp(needle, 'g'), replacement);","}"])+"("+e+", "+o+", "+t+")",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.text_reverse=function(t){return[(Blockly.JavaScript.valueToCode(t,"TEXT",Blockly.JavaScript.ORDER_MEMBER)||"''")+".split('').reverse().join('')",Blockly.JavaScript.ORDER_MEMBER]},Blockly.JavaScript.variables={},Blockly.JavaScript.variables_get=function(t){return[Blockly.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE),Blockly.JavaScript.ORDER_ATOMIC]},Blockly.JavaScript.variables_set=function(t){var e=Blockly.JavaScript.valueToCode(t,"VALUE",Blockly.JavaScript.ORDER_ASSIGNMENT)||"0";return Blockly.JavaScript.variableDB_.getName(t.getFieldValue("VAR"),Blockly.Variables.NAME_TYPE)+" = "+e+";\n"},Blockly.JavaScript.variablesDynamic={},Blockly.JavaScript.variables_get_dynamic=Blockly.JavaScript.variables_get,Blockly.JavaScript.variables_set_dynamic=Blockly.JavaScript.variables_set,Blockly.Msg.ADD_COMMENT="Añadir comentario",Blockly.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="No se puede eliminar la variable '%1' porque es parte de la definición de la función '%2'",Blockly.Msg.CHANGE_VALUE_TITLE="Cambiar el valor:",Blockly.Msg.CLEAN_UP="Limpiar los bloques",Blockly.Msg.COLLAPSED_WARNINGS_WARNING="Bloques colapsados contienen advertencias.",Blockly.Msg.COLLAPSE_ALL="Contraer bloques",Blockly.Msg.COLLAPSE_BLOCK="Contraer bloque",Blockly.Msg.COLOUR_BLEND_COLOUR1="color 1",Blockly.Msg.COLOUR_BLEND_COLOUR2="color 2",Blockly.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",Blockly.Msg.COLOUR_BLEND_RATIO="proporción",Blockly.Msg.COLOUR_BLEND_TITLE="combinar",Blockly.Msg.COLOUR_BLEND_TOOLTIP="Combina dos colores con una proporción determinada (0,0-1,0).",Blockly.Msg.COLOUR_PICKER_HELPURL="https://es.wikipedia.org/wiki/Color",Blockly.Msg.COLOUR_PICKER_TOOLTIP="Elige un color de la paleta.",Blockly.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",Blockly.Msg.COLOUR_RANDOM_TITLE="color aleatorio",Blockly.Msg.COLOUR_RANDOM_TOOLTIP="Elige un color al azar.",Blockly.Msg.COLOUR_RGB_BLUE="azul",Blockly.Msg.COLOUR_RGB_GREEN="verde",Blockly.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",Blockly.Msg.COLOUR_RGB_RED="rojo",Blockly.Msg.COLOUR_RGB_TITLE="colorear con",Blockly.Msg.COLOUR_RGB_TOOLTIP="Crea un color con cantidades específicas de rojo, verde y azul. Todos los valores deben encontrarse entre 0 y 100.",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="romper el bucle",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continuar con la siguiente iteración del bucle",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Romper el bucle que lo contiene.",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Saltar el resto de este bucle, y continuar con la siguiente iteración.",Blockly.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Atención: este bloque puede usarse solamente dentro de un bucle.",Blockly.Msg.CONTROLS_FOREACH_HELPURL="https://es.wikipedia.org/wiki/Foreach",Blockly.Msg.CONTROLS_FOREACH_TITLE="para cada elemento %1 en la lista %2",Blockly.Msg.CONTROLS_FOREACH_TOOLTIP="Para cada elemento en una lista, establecer la variable '%1' al elemento y luego hacer algunas declaraciones.",Blockly.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",Blockly.Msg.CONTROLS_FOR_TITLE="contar con %1 desde %2 hasta %3 de a %4",Blockly.Msg.CONTROLS_FOR_TOOLTIP='Hacer que la variable "%1" tome los valores desde el número de inicio hasta el número final, contando con el intervalo especificado, y hacer los bloques especificados.',Blockly.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Agregar una condición a este bloque.",Blockly.Msg.CONTROLS_IF_ELSE_TOOLTIP="Agregar una condición general final a este bloque.",Blockly.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",Blockly.Msg.CONTROLS_IF_IF_TOOLTIP="Agregar, eliminar o reordenar las secciones para reconfigurar este bloque.",Blockly.Msg.CONTROLS_IF_MSG_ELSE="sino",Blockly.Msg.CONTROLS_IF_MSG_ELSEIF="sino si",Blockly.Msg.CONTROLS_IF_MSG_IF="si",Blockly.Msg.CONTROLS_IF_TOOLTIP_1="Si un valor es verdadero, entonces hacer algunas declaraciones.",Blockly.Msg.CONTROLS_IF_TOOLTIP_2="Si un valor es verdadero, entonces hacer el primer bloque de declaraciones.  De lo contrario, hacer el segundo bloque de declaraciones.",Blockly.Msg.CONTROLS_IF_TOOLTIP_3="Si el primer valor es verdadero, entonces hacer el primer bloque de declaraciones. De lo contrario, si el segundo valor es verdadero, hacer el segundo bloque de declaraciones.",Blockly.Msg.CONTROLS_IF_TOOLTIP_4="Si el primer valor es verdadero, entonces hacer el primer bloque de declaraciones. De lo contrario, si el segundo valor es verdadero, hacer el segundo bloque de declaraciones. Si ninguno de los valores son verdaderos, hacer el último bloque de declaraciones.",Blockly.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",Blockly.Msg.CONTROLS_REPEAT_INPUT_DO="hacer",Blockly.Msg.CONTROLS_REPEAT_TITLE="repetir %1 veces",Blockly.Msg.CONTROLS_REPEAT_TOOLTIP="Hacer algunas declaraciones varias veces.",Blockly.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repetir hasta",Blockly.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repetir mientras",Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="Mientras un valor sea falso, entonces hacer algunas declaraciones.",Blockly.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="Mientras un valor sea verdadero, entonces hacer algunas declaraciones.",Blockly.Msg.DELETE_ALL_BLOCKS="¿Eliminar todos los %1 bloques?",Blockly.Msg.DELETE_BLOCK="Eliminar bloque",Blockly.Msg.DELETE_VARIABLE='Borrar la variable "%1"',Blockly.Msg.DELETE_VARIABLE_CONFIRMATION="¿Borrar %1 usos de la variable '%2'?",Blockly.Msg.DELETE_X_BLOCKS="Eliminar %1 bloques",Blockly.Msg.DISABLE_BLOCK="Desactivar bloque",Blockly.Msg.DUPLICATE_BLOCK="Duplicar",Blockly.Msg.DUPLICATE_COMMENT="Duplicar comentario",Blockly.Msg.ENABLE_BLOCK="Activar bloque",Blockly.Msg.EXPAND_ALL="Expandir bloques",Blockly.Msg.EXPAND_BLOCK="Expandir bloque",Blockly.Msg.EXTERNAL_INPUTS="Entradas externas",Blockly.Msg.HELP="Ayuda",Blockly.Msg.INLINE_INPUTS="Entradas en línea",Blockly.Msg.IOS_CANCEL="Cancelar",Blockly.Msg.IOS_ERROR="Error",Blockly.Msg.IOS_OK="Aceptar",Blockly.Msg.IOS_PROCEDURES_ADD_INPUT="+ Añadir entrada",Blockly.Msg.IOS_PROCEDURES_ALLOW_STATEMENTS="Permitir declaraciones",Blockly.Msg.IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR="Esta función tiene entradas duplicadas.",Blockly.Msg.IOS_PROCEDURES_INPUTS="ENTRADAS",Blockly.Msg.IOS_VARIABLES_ADD_BUTTON="Añadir",Blockly.Msg.IOS_VARIABLES_ADD_VARIABLE="+ Añadir variable",Blockly.Msg.IOS_VARIABLES_DELETE_BUTTON="Borrar",Blockly.Msg.IOS_VARIABLES_EMPTY_NAME_ERROR="No puedes usar un nombre de variable vacío.",Blockly.Msg.IOS_VARIABLES_RENAME_BUTTON="Renombrar",Blockly.Msg.IOS_VARIABLES_VARIABLE_NAME="Nombre de la variable",Blockly.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",Blockly.Msg.LISTS_CREATE_EMPTY_TITLE="crear lista vacía",Blockly.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Devuelve una lista, de longitud 0, sin ningún dato",Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="lista",Blockly.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Agregar, eliminar o reorganizar las secciones para reconfigurar este bloque de lista.",Blockly.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",Blockly.Msg.LISTS_CREATE_WITH_INPUT_WITH="crear lista con",Blockly.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Agregar un elemento a la lista.",Blockly.Msg.LISTS_CREATE_WITH_TOOLTIP="Crear una lista con cualquier número de elementos.",Blockly.Msg.LISTS_GET_INDEX_FIRST="primero",Blockly.Msg.LISTS_GET_INDEX_FROM_END="# del final",Blockly.Msg.LISTS_GET_INDEX_FROM_START="#",Blockly.Msg.LISTS_GET_INDEX_GET="obtener",Blockly.Msg.LISTS_GET_INDEX_GET_REMOVE="obtener y eliminar",Blockly.Msg.LISTS_GET_INDEX_LAST="último",Blockly.Msg.LISTS_GET_INDEX_RANDOM="aleatorio",Blockly.Msg.LISTS_GET_INDEX_REMOVE="eliminar",Blockly.Msg.LISTS_GET_INDEX_TAIL="",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Devuelve el primer elemento de una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Devuelve el elemento en la posición especificada en una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Devuelve el último elemento de una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Devuelve un elemento aleatorio en una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Elimina y devuelve el primer elemento de una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Elimina y devuelve el elemento en la posición especificada en una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Elimina y devuelve el último elemento de una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Elimina y devuelve un elemento aleatorio en una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Elimina el primer elemento de una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Elimina el elemento en la posición especificada en una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Elimina el último elemento de una lista.",Blockly.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Elimina un elemento aleatorio en una lista.",Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_END="hasta # del final",Blockly.Msg.LISTS_GET_SUBLIST_END_FROM_START="hasta #",Blockly.Msg.LISTS_GET_SUBLIST_END_LAST="hasta el último",Blockly.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",Blockly.Msg.LISTS_GET_SUBLIST_START_FIRST="obtener sublista desde el primero",Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_END="obtener sublista desde # del final",Blockly.Msg.LISTS_GET_SUBLIST_START_FROM_START="obtener sublista desde #",Blockly.Msg.LISTS_GET_SUBLIST_TAIL="",Blockly.Msg.LISTS_GET_SUBLIST_TOOLTIP="Crea una copia de la parte especificada de una lista.",Blockly.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 es el último elemento.",Blockly.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 es el primer elemento.",Blockly.Msg.LISTS_INDEX_OF_FIRST="encontrar la primera aparición del elemento",Blockly.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",Blockly.Msg.LISTS_INDEX_OF_LAST="encontrar la última aparición del elemento",Blockly.Msg.LISTS_INDEX_OF_TOOLTIP="Devuelve el índice de la primera/última aparición del elemento en la lista. Devuelve %1 si el elemento no se encuentra.",Blockly.Msg.LISTS_INLIST="en la lista",Blockly.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",Blockly.Msg.LISTS_ISEMPTY_TITLE="%1 está vacía",Blockly.Msg.LISTS_ISEMPTY_TOOLTIP="Devuelve verdadero si la lista está vacía.",Blockly.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",Blockly.Msg.LISTS_LENGTH_TITLE="longitud de %1",Blockly.Msg.LISTS_LENGTH_TOOLTIP="Devuelve la longitud de una lista.",Blockly.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",Blockly.Msg.LISTS_REPEAT_TITLE="crear lista con el elemento %1 repetido %2 veces",Blockly.Msg.LISTS_REPEAT_TOOLTIP="Crea una lista que consta de un valor dado repetido el número de veces especificado.",Blockly.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",Blockly.Msg.LISTS_REVERSE_MESSAGE0="invertir %1",Blockly.Msg.LISTS_REVERSE_TOOLTIP="Invertir una copia de una lista.",Blockly.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",Blockly.Msg.LISTS_SET_INDEX_INPUT_TO="como",Blockly.Msg.LISTS_SET_INDEX_INSERT="insertar en",Blockly.Msg.LISTS_SET_INDEX_SET="establecer",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserta el elemento al inicio de una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserta el elemento en la posición especificada en una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Añade el elemento al final de una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserta el elemento aleatoriamente en una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Establece el primer elemento de una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Establece el elemento en la posición especificada en una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Establece el último elemento de una lista.",Blockly.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Establece un elemento aleatorio en una lista.",Blockly.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",Blockly.Msg.LISTS_SORT_ORDER_ASCENDING="ascendente",Blockly.Msg.LISTS_SORT_ORDER_DESCENDING="descendente",Blockly.Msg.LISTS_SORT_TITLE="orden %1 %2 %3",Blockly.Msg.LISTS_SORT_TOOLTIP="Ordenar una copia de una lista.",Blockly.Msg.LISTS_SORT_TYPE_IGNORECASE="alfabético, ignorar mayúscula/minúscula",Blockly.Msg.LISTS_SORT_TYPE_NUMERIC="numérico",Blockly.Msg.LISTS_SORT_TYPE_TEXT="alfabético",Blockly.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",Blockly.Msg.LISTS_SPLIT_LIST_FROM_TEXT="hacer lista a partir de texto",Blockly.Msg.LISTS_SPLIT_TEXT_FROM_LIST="hacer texto a partir de lista",Blockly.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Unir una lista de textos en un solo texto, separado por un delimitador.",Blockly.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Dividir el texto en una lista de textos, separando en cada delimitador.",Blockly.Msg.LISTS_SPLIT_WITH_DELIMITER="con delimitador",Blockly.Msg.LOGIC_BOOLEAN_FALSE="falso",Blockly.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",Blockly.Msg.LOGIC_BOOLEAN_TOOLTIP="Devuelve verdadero o falso.",Blockly.Msg.LOGIC_BOOLEAN_TRUE="verdadero",Blockly.Msg.LOGIC_COMPARE_HELPURL="https://es.wikipedia.org/wiki/Desigualdad_matemática",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Devuelve verdadero si ambas entradas son iguales.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GT="Devuelve verdadero si la primera entrada es mayor que la segunda entrada.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Devuelve verdadero si la primera entrada es mayor o igual a la segunda entrada.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LT="Devuelve verdadero si la primera entrada es menor que la segunda entrada.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Devuelve verdadero si la primera entrada es menor que o igual a la segunda entrada.",Blockly.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Devuelve verdadero si ambas entradas son distintas.",Blockly.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",Blockly.Msg.LOGIC_NEGATE_TITLE="no %1",Blockly.Msg.LOGIC_NEGATE_TOOLTIP="Devuelve verdadero si la entrada es falsa. Devuelve falso si la entrada es verdadera.",Blockly.Msg.LOGIC_NULL="nulo",Blockly.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",Blockly.Msg.LOGIC_NULL_TOOLTIP="Devuelve nulo.",Blockly.Msg.LOGIC_OPERATION_AND="y",Blockly.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",Blockly.Msg.LOGIC_OPERATION_OR="o",Blockly.Msg.LOGIC_OPERATION_TOOLTIP_AND="Devuelve verdadero si ambas entradas son verdaderas.",Blockly.Msg.LOGIC_OPERATION_TOOLTIP_OR="Devuelve verdadero si al menos una de las entradas es verdadera.",Blockly.Msg.LOGIC_TERNARY_CONDITION="prueba",Blockly.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",Blockly.Msg.LOGIC_TERNARY_IF_FALSE="si es falso",Blockly.Msg.LOGIC_TERNARY_IF_TRUE="si es verdadero",Blockly.Msg.LOGIC_TERNARY_TOOLTIP='Comprueba la condición en "prueba". Si la condición es verdadera, devuelve el valor "si es verdadero"; de lo contrario, devuelve el valor "si es falso".',Blockly.Msg.MATH_ADDITION_SYMBOL="+",Blockly.Msg.MATH_ARITHMETIC_HELPURL="https://es.wikipedia.org/wiki/Aritmética",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Devuelve la suma de ambos números.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Devuelve el cociente de ambos números.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Devuelve la diferencia de ambos números.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Devuelve el producto de ambos números.",Blockly.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Devuelve el primer número elevado a la potencia del segundo.",Blockly.Msg.MATH_ATAN2_HELPURL="https://es.wikipedia.org/wiki/Arcotangente_de_dos_par%C3%A1metros",Blockly.Msg.MATH_ATAN2_TITLE="Arcotangente de X:%1 Y:%2",Blockly.Msg.MATH_ATAN2_TOOLTIP="Regresar el arcotangente del punto (X,Y) en grados de -180 a 180.",Blockly.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",Blockly.Msg.MATH_CHANGE_TITLE="añadir %2 a %1",Blockly.Msg.MATH_CHANGE_TOOLTIP="Añadir un número a la variable «%1».",Blockly.Msg.MATH_CONSTANT_HELPURL="https://es.wikipedia.org/wiki/Anexo:Constantes_matemáticas",Blockly.Msg.MATH_CONSTANT_TOOLTIP="Devuelve una de las constantes comunes: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…) o ∞ (infinito).",Blockly.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",Blockly.Msg.MATH_CONSTRAIN_TITLE="limitar %1 entre %2 y %3",Blockly.Msg.MATH_CONSTRAIN_TOOLTIP="Limitar un número entre los límites especificados (inclusive).",Blockly.Msg.MATH_DIVISION_SYMBOL="÷",Blockly.Msg.MATH_IS_DIVISIBLE_BY="es divisible por",Blockly.Msg.MATH_IS_EVEN="es par",Blockly.Msg.MATH_IS_NEGATIVE="es negativo",Blockly.Msg.MATH_IS_ODD="es impar",Blockly.Msg.MATH_IS_POSITIVE="es positivo",Blockly.Msg.MATH_IS_PRIME="es primo",Blockly.Msg.MATH_IS_TOOLTIP="Comprueba si un número es par, impar, primo, entero, positivo, negativo, o si es divisible por un número determinado. Devuelve verdadero o falso.",Blockly.Msg.MATH_IS_WHOLE="es entero",Blockly.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",Blockly.Msg.MATH_MODULO_TITLE="resto de %1 ÷ %2",Blockly.Msg.MATH_MODULO_TOOLTIP="Devuelve el resto al dividir los dos números.",Blockly.Msg.MATH_MULTIPLICATION_SYMBOL="×",Blockly.Msg.MATH_NUMBER_HELPURL="https://es.wikipedia.org/wiki/Número",Blockly.Msg.MATH_NUMBER_TOOLTIP="Un número.",Blockly.Msg.MATH_ONLIST_HELPURL="",Blockly.Msg.MATH_ONLIST_OPERATOR_AVERAGE="promedio de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_MAX="máximo de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_MEDIAN="mediana de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_MIN="mínimo de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_MODE="modas de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_RANDOM="elemento aleatorio de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_STD_DEV="desviación estándar de la lista",Blockly.Msg.MATH_ONLIST_OPERATOR_SUM="suma de la lista",Blockly.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Devuelve el promedio (media aritmética) de los valores numéricos en la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MAX="Devuelve el número más grande en la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Devuelve la mediana en la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MIN="Devuelve el número más pequeño en la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_MODE="Devuelve una lista de los elementos más comunes en la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Devuelve un elemento aleatorio de la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Devuelve la desviación estándar de la lista.",Blockly.Msg.MATH_ONLIST_TOOLTIP_SUM="Devuelve la suma de todos los números en la lista.",Blockly.Msg.MATH_POWER_SYMBOL="^",Blockly.Msg.MATH_RANDOM_FLOAT_HELPURL="https://es.wikipedia.org/wiki/Generador_de_números_aleatorios",Blockly.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="fracción aleatoria",Blockly.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Devuelve una fracción aleatoria entre 0,0 (ambos inclusive) y 1.0 (exclusivo).",Blockly.Msg.MATH_RANDOM_INT_HELPURL="https://es.wikipedia.org/wiki/Generador_de_números_aleatorios",Blockly.Msg.MATH_RANDOM_INT_TITLE="entero aleatorio de %1 a %2",Blockly.Msg.MATH_RANDOM_INT_TOOLTIP="Devuelve un entero aleatorio entre los dos límites especificados, inclusive.",Blockly.Msg.MATH_ROUND_HELPURL="https://es.wikipedia.org/wiki/Redondeo",Blockly.Msg.MATH_ROUND_OPERATOR_ROUND="redondear",Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="redondear a la baja",Blockly.Msg.MATH_ROUND_OPERATOR_ROUNDUP="redondear al alza",Blockly.Msg.MATH_ROUND_TOOLTIP="Redondear un número al alza o a la baja.",Blockly.Msg.MATH_SINGLE_HELPURL="https://es.wikipedia.org/wiki/Ra%C3%ADz_cuadrada",Blockly.Msg.MATH_SINGLE_OP_ABSOLUTE="absoluto",Blockly.Msg.MATH_SINGLE_OP_ROOT="raíz cuadrada",Blockly.Msg.MATH_SINGLE_TOOLTIP_ABS="Devuelve el valor absoluto de un número.",Blockly.Msg.MATH_SINGLE_TOOLTIP_EXP="Devuelve e a la potencia de un número.",Blockly.Msg.MATH_SINGLE_TOOLTIP_LN="Devuelve el logaritmo natural de un número.",Blockly.Msg.MATH_SINGLE_TOOLTIP_LOG10="Devuelve el logaritmo base 10 de un número.",Blockly.Msg.MATH_SINGLE_TOOLTIP_NEG="Devuelve la negación de un número.",Blockly.Msg.MATH_SINGLE_TOOLTIP_POW10="Devuelve 10 a la potencia de un número.",Blockly.Msg.MATH_SINGLE_TOOLTIP_ROOT="Devuelve la raíz cuadrada de un número.",Blockly.Msg.MATH_SUBTRACTION_SYMBOL="-",Blockly.Msg.MATH_TRIG_ACOS="acos",Blockly.Msg.MATH_TRIG_ASIN="asin",Blockly.Msg.MATH_TRIG_ATAN="atan",Blockly.Msg.MATH_TRIG_COS="cos",Blockly.Msg.MATH_TRIG_HELPURL="https://es.wikipedia.org/wiki/Función_trigonométrica",Blockly.Msg.MATH_TRIG_SIN="sin",Blockly.Msg.MATH_TRIG_TAN="tan",Blockly.Msg.MATH_TRIG_TOOLTIP_ACOS="Devuelve el arcocoseno de un número.",Blockly.Msg.MATH_TRIG_TOOLTIP_ASIN="Devuelve el arcoseno de un número.",Blockly.Msg.MATH_TRIG_TOOLTIP_ATAN="Devuelve el arcotangente de un número.",Blockly.Msg.MATH_TRIG_TOOLTIP_COS="Devuelve el coseno de un grado (no radián).",Blockly.Msg.MATH_TRIG_TOOLTIP_SIN="Devuelve el seno de un grado (no radián).",Blockly.Msg.MATH_TRIG_TOOLTIP_TAN="Devuelve la tangente de un grado (no radián).",Blockly.Msg.NEW_COLOUR_VARIABLE="Crear una variable de color...",Blockly.Msg.NEW_NUMBER_VARIABLE="Crear una variable de número...",Blockly.Msg.NEW_STRING_VARIABLE="Crear una cadena variable...",Blockly.Msg.NEW_VARIABLE="Crear variable…",Blockly.Msg.NEW_VARIABLE_TITLE="Nombre de variable nueva:",Blockly.Msg.NEW_VARIABLE_TYPE_TITLE="Nuevo tipo de variable:",Blockly.Msg.ORDINAL_NUMBER_SUFFIX="",Blockly.Msg.PROCEDURES_ALLOW_STATEMENTS="permitir declaraciones",Blockly.Msg.PROCEDURES_BEFORE_PARAMS="con:",Blockly.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://es.wikipedia.org/wiki/Subrutina",Blockly.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Ejecuta la función definida por el usuario '%1'.",Blockly.Msg.PROCEDURES_CALLRETURN_HELPURL="https://es.wikipedia.org/wiki/Subrutina",Blockly.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Ejecuta la función definida por el usuario '%1' y usa su salida.",Blockly.Msg.PROCEDURES_CALL_BEFORE_PARAMS="con:",Blockly.Msg.PROCEDURES_CREATE_DO="Crear '%1'",Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe esta función...",Blockly.Msg.PROCEDURES_DEFNORETURN_DO="",Blockly.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="hacer algo",Blockly.Msg.PROCEDURES_DEFNORETURN_TITLE="para",Blockly.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Crea una función sin salida.",Blockly.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",Blockly.Msg.PROCEDURES_DEFRETURN_RETURN="devuelve",Blockly.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Crea una función con una salida.",Blockly.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Advertencia: Esta función tiene parámetros duplicados.",Blockly.Msg.PROCEDURES_HIGHLIGHT_DEF="Destacar definición de la función",Blockly.Msg.PROCEDURES_IFRETURN_HELPURL="http://c2.com/cgi/wiki?GuardClause",Blockly.Msg.PROCEDURES_IFRETURN_TOOLTIP="Si un valor es verdadero, entonces devuelve un segundo valor.",Blockly.Msg.PROCEDURES_IFRETURN_WARNING="Advertencia: Este bloque solo puede ser utilizado dentro de la definición de una función.",Blockly.Msg.PROCEDURES_MUTATORARG_TITLE="nombre de entrada:",Blockly.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Añadir una entrada a la función.",Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="entradas",Blockly.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Añadir, eliminar o reordenar entradas para esta función.",Blockly.Msg.REDO="Rehacer",Blockly.Msg.REMOVE_COMMENT="Eliminar comentario",Blockly.Msg.RENAME_VARIABLE="Cambiar nombre de variable…",Blockly.Msg.RENAME_VARIABLE_TITLE="Renombrar todas las variables «%1» a:",Blockly.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",Blockly.Msg.TEXT_APPEND_TITLE="a %1 añade el texto %2",Blockly.Msg.TEXT_APPEND_TOOLTIP="Añadir texto a la variable '%1'.",Blockly.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",Blockly.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="a minúsculas",Blockly.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="a Mayúsculas Cada Palabra",Blockly.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="a MAYÚSCULAS",Blockly.Msg.TEXT_CHANGECASE_TOOLTIP="Devuelve una copia del texto en un tamaño diferente.",Blockly.Msg.TEXT_CHARAT_FIRST="obtener la primera letra",Blockly.Msg.TEXT_CHARAT_FROM_END="obtener la letra # del final",Blockly.Msg.TEXT_CHARAT_FROM_START="obtener la letra #",Blockly.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",Blockly.Msg.TEXT_CHARAT_LAST="obtener la última letra",Blockly.Msg.TEXT_CHARAT_RANDOM="obtener letra aleatoria",Blockly.Msg.TEXT_CHARAT_TAIL="",Blockly.Msg.TEXT_CHARAT_TITLE="en el texto %1 %2",Blockly.Msg.TEXT_CHARAT_TOOLTIP="Devuelve la letra en la posición especificada.",Blockly.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",Blockly.Msg.TEXT_COUNT_MESSAGE0="contar %1 en %2",Blockly.Msg.TEXT_COUNT_TOOLTIP="Cuantas veces aparece un texto dentro de otro texto.",Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Agregar un elemento al texto.",Blockly.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="unir",Blockly.Msg.TEXT_CREATE_JOIN_TOOLTIP="Agregar, eliminar o reordenar las secciones para reconfigurar este bloque de texto.",Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_END="hasta la letra # del final",Blockly.Msg.TEXT_GET_SUBSTRING_END_FROM_START="hasta la letra #",Blockly.Msg.TEXT_GET_SUBSTRING_END_LAST="hasta la última letra",Blockly.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",Blockly.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="en el texto",Blockly.Msg.TEXT_GET_SUBSTRING_START_FIRST="obtener subcadena desde la primera letra",Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_END="obtener subcadena desde la letra # del final",Blockly.Msg.TEXT_GET_SUBSTRING_START_FROM_START="obtener subcadena desde la letra #",Blockly.Msg.TEXT_GET_SUBSTRING_TAIL="",Blockly.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Devuelve una porción determinada del texto.",Blockly.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",Blockly.Msg.TEXT_INDEXOF_OPERATOR_FIRST="encontrar la primera aparición del texto",Blockly.Msg.TEXT_INDEXOF_OPERATOR_LAST="encontrar la última aparición del texto",Blockly.Msg.TEXT_INDEXOF_TITLE="en el texto %1 %2 %3",Blockly.Msg.TEXT_INDEXOF_TOOLTIP="Devuelve el índice de la primera/última aparición del primer texto en el segundo texto. Devuelve %1 si el texto no se encuentra.",Blockly.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",Blockly.Msg.TEXT_ISEMPTY_TITLE="%1 está vacío",Blockly.Msg.TEXT_ISEMPTY_TOOLTIP="Devuelve verdadero si el texto proporcionado está vacío.",Blockly.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",Blockly.Msg.TEXT_JOIN_TITLE_CREATEWITH="crear texto con",Blockly.Msg.TEXT_JOIN_TOOLTIP="Crear un fragmento de texto al unir cualquier número de elementos.",Blockly.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",Blockly.Msg.TEXT_LENGTH_TITLE="longitud de %1",Blockly.Msg.TEXT_LENGTH_TOOLTIP="Devuelve el número de letras (espacios incluidos) del texto proporcionado.",Blockly.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",Blockly.Msg.TEXT_PRINT_TITLE="imprimir %1",Blockly.Msg.TEXT_PRINT_TOOLTIP="Imprimir el texto, número u otro valor especificado.",Blockly.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",Blockly.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Solicitar al usuario un número.",Blockly.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Solicitar al usuario un texto.",Blockly.Msg.TEXT_PROMPT_TYPE_NUMBER="solicitar número con el mensaje",Blockly.Msg.TEXT_PROMPT_TYPE_TEXT="solicitar texto con el mensaje",Blockly.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",Blockly.Msg.TEXT_REPLACE_MESSAGE0="reemplazar %1 con %2 en %3",Blockly.Msg.TEXT_REPLACE_TOOLTIP="Reemplazar todas las veces que un texto dentro de otro texto.",Blockly.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",Blockly.Msg.TEXT_REVERSE_MESSAGE0="invertir %1",Blockly.Msg.TEXT_REVERSE_TOOLTIP="Invierte el orden de los caracteres en el texto.",Blockly.Msg.TEXT_TEXT_HELPURL="https://es.wikipedia.org/wiki/Cadena_de_caracteres",Blockly.Msg.TEXT_TEXT_TOOLTIP="Una letra, palabra o línea de texto.",Blockly.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",Blockly.Msg.TEXT_TRIM_OPERATOR_BOTH="quitar espacios de ambos lados de",Blockly.Msg.TEXT_TRIM_OPERATOR_LEFT="quitar espacios iniciales de",Blockly.Msg.TEXT_TRIM_OPERATOR_RIGHT="quitar espacios finales de",Blockly.Msg.TEXT_TRIM_TOOLTIP="Devuelve una copia del texto sin los espacios de uno o ambos extremos.",Blockly.Msg.TODAY="Hoy",Blockly.Msg.UNDO="Deshacer",Blockly.Msg.UNNAMED_KEY="unnamed",Blockly.Msg.VARIABLES_DEFAULT_NAME="elemento",Blockly.Msg.VARIABLES_GET_CREATE_SET="Crear 'establecer %1'",Blockly.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",Blockly.Msg.VARIABLES_GET_TOOLTIP="Devuelve el valor de esta variable.",Blockly.Msg.VARIABLES_SET="establecer %1 a %2",Blockly.Msg.VARIABLES_SET_CREATE_GET="Crear 'obtener %1'",Blockly.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",Blockly.Msg.VARIABLES_SET_TOOLTIP="Establece esta variable para que sea igual a la entrada.",Blockly.Msg.VARIABLE_ALREADY_EXISTS="Ya existe una variable llamada '%1'.",Blockly.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="Ya existe una variable nombrada '%1' para otra variable del tipo: '%2'.",Blockly.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Di algo…",Blockly.Msg.CONTROLS_FOREACH_INPUT_DO=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.CONTROLS_FOR_INPUT_DO=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=Blockly.Msg.CONTROLS_IF_MSG_ELSEIF,Blockly.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=Blockly.Msg.CONTROLS_IF_MSG_ELSE,Blockly.Msg.CONTROLS_IF_IF_TITLE_IF=Blockly.Msg.CONTROLS_IF_MSG_IF,Blockly.Msg.CONTROLS_IF_MSG_THEN=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=Blockly.Msg.CONTROLS_REPEAT_INPUT_DO,Blockly.Msg.LISTS_CREATE_WITH_ITEM_TITLE=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.LISTS_GET_INDEX_HELPURL=Blockly.Msg.LISTS_INDEX_OF_HELPURL,Blockly.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=Blockly.Msg.LISTS_INLIST,Blockly.Msg.MATH_CHANGE_TITLE_ITEM=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.PROCEDURES_DEFRETURN_COMMENT=Blockly.Msg.PROCEDURES_DEFNORETURN_COMMENT,Blockly.Msg.PROCEDURES_DEFRETURN_DO=Blockly.Msg.PROCEDURES_DEFNORETURN_DO,Blockly.Msg.PROCEDURES_DEFRETURN_PROCEDURE=Blockly.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,Blockly.Msg.PROCEDURES_DEFRETURN_TITLE=Blockly.Msg.PROCEDURES_DEFNORETURN_TITLE,Blockly.Msg.TEXT_APPEND_VARIABLE=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=Blockly.Msg.VARIABLES_DEFAULT_NAME,Blockly.Msg.MATH_HUE="230",Blockly.Msg.LOOPS_HUE="120",Blockly.Msg.LISTS_HUE="260",Blockly.Msg.LOGIC_HUE="210",Blockly.Msg.VARIABLES_HUE="330",Blockly.Msg.TEXTS_HUE="160",Blockly.Msg.PROCEDURES_HUE="290",Blockly.Msg.COLOUR_HUE="20",Blockly.Msg.VARIABLES_DYNAMIC_HUE="310",function(t,e){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){var o=[],l=t.document,i=Object.getPrototypeOf,n=o.slice,r=o.concat,s=o.push,c=o.indexOf,a={},u=a.toString,h=a.hasOwnProperty,p=h.toString,y=p.call(Object),k={},d=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},_=function(t){return null!=t&&t===t.window},B={type:!0,src:!0,nonce:!0,noModule:!0};function g(t,e,o){var i,n,r=(o=o||l).createElement("script");if(r.text=t,e)for(i in B)(n=e[i]||e.getAttribute&&e.getAttribute(i))&&r.setAttribute(i,n);o.head.appendChild(r).parentNode.removeChild(r)}function T(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?a[u.call(t)]||"object":typeof t}var f="3.4.1",E=function(t,e){return new E.fn.init(t,e)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;function m(t){var e=!!t&&"length"in t&&t.length,o=T(t);return!d(t)&&!_(t)&&("array"===o||0===e||"number"==typeof e&&0<e&&e-1 in t)}E.fn=E.prototype={jquery:f,constructor:E,length:0,toArray:function(){return n.call(this)},get:function(t){return null==t?n.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=E.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return E.each(this,t)},map:function(t){return this.pushStack(E.map(this,(function(e,o){return t.call(e,o,e)})))},slice:function(){return this.pushStack(n.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,o=+t+(t<0?e:0);return this.pushStack(0<=o&&o<e?[this[o]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:o.sort,splice:o.splice},E.extend=E.fn.extend=function(){var t,e,o,l,i,n,r=arguments[0]||{},s=1,c=arguments.length,a=!1;for("boolean"==typeof r&&(a=r,r=arguments[s]||{},s++),"object"==typeof r||d(r)||(r={}),s===c&&(r=this,s--);s<c;s++)if(null!=(t=arguments[s]))for(e in t)l=t[e],"__proto__"!==e&&r!==l&&(a&&l&&(E.isPlainObject(l)||(i=Array.isArray(l)))?(o=r[e],n=i&&!Array.isArray(o)?[]:i||E.isPlainObject(o)?o:{},i=!1,r[e]=E.extend(a,n,l)):void 0!==l&&(r[e]=l));return r},E.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,o;return!(!t||"[object Object]"!==u.call(t)||(e=i(t))&&("function"!=typeof(o=h.call(e,"constructor")&&e.constructor)||p.call(o)!==y))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e){g(t,{nonce:e&&e.nonce})},each:function(t,e){var o,l=0;if(m(t))for(o=t.length;l<o&&!1!==e.call(t[l],l,t[l]);l++);else for(l in t)if(!1===e.call(t[l],l,t[l]))break;return t},trim:function(t){return null==t?"":(t+"").replace(v,"")},makeArray:function(t,e){var o=e||[];return null!=t&&(m(Object(t))?E.merge(o,"string"==typeof t?[t]:t):s.call(o,t)),o},inArray:function(t,e,o){return null==e?-1:c.call(e,t,o)},merge:function(t,e){for(var o=+e.length,l=0,i=t.length;l<o;l++)t[i++]=e[l];return t.length=i,t},grep:function(t,e,o){for(var l=[],i=0,n=t.length,r=!o;i<n;i++)!e(t[i],i)!==r&&l.push(t[i]);return l},map:function(t,e,o){var l,i,n=0,s=[];if(m(t))for(l=t.length;n<l;n++)null!=(i=e(t[n],n,o))&&s.push(i);else for(n in t)null!=(i=e(t[n],n,o))&&s.push(i);return r.apply([],s)},guid:1,support:k}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=o[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){a["[object "+e+"]"]=e.toLowerCase()}));var b=function(t){var e,o,l,i,n,r,s,c,a,u,h,p,y,k,d,_,B,g,T,f="sizzle"+1*new Date,E=t.document,v=0,m=0,b=ct(),S=ct(),C=ct(),R=ct(),I=function(t,e){return t===e&&(h=!0),0},O={}.hasOwnProperty,A=[],D=A.pop,N=A.push,M=A.push,L=A.slice,w=function(t,e){for(var o=0,l=t.length;o<l;o++)if(t[o]===e)return o;return-1},x="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",U="\\["+P+"*("+F+")(?:"+P+"*([*^$|!~]?=)"+P+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+F+"))|)"+P+"*\\]",H=":("+F+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+U+")*)|.*)\\)|)",V=new RegExp(P+"+","g"),G=new RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),W=new RegExp("^"+P+"*,"+P+"*"),X=new RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),Y=new RegExp(P+"|>"),J=new RegExp(H),K=new RegExp("^"+F+"$"),z={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F+"|[*])"),ATTR:new RegExp("^"+U),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:new RegExp("^(?:"+x+")$","i"),needsContext:new RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},j=/HTML$/i,q=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,$=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),ot=function(t,e,o){var l="0x"+e-65536;return l!=l||o?e:l<0?String.fromCharCode(l+65536):String.fromCharCode(l>>10|55296,1023&l|56320)},lt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,it=function(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},nt=function(){p()},rt=ft((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{M.apply(A=L.call(E.childNodes),E.childNodes)}catch(e){M={apply:A.length?function(t,e){N.apply(t,L.call(e))}:function(t,e){for(var o=t.length,l=0;t[o++]=e[l++];);t.length=o-1}}}function st(t,e,l,i){var n,s,a,u,h,k,B,g=e&&e.ownerDocument,v=e?e.nodeType:9;if(l=l||[],"string"!=typeof t||!t||1!==v&&9!==v&&11!==v)return l;if(!i&&((e?e.ownerDocument||e:E)!==y&&p(e),e=e||y,d)){if(11!==v&&(h=$.exec(t)))if(n=h[1]){if(9===v){if(!(a=e.getElementById(n)))return l;if(a.id===n)return l.push(a),l}else if(g&&(a=g.getElementById(n))&&T(e,a)&&a.id===n)return l.push(a),l}else{if(h[2])return M.apply(l,e.getElementsByTagName(t)),l;if((n=h[3])&&o.getElementsByClassName&&e.getElementsByClassName)return M.apply(l,e.getElementsByClassName(n)),l}if(o.qsa&&!R[t+" "]&&(!_||!_.test(t))&&(1!==v||"object"!==e.nodeName.toLowerCase())){if(B=t,g=e,1===v&&Y.test(t)){for((u=e.getAttribute("id"))?u=u.replace(lt,it):e.setAttribute("id",u=f),s=(k=r(t)).length;s--;)k[s]="#"+u+" "+Tt(k[s]);B=k.join(","),g=tt.test(t)&&Bt(e.parentNode)||e}try{return M.apply(l,g.querySelectorAll(B)),l}catch(e){R(t,!0)}finally{u===f&&e.removeAttribute("id")}}}return c(t.replace(G,"$1"),e,l,i)}function ct(){var t=[];return function e(o,i){return t.push(o+" ")>l.cacheLength&&delete e[t.shift()],e[o+" "]=i}}function at(t){return t[f]=!0,t}function ut(t){var e=y.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ht(t,e){for(var o=t.split("|"),i=o.length;i--;)l.attrHandle[o[i]]=e}function pt(t,e){var o=e&&t,l=o&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(l)return l;if(o)for(;o=o.nextSibling;)if(o===e)return-1;return t?1:-1}function yt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function kt(t){return function(e){var o=e.nodeName.toLowerCase();return("input"===o||"button"===o)&&e.type===t}}function dt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&rt(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function _t(t){return at((function(e){return e=+e,at((function(o,l){for(var i,n=t([],o.length,e),r=n.length;r--;)o[i=n[r]]&&(o[i]=!(l[i]=o[i]))}))}))}function Bt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in o=st.support={},n=st.isXML=function(t){var e=(t.ownerDocument||t).documentElement;return!j.test(t.namespaceURI||e&&e.nodeName||"HTML")},p=st.setDocument=function(t){var e,i,r=t?t.ownerDocument||t:E;return r!==y&&9===r.nodeType&&r.documentElement&&(k=(y=r).documentElement,d=!n(y),E!==y&&(i=y.defaultView)&&i.top!==i&&(i.addEventListener?i.addEventListener("unload",nt,!1):i.attachEvent&&i.attachEvent("onunload",nt)),o.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),o.getElementsByTagName=ut((function(t){return t.appendChild(y.createComment("")),!t.getElementsByTagName("*").length})),o.getElementsByClassName=Q.test(y.getElementsByClassName),o.getById=ut((function(t){return k.appendChild(t).id=f,!y.getElementsByName||!y.getElementsByName(f).length})),o.getById?(l.filter.ID=function(t){var e=t.replace(et,ot);return function(t){return t.getAttribute("id")===e}},l.find.ID=function(t,e){if(void 0!==e.getElementById&&d){var o=e.getElementById(t);return o?[o]:[]}}):(l.filter.ID=function(t){var e=t.replace(et,ot);return function(t){var o=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return o&&o.value===e}},l.find.ID=function(t,e){if(void 0!==e.getElementById&&d){var o,l,i,n=e.getElementById(t);if(n){if((o=n.getAttributeNode("id"))&&o.value===t)return[n];for(i=e.getElementsByName(t),l=0;n=i[l++];)if((o=n.getAttributeNode("id"))&&o.value===t)return[n]}return[]}}),l.find.TAG=o.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):o.qsa?e.querySelectorAll(t):void 0}:function(t,e){var o,l=[],i=0,n=e.getElementsByTagName(t);if("*"===t){for(;o=n[i++];)1===o.nodeType&&l.push(o);return l}return n},l.find.CLASS=o.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&d)return e.getElementsByClassName(t)},B=[],_=[],(o.qsa=Q.test(y.querySelectorAll))&&(ut((function(t){k.appendChild(t).innerHTML="<a id='"+f+"'></a><select id='"+f+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&_.push("[*^$]="+P+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||_.push("\\["+P+"*(?:value|"+x+")"),t.querySelectorAll("[id~="+f+"-]").length||_.push("~="),t.querySelectorAll(":checked").length||_.push(":checked"),t.querySelectorAll("a#"+f+"+*").length||_.push(".#.+[+~]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=y.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&_.push("name"+P+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&_.push(":enabled",":disabled"),k.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&_.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),_.push(",.*:")}))),(o.matchesSelector=Q.test(g=k.matches||k.webkitMatchesSelector||k.mozMatchesSelector||k.oMatchesSelector||k.msMatchesSelector))&&ut((function(t){o.disconnectedMatch=g.call(t,"*"),g.call(t,"[s!='']:x"),B.push("!=",H)})),_=_.length&&new RegExp(_.join("|")),B=B.length&&new RegExp(B.join("|")),e=Q.test(k.compareDocumentPosition),T=e||Q.test(k.contains)?function(t,e){var o=9===t.nodeType?t.documentElement:t,l=e&&e.parentNode;return t===l||!(!l||1!==l.nodeType||!(o.contains?o.contains(l):t.compareDocumentPosition&&16&t.compareDocumentPosition(l)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},I=e?function(t,e){if(t===e)return h=!0,0;var l=!t.compareDocumentPosition-!e.compareDocumentPosition;return l||(1&(l=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!o.sortDetached&&e.compareDocumentPosition(t)===l?t===y||t.ownerDocument===E&&T(E,t)?-1:e===y||e.ownerDocument===E&&T(E,e)?1:u?w(u,t)-w(u,e):0:4&l?-1:1)}:function(t,e){if(t===e)return h=!0,0;var o,l=0,i=t.parentNode,n=e.parentNode,r=[t],s=[e];if(!i||!n)return t===y?-1:e===y?1:i?-1:n?1:u?w(u,t)-w(u,e):0;if(i===n)return pt(t,e);for(o=t;o=o.parentNode;)r.unshift(o);for(o=e;o=o.parentNode;)s.unshift(o);for(;r[l]===s[l];)l++;return l?pt(r[l],s[l]):r[l]===E?-1:s[l]===E?1:0}),y},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if((t.ownerDocument||t)!==y&&p(t),o.matchesSelector&&d&&!R[e+" "]&&(!B||!B.test(e))&&(!_||!_.test(e)))try{var l=g.call(t,e);if(l||o.disconnectedMatch||t.document&&11!==t.document.nodeType)return l}catch(t){R(e,!0)}return 0<st(e,y,null,[t]).length},st.contains=function(t,e){return(t.ownerDocument||t)!==y&&p(t),T(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!==y&&p(t);var i=l.attrHandle[e.toLowerCase()],n=i&&O.call(l.attrHandle,e.toLowerCase())?i(t,e,!d):void 0;return void 0!==n?n:o.attributes||!d?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},st.escape=function(t){return(t+"").replace(lt,it)},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,l=[],i=0,n=0;if(h=!o.detectDuplicates,u=!o.sortStable&&t.slice(0),t.sort(I),h){for(;e=t[n++];)e===t[n]&&(i=l.push(n));for(;i--;)t.splice(l[i],1)}return u=null,t},i=st.getText=function(t){var e,o="",l=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)o+=i(t)}else if(3===n||4===n)return t.nodeValue}else for(;e=t[l++];)o+=i(e);return o},(l=st.selectors={cacheLength:50,createPseudo:at,match:z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,ot),t[3]=(t[3]||t[4]||t[5]||"").replace(et,ot),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,o=!t[6]&&t[2];return z.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":o&&J.test(o)&&(e=r(o,!0))&&(e=o.indexOf(")",o.length-e)-o.length)&&(t[0]=t[0].slice(0,e),t[2]=o.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,ot).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=b[t+" "];return e||(e=new RegExp("(^|"+P+")"+t+"("+P+"|$)"))&&b(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,o){return function(l){var i=st.attr(l,t);return null==i?"!="===e:!e||(i+="","="===e?i===o:"!="===e?i!==o:"^="===e?o&&0===i.indexOf(o):"*="===e?o&&-1<i.indexOf(o):"$="===e?o&&i.slice(-o.length)===o:"~="===e?-1<(" "+i.replace(V," ")+" ").indexOf(o):"|="===e&&(i===o||i.slice(0,o.length+1)===o+"-"))}},CHILD:function(t,e,o,l,i){var n="nth"!==t.slice(0,3),r="last"!==t.slice(-4),s="of-type"===e;return 1===l&&0===i?function(t){return!!t.parentNode}:function(e,o,c){var a,u,h,p,y,k,d=n!==r?"nextSibling":"previousSibling",_=e.parentNode,B=s&&e.nodeName.toLowerCase(),g=!c&&!s,T=!1;if(_){if(n){for(;d;){for(p=e;p=p[d];)if(s?p.nodeName.toLowerCase()===B:1===p.nodeType)return!1;k=d="only"===t&&!k&&"nextSibling"}return!0}if(k=[r?_.firstChild:_.lastChild],r&&g){for(T=(y=(a=(u=(h=(p=_)[f]||(p[f]={}))[p.uniqueID]||(h[p.uniqueID]={}))[t]||[])[0]===v&&a[1])&&a[2],p=y&&_.childNodes[y];p=++y&&p&&p[d]||(T=y=0)||k.pop();)if(1===p.nodeType&&++T&&p===e){u[t]=[v,y,T];break}}else if(g&&(T=y=(a=(u=(h=(p=e)[f]||(p[f]={}))[p.uniqueID]||(h[p.uniqueID]={}))[t]||[])[0]===v&&a[1]),!1===T)for(;(p=++y&&p&&p[d]||(T=y=0)||k.pop())&&((s?p.nodeName.toLowerCase()!==B:1!==p.nodeType)||!++T||(g&&((u=(h=p[f]||(p[f]={}))[p.uniqueID]||(h[p.uniqueID]={}))[t]=[v,T]),p!==e)););return(T-=i)===l||T%l==0&&0<=T/l}}},PSEUDO:function(t,e){var o,i=l.pseudos[t]||l.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return i[f]?i(e):1<i.length?(o=[t,t,"",e],l.setFilters.hasOwnProperty(t.toLowerCase())?at((function(t,o){for(var l,n=i(t,e),r=n.length;r--;)t[l=w(t,n[r])]=!(o[l]=n[r])})):function(t){return i(t,0,o)}):i}},pseudos:{not:at((function(t){var e=[],o=[],l=s(t.replace(G,"$1"));return l[f]?at((function(t,e,o,i){for(var n,r=l(t,null,i,[]),s=t.length;s--;)(n=r[s])&&(t[s]=!(e[s]=n))})):function(t,i,n){return e[0]=t,l(e,null,n,o),e[0]=null,!o.pop()}})),has:at((function(t){return function(e){return 0<st(t,e).length}})),contains:at((function(t){return t=t.replace(et,ot),function(e){return-1<(e.textContent||i(e)).indexOf(t)}})),lang:at((function(t){return K.test(t||"")||st.error("unsupported lang: "+t),t=t.replace(et,ot).toLowerCase(),function(e){var o;do{if(o=d?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(o=o.toLowerCase())===t||0===o.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var o=t.location&&t.location.hash;return o&&o.slice(1)===e.id},root:function(t){return t===k},focus:function(t){return t===y.activeElement&&(!y.hasFocus||y.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:dt(!1),disabled:dt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!l.pseudos.empty(t)},header:function(t){return Z.test(t.nodeName)},input:function(t){return q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:_t((function(){return[0]})),last:_t((function(t,e){return[e-1]})),eq:_t((function(t,e,o){return[o<0?o+e:o]})),even:_t((function(t,e){for(var o=0;o<e;o+=2)t.push(o);return t})),odd:_t((function(t,e){for(var o=1;o<e;o+=2)t.push(o);return t})),lt:_t((function(t,e,o){for(var l=o<0?o+e:e<o?e:o;0<=--l;)t.push(l);return t})),gt:_t((function(t,e,o){for(var l=o<0?o+e:o;++l<e;)t.push(l);return t}))}}).pseudos.nth=l.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})l.pseudos[e]=yt(e);for(e in{submit:!0,reset:!0})l.pseudos[e]=kt(e);function gt(){}function Tt(t){for(var e=0,o=t.length,l="";e<o;e++)l+=t[e].value;return l}function ft(t,e,o){var l=e.dir,i=e.next,n=i||l,r=o&&"parentNode"===n,s=m++;return e.first?function(e,o,i){for(;e=e[l];)if(1===e.nodeType||r)return t(e,o,i);return!1}:function(e,o,c){var a,u,h,p=[v,s];if(c){for(;e=e[l];)if((1===e.nodeType||r)&&t(e,o,c))return!0}else for(;e=e[l];)if(1===e.nodeType||r)if(u=(h=e[f]||(e[f]={}))[e.uniqueID]||(h[e.uniqueID]={}),i&&i===e.nodeName.toLowerCase())e=e[l]||e;else{if((a=u[n])&&a[0]===v&&a[1]===s)return p[2]=a[2];if((u[n]=p)[2]=t(e,o,c))return!0}return!1}}function Et(t){return 1<t.length?function(e,o,l){for(var i=t.length;i--;)if(!t[i](e,o,l))return!1;return!0}:t[0]}function vt(t,e,o,l,i){for(var n,r=[],s=0,c=t.length,a=null!=e;s<c;s++)(n=t[s])&&(o&&!o(n,l,i)||(r.push(n),a&&e.push(s)));return r}function mt(t,e,o,l,i,n){return l&&!l[f]&&(l=mt(l)),i&&!i[f]&&(i=mt(i,n)),at((function(n,r,s,c){var a,u,h,p=[],y=[],k=r.length,d=n||function(t,e,o){for(var l=0,i=e.length;l<i;l++)st(t,e[l],o);return o}(e||"*",s.nodeType?[s]:s,[]),_=!t||!n&&e?d:vt(d,p,t,s,c),B=o?i||(n?t:k||l)?[]:r:_;if(o&&o(_,B,s,c),l)for(a=vt(B,y),l(a,[],s,c),u=a.length;u--;)(h=a[u])&&(B[y[u]]=!(_[y[u]]=h));if(n){if(i||t){if(i){for(a=[],u=B.length;u--;)(h=B[u])&&a.push(_[u]=h);i(null,B=[],a,c)}for(u=B.length;u--;)(h=B[u])&&-1<(a=i?w(n,h):p[u])&&(n[a]=!(r[a]=h))}}else B=vt(B===r?B.splice(k,B.length):B),i?i(null,r,B,c):M.apply(r,B)}))}function bt(t){for(var e,o,i,n=t.length,r=l.relative[t[0].type],s=r||l.relative[" "],c=r?1:0,u=ft((function(t){return t===e}),s,!0),h=ft((function(t){return-1<w(e,t)}),s,!0),p=[function(t,o,l){var i=!r&&(l||o!==a)||((e=o).nodeType?u(t,o,l):h(t,o,l));return e=null,i}];c<n;c++)if(o=l.relative[t[c].type])p=[ft(Et(p),o)];else{if((o=l.filter[t[c].type].apply(null,t[c].matches))[f]){for(i=++c;i<n&&!l.relative[t[i].type];i++);return mt(1<c&&Et(p),1<c&&Tt(t.slice(0,c-1).concat({value:" "===t[c-2].type?"*":""})).replace(G,"$1"),o,c<i&&bt(t.slice(c,i)),i<n&&bt(t=t.slice(i)),i<n&&Tt(t))}p.push(o)}return Et(p)}return gt.prototype=l.filters=l.pseudos,l.setFilters=new gt,r=st.tokenize=function(t,e){var o,i,n,r,s,c,a,u=S[t+" "];if(u)return e?0:u.slice(0);for(s=t,c=[],a=l.preFilter;s;){for(r in o&&!(i=W.exec(s))||(i&&(s=s.slice(i[0].length)||s),c.push(n=[])),o=!1,(i=X.exec(s))&&(o=i.shift(),n.push({value:o,type:i[0].replace(G," ")}),s=s.slice(o.length)),l.filter)!(i=z[r].exec(s))||a[r]&&!(i=a[r](i))||(o=i.shift(),n.push({value:o,type:r,matches:i}),s=s.slice(o.length));if(!o)break}return e?s.length:s?st.error(t):S(t,c).slice(0)},s=st.compile=function(t,e){var o,i,n,s,c,u,h=[],k=[],_=C[t+" "];if(!_){for(e||(e=r(t)),o=e.length;o--;)(_=bt(e[o]))[f]?h.push(_):k.push(_);(_=C(t,(i=k,s=0<(n=h).length,c=0<i.length,u=function(t,e,o,r,u){var h,k,_,B=0,g="0",T=t&&[],f=[],E=a,m=t||c&&l.find.TAG("*",u),b=v+=null==E?1:Math.random()||.1,S=m.length;for(u&&(a=e===y||e||u);g!==S&&null!=(h=m[g]);g++){if(c&&h){for(k=0,e||h.ownerDocument===y||(p(h),o=!d);_=i[k++];)if(_(h,e||y,o)){r.push(h);break}u&&(v=b)}s&&((h=!_&&h)&&B--,t&&T.push(h))}if(B+=g,s&&g!==B){for(k=0;_=n[k++];)_(T,f,e,o);if(t){if(0<B)for(;g--;)T[g]||f[g]||(f[g]=D.call(r));f=vt(f)}M.apply(r,f),u&&!t&&0<f.length&&1<B+n.length&&st.uniqueSort(r)}return u&&(v=b,a=E),T},s?at(u):u))).selector=t}return _},c=st.select=function(t,e,o,i){var n,c,a,u,h,p="function"==typeof t&&t,y=!i&&r(t=p.selector||t);if(o=o||[],1===y.length){if(2<(c=y[0]=y[0].slice(0)).length&&"ID"===(a=c[0]).type&&9===e.nodeType&&d&&l.relative[c[1].type]){if(!(e=(l.find.ID(a.matches[0].replace(et,ot),e)||[])[0]))return o;p&&(e=e.parentNode),t=t.slice(c.shift().value.length)}for(n=z.needsContext.test(t)?0:c.length;n--&&!l.relative[u=(a=c[n]).type];)if((h=l.find[u])&&(i=h(a.matches[0].replace(et,ot),tt.test(c[0].type)&&Bt(e.parentNode)||e))){if(c.splice(n,1),!(t=i.length&&Tt(c)))return M.apply(o,i),o;break}}return(p||s(t,y))(i,e,!d,o,!e||tt.test(t)&&Bt(e.parentNode)||e),o},o.sortStable=f.split("").sort(I).join("")===f,o.detectDuplicates=!!h,p(),o.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(y.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ht("type|href|height|width",(function(t,e,o){if(!o)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),o.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ht("value",(function(t,e,o){if(!o&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ht(x,(function(t,e,o){var l;if(!o)return!0===t[e]?e.toLowerCase():(l=t.getAttributeNode(e))&&l.specified?l.value:null})),st}(t);E.find=b,E.expr=b.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=b.uniqueSort,E.text=b.getText,E.isXMLDoc=b.isXML,E.contains=b.contains,E.escapeSelector=b.escape;var S=function(t,e,o){for(var l=[],i=void 0!==o;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&E(t).is(o))break;l.push(t)}return l},C=function(t,e){for(var o=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&o.push(t);return o},R=E.expr.match.needsContext;function I(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var O=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function A(t,e,o){return d(e)?E.grep(t,(function(t,l){return!!e.call(t,l,t)!==o})):e.nodeType?E.grep(t,(function(t){return t===e!==o})):"string"!=typeof e?E.grep(t,(function(t){return-1<c.call(e,t)!==o})):E.filter(e,t,o)}E.filter=function(t,e,o){var l=e[0];return o&&(t=":not("+t+")"),1===e.length&&1===l.nodeType?E.find.matchesSelector(l,t)?[l]:[]:E.find.matches(t,E.grep(e,(function(t){return 1===t.nodeType})))},E.fn.extend({find:function(t){var e,o,l=this.length,i=this;if("string"!=typeof t)return this.pushStack(E(t).filter((function(){for(e=0;e<l;e++)if(E.contains(i[e],this))return!0})));for(o=this.pushStack([]),e=0;e<l;e++)E.find(t,i[e],o);return 1<l?E.uniqueSort(o):o},filter:function(t){return this.pushStack(A(this,t||[],!1))},not:function(t){return this.pushStack(A(this,t||[],!0))},is:function(t){return!!A(this,"string"==typeof t&&R.test(t)?E(t):t||[],!1).length}});var D,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(t,e,o){var i,n;if(!t)return this;if(o=o||D,"string"==typeof t){if(!(i="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:N.exec(t))||!i[1]&&e)return!e||e.jquery?(e||o).find(t):this.constructor(e).find(t);if(i[1]){if(E.merge(this,E.parseHTML(i[1],(e=e instanceof E?e[0]:e)&&e.nodeType?e.ownerDocument||e:l,!0)),O.test(i[1])&&E.isPlainObject(e))for(i in e)d(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return(n=l.getElementById(i[2]))&&(this[0]=n,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):d(t)?void 0!==o.ready?o.ready(t):t(E):E.makeArray(t,this)}).prototype=E.fn,D=E(l);var M=/^(?:parents|prev(?:Until|All))/,L={children:!0,contents:!0,next:!0,prev:!0};function w(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}E.fn.extend({has:function(t){var e=E(t,this),o=e.length;return this.filter((function(){for(var t=0;t<o;t++)if(E.contains(this,e[t]))return!0}))},closest:function(t,e){var o,l=0,i=this.length,n=[],r="string"!=typeof t&&E(t);if(!R.test(t))for(;l<i;l++)for(o=this[l];o&&o!==e;o=o.parentNode)if(o.nodeType<11&&(r?-1<r.index(o):1===o.nodeType&&E.find.matchesSelector(o,t))){n.push(o);break}return this.pushStack(1<n.length?E.uniqueSort(n):n)},index:function(t){return t?"string"==typeof t?c.call(E(t),this[0]):c.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),E.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return S(t,"parentNode")},parentsUntil:function(t,e,o){return S(t,"parentNode",o)},next:function(t){return w(t,"nextSibling")},prev:function(t){return w(t,"previousSibling")},nextAll:function(t){return S(t,"nextSibling")},prevAll:function(t){return S(t,"previousSibling")},nextUntil:function(t,e,o){return S(t,"nextSibling",o)},prevUntil:function(t,e,o){return S(t,"previousSibling",o)},siblings:function(t){return C((t.parentNode||{}).firstChild,t)},children:function(t){return C(t.firstChild)},contents:function(t){return void 0!==t.contentDocument?t.contentDocument:(I(t,"template")&&(t=t.content||t),E.merge([],t.childNodes))}},(function(t,e){E.fn[t]=function(o,l){var i=E.map(this,e,o);return"Until"!==t.slice(-5)&&(l=o),l&&"string"==typeof l&&(i=E.filter(l,i)),1<this.length&&(L[t]||E.uniqueSort(i),M.test(t)&&i.reverse()),this.pushStack(i)}}));var x=/[^\x20\t\r\n\f]+/g;function P(t){return t}function F(t){throw t}function U(t,e,o,l){var i;try{t&&d(i=t.promise)?i.call(t).done(e).fail(o):t&&d(i=t.then)?i.call(t,e,o):e.apply(void 0,[t].slice(l))}catch(t){o.apply(void 0,[t])}}E.Callbacks=function(t){var e;t="string"==typeof t?(e={},E.each(t.match(x)||[],(function(t,o){e[o]=!0})),e):E.extend({},t);var o,l,i,n,r=[],s=[],c=-1,a=function(){for(n=n||t.once,i=o=!0;s.length;c=-1)for(l=s.shift();++c<r.length;)!1===r[c].apply(l[0],l[1])&&t.stopOnFalse&&(c=r.length,l=!1);t.memory||(l=!1),o=!1,n&&(r=l?[]:"")},u={add:function(){return r&&(l&&!o&&(c=r.length-1,s.push(l)),function e(o){E.each(o,(function(o,l){d(l)?t.unique&&u.has(l)||r.push(l):l&&l.length&&"string"!==T(l)&&e(l)}))}(arguments),l&&!o&&a()),this},remove:function(){return E.each(arguments,(function(t,e){for(var o;-1<(o=E.inArray(e,r,o));)r.splice(o,1),o<=c&&c--})),this},has:function(t){return t?-1<E.inArray(t,r):0<r.length},empty:function(){return r&&(r=[]),this},disable:function(){return n=s=[],r=l="",this},disabled:function(){return!r},lock:function(){return n=s=[],l||o||(r=l=""),this},locked:function(){return!!n},fireWith:function(t,e){return n||(e=[t,(e=e||[]).slice?e.slice():e],s.push(e),o||a()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},E.extend({Deferred:function(e){var o=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],l="pending",i={state:function(){return l},always:function(){return n.done(arguments).fail(arguments),this},catch:function(t){return i.then(null,t)},pipe:function(){var t=arguments;return E.Deferred((function(e){E.each(o,(function(o,l){var i=d(t[l[4]])&&t[l[4]];n[l[1]]((function(){var t=i&&i.apply(this,arguments);t&&d(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[l[0]+"With"](this,i?[t]:arguments)}))})),t=null})).promise()},then:function(e,l,i){var n=0;function r(e,o,l,i){return function(){var s=this,c=arguments,a=function(){var t,a;if(!(e<n)){if((t=l.apply(s,c))===o.promise())throw new TypeError("Thenable self-resolution");d(a=t&&("object"==typeof t||"function"==typeof t)&&t.then)?i?a.call(t,r(n,o,P,i),r(n,o,F,i)):(n++,a.call(t,r(n,o,P,i),r(n,o,F,i),r(n,o,P,o.notifyWith))):(l!==P&&(s=void 0,c=[t]),(i||o.resolveWith)(s,c))}},u=i?a:function(){try{a()}catch(a){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(a,u.stackTrace),n<=e+1&&(l!==F&&(s=void 0,c=[a]),o.rejectWith(s,c))}};e?u():(E.Deferred.getStackHook&&(u.stackTrace=E.Deferred.getStackHook()),t.setTimeout(u))}}return E.Deferred((function(t){o[0][3].add(r(0,t,d(i)?i:P,t.notifyWith)),o[1][3].add(r(0,t,d(e)?e:P)),o[2][3].add(r(0,t,d(l)?l:F))})).promise()},promise:function(t){return null!=t?E.extend(t,i):i}},n={};return E.each(o,(function(t,e){var r=e[2],s=e[5];i[e[1]]=r.add,s&&r.add((function(){l=s}),o[3-t][2].disable,o[3-t][3].disable,o[0][2].lock,o[0][3].lock),r.add(e[3].fire),n[e[0]]=function(){return n[e[0]+"With"](this===n?void 0:this,arguments),this},n[e[0]+"With"]=r.fireWith})),i.promise(n),e&&e.call(n,n),n},when:function(t){var e=arguments.length,o=e,l=Array(o),i=n.call(arguments),r=E.Deferred(),s=function(t){return function(o){l[t]=this,i[t]=1<arguments.length?n.call(arguments):o,--e||r.resolveWith(l,i)}};if(e<=1&&(U(t,r.done(s(o)).resolve,r.reject,!e),"pending"===r.state()||d(i[o]&&i[o].then)))return r.then();for(;o--;)U(i[o],s(o),r.reject);return r.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(e,o){t.console&&t.console.warn&&e&&H.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,o)},E.readyException=function(e){t.setTimeout((function(){throw e}))};var V=E.Deferred();function G(){l.removeEventListener("DOMContentLoaded",G),t.removeEventListener("load",G),E.ready()}E.fn.ready=function(t){return V.then(t).catch((function(t){E.readyException(t)})),this},E.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--E.readyWait:E.isReady)||(E.isReady=!0)!==t&&0<--E.readyWait||V.resolveWith(l,[E])}}),E.ready.then=V.then,"complete"===l.readyState||"loading"!==l.readyState&&!l.documentElement.doScroll?t.setTimeout(E.ready):(l.addEventListener("DOMContentLoaded",G),t.addEventListener("load",G));var W=function(t,e,o,l,i,n,r){var s=0,c=t.length,a=null==o;if("object"===T(o))for(s in i=!0,o)W(t,e,s,o[s],!0,n,r);else if(void 0!==l&&(i=!0,d(l)||(r=!0),a&&(r?(e.call(t,l),e=null):(a=e,e=function(t,e,o){return a.call(E(t),o)})),e))for(;s<c;s++)e(t[s],o,r?l:l.call(t[s],s,e(t[s],o)));return i?t:a?e.call(t):c?e(t[0],o):n},X=/^-ms-/,Y=/-([a-z])/g;function J(t,e){return e.toUpperCase()}function K(t){return t.replace(X,"ms-").replace(Y,J)}var z=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function j(){this.expando=E.expando+j.uid++}j.uid=1,j.prototype={cache:function(t){var e=t[this.expando];return e||(e={},z(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,o){var l,i=this.cache(t);if("string"==typeof e)i[K(e)]=o;else for(l in e)i[K(l)]=e[l];return i},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][K(e)]},access:function(t,e,o){return void 0===e||e&&"string"==typeof e&&void 0===o?this.get(t,e):(this.set(t,e,o),void 0!==o?o:e)},remove:function(t,e){var o,l=t[this.expando];if(void 0!==l){if(void 0!==e){o=(e=Array.isArray(e)?e.map(K):(e=K(e))in l?[e]:e.match(x)||[]).length;for(;o--;)delete l[e[o]]}(void 0===e||E.isEmptyObject(l))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!E.isEmptyObject(e)}};var q=new j,Z=new j,Q=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,$=/[A-Z]/g;function tt(t,e,o){var l,i;if(void 0===o&&1===t.nodeType)if(l="data-"+e.replace($,"-$&").toLowerCase(),"string"==typeof(o=t.getAttribute(l))){try{o="true"===(i=o)||"false"!==i&&("null"===i?null:i===+i+""?+i:Q.test(i)?JSON.parse(i):i)}catch(t){}Z.set(t,e,o)}else o=void 0;return o}E.extend({hasData:function(t){return Z.hasData(t)||q.hasData(t)},data:function(t,e,o){return Z.access(t,e,o)},removeData:function(t,e){Z.remove(t,e)},_data:function(t,e,o){return q.access(t,e,o)},_removeData:function(t,e){q.remove(t,e)}}),E.fn.extend({data:function(t,e){var o,l,i,n=this[0],r=n&&n.attributes;if(void 0===t){if(this.length&&(i=Z.get(n),1===n.nodeType&&!q.get(n,"hasDataAttrs"))){for(o=r.length;o--;)r[o]&&0===(l=r[o].name).indexOf("data-")&&(l=K(l.slice(5)),tt(n,l,i[l]));q.set(n,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each((function(){Z.set(this,t)})):W(this,(function(e){var o;if(n&&void 0===e)return void 0!==(o=Z.get(n,t))?o:void 0!==(o=tt(n,t))?o:void 0;this.each((function(){Z.set(this,t,e)}))}),null,e,1<arguments.length,null,!0)},removeData:function(t){return this.each((function(){Z.remove(this,t)}))}}),E.extend({queue:function(t,e,o){var l;if(t)return l=q.get(t,e=(e||"fx")+"queue"),o&&(!l||Array.isArray(o)?l=q.access(t,e,E.makeArray(o)):l.push(o)),l||[]},dequeue:function(t,e){var o=E.queue(t,e=e||"fx"),l=o.length,i=o.shift(),n=E._queueHooks(t,e);"inprogress"===i&&(i=o.shift(),l--),i&&("fx"===e&&o.unshift("inprogress"),delete n.stop,i.call(t,(function(){E.dequeue(t,e)}),n)),!l&&n&&n.empty.fire()},_queueHooks:function(t,e){var o=e+"queueHooks";return q.get(t,o)||q.access(t,o,{empty:E.Callbacks("once memory").add((function(){q.remove(t,[e+"queue",o])}))})}}),E.fn.extend({queue:function(t,e){var o=2;return"string"!=typeof t&&(e=t,t="fx",o--),arguments.length<o?E.queue(this[0],t):void 0===e?this:this.each((function(){var o=E.queue(this,t,e);E._queueHooks(this,t),"fx"===t&&"inprogress"!==o[0]&&E.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){E.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var o,l=1,i=E.Deferred(),n=this,r=this.length,s=function(){--l||i.resolveWith(n,[n])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";r--;)(o=q.get(n[r],t+"queueHooks"))&&o.empty&&(l++,o.empty.add(s));return s(),i.promise(e)}});var et=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ot=new RegExp("^(?:([+-])=|)("+et+")([a-z%]*)$","i"),lt=["Top","Right","Bottom","Left"],it=l.documentElement,nt=function(t){return E.contains(t.ownerDocument,t)},rt={composed:!0};it.getRootNode&&(nt=function(t){return E.contains(t.ownerDocument,t)||t.getRootNode(rt)===t.ownerDocument});var st=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&nt(t)&&"none"===E.css(t,"display")},ct=function(t,e,o,l){var i,n,r={};for(n in e)r[n]=t.style[n],t.style[n]=e[n];for(n in i=o.apply(t,l||[]),e)t.style[n]=r[n];return i};function at(t,e,o,l){var i,n,r=20,s=l?function(){return l.cur()}:function(){return E.css(t,e,"")},c=s(),a=o&&o[3]||(E.cssNumber[e]?"":"px"),u=t.nodeType&&(E.cssNumber[e]||"px"!==a&&+c)&&ot.exec(E.css(t,e));if(u&&u[3]!==a){for(a=a||u[3],u=+(c/=2)||1;r--;)E.style(t,e,u+a),(1-n)*(1-(n=s()/c||.5))<=0&&(r=0),u/=n;E.style(t,e,(u*=2)+a),o=o||[]}return o&&(u=+u||+c||0,i=o[1]?u+(o[1]+1)*o[2]:+o[2],l&&(l.unit=a,l.start=u,l.end=i)),i}var ut={};function ht(t,e){for(var o,l,i,n,r,s,c,a=[],u=0,h=t.length;u<h;u++)(l=t[u]).style&&(o=l.style.display,e?("none"===o&&(a[u]=q.get(l,"display")||null,a[u]||(l.style.display="")),""===l.style.display&&st(l)&&(a[u]=(c=r=n=void 0,r=(i=l).ownerDocument,(c=ut[s=i.nodeName])||(n=r.body.appendChild(r.createElement(s)),c=E.css(n,"display"),n.parentNode.removeChild(n),"none"===c&&(c="block"),ut[s]=c)))):"none"!==o&&(a[u]="none",q.set(l,"display",o)));for(u=0;u<h;u++)null!=a[u]&&(t[u].style.display=a[u]);return t}E.fn.extend({show:function(){return ht(this,!0)},hide:function(){return ht(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){st(this)?E(this).show():E(this).hide()}))}});var pt=/^(?:checkbox|radio)$/i,yt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,kt=/^$|^module$|\/(?:java|ecma)script/i,dt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function _t(t,e){var o;return o=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&I(t,e)?E.merge([t],o):o}function Bt(t,e){for(var o=0,l=t.length;o<l;o++)q.set(t[o],"globalEval",!e||q.get(e[o],"globalEval"))}dt.optgroup=dt.option,dt.tbody=dt.tfoot=dt.colgroup=dt.caption=dt.thead,dt.th=dt.td;var gt,Tt,ft=/<|&#?\w+;/;function Et(t,e,o,l,i){for(var n,r,s,c,a,u,h=e.createDocumentFragment(),p=[],y=0,k=t.length;y<k;y++)if((n=t[y])||0===n)if("object"===T(n))E.merge(p,n.nodeType?[n]:n);else if(ft.test(n)){for(r=r||h.appendChild(e.createElement("div")),s=(yt.exec(n)||["",""])[1].toLowerCase(),r.innerHTML=(c=dt[s]||dt._default)[1]+E.htmlPrefilter(n)+c[2],u=c[0];u--;)r=r.lastChild;E.merge(p,r.childNodes),(r=h.firstChild).textContent=""}else p.push(e.createTextNode(n));for(h.textContent="",y=0;n=p[y++];)if(l&&-1<E.inArray(n,l))i&&i.push(n);else if(a=nt(n),r=_t(h.appendChild(n),"script"),a&&Bt(r),o)for(u=0;n=r[u++];)kt.test(n.type||"")&&o.push(n);return h}gt=l.createDocumentFragment().appendChild(l.createElement("div")),(Tt=l.createElement("input")).setAttribute("type","radio"),Tt.setAttribute("checked","checked"),Tt.setAttribute("name","t"),gt.appendChild(Tt),k.checkClone=gt.cloneNode(!0).cloneNode(!0).lastChild.checked,gt.innerHTML="<textarea>x</textarea>",k.noCloneChecked=!!gt.cloneNode(!0).lastChild.defaultValue;var vt=/^key/,mt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,bt=/^([^.]*)(?:\.(.+)|)/;function St(){return!0}function Ct(){return!1}function Rt(t,e){return t===function(){try{return l.activeElement}catch(t){}}()==("focus"===e)}function It(t,e,o,l,i,n){var r,s;if("object"==typeof e){for(s in"string"!=typeof o&&(l=l||o,o=void 0),e)It(t,s,o,l,e[s],n);return t}if(null==l&&null==i?(i=o,l=o=void 0):null==i&&("string"==typeof o?(i=l,l=void 0):(i=l,l=o,o=void 0)),!1===i)i=Ct;else if(!i)return t;return 1===n&&(r=i,(i=function(t){return E().off(t),r.apply(this,arguments)}).guid=r.guid||(r.guid=E.guid++)),t.each((function(){E.event.add(this,e,i,l,o)}))}function Ot(t,e,o){o?(q.set(t,e,!1),E.event.add(t,e,{namespace:!1,handler:function(t){var l,i,r=q.get(this,e);if(1&t.isTrigger&&this[e]){if(r.length)(E.event.special[e]||{}).delegateType&&t.stopPropagation();else if(r=n.call(arguments),q.set(this,e,r),l=o(this,e),this[e](),r!==(i=q.get(this,e))||l?q.set(this,e,!1):i={},r!==i)return t.stopImmediatePropagation(),t.preventDefault(),i.value}else r.length&&(q.set(this,e,{value:E.event.trigger(E.extend(r[0],E.Event.prototype),r.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===q.get(t,e)&&E.event.add(t,e,St)}E.event={global:{},add:function(t,e,o,l,i){var n,r,s,c,a,u,h,p,y,k,d,_=q.get(t);if(_)for(o.handler&&(o=(n=o).handler,i=n.selector),i&&E.find.matchesSelector(it,i),o.guid||(o.guid=E.guid++),(c=_.events)||(c=_.events={}),(r=_.handle)||(r=_.handle=function(e){return void 0!==E&&E.event.triggered!==e.type?E.event.dispatch.apply(t,arguments):void 0}),a=(e=(e||"").match(x)||[""]).length;a--;)y=d=(s=bt.exec(e[a])||[])[1],k=(s[2]||"").split(".").sort(),y&&(h=E.event.special[y]||{},h=E.event.special[y=(i?h.delegateType:h.bindType)||y]||{},u=E.extend({type:y,origType:d,data:l,handler:o,guid:o.guid,selector:i,needsContext:i&&E.expr.match.needsContext.test(i),namespace:k.join(".")},n),(p=c[y])||((p=c[y]=[]).delegateCount=0,h.setup&&!1!==h.setup.call(t,l,k,r)||t.addEventListener&&t.addEventListener(y,r)),h.add&&(h.add.call(t,u),u.handler.guid||(u.handler.guid=o.guid)),i?p.splice(p.delegateCount++,0,u):p.push(u),E.event.global[y]=!0)},remove:function(t,e,o,l,i){var n,r,s,c,a,u,h,p,y,k,d,_=q.hasData(t)&&q.get(t);if(_&&(c=_.events)){for(a=(e=(e||"").match(x)||[""]).length;a--;)if(y=d=(s=bt.exec(e[a])||[])[1],k=(s[2]||"").split(".").sort(),y){for(h=E.event.special[y]||{},p=c[y=(l?h.delegateType:h.bindType)||y]||[],s=s[2]&&new RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"),r=n=p.length;n--;)u=p[n],!i&&d!==u.origType||o&&o.guid!==u.guid||s&&!s.test(u.namespace)||l&&l!==u.selector&&("**"!==l||!u.selector)||(p.splice(n,1),u.selector&&p.delegateCount--,h.remove&&h.remove.call(t,u));r&&!p.length&&(h.teardown&&!1!==h.teardown.call(t,k,_.handle)||E.removeEvent(t,y,_.handle),delete c[y])}else for(y in c)E.event.remove(t,y+e[a],o,l,!0);E.isEmptyObject(c)&&q.remove(t,"handle events")}},dispatch:function(t){var e,o,l,i,n,r,s=E.event.fix(t),c=new Array(arguments.length),a=(q.get(this,"events")||{})[s.type]||[],u=E.event.special[s.type]||{};for(c[0]=s,e=1;e<arguments.length;e++)c[e]=arguments[e];if(s.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,s)){for(r=E.event.handlers.call(this,s,a),e=0;(i=r[e++])&&!s.isPropagationStopped();)for(s.currentTarget=i.elem,o=0;(n=i.handlers[o++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!1!==n.namespace&&!s.rnamespace.test(n.namespace)||(s.handleObj=n,s.data=n.data,void 0!==(l=((E.event.special[n.origType]||{}).handle||n.handler).apply(i.elem,c))&&!1===(s.result=l)&&(s.preventDefault(),s.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,s),s.result}},handlers:function(t,e){var o,l,i,n,r,s=[],c=e.delegateCount,a=t.target;if(c&&a.nodeType&&!("click"===t.type&&1<=t.button))for(;a!==this;a=a.parentNode||this)if(1===a.nodeType&&("click"!==t.type||!0!==a.disabled)){for(n=[],r={},o=0;o<c;o++)void 0===r[i=(l=e[o]).selector+" "]&&(r[i]=l.needsContext?-1<E(i,this).index(a):E.find(i,this,null,[a]).length),r[i]&&n.push(l);n.length&&s.push({elem:a,handlers:n})}return a=this,c<e.length&&s.push({elem:a,handlers:e.slice(c)}),s},addProp:function(t,e){Object.defineProperty(E.Event.prototype,t,{enumerable:!0,configurable:!0,get:d(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[E.expando]?t:new E.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return pt.test(e.type)&&e.click&&I(e,"input")&&Ot(e,"click",St),!1},trigger:function(t){var e=this||t;return pt.test(e.type)&&e.click&&I(e,"input")&&Ot(e,"click"),!0},_default:function(t){var e=t.target;return pt.test(e.type)&&e.click&&I(e,"input")&&q.get(e,"click")||I(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},E.removeEvent=function(t,e,o){t.removeEventListener&&t.removeEventListener(e,o)},E.Event=function(t,e){if(!(this instanceof E.Event))return new E.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?St:Ct,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&E.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Ct,isPropagationStopped:Ct,isImmediatePropagationStopped:Ct,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=St,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=St,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=St,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&vt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&mt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},(function(t,e){E.event.special[t]={setup:function(){return Ot(this,t,Rt),!1},trigger:function(){return Ot(this,t),!0},delegateType:e}})),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){E.event.special[t]={delegateType:e,bindType:e,handle:function(t){var o,l=t.relatedTarget,i=t.handleObj;return l&&(l===this||E.contains(this,l))||(t.type=i.origType,o=i.handler.apply(this,arguments),t.type=e),o}}})),E.fn.extend({on:function(t,e,o,l){return It(this,t,e,o,l)},one:function(t,e,o,l){return It(this,t,e,o,l,1)},off:function(t,e,o){var l,i;if(t&&t.preventDefault&&t.handleObj)return l=t.handleObj,E(t.delegateTarget).off(l.namespace?l.origType+"."+l.namespace:l.origType,l.selector,l.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return!1!==e&&"function"!=typeof e||(o=e,e=void 0),!1===o&&(o=Ct),this.each((function(){E.event.remove(this,t,o,e)}))}});var At=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,Dt=/<script|<style|<link/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,Mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Lt(t,e){return I(t,"table")&&I(11!==e.nodeType?e:e.firstChild,"tr")&&E(t).children("tbody")[0]||t}function wt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function xt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Pt(t,e){var o,l,i,n,r,s,c,a;if(1===e.nodeType){if(q.hasData(t)&&(n=q.access(t),r=q.set(e,n),a=n.events))for(i in delete r.handle,r.events={},a)for(o=0,l=a[i].length;o<l;o++)E.event.add(e,i,a[i][o]);Z.hasData(t)&&(s=Z.access(t),c=E.extend({},s),Z.set(e,c))}}function Ft(t,e,o,l){e=r.apply([],e);var i,n,s,c,a,u,h=0,p=t.length,y=p-1,_=e[0],B=d(_);if(B||1<p&&"string"==typeof _&&!k.checkClone&&Nt.test(_))return t.each((function(i){var n=t.eq(i);B&&(e[0]=_.call(this,i,n.html())),Ft(n,e,o,l)}));if(p&&(n=(i=Et(e,t[0].ownerDocument,!1,t,l)).firstChild,1===i.childNodes.length&&(i=n),n||l)){for(c=(s=E.map(_t(i,"script"),wt)).length;h<p;h++)a=i,h!==y&&(a=E.clone(a,!0,!0),c&&E.merge(s,_t(a,"script"))),o.call(t[h],a,h);if(c)for(u=s[s.length-1].ownerDocument,E.map(s,xt),h=0;h<c;h++)kt.test((a=s[h]).type||"")&&!q.access(a,"globalEval")&&E.contains(u,a)&&(a.src&&"module"!==(a.type||"").toLowerCase()?E._evalUrl&&!a.noModule&&E._evalUrl(a.src,{nonce:a.nonce||a.getAttribute("nonce")}):g(a.textContent.replace(Mt,""),a,u))}return t}function Ut(t,e,o){for(var l,i=e?E.filter(e,t):t,n=0;null!=(l=i[n]);n++)o||1!==l.nodeType||E.cleanData(_t(l)),l.parentNode&&(o&&nt(l)&&Bt(_t(l,"script")),l.parentNode.removeChild(l));return t}E.extend({htmlPrefilter:function(t){return t.replace(At,"<$1></$2>")},clone:function(t,e,o){var l,i,n,r,s,c,a,u=t.cloneNode(!0),h=nt(t);if(!(k.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||E.isXMLDoc(t)))for(r=_t(u),l=0,i=(n=_t(t)).length;l<i;l++)s=n[l],"input"===(a=(c=r[l]).nodeName.toLowerCase())&&pt.test(s.type)?c.checked=s.checked:"input"!==a&&"textarea"!==a||(c.defaultValue=s.defaultValue);if(e)if(o)for(n=n||_t(t),r=r||_t(u),l=0,i=n.length;l<i;l++)Pt(n[l],r[l]);else Pt(t,u);return 0<(r=_t(u,"script")).length&&Bt(r,!h&&_t(t,"script")),u},cleanData:function(t){for(var e,o,l,i=E.event.special,n=0;void 0!==(o=t[n]);n++)if(z(o)){if(e=o[q.expando]){if(e.events)for(l in e.events)i[l]?E.event.remove(o,l):E.removeEvent(o,l,e.handle);o[q.expando]=void 0}o[Z.expando]&&(o[Z.expando]=void 0)}}}),E.fn.extend({detach:function(t){return Ut(this,t,!0)},remove:function(t){return Ut(this,t)},text:function(t){return W(this,(function(t){return void 0===t?E.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Ft(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Lt(this,t).appendChild(t)}))},prepend:function(){return Ft(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Lt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Ft(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Ft(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(E.cleanData(_t(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return E.clone(this,t,e)}))},html:function(t){return W(this,(function(t){var e=this[0]||{},o=0,l=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Dt.test(t)&&!dt[(yt.exec(t)||["",""])[1].toLowerCase()]){t=E.htmlPrefilter(t);try{for(;o<l;o++)1===(e=this[o]||{}).nodeType&&(E.cleanData(_t(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Ft(this,arguments,(function(e){var o=this.parentNode;E.inArray(this,t)<0&&(E.cleanData(_t(this)),o&&o.replaceChild(e,this))}),t)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){E.fn[t]=function(t){for(var o,l=[],i=E(t),n=i.length-1,r=0;r<=n;r++)o=r===n?this:this.clone(!0),E(i[r])[e](o),s.apply(l,o.get());return this.pushStack(l)}}));var Ht=new RegExp("^("+et+")(?!px)[a-z%]+$","i"),Vt=function(e){var o=e.ownerDocument.defaultView;return o&&o.opener||(o=t),o.getComputedStyle(e)},Gt=new RegExp(lt.join("|"),"i");function Wt(t,e,o){var l,i,n,r,s=t.style;return(o=o||Vt(t))&&(""!==(r=o.getPropertyValue(e)||o[e])||nt(t)||(r=E.style(t,e)),!k.pixelBoxStyles()&&Ht.test(r)&&Gt.test(e)&&(l=s.width,i=s.minWidth,n=s.maxWidth,s.minWidth=s.maxWidth=s.width=r,r=o.width,s.width=l,s.minWidth=i,s.maxWidth=n)),void 0!==r?r+"":r}function Xt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(u){a.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",it.appendChild(a).appendChild(u);var e=t.getComputedStyle(u);i="1%"!==e.top,c=12===o(e.marginLeft),u.style.right="60%",s=36===o(e.right),n=36===o(e.width),u.style.position="absolute",r=12===o(u.offsetWidth/3),it.removeChild(a),u=null}}function o(t){return Math.round(parseFloat(t))}var i,n,r,s,c,a=l.createElement("div"),u=l.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",k.clearCloneStyle="content-box"===u.style.backgroundClip,E.extend(k,{boxSizingReliable:function(){return e(),n},pixelBoxStyles:function(){return e(),s},pixelPosition:function(){return e(),i},reliableMarginLeft:function(){return e(),c},scrollboxSize:function(){return e(),r}}))}();var Yt=["Webkit","Moz","ms"],Jt=l.createElement("div").style,Kt={};function zt(t){return E.cssProps[t]||Kt[t]||(t in Jt?t:Kt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),o=Yt.length;o--;)if((t=Yt[o]+e)in Jt)return t}(t)||t)}var jt=/^(none|table(?!-c[ea]).+)/,qt=/^--/,Zt={position:"absolute",visibility:"hidden",display:"block"},Qt={letterSpacing:"0",fontWeight:"400"};function $t(t,e,o){var l=ot.exec(e);return l?Math.max(0,l[2]-(o||0))+(l[3]||"px"):e}function te(t,e,o,l,i,n){var r="width"===e?1:0,s=0,c=0;if(o===(l?"border":"content"))return 0;for(;r<4;r+=2)"margin"===o&&(c+=E.css(t,o+lt[r],!0,i)),l?("content"===o&&(c-=E.css(t,"padding"+lt[r],!0,i)),"margin"!==o&&(c-=E.css(t,"border"+lt[r]+"Width",!0,i))):(c+=E.css(t,"padding"+lt[r],!0,i),"padding"!==o?c+=E.css(t,"border"+lt[r]+"Width",!0,i):s+=E.css(t,"border"+lt[r]+"Width",!0,i));return!l&&0<=n&&(c+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-n-c-s-.5))||0),c}function ee(t,e,o){var l=Vt(t),i=(!k.boxSizingReliable()||o)&&"border-box"===E.css(t,"boxSizing",!1,l),n=i,r=Wt(t,e,l),s="offset"+e[0].toUpperCase()+e.slice(1);if(Ht.test(r)){if(!o)return r;r="auto"}return(!k.boxSizingReliable()&&i||"auto"===r||!parseFloat(r)&&"inline"===E.css(t,"display",!1,l))&&t.getClientRects().length&&(i="border-box"===E.css(t,"boxSizing",!1,l),(n=s in t)&&(r=t[s])),(r=parseFloat(r)||0)+te(t,e,o||(i?"border":"content"),n,l,r)+"px"}function oe(t,e,o,l,i){return new oe.prototype.init(t,e,o,l,i)}E.extend({cssHooks:{opacity:{get:function(t,e){if(e){var o=Wt(t,"opacity");return""===o?"1":o}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,o,l){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,n,r,s=K(e),c=qt.test(e),a=t.style;if(c||(e=zt(s)),r=E.cssHooks[e]||E.cssHooks[s],void 0===o)return r&&"get"in r&&void 0!==(i=r.get(t,!1,l))?i:a[e];"string"==(n=typeof o)&&(i=ot.exec(o))&&i[1]&&(o=at(t,e,i),n="number"),null!=o&&o==o&&("number"!==n||c||(o+=i&&i[3]||(E.cssNumber[s]?"":"px")),k.clearCloneStyle||""!==o||0!==e.indexOf("background")||(a[e]="inherit"),r&&"set"in r&&void 0===(o=r.set(t,o,l))||(c?a.setProperty(e,o):a[e]=o))}},css:function(t,e,o,l){var i,n,r,s=K(e);return qt.test(e)||(e=zt(s)),(r=E.cssHooks[e]||E.cssHooks[s])&&"get"in r&&(i=r.get(t,!0,o)),void 0===i&&(i=Wt(t,e,l)),"normal"===i&&e in Qt&&(i=Qt[e]),""===o||o?(n=parseFloat(i),!0===o||isFinite(n)?n||0:i):i}}),E.each(["height","width"],(function(t,e){E.cssHooks[e]={get:function(t,o,l){if(o)return!jt.test(E.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ee(t,e,l):ct(t,Zt,(function(){return ee(t,e,l)}))},set:function(t,o,l){var i,n=Vt(t),r=!k.scrollboxSize()&&"absolute"===n.position,s=(r||l)&&"border-box"===E.css(t,"boxSizing",!1,n),c=l?te(t,e,l,s,n):0;return s&&r&&(c-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(n[e])-te(t,e,"border",!1,n)-.5)),c&&(i=ot.exec(o))&&"px"!==(i[3]||"px")&&(t.style[e]=o,o=E.css(t,e)),$t(0,o,c)}}})),E.cssHooks.marginLeft=Xt(k.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Wt(t,"marginLeft"))||t.getBoundingClientRect().left-ct(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),E.each({margin:"",padding:"",border:"Width"},(function(t,e){E.cssHooks[t+e]={expand:function(o){for(var l=0,i={},n="string"==typeof o?o.split(" "):[o];l<4;l++)i[t+lt[l]+e]=n[l]||n[l-2]||n[0];return i}},"margin"!==t&&(E.cssHooks[t+e].set=$t)})),E.fn.extend({css:function(t,e){return W(this,(function(t,e,o){var l,i,n={},r=0;if(Array.isArray(e)){for(l=Vt(t),i=e.length;r<i;r++)n[e[r]]=E.css(t,e[r],!1,l);return n}return void 0!==o?E.style(t,e,o):E.css(t,e)}),t,e,1<arguments.length)}}),((E.Tween=oe).prototype={constructor:oe,init:function(t,e,o,l,i,n){this.elem=t,this.prop=o,this.easing=i||E.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=l,this.unit=n||(E.cssNumber[o]?"":"px")},cur:function(){var t=oe.propHooks[this.prop];return t&&t.get?t.get(this):oe.propHooks._default.get(this)},run:function(t){var e,o=oe.propHooks[this.prop];return this.pos=e=this.options.duration?E.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),o&&o.set?o.set(this):oe.propHooks._default.set(this),this}}).init.prototype=oe.prototype,(oe.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=E.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){E.fx.step[t.prop]?E.fx.step[t.prop](t):1!==t.elem.nodeType||!E.cssHooks[t.prop]&&null==t.elem.style[zt(t.prop)]?t.elem[t.prop]=t.now:E.style(t.elem,t.prop,t.now+t.unit)}}}).scrollTop=oe.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},E.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},E.fx=oe.prototype.init,E.fx.step={};var le,ie,ne,re,se=/^(?:toggle|show|hide)$/,ce=/queueHooks$/;function ae(){ie&&(!1===l.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(ae):t.setTimeout(ae,E.fx.interval),E.fx.tick())}function ue(){return t.setTimeout((function(){le=void 0})),le=Date.now()}function he(t,e){var o,l=0,i={height:t};for(e=e?1:0;l<4;l+=2-e)i["margin"+(o=lt[l])]=i["padding"+o]=t;return e&&(i.opacity=i.width=t),i}function pe(t,e,o){for(var l,i=(ye.tweeners[e]||[]).concat(ye.tweeners["*"]),n=0,r=i.length;n<r;n++)if(l=i[n].call(o,e,t))return l}function ye(t,e,o){var l,i,n=0,r=ye.prefilters.length,s=E.Deferred().always((function(){delete c.elem})),c=function(){if(i)return!1;for(var e=le||ue(),o=Math.max(0,a.startTime+a.duration-e),l=1-(o/a.duration||0),n=0,r=a.tweens.length;n<r;n++)a.tweens[n].run(l);return s.notifyWith(t,[a,l,o]),l<1&&r?o:(r||s.notifyWith(t,[a,1,0]),s.resolveWith(t,[a]),!1)},a=s.promise({elem:t,props:E.extend({},e),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},o),originalProperties:e,originalOptions:o,startTime:le||ue(),duration:o.duration,tweens:[],createTween:function(e,o){var l=E.Tween(t,a.opts,e,o,a.opts.specialEasing[e]||a.opts.easing);return a.tweens.push(l),l},stop:function(e){var o=0,l=e?a.tweens.length:0;if(i)return this;for(i=!0;o<l;o++)a.tweens[o].run(1);return e?(s.notifyWith(t,[a,1,0]),s.resolveWith(t,[a,e])):s.rejectWith(t,[a,e]),this}}),u=a.props;for(function(t,e){var o,l,i,n,r;for(o in t)if(i=e[l=K(o)],n=t[o],Array.isArray(n)&&(i=n[1],n=t[o]=n[0]),o!==l&&(t[l]=n,delete t[o]),(r=E.cssHooks[l])&&"expand"in r)for(o in n=r.expand(n),delete t[l],n)o in t||(t[o]=n[o],e[o]=i);else e[l]=i}(u,a.opts.specialEasing);n<r;n++)if(l=ye.prefilters[n].call(a,t,u,a.opts))return d(l.stop)&&(E._queueHooks(a.elem,a.opts.queue).stop=l.stop.bind(l)),l;return E.map(u,pe,a),d(a.opts.start)&&a.opts.start.call(t,a),a.progress(a.opts.progress).done(a.opts.done,a.opts.complete).fail(a.opts.fail).always(a.opts.always),E.fx.timer(E.extend(c,{elem:t,anim:a,queue:a.opts.queue})),a}E.Animation=E.extend(ye,{tweeners:{"*":[function(t,e){var o=this.createTween(t,e);return at(o.elem,t,ot.exec(e),o),o}]},tweener:function(t,e){d(t)?(e=t,t=["*"]):t=t.match(x);for(var o,l=0,i=t.length;l<i;l++)(ye.tweeners[o=t[l]]=ye.tweeners[o]||[]).unshift(e)},prefilters:[function(t,e,o){var l,i,n,r,s,c,a,u,h="width"in e||"height"in e,p=this,y={},k=t.style,d=t.nodeType&&st(t),_=q.get(t,"fxshow");for(l in o.queue||(null==(r=E._queueHooks(t,"fx")).unqueued&&(r.unqueued=0,s=r.empty.fire,r.empty.fire=function(){r.unqueued||s()}),r.unqueued++,p.always((function(){p.always((function(){r.unqueued--,E.queue(t,"fx").length||r.empty.fire()}))}))),e)if(se.test(i=e[l])){if(delete e[l],n=n||"toggle"===i,i===(d?"hide":"show")){if("show"!==i||!_||void 0===_[l])continue;d=!0}y[l]=_&&_[l]||E.style(t,l)}if((c=!E.isEmptyObject(e))||!E.isEmptyObject(y))for(l in h&&1===t.nodeType&&(o.overflow=[k.overflow,k.overflowX,k.overflowY],null==(a=_&&_.display)&&(a=q.get(t,"display")),"none"===(u=E.css(t,"display"))&&(a?u=a:(ht([t],!0),a=t.style.display||a,u=E.css(t,"display"),ht([t]))),("inline"===u||"inline-block"===u&&null!=a)&&"none"===E.css(t,"float")&&(c||(p.done((function(){k.display=a})),null==a&&(a="none"===(u=k.display)?"":u)),k.display="inline-block")),o.overflow&&(k.overflow="hidden",p.always((function(){k.overflow=o.overflow[0],k.overflowX=o.overflow[1],k.overflowY=o.overflow[2]}))),c=!1,y)c||(_?"hidden"in _&&(d=_.hidden):_=q.access(t,"fxshow",{display:a}),n&&(_.hidden=!d),d&&ht([t],!0),p.done((function(){for(l in d||ht([t]),q.remove(t,"fxshow"),y)E.style(t,l,y[l])}))),c=pe(d?_[l]:0,l,p),l in _||(_[l]=c.start,d&&(c.end=c.start,c.start=0))}],prefilter:function(t,e){e?ye.prefilters.unshift(t):ye.prefilters.push(t)}}),E.speed=function(t,e,o){var l=t&&"object"==typeof t?E.extend({},t):{complete:o||!o&&e||d(t)&&t,duration:t,easing:o&&e||e&&!d(e)&&e};return E.fx.off?l.duration=0:"number"!=typeof l.duration&&(l.duration=l.duration in E.fx.speeds?E.fx.speeds[l.duration]:E.fx.speeds._default),null!=l.queue&&!0!==l.queue||(l.queue="fx"),l.old=l.complete,l.complete=function(){d(l.old)&&l.old.call(this),l.queue&&E.dequeue(this,l.queue)},l},E.fn.extend({fadeTo:function(t,e,o,l){return this.filter(st).css("opacity",0).show().end().animate({opacity:e},t,o,l)},animate:function(t,e,o,l){var i=E.isEmptyObject(t),n=E.speed(e,o,l),r=function(){var e=ye(this,E.extend({},t),n);(i||q.get(this,"finish"))&&e.stop(!0)};return r.finish=r,i||!1===n.queue?this.each(r):this.queue(n.queue,r)},stop:function(t,e,o){var l=function(t){var e=t.stop;delete t.stop,e(o)};return"string"!=typeof t&&(o=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,i=null!=t&&t+"queueHooks",n=E.timers,r=q.get(this);if(i)r[i]&&r[i].stop&&l(r[i]);else for(i in r)r[i]&&r[i].stop&&ce.test(i)&&l(r[i]);for(i=n.length;i--;)n[i].elem!==this||null!=t&&n[i].queue!==t||(n[i].anim.stop(o),e=!1,n.splice(i,1));!e&&o||E.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,o=q.get(this),l=o[t+"queue"],i=o[t+"queueHooks"],n=E.timers,r=l?l.length:0;for(o.finish=!0,E.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=n.length;e--;)n[e].elem===this&&n[e].queue===t&&(n[e].anim.stop(!0),n.splice(e,1));for(e=0;e<r;e++)l[e]&&l[e].finish&&l[e].finish.call(this);delete o.finish}))}}),E.each(["toggle","show","hide"],(function(t,e){var o=E.fn[e];E.fn[e]=function(t,l,i){return null==t||"boolean"==typeof t?o.apply(this,arguments):this.animate(he(e,!0),t,l,i)}})),E.each({slideDown:he("show"),slideUp:he("hide"),slideToggle:he("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){E.fn[t]=function(t,o,l){return this.animate(e,t,o,l)}})),E.timers=[],E.fx.tick=function(){var t,e=0,o=E.timers;for(le=Date.now();e<o.length;e++)(t=o[e])()||o[e]!==t||o.splice(e--,1);o.length||E.fx.stop(),le=void 0},E.fx.timer=function(t){E.timers.push(t),E.fx.start()},E.fx.interval=13,E.fx.start=function(){ie||(ie=!0,ae())},E.fx.stop=function(){ie=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(e,o){return e=E.fx&&E.fx.speeds[e]||e,this.queue(o=o||"fx",(function(o,l){var i=t.setTimeout(o,e);l.stop=function(){t.clearTimeout(i)}}))},ne=l.createElement("input"),re=l.createElement("select").appendChild(l.createElement("option")),ne.type="checkbox",k.checkOn=""!==ne.value,k.optSelected=re.selected,(ne=l.createElement("input")).value="t",ne.type="radio",k.radioValue="t"===ne.value;var ke,de=E.expr.attrHandle;E.fn.extend({attr:function(t,e){return W(this,E.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each((function(){E.removeAttr(this,t)}))}}),E.extend({attr:function(t,e,o){var l,i,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return void 0===t.getAttribute?E.prop(t,e,o):(1===n&&E.isXMLDoc(t)||(i=E.attrHooks[e.toLowerCase()]||(E.expr.match.bool.test(e)?ke:void 0)),void 0!==o?null===o?void E.removeAttr(t,e):i&&"set"in i&&void 0!==(l=i.set(t,o,e))?l:(t.setAttribute(e,o+""),o):i&&"get"in i&&null!==(l=i.get(t,e))?l:null==(l=E.find.attr(t,e))?void 0:l)},attrHooks:{type:{set:function(t,e){if(!k.radioValue&&"radio"===e&&I(t,"input")){var o=t.value;return t.setAttribute("type",e),o&&(t.value=o),e}}}},removeAttr:function(t,e){var o,l=0,i=e&&e.match(x);if(i&&1===t.nodeType)for(;o=i[l++];)t.removeAttribute(o)}}),ke={set:function(t,e,o){return!1===e?E.removeAttr(t,o):t.setAttribute(o,o),o}},E.each(E.expr.match.bool.source.match(/\w+/g),(function(t,e){var o=de[e]||E.find.attr;de[e]=function(t,e,l){var i,n,r=e.toLowerCase();return l||(n=de[r],de[r]=i,i=null!=o(t,e,l)?r:null,de[r]=n),i}}));var _e=/^(?:input|select|textarea|button)$/i,Be=/^(?:a|area)$/i;function ge(t){return(t.match(x)||[]).join(" ")}function Te(t){return t.getAttribute&&t.getAttribute("class")||""}function fe(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(x)||[]}E.fn.extend({prop:function(t,e){return W(this,E.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each((function(){delete this[E.propFix[t]||t]}))}}),E.extend({prop:function(t,e,o){var l,i,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return 1===n&&E.isXMLDoc(t)||(i=E.propHooks[e=E.propFix[e]||e]),void 0!==o?i&&"set"in i&&void 0!==(l=i.set(t,o,e))?l:t[e]=o:i&&"get"in i&&null!==(l=i.get(t,e))?l:t[e]},propHooks:{tabIndex:{get:function(t){var e=E.find.attr(t,"tabindex");return e?parseInt(e,10):_e.test(t.nodeName)||Be.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),k.optSelected||(E.propHooks.selected={get:function(t){return null},set:function(t){}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){E.propFix[this.toLowerCase()]=this})),E.fn.extend({addClass:function(t){var e,o,l,i,n,r,s,c=0;if(d(t))return this.each((function(e){E(this).addClass(t.call(this,e,Te(this)))}));if((e=fe(t)).length)for(;o=this[c++];)if(i=Te(o),l=1===o.nodeType&&" "+ge(i)+" "){for(r=0;n=e[r++];)l.indexOf(" "+n+" ")<0&&(l+=n+" ");i!==(s=ge(l))&&o.setAttribute("class",s)}return this},removeClass:function(t){var e,o,l,i,n,r,s,c=0;if(d(t))return this.each((function(e){E(this).removeClass(t.call(this,e,Te(this)))}));if(!arguments.length)return this.attr("class","");if((e=fe(t)).length)for(;o=this[c++];)if(i=Te(o),l=1===o.nodeType&&" "+ge(i)+" "){for(r=0;n=e[r++];)for(;-1<l.indexOf(" "+n+" ");)l=l.replace(" "+n+" "," ");i!==(s=ge(l))&&o.setAttribute("class",s)}return this},toggleClass:function(t,e){var o=typeof t,l="string"===o||Array.isArray(t);return"boolean"==typeof e&&l?e?this.addClass(t):this.removeClass(t):d(t)?this.each((function(o){E(this).toggleClass(t.call(this,o,Te(this),e),e)})):this.each((function(){var e,i,n,r;if(l)for(i=0,n=E(this),r=fe(t);e=r[i++];)n.hasClass(e)?n.removeClass(e):n.addClass(e);else void 0!==t&&"boolean"!==o||((e=Te(this))&&q.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":q.get(this,"__className__")||""))}))},hasClass:function(t){var e,o,l=0;for(e=" "+t+" ";o=this[l++];)if(1===o.nodeType&&-1<(" "+ge(Te(o))+" ").indexOf(e))return!0;return!1}});var Ee=/\r/g;E.fn.extend({val:function(t){var e,o,l,i=this[0];return arguments.length?(l=d(t),this.each((function(o){var i;1===this.nodeType&&(null==(i=l?t.call(this,o,E(this).val()):t)?i="":"number"==typeof i?i+="":Array.isArray(i)&&(i=E.map(i,(function(t){return null==t?"":t+""}))),(e=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))}))):i?(e=E.valHooks[i.type]||E.valHooks[i.nodeName.toLowerCase()])&&"get"in e&&void 0!==(o=e.get(i,"value"))?o:"string"==typeof(o=i.value)?o.replace(Ee,""):null==o?"":o:void 0}}),E.extend({valHooks:{option:{get:function(t){var e=E.find.attr(t,"value");return null!=e?e:ge(E.text(t))}},select:{get:function(t){var e,o,l,i=t.options,n=t.selectedIndex,r="select-one"===t.type,s=r?null:[],c=r?n+1:i.length;for(l=n<0?c:r?n:0;l<c;l++)if(((o=i[l]).selected||l===n)&&!o.disabled&&(!o.parentNode.disabled||!I(o.parentNode,"optgroup"))){if(e=E(o).val(),r)return e;s.push(e)}return s},set:function(t,e){for(var o,l,i=t.options,n=E.makeArray(e),r=i.length;r--;)((l=i[r]).selected=-1<E.inArray(E.valHooks.option.get(l),n))&&(o=!0);return o||(t.selectedIndex=-1),n}}}}),E.each(["radio","checkbox"],(function(){E.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<E.inArray(E(t).val(),e)}},k.checkOn||(E.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),k.focusin="onfocusin"in t;var ve=/^(?:focusinfocus|focusoutblur)$/,me=function(t){t.stopPropagation()};E.extend(E.event,{trigger:function(e,o,i,n){var r,s,c,a,u,p,y,k,B=[i||l],g=h.call(e,"type")?e.type:e,T=h.call(e,"namespace")?e.namespace.split("."):[];if(s=k=c=i=i||l,3!==i.nodeType&&8!==i.nodeType&&!ve.test(g+E.event.triggered)&&(-1<g.indexOf(".")&&(g=(T=g.split(".")).shift(),T.sort()),u=g.indexOf(":")<0&&"on"+g,(e=e[E.expando]?e:new E.Event(g,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=T.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+T.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),o=null==o?[e]:E.makeArray(o,[e]),y=E.event.special[g]||{},n||!y.trigger||!1!==y.trigger.apply(i,o))){if(!n&&!y.noBubble&&!_(i)){for(ve.test((a=y.delegateType||g)+g)||(s=s.parentNode);s;s=s.parentNode)B.push(s),c=s;c===(i.ownerDocument||l)&&B.push(c.defaultView||c.parentWindow||t)}for(r=0;(s=B[r++])&&!e.isPropagationStopped();)k=s,e.type=1<r?a:y.bindType||g,(p=(q.get(s,"events")||{})[e.type]&&q.get(s,"handle"))&&p.apply(s,o),(p=u&&s[u])&&p.apply&&z(s)&&(e.result=p.apply(s,o),!1===e.result&&e.preventDefault());return e.type=g,n||e.isDefaultPrevented()||y._default&&!1!==y._default.apply(B.pop(),o)||!z(i)||u&&d(i[g])&&!_(i)&&((c=i[u])&&(i[u]=null),E.event.triggered=g,e.isPropagationStopped()&&k.addEventListener(g,me),i[g](),e.isPropagationStopped()&&k.removeEventListener(g,me),E.event.triggered=void 0,c&&(i[u]=c)),e.result}},simulate:function(t,e,o){var l=E.extend(new E.Event,o,{type:t,isSimulated:!0});E.event.trigger(l,null,e)}}),E.fn.extend({trigger:function(t,e){return this.each((function(){E.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var o=this[0];if(o)return E.event.trigger(t,e,o,!0)}}),k.focusin||E.each({focus:"focusin",blur:"focusout"},(function(t,e){var o=function(t){E.event.simulate(e,t.target,E.event.fix(t))};E.event.special[e]={setup:function(){var l=this.ownerDocument||this,i=q.access(l,e);i||l.addEventListener(t,o,!0),q.access(l,e,(i||0)+1)},teardown:function(){var l=this.ownerDocument||this,i=q.access(l,e)-1;i?q.access(l,e,i):(l.removeEventListener(t,o,!0),q.remove(l,e))}}}));var be=t.location,Se=Date.now(),Ce=/\?/;E.parseXML=function(e){var o;if(!e||"string"!=typeof e)return null;try{o=(new t.DOMParser).parseFromString(e,"text/xml")}catch(e){o=void 0}return o&&!o.getElementsByTagName("parsererror").length||E.error("Invalid XML: "+e),o};var Re=/\[\]$/,Ie=/\r?\n/g,Oe=/^(?:submit|button|image|reset|file)$/i,Ae=/^(?:input|select|textarea|keygen)/i;function De(t,e,o,l){var i;if(Array.isArray(e))E.each(e,(function(e,i){o||Re.test(t)?l(t,i):De(t+"["+("object"==typeof i&&null!=i?e:"")+"]",i,o,l)}));else if(o||"object"!==T(e))l(t,e);else for(i in e)De(t+"["+i+"]",e[i],o,l)}E.param=function(t,e){var o,l=[],i=function(t,e){var o=d(e)?e():e;l[l.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==o?"":o)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!E.isPlainObject(t))E.each(t,(function(){i(this.name,this.value)}));else for(o in t)De(o,t[o],e,i);return l.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=E.prop(this,"elements");return t?E.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!E(this).is(":disabled")&&Ae.test(this.nodeName)&&!Oe.test(t)&&(this.checked||!pt.test(t))})).map((function(t,e){var o=E(this).val();return null==o?null:Array.isArray(o)?E.map(o,(function(t){return{name:e.name,value:t.replace(Ie,"\r\n")}})):{name:e.name,value:o.replace(Ie,"\r\n")}})).get()}});var Ne=/%20/g,Me=/#.*$/,Le=/([?&])_=[^&]*/,we=/^(.*?):[ \t]*([^\r\n]*)$/gm,xe=/^(?:GET|HEAD)$/,Pe=/^\/\//,Fe={},Ue={},He="*/".concat("*"),Ve=l.createElement("a");function Ge(t){return function(e,o){"string"!=typeof e&&(o=e,e="*");var l,i=0,n=e.toLowerCase().match(x)||[];if(d(o))for(;l=n[i++];)"+"===l[0]?(l=l.slice(1)||"*",(t[l]=t[l]||[]).unshift(o)):(t[l]=t[l]||[]).push(o)}}function We(t,e,o,l){var i={},n=t===Ue;function r(s){var c;return i[s]=!0,E.each(t[s]||[],(function(t,s){var a=s(e,o,l);return"string"!=typeof a||n||i[a]?n?!(c=a):void 0:(e.dataTypes.unshift(a),r(a),!1)})),c}return r(e.dataTypes[0])||!i["*"]&&r("*")}function Xe(t,e){var o,l,i=E.ajaxSettings.flatOptions||{};for(o in e)void 0!==e[o]&&((i[o]?t:l||(l={}))[o]=e[o]);return l&&E.extend(!0,t,l),t}Ve.href=be.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:be.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(be.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":He,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Xe(Xe(t,E.ajaxSettings),e):Xe(E.ajaxSettings,t)},ajaxPrefilter:Ge(Fe),ajaxTransport:Ge(Ue),ajax:function(e,o){"object"==typeof e&&(o=e,e=void 0);var i,n,r,s,c,a,u,h,p,y,k=E.ajaxSetup({},o=o||{}),d=k.context||k,_=k.context&&(d.nodeType||d.jquery)?E(d):E.event,B=E.Deferred(),g=E.Callbacks("once memory"),T=k.statusCode||{},f={},v={},m="canceled",b={readyState:0,getResponseHeader:function(t){var e;if(u){if(!s)for(s={};e=we.exec(r);)s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return u?r:null},setRequestHeader:function(t,e){return null==u&&(t=v[t.toLowerCase()]=v[t.toLowerCase()]||t,f[t]=e),this},overrideMimeType:function(t){return null==u&&(k.mimeType=t),this},statusCode:function(t){var e;if(t)if(u)b.always(t[b.status]);else for(e in t)T[e]=[T[e],t[e]];return this},abort:function(t){var e=t||m;return i&&i.abort(e),S(0,e),this}};if(B.promise(b),k.url=((e||k.url||be.href)+"").replace(Pe,be.protocol+"//"),k.type=o.method||o.type||k.method||k.type,k.dataTypes=(k.dataType||"*").toLowerCase().match(x)||[""],null==k.crossDomain){a=l.createElement("a");try{a.href=k.url,a.href=a.href,k.crossDomain=Ve.protocol+"//"+Ve.host!=a.protocol+"//"+a.host}catch(e){k.crossDomain=!0}}if(k.data&&k.processData&&"string"!=typeof k.data&&(k.data=E.param(k.data,k.traditional)),We(Fe,k,o,b),u)return b;for(p in(h=E.event&&k.global)&&0==E.active++&&E.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!xe.test(k.type),n=k.url.replace(Me,""),k.hasContent?k.data&&k.processData&&0===(k.contentType||"").indexOf("application/x-www-form-urlencoded")&&(k.data=k.data.replace(Ne,"+")):(y=k.url.slice(n.length),k.data&&(k.processData||"string"==typeof k.data)&&(n+=(Ce.test(n)?"&":"?")+k.data,delete k.data),!1===k.cache&&(n=n.replace(Le,"$1"),y=(Ce.test(n)?"&":"?")+"_="+Se+++y),k.url=n+y),k.ifModified&&(E.lastModified[n]&&b.setRequestHeader("If-Modified-Since",E.lastModified[n]),E.etag[n]&&b.setRequestHeader("If-None-Match",E.etag[n])),(k.data&&k.hasContent&&!1!==k.contentType||o.contentType)&&b.setRequestHeader("Content-Type",k.contentType),b.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+He+"; q=0.01":""):k.accepts["*"]),k.headers)b.setRequestHeader(p,k.headers[p]);if(k.beforeSend&&(!1===k.beforeSend.call(d,b,k)||u))return b.abort();if(m="abort",g.add(k.complete),b.done(k.success),b.fail(k.error),i=We(Ue,k,o,b)){if(b.readyState=1,h&&_.trigger("ajaxSend",[b,k]),u)return b;k.async&&0<k.timeout&&(c=t.setTimeout((function(){b.abort("timeout")}),k.timeout));try{u=!1,i.send(f,S)}catch(e){if(u)throw e;S(-1,e)}}else S(-1,"No Transport");function S(e,o,l,s){var a,p,y,f,v,m=o;u||(u=!0,c&&t.clearTimeout(c),i=void 0,r=s||"",b.readyState=0<e?4:0,a=200<=e&&e<300||304===e,l&&(f=function(t,e,o){for(var l,i,n,r,s=t.contents,c=t.dataTypes;"*"===c[0];)c.shift(),void 0===l&&(l=t.mimeType||e.getResponseHeader("Content-Type"));if(l)for(i in s)if(s[i]&&s[i].test(l)){c.unshift(i);break}if(c[0]in o)n=c[0];else{for(i in o){if(!c[0]||t.converters[i+" "+c[0]]){n=i;break}r||(r=i)}n=n||r}if(n)return n!==c[0]&&c.unshift(n),o[n]}(k,b,l)),f=function(t,e,o,l){var i,n,r,s,c,a={},u=t.dataTypes.slice();if(u[1])for(r in t.converters)a[r.toLowerCase()]=t.converters[r];for(n=u.shift();n;)if(t.responseFields[n]&&(o[t.responseFields[n]]=e),!c&&l&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),c=n,n=u.shift())if("*"===n)n=c;else if("*"!==c&&c!==n){if(!(r=a[c+" "+n]||a["* "+n]))for(i in a)if((s=i.split(" "))[1]===n&&(r=a[c+" "+s[0]]||a["* "+s[0]])){!0===r?r=a[i]:!0!==a[i]&&(n=s[0],u.unshift(s[1]));break}if(!0!==r)if(r&&t.throws)e=r(e);else try{e=r(e)}catch(t){return{state:"parsererror",error:r?t:"No conversion from "+c+" to "+n}}}return{state:"success",data:e}}(k,f,b,a),a?(k.ifModified&&((v=b.getResponseHeader("Last-Modified"))&&(E.lastModified[n]=v),(v=b.getResponseHeader("etag"))&&(E.etag[n]=v)),204===e||"HEAD"===k.type?m="nocontent":304===e?m="notmodified":(m=f.state,p=f.data,a=!(y=f.error))):(y=m,!e&&m||(m="error",e<0&&(e=0))),b.status=e,b.statusText=(o||m)+"",a?B.resolveWith(d,[p,m,b]):B.rejectWith(d,[b,m,y]),b.statusCode(T),T=void 0,h&&_.trigger(a?"ajaxSuccess":"ajaxError",[b,k,a?p:y]),g.fireWith(d,[b,m]),h&&(_.trigger("ajaxComplete",[b,k]),--E.active||E.event.trigger("ajaxStop")))}return b},getJSON:function(t,e,o){return E.get(t,e,o,"json")},getScript:function(t,e){return E.get(t,void 0,e,"script")}}),E.each(["get","post"],(function(t,e){E[e]=function(t,o,l,i){return d(o)&&(i=i||l,l=o,o=void 0),E.ajax(E.extend({url:t,type:e,dataType:i,data:o,success:l},E.isPlainObject(t)&&t))}})),E._evalUrl=function(t,e){return E.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){E.globalEval(t,e)}})},E.fn.extend({wrapAll:function(t){var e;return this[0]&&(d(t)&&(t=t.call(this[0])),e=E(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return d(t)?this.each((function(e){E(this).wrapInner(t.call(this,e))})):this.each((function(){var e=E(this),o=e.contents();o.length?o.wrapAll(t):e.append(t)}))},wrap:function(t){var e=d(t);return this.each((function(o){E(this).wrapAll(e?t.call(this,o):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){E(this).replaceWith(this.childNodes)})),this}}),E.expr.pseudos.hidden=function(t){return!E.expr.pseudos.visible(t)},E.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var Ye={0:200,1223:204},Je=E.ajaxSettings.xhr();k.cors=!!Je&&"withCredentials"in Je,k.ajax=Je=!!Je,E.ajaxTransport((function(e){var o,l;if(k.cors||Je&&!e.crossDomain)return{send:function(i,n){var r,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)s[r]=e.xhrFields[r];for(r in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest"),i)s.setRequestHeader(r,i[r]);o=function(t){return function(){o&&(o=l=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?n(0,"error"):n(s.status,s.statusText):n(Ye[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=o(),l=s.onerror=s.ontimeout=o("error"),void 0!==s.onabort?s.onabort=l:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout((function(){o&&l()}))},o=o("abort");try{s.send(e.hasContent&&e.data||null)}catch(i){if(o)throw i}},abort:function(){o&&o()}}})),E.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return E.globalEval(t),t}}}),E.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),E.ajaxTransport("script",(function(t){var e,o;if(t.crossDomain||t.scriptAttrs)return{send:function(i,n){e=E("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",o=function(t){e.remove(),o=null,t&&n("error"===t.type?404:200,t.type)}),l.head.appendChild(e[0])},abort:function(){o&&o()}}}));var Ke,ze=[],je=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ze.pop()||E.expando+"_"+Se++;return this[t]=!0,t}}),E.ajaxPrefilter("json jsonp",(function(e,o,l){var i,n,r,s=!1!==e.jsonp&&(je.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&je.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return i=e.jsonpCallback=d(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(je,"$1"+i):!1!==e.jsonp&&(e.url+=(Ce.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return r||E.error(i+" was not called"),r[0]},e.dataTypes[0]="json",n=t[i],t[i]=function(){r=arguments},l.always((function(){void 0===n?E(t).removeProp(i):t[i]=n,e[i]&&(e.jsonpCallback=o.jsonpCallback,ze.push(i)),r&&d(n)&&n(r[0]),r=n=void 0})),"script"})),k.createHTMLDocument=((Ke=l.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Ke.childNodes.length),E.parseHTML=function(t,e,o){return"string"!=typeof t?[]:("boolean"==typeof e&&(o=e,e=!1),e||(k.createHTMLDocument?((i=(e=l.implementation.createHTMLDocument("")).createElement("base")).href=l.location.href,e.head.appendChild(i)):e=l),r=!o&&[],(n=O.exec(t))?[e.createElement(n[1])]:(n=Et([t],e,r),r&&r.length&&E(r).remove(),E.merge([],n.childNodes)));var i,n,r},E.fn.load=function(t,e,o){var l,i,n,r=this,s=t.indexOf(" ");return-1<s&&(l=ge(t.slice(s)),t=t.slice(0,s)),d(e)?(o=e,e=void 0):e&&"object"==typeof e&&(i="POST"),0<r.length&&E.ajax({url:t,type:i||"GET",dataType:"html",data:e}).done((function(t){n=arguments,r.html(l?E("<div>").append(E.parseHTML(t)).find(l):t)})).always(o&&function(t,e){r.each((function(){o.apply(this,n||[t.responseText,e,t])}))}),this},E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){E.fn[e]=function(t){return this.on(e,t)}})),E.expr.pseudos.animated=function(t){return E.grep(E.timers,(function(e){return t===e.elem})).length},E.offset={setOffset:function(t,e,o){var l,i,n,r,s,c,a=E.css(t,"position"),u=E(t),h={};"static"===a&&(t.style.position="relative"),s=u.offset(),n=E.css(t,"top"),c=E.css(t,"left"),("absolute"===a||"fixed"===a)&&-1<(n+c).indexOf("auto")?(r=(l=u.position()).top,i=l.left):(r=parseFloat(n)||0,i=parseFloat(c)||0),d(e)&&(e=e.call(t,o,E.extend({},s))),null!=e.top&&(h.top=e.top-s.top+r),null!=e.left&&(h.left=e.left-s.left+i),"using"in e?e.using.call(t,h):u.css(h)}},E.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){E.offset.setOffset(this,t,e)}));var e,o,l=this[0];return l?l.getClientRects().length?{top:(e=l.getBoundingClientRect()).top+(o=l.ownerDocument.defaultView).pageYOffset,left:e.left+o.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,o,l=this[0],i={top:0,left:0};if("fixed"===E.css(l,"position"))e=l.getBoundingClientRect();else{for(e=this.offset(),o=l.ownerDocument,t=l.offsetParent||o.documentElement;t&&(t===o.body||t===o.documentElement)&&"static"===E.css(t,"position");)t=t.parentNode;t&&t!==l&&1===t.nodeType&&((i=E(t).offset()).top+=E.css(t,"borderTopWidth",!0),i.left+=E.css(t,"borderLeftWidth",!0))}return{top:e.top-i.top-E.css(l,"marginTop",!0),left:e.left-i.left-E.css(l,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===E.css(t,"position");)t=t.offsetParent;return t||it}))}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var o="pageYOffset"===e;E.fn[t]=function(l){return W(this,(function(t,l,i){var n;if(_(t)?n=t:9===t.nodeType&&(n=t.defaultView),void 0===i)return n?n[e]:t[l];n?n.scrollTo(o?n.pageXOffset:i,o?i:n.pageYOffset):t[l]=i}),t,l,arguments.length)}})),E.each(["top","left"],(function(t,e){E.cssHooks[e]=Xt(k.pixelPosition,(function(t,o){if(o)return o=Wt(t,e),Ht.test(o)?E(t).position()[e]+"px":o}))})),E.each({Height:"height",Width:"width"},(function(t,e){E.each({padding:"inner"+t,content:e,"":"outer"+t},(function(o,l){E.fn[l]=function(i,n){var r=arguments.length&&(o||"boolean"!=typeof i),s=o||(!0===i||!0===n?"margin":"border");return W(this,(function(e,o,i){var n;return _(e)?0===l.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+t],n["scroll"+t],e.body["offset"+t],n["offset"+t],n["client"+t])):void 0===i?E.css(e,o,s):E.style(e,o,i,s)}),e,r?i:void 0,r)}}))})),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){E.fn[e]=function(t,o){return 0<arguments.length?this.on(e,null,t,o):this.trigger(e)}})),E.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),E.fn.extend({bind:function(t,e,o){return this.on(t,null,e,o)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,o,l){return this.on(e,t,o,l)},undelegate:function(t,e,o){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",o)}}),E.proxy=function(t,e){var o,l,i;if("string"==typeof e&&(o=t[e],e=t,t=o),d(t))return l=n.call(arguments,2),(i=function(){return t.apply(e||this,l.concat(n.call(arguments)))}).guid=t.guid=t.guid||E.guid++,i},E.holdReady=function(t){t?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=I,E.isFunction=d,E.isWindow=_,E.camelCase=K,E.type=T,E.now=Date.now,E.isNumeric=function(t){var e=E.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return E}));var qe=t.jQuery,Ze=t.$;return E.noConflict=function(e){return t.$===E&&(t.$=Ze),e&&t.jQuery===E&&(t.jQuery=qe),E},e||(t.jQuery=t.$=E),E}));